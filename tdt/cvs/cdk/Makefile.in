# Makefile.in generated by automake 1.11.1 from Makefile.am.
# @configure_input@

# Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
# 2003, 2004, 2005, 2006, 2007, 2008, 2009  Free Software Foundation,
# Inc.
# This Makefile.in is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.

@SET_MAKE@

# http://www.stlinux.com/docs/getting_started-1.0/doc.php?print=1

##################################################################################################

# ipkg overall stuff

#include @buildprefix@/make/shared.mk

#
# FILESYSTEM
#
#$(prefix)/min-cdkroot $(prefix)/std-cdkroot $(prefix)/max-cdkroot \
#$(targetprefix): \
#$(prefix)/%:
#	$(INSTALL) -d $@

#
# DIVERSE STUFF / TOOLS
#

# misc/libs

# misc/tools

# tuxbox/plugins

#
# STOCK (pvrmain GUI)
#

# tuxbox/enigma2

#if ENABLE_MEDIAFWGSTREAMER
#MEDIAFW = gstreamer
#else
#MEDIAFW = eplayer4
#endif

# tuxbox/neutrino

# tuxbox/libtuxbox

# This file contains different cleaning targets. They try to be, at least
# in spirit, compatible with the GNU Makefiles standards.

# Note: automake defines targets clean etc, the Makefile author
# therefore should not. Instead, we define targets like clean-local,
# which are called from automake's clean.

# Phony declarations of targets in Makefile.am
pkgdatadir = $(datadir)/@PACKAGE@
pkgincludedir = $(includedir)/@PACKAGE@
pkglibdir = $(libdir)/@PACKAGE@
pkglibexecdir = $(libexecdir)/@PACKAGE@
am__cd = CDPATH="$${ZSH_VERSION+.}$(PATH_SEPARATOR)" && cd
install_sh_DATA = $(install_sh) -c -m 644
install_sh_PROGRAM = $(install_sh) -c
install_sh_SCRIPT = $(install_sh) -c
INSTALL_HEADER = $(INSTALL_DATA)
transform = $(program_transform_name)
NORMAL_INSTALL = :
PRE_INSTALL = :
POST_INSTALL = :
NORMAL_UNINSTALL = :
PRE_UNINSTALL = :
POST_UNINSTALL = :
build_triplet = @build@
host_triplet = @host@
target_triplet = @target@
DIST_COMMON = README $(am__configure_deps) $(srcdir)/Makefile.am \
	$(srcdir)/Makefile.in $(srcdir)/make/archive-specs.mk \
	$(srcdir)/make/bare-os.mk $(srcdir)/make/bootstrap.mk \
	$(srcdir)/make/buildenv.mk $(srcdir)/make/busybox.mk \
	$(srcdir)/make/cleantargets.mk \
	$(srcdir)/make/contrib-apps-specs.mk \
	$(srcdir)/make/contrib-apps.mk $(srcdir)/make/contrib-libs.mk \
	$(srcdir)/make/development.mk $(srcdir)/make/disttargets.mk \
	$(srcdir)/make/diverse-tools.mk \
	$(srcdir)/make/enigma2-nightly.mk $(srcdir)/make/enigma2.mk \
	$(srcdir)/make/hostapps.mk $(srcdir)/make/ipkg.mk \
	$(srcdir)/make/libtuxbox.mk $(srcdir)/make/linux-kernel.mk \
	$(srcdir)/make/misc-specs.mk $(srcdir)/make/misc_libs.mk \
	$(srcdir)/make/misc_tools.mk $(srcdir)/make/net-apps.mk \
	$(srcdir)/make/neutrino.mk $(srcdir)/make/phony.mk \
	$(srcdir)/make/plugins.mk $(srcdir)/make/prog.mk \
	$(srcdir)/make/record.mk $(srcdir)/make/reduce-libs.mk \
	$(srcdir)/make/release.mk $(srcdir)/make/release_evolux.mk \
	$(srcdir)/make/release_neutrino.mk \
	$(srcdir)/make/release_neutrino_nightly.mk \
	$(srcdir)/make/release_neutrino_static.mk \
	$(srcdir)/make/root-etc.mk \
	$(srcdir)/make/stg-framebuffer-specs.mk \
	$(srcdir)/make/stock.mk $(srcdir)/make/tags.mk \
	$(srcdir)/make/u-boot.mk $(srcdir)/make/yaud.mk \
	$(srcdir)/rules-downcheck.pl.in $(top_srcdir)/configure \
	AUTHORS COPYING ChangeLog INSTALL NEWS config.guess config.sub \
	depcomp install-sh ltmain.sh missing
@ENABLE_CCACHE_TRUE@am__append_1 = --enable-ccache 
@MAINTAINER_MODE_TRUE@am__append_2 = --enable-maintainer-mode
@TARGETRULESET_FLASH_TRUE@am__append_3 = --without-debug
subdir = .
ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
am__aclocal_m4_deps = $(top_srcdir)/acinclude.m4 \
	$(top_srcdir)/configure.ac
am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
	$(ACLOCAL_M4)
am__CONFIG_DISTCLEAN_FILES = config.status config.cache config.log \
 configure.lineno config.status.lineno
mkinstalldirs = $(install_sh) -d
CONFIG_CLEAN_FILES = rules-downcheck.pl
CONFIG_CLEAN_VPATH_FILES =
SOURCES =
DIST_SOURCES =
DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
distdir = $(PACKAGE)-$(VERSION)
top_distdir = $(distdir)
am__remove_distdir = \
  { test ! -d "$(distdir)" \
    || { find "$(distdir)" -type d ! -perm -200 -exec chmod u+w {} ';' \
         && rm -fr "$(distdir)"; }; }
DIST_ARCHIVES = $(distdir).tar.gz
GZIP_ENV = --best
distuninstallcheck_listfiles = find . -type f -print
distcleancheck_listfiles = find . -type f -print
VPATH = $(DEPDIR)
ACLOCAL = @ACLOCAL@
ADB_BOX = @ADB_BOX@
AMTAR = @AMTAR@
ATEVIO7500 = @ATEVIO7500@
AUTOCONF = @AUTOCONF@
AUTOHEADER = @AUTOHEADER@
AUTOMAKE = @AUTOMAKE@
AWK = @AWK@
BZIP2 = @BZIP2@
CC = @CC@
CCACHE = @CCACHE@
CCACHE_BIN = @CCACHE_BIN@
CCDEPMODE = @CCDEPMODE@
CFLAGS = @CFLAGS@
CFV = @CFV@
CIFS = @CIFS@
CLEANUP = @CLEANUP@
CPPFLAGS = @CPPFLAGS@
CPU_MODEL = @CPU_MODEL@
CUBEREVO = @CUBEREVO@
CUBEREVO_2000HD = @CUBEREVO_2000HD@
CUBEREVO_250HD = @CUBEREVO_250HD@
CUBEREVO_9500HD = @CUBEREVO_9500HD@
CUBEREVO_MINI = @CUBEREVO_MINI@
CUBEREVO_MINI2 = @CUBEREVO_MINI2@
CUBEREVO_MINI_FTA = @CUBEREVO_MINI_FTA@
CXX = @CXX@
CXXDEPMODE = @CXXDEPMODE@
CXXFLAGS = @CXXFLAGS@
CYGPATH_W = @CYGPATH_W@
DATA_PARTITION_SIZE = @DATA_PARTITION_SIZE@
DEFS = @DEFS@
DEPDIR = .deps
DEPENDS_a52dec = @DEPENDS_a52dec@
DEPENDS_autofs = @DEPENDS_autofs@
DEPENDS_brofs = @DEPENDS_brofs@
DEPENDS_busybox = @DEPENDS_busybox@
DEPENDS_cairo = @DEPENDS_cairo@
DEPENDS_ccache = @DEPENDS_ccache@
DEPENDS_console_data = @DEPENDS_console_data@
DEPENDS_cramfs = @DEPENDS_cramfs@
DEPENDS_curl = @DEPENDS_curl@
DEPENDS_curlftpfs = @DEPENDS_curlftpfs@
DEPENDS_dfbpp = @DEPENDS_dfbpp@
DEPENDS_directfb = @DEPENDS_directfb@
DEPENDS_e2fsprogs = @DEPENDS_e2fsprogs@
DEPENDS_elementtree = @DEPENDS_elementtree@
DEPENDS_enchant = @DEPENDS_enchant@
DEPENDS_ethtool = @DEPENDS_ethtool@
DEPENDS_evebrowser = @DEPENDS_evebrowser@
DEPENDS_expat = @DEPENDS_expat@
DEPENDS_fbset = @DEPENDS_fbset@
DEPENDS_ffmpeg = @DEPENDS_ffmpeg@
DEPENDS_flashybrid = @DEPENDS_flashybrid@
DEPENDS_fontconfig = @DEPENDS_fontconfig@
DEPENDS_freetype = @DEPENDS_freetype@
DEPENDS_freetype_old = @DEPENDS_freetype_old@
DEPENDS_fuse = @DEPENDS_fuse@
DEPENDS_glib2 = @DEPENDS_glib2@
DEPENDS_grep = @DEPENDS_grep@
DEPENDS_gst_ffmpeg = @DEPENDS_gst_ffmpeg@
DEPENDS_gst_plugins_bad = @DEPENDS_gst_plugins_bad@
DEPENDS_gst_plugins_base = @DEPENDS_gst_plugins_base@
DEPENDS_gst_plugins_dvbmediasink = @DEPENDS_gst_plugins_dvbmediasink@
DEPENDS_gst_plugins_good = @DEPENDS_gst_plugins_good@
DEPENDS_gst_plugins_ugly = @DEPENDS_gst_plugins_ugly@
DEPENDS_gstreamer = @DEPENDS_gstreamer@
DEPENDS_host_python = @DEPENDS_host_python@
DEPENDS_icu4c = @DEPENDS_icu4c@
DEPENDS_ipkg = @DEPENDS_ipkg@
DEPENDS_ipkg_host = @DEPENDS_ipkg_host@
DEPENDS_ipkg_utils = @DEPENDS_ipkg_utils@
DEPENDS_jfsutils = @DEPENDS_jfsutils@
DEPENDS_jpeg = @DEPENDS_jpeg@
DEPENDS_lcms = @DEPENDS_lcms@
DEPENDS_libalsa = @DEPENDS_libalsa@
DEPENDS_libass = @DEPENDS_libass@
DEPENDS_libboost = @DEPENDS_libboost@
DEPENDS_libcap = @DEPENDS_libcap@
DEPENDS_libdvdcss = @DEPENDS_libdvdcss@
DEPENDS_libdvdnav = @DEPENDS_libdvdnav@
DEPENDS_libdvdread = @DEPENDS_libdvdread@
DEPENDS_libflac = @DEPENDS_libflac@
DEPENDS_libfribidi = @DEPENDS_libfribidi@
DEPENDS_libgif = @DEPENDS_libgif@
DEPENDS_libiconv = @DEPENDS_libiconv@
DEPENDS_libid3tag = @DEPENDS_libid3tag@
DEPENDS_libmad = @DEPENDS_libmad@
DEPENDS_libmng = @DEPENDS_libmng@
DEPENDS_libogg = @DEPENDS_libogg@
DEPENDS_libpng = @DEPENDS_libpng@
DEPENDS_libreadline = @DEPENDS_libreadline@
DEPENDS_libsigc = @DEPENDS_libsigc@
DEPENDS_libsoup = @DEPENDS_libsoup@
DEPENDS_libtool = @DEPENDS_libtool@
DEPENDS_libungif = @DEPENDS_libungif@
DEPENDS_libvorbisidec = @DEPENDS_libvorbisidec@
DEPENDS_libxml2 = @DEPENDS_libxml2@
DEPENDS_libxmlccwrap = @DEPENDS_libxmlccwrap@
DEPENDS_libxslt = @DEPENDS_libxslt@
DEPENDS_libz = @DEPENDS_libz@
DEPENDS_lighttpd = @DEPENDS_lighttpd@
DEPENDS_linux = @DEPENDS_linux@
DEPENDS_linux23 = @DEPENDS_linux23@
DEPENDS_linux24 = @DEPENDS_linux24@
DEPENDS_linuxp0040 = @DEPENDS_linuxp0040@
DEPENDS_linuxp0041 = @DEPENDS_linuxp0041@
DEPENDS_linuxp0119 = @DEPENDS_linuxp0119@
DEPENDS_linuxp0123 = @DEPENDS_linuxp0123@
DEPENDS_linuxp0201 = @DEPENDS_linuxp0201@
DEPENDS_linuxp0205 = @DEPENDS_linuxp0205@
DEPENDS_linuxp0206 = @DEPENDS_linuxp0206@
DEPENDS_linuxp0207 = @DEPENDS_linuxp0207@
DEPENDS_linuxp0209 = @DEPENDS_linuxp0209@
DEPENDS_lirc = @DEPENDS_lirc@
DEPENDS_lite = @DEPENDS_lite@
DEPENDS_lm_sensors = @DEPENDS_lm_sensors@
DEPENDS_lsb = @DEPENDS_lsb@
DEPENDS_lxml = @DEPENDS_lxml@
DEPENDS_mc = @DEPENDS_mc@
DEPENDS_mencoder = @DEPENDS_mencoder@
DEPENDS_module_init_tools = @DEPENDS_module_init_tools@
DEPENDS_mplayer = @DEPENDS_mplayer@
DEPENDS_nano = @DEPENDS_nano@
DEPENDS_ncurses = @DEPENDS_ncurses@
DEPENDS_netio = @DEPENDS_netio@
DEPENDS_netkit_base = @DEPENDS_netkit_base@
DEPENDS_netkit_ftp = @DEPENDS_netkit_ftp@
DEPENDS_nfs_utils = @DEPENDS_nfs_utils@
DEPENDS_openrdate = @DEPENDS_openrdate@
DEPENDS_openssl = @DEPENDS_openssl@
DEPENDS_opkg = @DEPENDS_opkg@
DEPENDS_pixman = @DEPENDS_pixman@
DEPENDS_pngquant = @DEPENDS_pngquant@
DEPENDS_portmap = @DEPENDS_portmap@
DEPENDS_pyopenssl = @DEPENDS_pyopenssl@
DEPENDS_python = @DEPENDS_python@
DEPENDS_record = @DEPENDS_record@
DEPENDS_rsync = @DEPENDS_rsync@
DEPENDS_ruby = @DEPENDS_ruby@
DEPENDS_samba = @DEPENDS_samba@
DEPENDS_sdparm = @DEPENDS_sdparm@
DEPENDS_setuptools = @DEPENDS_setuptools@
DEPENDS_sg3_utils = @DEPENDS_sg3_utils@
DEPENDS_sqlite = @DEPENDS_sqlite@
DEPENDS_squashfs = @DEPENDS_squashfs@
DEPENDS_sysvinit = @DEPENDS_sysvinit@
DEPENDS_twisted = @DEPENDS_twisted@
DEPENDS_twistedweb2 = @DEPENDS_twistedweb2@
DEPENDS_util_linux = @DEPENDS_util_linux@
DEPENDS_vsftpd = @DEPENDS_vsftpd@
DEPENDS_webkitdfb = @DEPENDS_webkitdfb@
DEPENDS_wireless_tools = @DEPENDS_wireless_tools@
DEPENDS_wpa_supplicant = @DEPENDS_wpa_supplicant@
DEPENDS_xfsprogs = @DEPENDS_xfsprogs@
DEPENDS_zd1211 = @DEPENDS_zd1211@
DEPENDS_zope_interface = @DEPENDS_zope_interface@
DEPSCLEANUP = @DEPSCLEANUP@
DEPSCLEANUP_a52dec = @DEPSCLEANUP_a52dec@
DEPSCLEANUP_autofs = @DEPSCLEANUP_autofs@
DEPSCLEANUP_brofs = @DEPSCLEANUP_brofs@
DEPSCLEANUP_busybox = @DEPSCLEANUP_busybox@
DEPSCLEANUP_cairo = @DEPSCLEANUP_cairo@
DEPSCLEANUP_ccache = @DEPSCLEANUP_ccache@
DEPSCLEANUP_console_data = @DEPSCLEANUP_console_data@
DEPSCLEANUP_cramfs = @DEPSCLEANUP_cramfs@
DEPSCLEANUP_curl = @DEPSCLEANUP_curl@
DEPSCLEANUP_curlftpfs = @DEPSCLEANUP_curlftpfs@
DEPSCLEANUP_dfbpp = @DEPSCLEANUP_dfbpp@
DEPSCLEANUP_directfb = @DEPSCLEANUP_directfb@
DEPSCLEANUP_e2fsprogs = @DEPSCLEANUP_e2fsprogs@
DEPSCLEANUP_elementtree = @DEPSCLEANUP_elementtree@
DEPSCLEANUP_enchant = @DEPSCLEANUP_enchant@
DEPSCLEANUP_ethtool = @DEPSCLEANUP_ethtool@
DEPSCLEANUP_evebrowser = @DEPSCLEANUP_evebrowser@
DEPSCLEANUP_expat = @DEPSCLEANUP_expat@
DEPSCLEANUP_fbset = @DEPSCLEANUP_fbset@
DEPSCLEANUP_ffmpeg = @DEPSCLEANUP_ffmpeg@
DEPSCLEANUP_flashybrid = @DEPSCLEANUP_flashybrid@
DEPSCLEANUP_fontconfig = @DEPSCLEANUP_fontconfig@
DEPSCLEANUP_freetype = @DEPSCLEANUP_freetype@
DEPSCLEANUP_freetype_old = @DEPSCLEANUP_freetype_old@
DEPSCLEANUP_fuse = @DEPSCLEANUP_fuse@
DEPSCLEANUP_glib2 = @DEPSCLEANUP_glib2@
DEPSCLEANUP_grep = @DEPSCLEANUP_grep@
DEPSCLEANUP_gst_ffmpeg = @DEPSCLEANUP_gst_ffmpeg@
DEPSCLEANUP_gst_plugins_bad = @DEPSCLEANUP_gst_plugins_bad@
DEPSCLEANUP_gst_plugins_base = @DEPSCLEANUP_gst_plugins_base@
DEPSCLEANUP_gst_plugins_dvbmediasink = @DEPSCLEANUP_gst_plugins_dvbmediasink@
DEPSCLEANUP_gst_plugins_good = @DEPSCLEANUP_gst_plugins_good@
DEPSCLEANUP_gst_plugins_ugly = @DEPSCLEANUP_gst_plugins_ugly@
DEPSCLEANUP_gstreamer = @DEPSCLEANUP_gstreamer@
DEPSCLEANUP_host_python = @DEPSCLEANUP_host_python@
DEPSCLEANUP_icu4c = @DEPSCLEANUP_icu4c@
DEPSCLEANUP_ipkg = @DEPSCLEANUP_ipkg@
DEPSCLEANUP_ipkg_host = @DEPSCLEANUP_ipkg_host@
DEPSCLEANUP_ipkg_utils = @DEPSCLEANUP_ipkg_utils@
DEPSCLEANUP_jfsutils = @DEPSCLEANUP_jfsutils@
DEPSCLEANUP_jpeg = @DEPSCLEANUP_jpeg@
DEPSCLEANUP_lcms = @DEPSCLEANUP_lcms@
DEPSCLEANUP_libalsa = @DEPSCLEANUP_libalsa@
DEPSCLEANUP_libass = @DEPSCLEANUP_libass@
DEPSCLEANUP_libboost = @DEPSCLEANUP_libboost@
DEPSCLEANUP_libcap = @DEPSCLEANUP_libcap@
DEPSCLEANUP_libdvdcss = @DEPSCLEANUP_libdvdcss@
DEPSCLEANUP_libdvdnav = @DEPSCLEANUP_libdvdnav@
DEPSCLEANUP_libdvdread = @DEPSCLEANUP_libdvdread@
DEPSCLEANUP_libflac = @DEPSCLEANUP_libflac@
DEPSCLEANUP_libfribidi = @DEPSCLEANUP_libfribidi@
DEPSCLEANUP_libgif = @DEPSCLEANUP_libgif@
DEPSCLEANUP_libiconv = @DEPSCLEANUP_libiconv@
DEPSCLEANUP_libid3tag = @DEPSCLEANUP_libid3tag@
DEPSCLEANUP_libmad = @DEPSCLEANUP_libmad@
DEPSCLEANUP_libmng = @DEPSCLEANUP_libmng@
DEPSCLEANUP_libogg = @DEPSCLEANUP_libogg@
DEPSCLEANUP_libpng = @DEPSCLEANUP_libpng@
DEPSCLEANUP_libreadline = @DEPSCLEANUP_libreadline@
DEPSCLEANUP_libsigc = @DEPSCLEANUP_libsigc@
DEPSCLEANUP_libsoup = @DEPSCLEANUP_libsoup@
DEPSCLEANUP_libtool = @DEPSCLEANUP_libtool@
DEPSCLEANUP_libungif = @DEPSCLEANUP_libungif@
DEPSCLEANUP_libvorbisidec = @DEPSCLEANUP_libvorbisidec@
DEPSCLEANUP_libxml2 = @DEPSCLEANUP_libxml2@
DEPSCLEANUP_libxmlccwrap = @DEPSCLEANUP_libxmlccwrap@
DEPSCLEANUP_libxslt = @DEPSCLEANUP_libxslt@
DEPSCLEANUP_libz = @DEPSCLEANUP_libz@
DEPSCLEANUP_lighttpd = @DEPSCLEANUP_lighttpd@
DEPSCLEANUP_linux = @DEPSCLEANUP_linux@
DEPSCLEANUP_linux23 = @DEPSCLEANUP_linux23@
DEPSCLEANUP_linux24 = @DEPSCLEANUP_linux24@
DEPSCLEANUP_linuxp0040 = @DEPSCLEANUP_linuxp0040@
DEPSCLEANUP_linuxp0041 = @DEPSCLEANUP_linuxp0041@
DEPSCLEANUP_linuxp0119 = @DEPSCLEANUP_linuxp0119@
DEPSCLEANUP_linuxp0123 = @DEPSCLEANUP_linuxp0123@
DEPSCLEANUP_linuxp0201 = @DEPSCLEANUP_linuxp0201@
DEPSCLEANUP_linuxp0205 = @DEPSCLEANUP_linuxp0205@
DEPSCLEANUP_linuxp0206 = @DEPSCLEANUP_linuxp0206@
DEPSCLEANUP_linuxp0207 = @DEPSCLEANUP_linuxp0207@
DEPSCLEANUP_linuxp0209 = @DEPSCLEANUP_linuxp0209@
DEPSCLEANUP_lirc = @DEPSCLEANUP_lirc@
DEPSCLEANUP_lite = @DEPSCLEANUP_lite@
DEPSCLEANUP_lm_sensors = @DEPSCLEANUP_lm_sensors@
DEPSCLEANUP_lsb = @DEPSCLEANUP_lsb@
DEPSCLEANUP_lxml = @DEPSCLEANUP_lxml@
DEPSCLEANUP_mc = @DEPSCLEANUP_mc@
DEPSCLEANUP_mencoder = @DEPSCLEANUP_mencoder@
DEPSCLEANUP_module_init_tools = @DEPSCLEANUP_module_init_tools@
DEPSCLEANUP_mplayer = @DEPSCLEANUP_mplayer@
DEPSCLEANUP_nano = @DEPSCLEANUP_nano@
DEPSCLEANUP_ncurses = @DEPSCLEANUP_ncurses@
DEPSCLEANUP_netio = @DEPSCLEANUP_netio@
DEPSCLEANUP_netkit_base = @DEPSCLEANUP_netkit_base@
DEPSCLEANUP_netkit_ftp = @DEPSCLEANUP_netkit_ftp@
DEPSCLEANUP_nfs_utils = @DEPSCLEANUP_nfs_utils@
DEPSCLEANUP_openrdate = @DEPSCLEANUP_openrdate@
DEPSCLEANUP_openssl = @DEPSCLEANUP_openssl@
DEPSCLEANUP_opkg = @DEPSCLEANUP_opkg@
DEPSCLEANUP_pixman = @DEPSCLEANUP_pixman@
DEPSCLEANUP_pngquant = @DEPSCLEANUP_pngquant@
DEPSCLEANUP_portmap = @DEPSCLEANUP_portmap@
DEPSCLEANUP_pyopenssl = @DEPSCLEANUP_pyopenssl@
DEPSCLEANUP_python = @DEPSCLEANUP_python@
DEPSCLEANUP_record = @DEPSCLEANUP_record@
DEPSCLEANUP_rsync = @DEPSCLEANUP_rsync@
DEPSCLEANUP_ruby = @DEPSCLEANUP_ruby@
DEPSCLEANUP_samba = @DEPSCLEANUP_samba@
DEPSCLEANUP_sdparm = @DEPSCLEANUP_sdparm@
DEPSCLEANUP_setuptools = @DEPSCLEANUP_setuptools@
DEPSCLEANUP_sg3_utils = @DEPSCLEANUP_sg3_utils@
DEPSCLEANUP_sqlite = @DEPSCLEANUP_sqlite@
DEPSCLEANUP_squashfs = @DEPSCLEANUP_squashfs@
DEPSCLEANUP_sysvinit = @DEPSCLEANUP_sysvinit@
DEPSCLEANUP_twisted = @DEPSCLEANUP_twisted@
DEPSCLEANUP_twistedweb2 = @DEPSCLEANUP_twistedweb2@
DEPSCLEANUP_util_linux = @DEPSCLEANUP_util_linux@
DEPSCLEANUP_vsftpd = @DEPSCLEANUP_vsftpd@
DEPSCLEANUP_webkitdfb = @DEPSCLEANUP_webkitdfb@
DEPSCLEANUP_wireless_tools = @DEPSCLEANUP_wireless_tools@
DEPSCLEANUP_wpa_supplicant = @DEPSCLEANUP_wpa_supplicant@
DEPSCLEANUP_xfsprogs = @DEPSCLEANUP_xfsprogs@
DEPSCLEANUP_zd1211 = @DEPSCLEANUP_zd1211@
DEPSCLEANUP_zope_interface = @DEPSCLEANUP_zope_interface@
DEPSDISTCLEANUP_a52dec = @DEPSDISTCLEANUP_a52dec@
DEPSDISTCLEANUP_autofs = @DEPSDISTCLEANUP_autofs@
DEPSDISTCLEANUP_brofs = @DEPSDISTCLEANUP_brofs@
DEPSDISTCLEANUP_busybox = @DEPSDISTCLEANUP_busybox@
DEPSDISTCLEANUP_cairo = @DEPSDISTCLEANUP_cairo@
DEPSDISTCLEANUP_ccache = @DEPSDISTCLEANUP_ccache@
DEPSDISTCLEANUP_console_data = @DEPSDISTCLEANUP_console_data@
DEPSDISTCLEANUP_cramfs = @DEPSDISTCLEANUP_cramfs@
DEPSDISTCLEANUP_curl = @DEPSDISTCLEANUP_curl@
DEPSDISTCLEANUP_curlftpfs = @DEPSDISTCLEANUP_curlftpfs@
DEPSDISTCLEANUP_dfbpp = @DEPSDISTCLEANUP_dfbpp@
DEPSDISTCLEANUP_directfb = @DEPSDISTCLEANUP_directfb@
DEPSDISTCLEANUP_e2fsprogs = @DEPSDISTCLEANUP_e2fsprogs@
DEPSDISTCLEANUP_elementtree = @DEPSDISTCLEANUP_elementtree@
DEPSDISTCLEANUP_enchant = @DEPSDISTCLEANUP_enchant@
DEPSDISTCLEANUP_ethtool = @DEPSDISTCLEANUP_ethtool@
DEPSDISTCLEANUP_evebrowser = @DEPSDISTCLEANUP_evebrowser@
DEPSDISTCLEANUP_expat = @DEPSDISTCLEANUP_expat@
DEPSDISTCLEANUP_fbset = @DEPSDISTCLEANUP_fbset@
DEPSDISTCLEANUP_ffmpeg = @DEPSDISTCLEANUP_ffmpeg@
DEPSDISTCLEANUP_flashybrid = @DEPSDISTCLEANUP_flashybrid@
DEPSDISTCLEANUP_fontconfig = @DEPSDISTCLEANUP_fontconfig@
DEPSDISTCLEANUP_freetype = @DEPSDISTCLEANUP_freetype@
DEPSDISTCLEANUP_freetype_old = @DEPSDISTCLEANUP_freetype_old@
DEPSDISTCLEANUP_fuse = @DEPSDISTCLEANUP_fuse@
DEPSDISTCLEANUP_glib2 = @DEPSDISTCLEANUP_glib2@
DEPSDISTCLEANUP_grep = @DEPSDISTCLEANUP_grep@
DEPSDISTCLEANUP_gst_ffmpeg = @DEPSDISTCLEANUP_gst_ffmpeg@
DEPSDISTCLEANUP_gst_plugins_bad = @DEPSDISTCLEANUP_gst_plugins_bad@
DEPSDISTCLEANUP_gst_plugins_base = @DEPSDISTCLEANUP_gst_plugins_base@
DEPSDISTCLEANUP_gst_plugins_dvbmediasink = @DEPSDISTCLEANUP_gst_plugins_dvbmediasink@
DEPSDISTCLEANUP_gst_plugins_good = @DEPSDISTCLEANUP_gst_plugins_good@
DEPSDISTCLEANUP_gst_plugins_ugly = @DEPSDISTCLEANUP_gst_plugins_ugly@
DEPSDISTCLEANUP_gstreamer = @DEPSDISTCLEANUP_gstreamer@
DEPSDISTCLEANUP_host_python = @DEPSDISTCLEANUP_host_python@
DEPSDISTCLEANUP_icu4c = @DEPSDISTCLEANUP_icu4c@
DEPSDISTCLEANUP_ipkg = @DEPSDISTCLEANUP_ipkg@
DEPSDISTCLEANUP_ipkg_host = @DEPSDISTCLEANUP_ipkg_host@
DEPSDISTCLEANUP_ipkg_utils = @DEPSDISTCLEANUP_ipkg_utils@
DEPSDISTCLEANUP_jfsutils = @DEPSDISTCLEANUP_jfsutils@
DEPSDISTCLEANUP_jpeg = @DEPSDISTCLEANUP_jpeg@
DEPSDISTCLEANUP_lcms = @DEPSDISTCLEANUP_lcms@
DEPSDISTCLEANUP_libalsa = @DEPSDISTCLEANUP_libalsa@
DEPSDISTCLEANUP_libass = @DEPSDISTCLEANUP_libass@
DEPSDISTCLEANUP_libboost = @DEPSDISTCLEANUP_libboost@
DEPSDISTCLEANUP_libcap = @DEPSDISTCLEANUP_libcap@
DEPSDISTCLEANUP_libdvdcss = @DEPSDISTCLEANUP_libdvdcss@
DEPSDISTCLEANUP_libdvdnav = @DEPSDISTCLEANUP_libdvdnav@
DEPSDISTCLEANUP_libdvdread = @DEPSDISTCLEANUP_libdvdread@
DEPSDISTCLEANUP_libflac = @DEPSDISTCLEANUP_libflac@
DEPSDISTCLEANUP_libfribidi = @DEPSDISTCLEANUP_libfribidi@
DEPSDISTCLEANUP_libgif = @DEPSDISTCLEANUP_libgif@
DEPSDISTCLEANUP_libiconv = @DEPSDISTCLEANUP_libiconv@
DEPSDISTCLEANUP_libid3tag = @DEPSDISTCLEANUP_libid3tag@
DEPSDISTCLEANUP_libmad = @DEPSDISTCLEANUP_libmad@
DEPSDISTCLEANUP_libmng = @DEPSDISTCLEANUP_libmng@
DEPSDISTCLEANUP_libogg = @DEPSDISTCLEANUP_libogg@
DEPSDISTCLEANUP_libpng = @DEPSDISTCLEANUP_libpng@
DEPSDISTCLEANUP_libreadline = @DEPSDISTCLEANUP_libreadline@
DEPSDISTCLEANUP_libsigc = @DEPSDISTCLEANUP_libsigc@
DEPSDISTCLEANUP_libsoup = @DEPSDISTCLEANUP_libsoup@
DEPSDISTCLEANUP_libtool = @DEPSDISTCLEANUP_libtool@
DEPSDISTCLEANUP_libungif = @DEPSDISTCLEANUP_libungif@
DEPSDISTCLEANUP_libvorbisidec = @DEPSDISTCLEANUP_libvorbisidec@
DEPSDISTCLEANUP_libxml2 = @DEPSDISTCLEANUP_libxml2@
DEPSDISTCLEANUP_libxmlccwrap = @DEPSDISTCLEANUP_libxmlccwrap@
DEPSDISTCLEANUP_libxslt = @DEPSDISTCLEANUP_libxslt@
DEPSDISTCLEANUP_libz = @DEPSDISTCLEANUP_libz@
DEPSDISTCLEANUP_lighttpd = @DEPSDISTCLEANUP_lighttpd@
DEPSDISTCLEANUP_linux = @DEPSDISTCLEANUP_linux@
DEPSDISTCLEANUP_linux23 = @DEPSDISTCLEANUP_linux23@
DEPSDISTCLEANUP_linux24 = @DEPSDISTCLEANUP_linux24@
DEPSDISTCLEANUP_linuxp0040 = @DEPSDISTCLEANUP_linuxp0040@
DEPSDISTCLEANUP_linuxp0041 = @DEPSDISTCLEANUP_linuxp0041@
DEPSDISTCLEANUP_linuxp0119 = @DEPSDISTCLEANUP_linuxp0119@
DEPSDISTCLEANUP_linuxp0123 = @DEPSDISTCLEANUP_linuxp0123@
DEPSDISTCLEANUP_linuxp0201 = @DEPSDISTCLEANUP_linuxp0201@
DEPSDISTCLEANUP_linuxp0205 = @DEPSDISTCLEANUP_linuxp0205@
DEPSDISTCLEANUP_linuxp0206 = @DEPSDISTCLEANUP_linuxp0206@
DEPSDISTCLEANUP_linuxp0207 = @DEPSDISTCLEANUP_linuxp0207@
DEPSDISTCLEANUP_linuxp0209 = @DEPSDISTCLEANUP_linuxp0209@
DEPSDISTCLEANUP_lirc = @DEPSDISTCLEANUP_lirc@
DEPSDISTCLEANUP_lite = @DEPSDISTCLEANUP_lite@
DEPSDISTCLEANUP_lm_sensors = @DEPSDISTCLEANUP_lm_sensors@
DEPSDISTCLEANUP_lsb = @DEPSDISTCLEANUP_lsb@
DEPSDISTCLEANUP_lxml = @DEPSDISTCLEANUP_lxml@
DEPSDISTCLEANUP_mc = @DEPSDISTCLEANUP_mc@
DEPSDISTCLEANUP_mencoder = @DEPSDISTCLEANUP_mencoder@
DEPSDISTCLEANUP_module_init_tools = @DEPSDISTCLEANUP_module_init_tools@
DEPSDISTCLEANUP_mplayer = @DEPSDISTCLEANUP_mplayer@
DEPSDISTCLEANUP_nano = @DEPSDISTCLEANUP_nano@
DEPSDISTCLEANUP_ncurses = @DEPSDISTCLEANUP_ncurses@
DEPSDISTCLEANUP_netio = @DEPSDISTCLEANUP_netio@
DEPSDISTCLEANUP_netkit_base = @DEPSDISTCLEANUP_netkit_base@
DEPSDISTCLEANUP_netkit_ftp = @DEPSDISTCLEANUP_netkit_ftp@
DEPSDISTCLEANUP_nfs_utils = @DEPSDISTCLEANUP_nfs_utils@
DEPSDISTCLEANUP_openrdate = @DEPSDISTCLEANUP_openrdate@
DEPSDISTCLEANUP_openssl = @DEPSDISTCLEANUP_openssl@
DEPSDISTCLEANUP_opkg = @DEPSDISTCLEANUP_opkg@
DEPSDISTCLEANUP_pixman = @DEPSDISTCLEANUP_pixman@
DEPSDISTCLEANUP_pngquant = @DEPSDISTCLEANUP_pngquant@
DEPSDISTCLEANUP_portmap = @DEPSDISTCLEANUP_portmap@
DEPSDISTCLEANUP_pyopenssl = @DEPSDISTCLEANUP_pyopenssl@
DEPSDISTCLEANUP_python = @DEPSDISTCLEANUP_python@
DEPSDISTCLEANUP_record = @DEPSDISTCLEANUP_record@
DEPSDISTCLEANUP_rsync = @DEPSDISTCLEANUP_rsync@
DEPSDISTCLEANUP_ruby = @DEPSDISTCLEANUP_ruby@
DEPSDISTCLEANUP_samba = @DEPSDISTCLEANUP_samba@
DEPSDISTCLEANUP_sdparm = @DEPSDISTCLEANUP_sdparm@
DEPSDISTCLEANUP_setuptools = @DEPSDISTCLEANUP_setuptools@
DEPSDISTCLEANUP_sg3_utils = @DEPSDISTCLEANUP_sg3_utils@
DEPSDISTCLEANUP_sqlite = @DEPSDISTCLEANUP_sqlite@
DEPSDISTCLEANUP_squashfs = @DEPSDISTCLEANUP_squashfs@
DEPSDISTCLEANUP_sysvinit = @DEPSDISTCLEANUP_sysvinit@
DEPSDISTCLEANUP_twisted = @DEPSDISTCLEANUP_twisted@
DEPSDISTCLEANUP_twistedweb2 = @DEPSDISTCLEANUP_twistedweb2@
DEPSDISTCLEANUP_util_linux = @DEPSDISTCLEANUP_util_linux@
DEPSDISTCLEANUP_vsftpd = @DEPSDISTCLEANUP_vsftpd@
DEPSDISTCLEANUP_webkitdfb = @DEPSDISTCLEANUP_webkitdfb@
DEPSDISTCLEANUP_wireless_tools = @DEPSDISTCLEANUP_wireless_tools@
DEPSDISTCLEANUP_wpa_supplicant = @DEPSDISTCLEANUP_wpa_supplicant@
DEPSDISTCLEANUP_xfsprogs = @DEPSDISTCLEANUP_xfsprogs@
DEPSDISTCLEANUP_zd1211 = @DEPSDISTCLEANUP_zd1211@
DEPSDISTCLEANUP_zope_interface = @DEPSDISTCLEANUP_zope_interface@
DIR_a52dec = @DIR_a52dec@
DIR_autofs = @DIR_autofs@
DIR_brofs = @DIR_brofs@
DIR_busybox = @DIR_busybox@
DIR_cairo = @DIR_cairo@
DIR_ccache = @DIR_ccache@
DIR_console_data = @DIR_console_data@
DIR_cramfs = @DIR_cramfs@
DIR_curl = @DIR_curl@
DIR_curlftpfs = @DIR_curlftpfs@
DIR_dfbpp = @DIR_dfbpp@
DIR_directfb = @DIR_directfb@
DIR_directfb_examples = @DIR_directfb_examples@
DIR_e2fsprogs = @DIR_e2fsprogs@
DIR_elementtree = @DIR_elementtree@
DIR_enchant = @DIR_enchant@
DIR_ethtool = @DIR_ethtool@
DIR_evebrowser = @DIR_evebrowser@
DIR_expat = @DIR_expat@
DIR_fbset = @DIR_fbset@
DIR_ffmpeg = @DIR_ffmpeg@
DIR_flashybrid = @DIR_flashybrid@
DIR_fontconfig = @DIR_fontconfig@
DIR_freetype = @DIR_freetype@
DIR_freetype_old = @DIR_freetype_old@
DIR_fuse = @DIR_fuse@
DIR_glib2 = @DIR_glib2@
DIR_grep = @DIR_grep@
DIR_gst_ffmpeg = @DIR_gst_ffmpeg@
DIR_gst_plugins_bad = @DIR_gst_plugins_bad@
DIR_gst_plugins_base = @DIR_gst_plugins_base@
DIR_gst_plugins_dvbmediasink = @DIR_gst_plugins_dvbmediasink@
DIR_gst_plugins_good = @DIR_gst_plugins_good@
DIR_gst_plugins_ugly = @DIR_gst_plugins_ugly@
DIR_gstreamer = @DIR_gstreamer@
DIR_host_python = @DIR_host_python@
DIR_icu4c = @DIR_icu4c@
DIR_ipkg = @DIR_ipkg@
DIR_ipkg_host = @DIR_ipkg_host@
DIR_ipkg_utils = @DIR_ipkg_utils@
DIR_jfsutils = @DIR_jfsutils@
DIR_jpeg = @DIR_jpeg@
DIR_lcms = @DIR_lcms@
DIR_libalsa = @DIR_libalsa@
DIR_libass = @DIR_libass@
DIR_libboost = @DIR_libboost@
DIR_libcap = @DIR_libcap@
DIR_libdvdcss = @DIR_libdvdcss@
DIR_libdvdnav = @DIR_libdvdnav@
DIR_libdvdread = @DIR_libdvdread@
DIR_libflac = @DIR_libflac@
DIR_libfribidi = @DIR_libfribidi@
DIR_libgif = @DIR_libgif@
DIR_libiconv = @DIR_libiconv@
DIR_libid3tag = @DIR_libid3tag@
DIR_libmad = @DIR_libmad@
DIR_libmng = @DIR_libmng@
DIR_libogg = @DIR_libogg@
DIR_libpng = @DIR_libpng@
DIR_libreadline = @DIR_libreadline@
DIR_libsigc = @DIR_libsigc@
DIR_libsoup = @DIR_libsoup@
DIR_libtool = @DIR_libtool@
DIR_libungif = @DIR_libungif@
DIR_libvorbisidec = @DIR_libvorbisidec@
DIR_libxml2 = @DIR_libxml2@
DIR_libxmlccwrap = @DIR_libxmlccwrap@
DIR_libxslt = @DIR_libxslt@
DIR_libz = @DIR_libz@
DIR_lighttpd = @DIR_lighttpd@
DIR_linux = @DIR_linux@
DIR_linux23 = @DIR_linux23@
DIR_linux24 = @DIR_linux24@
DIR_linuxp0040 = @DIR_linuxp0040@
DIR_linuxp0041 = @DIR_linuxp0041@
DIR_linuxp0119 = @DIR_linuxp0119@
DIR_linuxp0123 = @DIR_linuxp0123@
DIR_linuxp0201 = @DIR_linuxp0201@
DIR_linuxp0205 = @DIR_linuxp0205@
DIR_linuxp0206 = @DIR_linuxp0206@
DIR_linuxp0207 = @DIR_linuxp0207@
DIR_linuxp0209 = @DIR_linuxp0209@
DIR_lirc = @DIR_lirc@
DIR_lite = @DIR_lite@
DIR_lm_sensors = @DIR_lm_sensors@
DIR_lsb = @DIR_lsb@
DIR_lxml = @DIR_lxml@
DIR_mc = @DIR_mc@
DIR_mencoder = @DIR_mencoder@
DIR_module_init_tools = @DIR_module_init_tools@
DIR_mplayer = @DIR_mplayer@
DIR_nano = @DIR_nano@
DIR_ncurses = @DIR_ncurses@
DIR_netio = @DIR_netio@
DIR_netkit_base = @DIR_netkit_base@
DIR_netkit_ftp = @DIR_netkit_ftp@
DIR_nfs_utils = @DIR_nfs_utils@
DIR_openrdate = @DIR_openrdate@
DIR_openssl = @DIR_openssl@
DIR_opkg = @DIR_opkg@
DIR_pixman = @DIR_pixman@
DIR_pngquant = @DIR_pngquant@
DIR_portmap = @DIR_portmap@
DIR_pyopenssl = @DIR_pyopenssl@
DIR_python = @DIR_python@
DIR_record = @DIR_record@
DIR_rsync = @DIR_rsync@
DIR_ruby = @DIR_ruby@
DIR_samba = @DIR_samba@
DIR_sdparm = @DIR_sdparm@
DIR_setuptools = @DIR_setuptools@
DIR_sg3_utils = @DIR_sg3_utils@
DIR_sqlite = @DIR_sqlite@
DIR_squashfs = @DIR_squashfs@
DIR_sysvinit = @DIR_sysvinit@
DIR_twisted = @DIR_twisted@
DIR_twistedweb2 = @DIR_twistedweb2@
DIR_util_linux = @DIR_util_linux@
DIR_vsftpd = @DIR_vsftpd@
DIR_webkitdfb = @DIR_webkitdfb@
DIR_wireless_tools = @DIR_wireless_tools@
DIR_wpa_supplicant = @DIR_wpa_supplicant@
DIR_xfsprogs = @DIR_xfsprogs@
DIR_zd1211 = @DIR_zd1211@
DIR_zope_interface = @DIR_zope_interface@
DISTCLEANUP = @DISTCLEANUP@
DISTCLEANUP_a52dec = @DISTCLEANUP_a52dec@
DISTCLEANUP_autofs = @DISTCLEANUP_autofs@
DISTCLEANUP_brofs = @DISTCLEANUP_brofs@
DISTCLEANUP_busybox = @DISTCLEANUP_busybox@
DISTCLEANUP_cairo = @DISTCLEANUP_cairo@
DISTCLEANUP_ccache = @DISTCLEANUP_ccache@
DISTCLEANUP_console_data = @DISTCLEANUP_console_data@
DISTCLEANUP_cramfs = @DISTCLEANUP_cramfs@
DISTCLEANUP_curl = @DISTCLEANUP_curl@
DISTCLEANUP_curlftpfs = @DISTCLEANUP_curlftpfs@
DISTCLEANUP_dfbpp = @DISTCLEANUP_dfbpp@
DISTCLEANUP_directfb = @DISTCLEANUP_directfb@
DISTCLEANUP_e2fsprogs = @DISTCLEANUP_e2fsprogs@
DISTCLEANUP_elementtree = @DISTCLEANUP_elementtree@
DISTCLEANUP_enchant = @DISTCLEANUP_enchant@
DISTCLEANUP_ethtool = @DISTCLEANUP_ethtool@
DISTCLEANUP_evebrowser = @DISTCLEANUP_evebrowser@
DISTCLEANUP_expat = @DISTCLEANUP_expat@
DISTCLEANUP_fbset = @DISTCLEANUP_fbset@
DISTCLEANUP_ffmpeg = @DISTCLEANUP_ffmpeg@
DISTCLEANUP_flashybrid = @DISTCLEANUP_flashybrid@
DISTCLEANUP_fontconfig = @DISTCLEANUP_fontconfig@
DISTCLEANUP_freetype = @DISTCLEANUP_freetype@
DISTCLEANUP_freetype_old = @DISTCLEANUP_freetype_old@
DISTCLEANUP_fuse = @DISTCLEANUP_fuse@
DISTCLEANUP_glib2 = @DISTCLEANUP_glib2@
DISTCLEANUP_grep = @DISTCLEANUP_grep@
DISTCLEANUP_gst_ffmpeg = @DISTCLEANUP_gst_ffmpeg@
DISTCLEANUP_gst_plugins_bad = @DISTCLEANUP_gst_plugins_bad@
DISTCLEANUP_gst_plugins_base = @DISTCLEANUP_gst_plugins_base@
DISTCLEANUP_gst_plugins_dvbmediasink = @DISTCLEANUP_gst_plugins_dvbmediasink@
DISTCLEANUP_gst_plugins_good = @DISTCLEANUP_gst_plugins_good@
DISTCLEANUP_gst_plugins_ugly = @DISTCLEANUP_gst_plugins_ugly@
DISTCLEANUP_gstreamer = @DISTCLEANUP_gstreamer@
DISTCLEANUP_host_python = @DISTCLEANUP_host_python@
DISTCLEANUP_icu4c = @DISTCLEANUP_icu4c@
DISTCLEANUP_ipkg = @DISTCLEANUP_ipkg@
DISTCLEANUP_ipkg_host = @DISTCLEANUP_ipkg_host@
DISTCLEANUP_ipkg_utils = @DISTCLEANUP_ipkg_utils@
DISTCLEANUP_jfsutils = @DISTCLEANUP_jfsutils@
DISTCLEANUP_jpeg = @DISTCLEANUP_jpeg@
DISTCLEANUP_lcms = @DISTCLEANUP_lcms@
DISTCLEANUP_libalsa = @DISTCLEANUP_libalsa@
DISTCLEANUP_libass = @DISTCLEANUP_libass@
DISTCLEANUP_libboost = @DISTCLEANUP_libboost@
DISTCLEANUP_libcap = @DISTCLEANUP_libcap@
DISTCLEANUP_libdvdcss = @DISTCLEANUP_libdvdcss@
DISTCLEANUP_libdvdnav = @DISTCLEANUP_libdvdnav@
DISTCLEANUP_libdvdread = @DISTCLEANUP_libdvdread@
DISTCLEANUP_libflac = @DISTCLEANUP_libflac@
DISTCLEANUP_libfribidi = @DISTCLEANUP_libfribidi@
DISTCLEANUP_libgif = @DISTCLEANUP_libgif@
DISTCLEANUP_libiconv = @DISTCLEANUP_libiconv@
DISTCLEANUP_libid3tag = @DISTCLEANUP_libid3tag@
DISTCLEANUP_libmad = @DISTCLEANUP_libmad@
DISTCLEANUP_libmng = @DISTCLEANUP_libmng@
DISTCLEANUP_libogg = @DISTCLEANUP_libogg@
DISTCLEANUP_libpng = @DISTCLEANUP_libpng@
DISTCLEANUP_libreadline = @DISTCLEANUP_libreadline@
DISTCLEANUP_libsigc = @DISTCLEANUP_libsigc@
DISTCLEANUP_libsoup = @DISTCLEANUP_libsoup@
DISTCLEANUP_libtool = @DISTCLEANUP_libtool@
DISTCLEANUP_libungif = @DISTCLEANUP_libungif@
DISTCLEANUP_libvorbisidec = @DISTCLEANUP_libvorbisidec@
DISTCLEANUP_libxml2 = @DISTCLEANUP_libxml2@
DISTCLEANUP_libxmlccwrap = @DISTCLEANUP_libxmlccwrap@
DISTCLEANUP_libxslt = @DISTCLEANUP_libxslt@
DISTCLEANUP_libz = @DISTCLEANUP_libz@
DISTCLEANUP_lighttpd = @DISTCLEANUP_lighttpd@
DISTCLEANUP_linux = @DISTCLEANUP_linux@
DISTCLEANUP_linux23 = @DISTCLEANUP_linux23@
DISTCLEANUP_linux24 = @DISTCLEANUP_linux24@
DISTCLEANUP_linuxp0040 = @DISTCLEANUP_linuxp0040@
DISTCLEANUP_linuxp0041 = @DISTCLEANUP_linuxp0041@
DISTCLEANUP_linuxp0119 = @DISTCLEANUP_linuxp0119@
DISTCLEANUP_linuxp0123 = @DISTCLEANUP_linuxp0123@
DISTCLEANUP_linuxp0201 = @DISTCLEANUP_linuxp0201@
DISTCLEANUP_linuxp0205 = @DISTCLEANUP_linuxp0205@
DISTCLEANUP_linuxp0206 = @DISTCLEANUP_linuxp0206@
DISTCLEANUP_linuxp0207 = @DISTCLEANUP_linuxp0207@
DISTCLEANUP_linuxp0209 = @DISTCLEANUP_linuxp0209@
DISTCLEANUP_lirc = @DISTCLEANUP_lirc@
DISTCLEANUP_lite = @DISTCLEANUP_lite@
DISTCLEANUP_lm_sensors = @DISTCLEANUP_lm_sensors@
DISTCLEANUP_lsb = @DISTCLEANUP_lsb@
DISTCLEANUP_lxml = @DISTCLEANUP_lxml@
DISTCLEANUP_mc = @DISTCLEANUP_mc@
DISTCLEANUP_mencoder = @DISTCLEANUP_mencoder@
DISTCLEANUP_module_init_tools = @DISTCLEANUP_module_init_tools@
DISTCLEANUP_mplayer = @DISTCLEANUP_mplayer@
DISTCLEANUP_nano = @DISTCLEANUP_nano@
DISTCLEANUP_ncurses = @DISTCLEANUP_ncurses@
DISTCLEANUP_netio = @DISTCLEANUP_netio@
DISTCLEANUP_netkit_base = @DISTCLEANUP_netkit_base@
DISTCLEANUP_netkit_ftp = @DISTCLEANUP_netkit_ftp@
DISTCLEANUP_nfs_utils = @DISTCLEANUP_nfs_utils@
DISTCLEANUP_openrdate = @DISTCLEANUP_openrdate@
DISTCLEANUP_openssl = @DISTCLEANUP_openssl@
DISTCLEANUP_opkg = @DISTCLEANUP_opkg@
DISTCLEANUP_pixman = @DISTCLEANUP_pixman@
DISTCLEANUP_pngquant = @DISTCLEANUP_pngquant@
DISTCLEANUP_portmap = @DISTCLEANUP_portmap@
DISTCLEANUP_pyopenssl = @DISTCLEANUP_pyopenssl@
DISTCLEANUP_python = @DISTCLEANUP_python@
DISTCLEANUP_record = @DISTCLEANUP_record@
DISTCLEANUP_rsync = @DISTCLEANUP_rsync@
DISTCLEANUP_ruby = @DISTCLEANUP_ruby@
DISTCLEANUP_samba = @DISTCLEANUP_samba@
DISTCLEANUP_sdparm = @DISTCLEANUP_sdparm@
DISTCLEANUP_setuptools = @DISTCLEANUP_setuptools@
DISTCLEANUP_sg3_utils = @DISTCLEANUP_sg3_utils@
DISTCLEANUP_sqlite = @DISTCLEANUP_sqlite@
DISTCLEANUP_squashfs = @DISTCLEANUP_squashfs@
DISTCLEANUP_sysvinit = @DISTCLEANUP_sysvinit@
DISTCLEANUP_twisted = @DISTCLEANUP_twisted@
DISTCLEANUP_twistedweb2 = @DISTCLEANUP_twistedweb2@
DISTCLEANUP_util_linux = @DISTCLEANUP_util_linux@
DISTCLEANUP_vsftpd = @DISTCLEANUP_vsftpd@
DISTCLEANUP_webkitdfb = @DISTCLEANUP_webkitdfb@
DISTCLEANUP_wireless_tools = @DISTCLEANUP_wireless_tools@
DISTCLEANUP_wpa_supplicant = @DISTCLEANUP_wpa_supplicant@
DISTCLEANUP_xfsprogs = @DISTCLEANUP_xfsprogs@
DISTCLEANUP_zd1211 = @DISTCLEANUP_zd1211@
DISTCLEANUP_zope_interface = @DISTCLEANUP_zope_interface@
DRPM = @DRPM@
DRPMBUILD = @DRPMBUILD@
ECHO_C = @ECHO_C@
ECHO_N = @ECHO_N@
ECHO_T = @ECHO_T@
EXEEXT = @EXEEXT@
FAKEROOT = @FAKEROOT@
FLASHROOTDIR_MODIFIED = @FLASHROOTDIR_MODIFIED@
FLASHROOT_MODIFIED = @FLASHROOT_MODIFIED@
FLASH_CUSTOMIZE = @FLASH_CUSTOMIZE@
FLASH_UFS910 = @FLASH_UFS910@
FONTDIR = @FONTDIR@
FORTIS_HDBOX = @FORTIS_HDBOX@
HAVANA_P0207_5 = @HAVANA_P0207_5@
HL101 = @HL101@
HOMECAST5101 = @HOMECAST5101@
HS7110 = @HS7110@
HS7810A = @HS7810A@
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_SCRIPT = @INSTALL_SCRIPT@
INSTALL_STRIP_PROGRAM = @INSTALL_STRIP_PROGRAM@
INSTALL_a52dec = @INSTALL_a52dec@
INSTALL_autofs = @INSTALL_autofs@
INSTALL_brofs = @INSTALL_brofs@
INSTALL_busybox = @INSTALL_busybox@
INSTALL_cairo = @INSTALL_cairo@
INSTALL_ccache = @INSTALL_ccache@
INSTALL_console_data = @INSTALL_console_data@
INSTALL_cramfs = @INSTALL_cramfs@
INSTALL_curl = @INSTALL_curl@
INSTALL_curlftpfs = @INSTALL_curlftpfs@
INSTALL_dfbpp = @INSTALL_dfbpp@
INSTALL_directfb = @INSTALL_directfb@
INSTALL_e2fsprogs = @INSTALL_e2fsprogs@
INSTALL_elementtree = @INSTALL_elementtree@
INSTALL_enchant = @INSTALL_enchant@
INSTALL_ethtool = @INSTALL_ethtool@
INSTALL_evebrowser = @INSTALL_evebrowser@
INSTALL_expat = @INSTALL_expat@
INSTALL_fbset = @INSTALL_fbset@
INSTALL_ffmpeg = @INSTALL_ffmpeg@
INSTALL_flashybrid = @INSTALL_flashybrid@
INSTALL_fontconfig = @INSTALL_fontconfig@
INSTALL_freetype = @INSTALL_freetype@
INSTALL_freetype_old = @INSTALL_freetype_old@
INSTALL_fuse = @INSTALL_fuse@
INSTALL_glib2 = @INSTALL_glib2@
INSTALL_grep = @INSTALL_grep@
INSTALL_gst_ffmpeg = @INSTALL_gst_ffmpeg@
INSTALL_gst_plugins_bad = @INSTALL_gst_plugins_bad@
INSTALL_gst_plugins_base = @INSTALL_gst_plugins_base@
INSTALL_gst_plugins_dvbmediasink = @INSTALL_gst_plugins_dvbmediasink@
INSTALL_gst_plugins_good = @INSTALL_gst_plugins_good@
INSTALL_gst_plugins_ugly = @INSTALL_gst_plugins_ugly@
INSTALL_gstreamer = @INSTALL_gstreamer@
INSTALL_host_python = @INSTALL_host_python@
INSTALL_icu4c = @INSTALL_icu4c@
INSTALL_ipkg = @INSTALL_ipkg@
INSTALL_ipkg_host = @INSTALL_ipkg_host@
INSTALL_ipkg_utils = @INSTALL_ipkg_utils@
INSTALL_jfsutils = @INSTALL_jfsutils@
INSTALL_jpeg = @INSTALL_jpeg@
INSTALL_lcms = @INSTALL_lcms@
INSTALL_libalsa = @INSTALL_libalsa@
INSTALL_libass = @INSTALL_libass@
INSTALL_libboost = @INSTALL_libboost@
INSTALL_libcap = @INSTALL_libcap@
INSTALL_libdvdcss = @INSTALL_libdvdcss@
INSTALL_libdvdnav = @INSTALL_libdvdnav@
INSTALL_libdvdread = @INSTALL_libdvdread@
INSTALL_libflac = @INSTALL_libflac@
INSTALL_libfribidi = @INSTALL_libfribidi@
INSTALL_libgif = @INSTALL_libgif@
INSTALL_libiconv = @INSTALL_libiconv@
INSTALL_libid3tag = @INSTALL_libid3tag@
INSTALL_libmad = @INSTALL_libmad@
INSTALL_libmng = @INSTALL_libmng@
INSTALL_libogg = @INSTALL_libogg@
INSTALL_libpng = @INSTALL_libpng@
INSTALL_libreadline = @INSTALL_libreadline@
INSTALL_libsigc = @INSTALL_libsigc@
INSTALL_libsoup = @INSTALL_libsoup@
INSTALL_libtool = @INSTALL_libtool@
INSTALL_libungif = @INSTALL_libungif@
INSTALL_libvorbisidec = @INSTALL_libvorbisidec@
INSTALL_libxml2 = @INSTALL_libxml2@
INSTALL_libxmlccwrap = @INSTALL_libxmlccwrap@
INSTALL_libxslt = @INSTALL_libxslt@
INSTALL_libz = @INSTALL_libz@
INSTALL_lighttpd = @INSTALL_lighttpd@
INSTALL_linux = @INSTALL_linux@
INSTALL_linux23 = @INSTALL_linux23@
INSTALL_linux24 = @INSTALL_linux24@
INSTALL_linuxp0040 = @INSTALL_linuxp0040@
INSTALL_linuxp0041 = @INSTALL_linuxp0041@
INSTALL_linuxp0119 = @INSTALL_linuxp0119@
INSTALL_linuxp0123 = @INSTALL_linuxp0123@
INSTALL_linuxp0201 = @INSTALL_linuxp0201@
INSTALL_linuxp0205 = @INSTALL_linuxp0205@
INSTALL_linuxp0206 = @INSTALL_linuxp0206@
INSTALL_linuxp0207 = @INSTALL_linuxp0207@
INSTALL_linuxp0209 = @INSTALL_linuxp0209@
INSTALL_lirc = @INSTALL_lirc@
INSTALL_lite = @INSTALL_lite@
INSTALL_lm_sensors = @INSTALL_lm_sensors@
INSTALL_lsb = @INSTALL_lsb@
INSTALL_lxml = @INSTALL_lxml@
INSTALL_mc = @INSTALL_mc@
INSTALL_mencoder = @INSTALL_mencoder@
INSTALL_module_init_tools = @INSTALL_module_init_tools@
INSTALL_mplayer = @INSTALL_mplayer@
INSTALL_nano = @INSTALL_nano@
INSTALL_ncurses = @INSTALL_ncurses@
INSTALL_netio = @INSTALL_netio@
INSTALL_netkit_base = @INSTALL_netkit_base@
INSTALL_netkit_ftp = @INSTALL_netkit_ftp@
INSTALL_nfs_utils = @INSTALL_nfs_utils@
INSTALL_openrdate = @INSTALL_openrdate@
INSTALL_openssl = @INSTALL_openssl@
INSTALL_opkg = @INSTALL_opkg@
INSTALL_pixman = @INSTALL_pixman@
INSTALL_pngquant = @INSTALL_pngquant@
INSTALL_portmap = @INSTALL_portmap@
INSTALL_pyopenssl = @INSTALL_pyopenssl@
INSTALL_python = @INSTALL_python@
INSTALL_record = @INSTALL_record@
INSTALL_rsync = @INSTALL_rsync@
INSTALL_ruby = @INSTALL_ruby@
INSTALL_samba = @INSTALL_samba@
INSTALL_sdparm = @INSTALL_sdparm@
INSTALL_setuptools = @INSTALL_setuptools@
INSTALL_sg3_utils = @INSTALL_sg3_utils@
INSTALL_sqlite = @INSTALL_sqlite@
INSTALL_squashfs = @INSTALL_squashfs@
INSTALL_sysvinit = @INSTALL_sysvinit@
INSTALL_twisted = @INSTALL_twisted@
INSTALL_twistedweb2 = @INSTALL_twistedweb2@
INSTALL_util_linux = @INSTALL_util_linux@
INSTALL_vsftpd = @INSTALL_vsftpd@
INSTALL_webkitdfb = @INSTALL_webkitdfb@
INSTALL_wireless_tools = @INSTALL_wireless_tools@
INSTALL_wpa_supplicant = @INSTALL_wpa_supplicant@
INSTALL_xfsprogs = @INSTALL_xfsprogs@
INSTALL_zd1211 = @INSTALL_zd1211@
INSTALL_zope_interface = @INSTALL_zope_interface@
IPBOX55 = @IPBOX55@
IPBOX99 = @IPBOX99@
IPBOX9900 = @IPBOX9900@
IPKG_a52dec = @IPKG_a52dec@
IPKG_autofs = @IPKG_autofs@
IPKG_brofs = @IPKG_brofs@
IPKG_busybox = @IPKG_busybox@
IPKG_cairo = @IPKG_cairo@
IPKG_ccache = @IPKG_ccache@
IPKG_console_data = @IPKG_console_data@
IPKG_cramfs = @IPKG_cramfs@
IPKG_curl = @IPKG_curl@
IPKG_curlftpfs = @IPKG_curlftpfs@
IPKG_dfbpp = @IPKG_dfbpp@
IPKG_directfb = @IPKG_directfb@
IPKG_e2fsprogs = @IPKG_e2fsprogs@
IPKG_elementtree = @IPKG_elementtree@
IPKG_enchant = @IPKG_enchant@
IPKG_ethtool = @IPKG_ethtool@
IPKG_evebrowser = @IPKG_evebrowser@
IPKG_expat = @IPKG_expat@
IPKG_fbset = @IPKG_fbset@
IPKG_ffmpeg = @IPKG_ffmpeg@
IPKG_flashybrid = @IPKG_flashybrid@
IPKG_fontconfig = @IPKG_fontconfig@
IPKG_freetype = @IPKG_freetype@
IPKG_freetype_old = @IPKG_freetype_old@
IPKG_fuse = @IPKG_fuse@
IPKG_glib2 = @IPKG_glib2@
IPKG_grep = @IPKG_grep@
IPKG_gst_ffmpeg = @IPKG_gst_ffmpeg@
IPKG_gst_plugins_bad = @IPKG_gst_plugins_bad@
IPKG_gst_plugins_base = @IPKG_gst_plugins_base@
IPKG_gst_plugins_dvbmediasink = @IPKG_gst_plugins_dvbmediasink@
IPKG_gst_plugins_good = @IPKG_gst_plugins_good@
IPKG_gst_plugins_ugly = @IPKG_gst_plugins_ugly@
IPKG_gstreamer = @IPKG_gstreamer@
IPKG_host_python = @IPKG_host_python@
IPKG_icu4c = @IPKG_icu4c@
IPKG_ipkg = @IPKG_ipkg@
IPKG_ipkg_host = @IPKG_ipkg_host@
IPKG_ipkg_utils = @IPKG_ipkg_utils@
IPKG_jfsutils = @IPKG_jfsutils@
IPKG_jpeg = @IPKG_jpeg@
IPKG_lcms = @IPKG_lcms@
IPKG_libalsa = @IPKG_libalsa@
IPKG_libass = @IPKG_libass@
IPKG_libboost = @IPKG_libboost@
IPKG_libcap = @IPKG_libcap@
IPKG_libdvdcss = @IPKG_libdvdcss@
IPKG_libdvdnav = @IPKG_libdvdnav@
IPKG_libdvdread = @IPKG_libdvdread@
IPKG_libflac = @IPKG_libflac@
IPKG_libfribidi = @IPKG_libfribidi@
IPKG_libgif = @IPKG_libgif@
IPKG_libiconv = @IPKG_libiconv@
IPKG_libid3tag = @IPKG_libid3tag@
IPKG_libmad = @IPKG_libmad@
IPKG_libmng = @IPKG_libmng@
IPKG_libogg = @IPKG_libogg@
IPKG_libpng = @IPKG_libpng@
IPKG_libreadline = @IPKG_libreadline@
IPKG_libsigc = @IPKG_libsigc@
IPKG_libsoup = @IPKG_libsoup@
IPKG_libtool = @IPKG_libtool@
IPKG_libungif = @IPKG_libungif@
IPKG_libvorbisidec = @IPKG_libvorbisidec@
IPKG_libxml2 = @IPKG_libxml2@
IPKG_libxmlccwrap = @IPKG_libxmlccwrap@
IPKG_libxslt = @IPKG_libxslt@
IPKG_libz = @IPKG_libz@
IPKG_lighttpd = @IPKG_lighttpd@
IPKG_linux = @IPKG_linux@
IPKG_linux23 = @IPKG_linux23@
IPKG_linux24 = @IPKG_linux24@
IPKG_linuxp0040 = @IPKG_linuxp0040@
IPKG_linuxp0041 = @IPKG_linuxp0041@
IPKG_linuxp0119 = @IPKG_linuxp0119@
IPKG_linuxp0123 = @IPKG_linuxp0123@
IPKG_linuxp0201 = @IPKG_linuxp0201@
IPKG_linuxp0205 = @IPKG_linuxp0205@
IPKG_linuxp0206 = @IPKG_linuxp0206@
IPKG_linuxp0207 = @IPKG_linuxp0207@
IPKG_linuxp0209 = @IPKG_linuxp0209@
IPKG_lirc = @IPKG_lirc@
IPKG_lite = @IPKG_lite@
IPKG_lm_sensors = @IPKG_lm_sensors@
IPKG_lsb = @IPKG_lsb@
IPKG_lxml = @IPKG_lxml@
IPKG_mc = @IPKG_mc@
IPKG_mencoder = @IPKG_mencoder@
IPKG_module_init_tools = @IPKG_module_init_tools@
IPKG_mplayer = @IPKG_mplayer@
IPKG_nano = @IPKG_nano@
IPKG_ncurses = @IPKG_ncurses@
IPKG_netio = @IPKG_netio@
IPKG_netkit_base = @IPKG_netkit_base@
IPKG_netkit_ftp = @IPKG_netkit_ftp@
IPKG_nfs_utils = @IPKG_nfs_utils@
IPKG_openrdate = @IPKG_openrdate@
IPKG_openssl = @IPKG_openssl@
IPKG_opkg = @IPKG_opkg@
IPKG_pixman = @IPKG_pixman@
IPKG_pngquant = @IPKG_pngquant@
IPKG_portmap = @IPKG_portmap@
IPKG_pyopenssl = @IPKG_pyopenssl@
IPKG_python = @IPKG_python@
IPKG_record = @IPKG_record@
IPKG_rsync = @IPKG_rsync@
IPKG_ruby = @IPKG_ruby@
IPKG_samba = @IPKG_samba@
IPKG_sdparm = @IPKG_sdparm@
IPKG_setuptools = @IPKG_setuptools@
IPKG_sg3_utils = @IPKG_sg3_utils@
IPKG_sqlite = @IPKG_sqlite@
IPKG_squashfs = @IPKG_squashfs@
IPKG_sysvinit = @IPKG_sysvinit@
IPKG_twisted = @IPKG_twisted@
IPKG_twistedweb2 = @IPKG_twistedweb2@
IPKG_util_linux = @IPKG_util_linux@
IPKG_vsftpd = @IPKG_vsftpd@
IPKG_webkitdfb = @IPKG_webkitdfb@
IPKG_wireless_tools = @IPKG_wireless_tools@
IPKG_wpa_supplicant = @IPKG_wpa_supplicant@
IPKG_xfsprogs = @IPKG_xfsprogs@
IPKG_zd1211 = @IPKG_zd1211@
IPKG_zope_interface = @IPKG_zope_interface@
KERNELLABEL = @KERNELLABEL@
KERNELSTMLABEL = @KERNELSTMLABEL@
KERNELVERSION = @KERNELVERSION@
LDFLAGS = @LDFLAGS@
LEX = @LEX@
LEXLIB = @LEXLIB@
LEX_OUTPUT_ROOT = @LEX_OUTPUT_ROOT@
LIBOBJS = @LIBOBJS@
LIBS = @LIBS@
LIRC = @LIRC@
LIST_CLEAN = @LIST_CLEAN@
LIST_DISTCLEAN = @LIST_DISTCLEAN@
LTLIBOBJS = @LTLIBOBJS@
M4 = @M4@
MAINT = @MAINT@
MAKEINFO = @MAKEINFO@
MEDIAFW = @MEDIAFW@
MEDIAFWGSTREAMER = @MEDIAFWGSTREAMER@
MEDIAFW_DEP = @MEDIAFW_DEP@
MKCRAMFS = @MKCRAMFS@
MKDIR_P = @MKDIR_P@
MKFSJFFS2 = @MKFSJFFS2@
MKJFFS2 = @MKJFFS2@
MKLIBS = @MKLIBS@
MULTICOM322 = @MULTICOM322@
MULTICOM324 = @MULTICOM324@
NFSSERVER = @NFSSERVER@
NTFS = @NTFS@
OBJEXT = @OBJEXT@
OCTAGON1008 = @OCTAGON1008@
P0119 = @P0119@
P0123 = @P0123@
P0201 = @P0201@
P0205 = @P0205@
P0206 = @P0206@
P0207 = @P0207@
P0209 = @P0209@
PACKAGE = @PACKAGE@
PACKAGE_BUGREPORT = @PACKAGE_BUGREPORT@
PACKAGE_NAME = @PACKAGE_NAME@
PACKAGE_STRING = @PACKAGE_STRING@
PACKAGE_TARNAME = @PACKAGE_TARNAME@
PACKAGE_URL = @PACKAGE_URL@
PACKAGE_VERSION = @PACKAGE_VERSION@
PATH_SEPARATOR = @PATH_SEPARATOR@
PLAYER131 = @PLAYER131@
PLAYER179 = @PLAYER179@
PLAYER191 = @PLAYER191@
PREPARE_a52dec = @PREPARE_a52dec@
PREPARE_autofs = @PREPARE_autofs@
PREPARE_brofs = @PREPARE_brofs@
PREPARE_busybox = @PREPARE_busybox@
PREPARE_cairo = @PREPARE_cairo@
PREPARE_ccache = @PREPARE_ccache@
PREPARE_console_data = @PREPARE_console_data@
PREPARE_cramfs = @PREPARE_cramfs@
PREPARE_curl = @PREPARE_curl@
PREPARE_curlftpfs = @PREPARE_curlftpfs@
PREPARE_dfbpp = @PREPARE_dfbpp@
PREPARE_directfb = @PREPARE_directfb@
PREPARE_e2fsprogs = @PREPARE_e2fsprogs@
PREPARE_elementtree = @PREPARE_elementtree@
PREPARE_enchant = @PREPARE_enchant@
PREPARE_ethtool = @PREPARE_ethtool@
PREPARE_evebrowser = @PREPARE_evebrowser@
PREPARE_expat = @PREPARE_expat@
PREPARE_fbset = @PREPARE_fbset@
PREPARE_ffmpeg = @PREPARE_ffmpeg@
PREPARE_flashybrid = @PREPARE_flashybrid@
PREPARE_fontconfig = @PREPARE_fontconfig@
PREPARE_freetype = @PREPARE_freetype@
PREPARE_freetype_old = @PREPARE_freetype_old@
PREPARE_fuse = @PREPARE_fuse@
PREPARE_glib2 = @PREPARE_glib2@
PREPARE_grep = @PREPARE_grep@
PREPARE_gst_ffmpeg = @PREPARE_gst_ffmpeg@
PREPARE_gst_plugins_bad = @PREPARE_gst_plugins_bad@
PREPARE_gst_plugins_base = @PREPARE_gst_plugins_base@
PREPARE_gst_plugins_dvbmediasink = @PREPARE_gst_plugins_dvbmediasink@
PREPARE_gst_plugins_good = @PREPARE_gst_plugins_good@
PREPARE_gst_plugins_ugly = @PREPARE_gst_plugins_ugly@
PREPARE_gstreamer = @PREPARE_gstreamer@
PREPARE_host_python = @PREPARE_host_python@
PREPARE_icu4c = @PREPARE_icu4c@
PREPARE_ipkg = @PREPARE_ipkg@
PREPARE_ipkg_host = @PREPARE_ipkg_host@
PREPARE_ipkg_utils = @PREPARE_ipkg_utils@
PREPARE_jfsutils = @PREPARE_jfsutils@
PREPARE_jpeg = @PREPARE_jpeg@
PREPARE_lcms = @PREPARE_lcms@
PREPARE_libalsa = @PREPARE_libalsa@
PREPARE_libass = @PREPARE_libass@
PREPARE_libboost = @PREPARE_libboost@
PREPARE_libcap = @PREPARE_libcap@
PREPARE_libdvdcss = @PREPARE_libdvdcss@
PREPARE_libdvdnav = @PREPARE_libdvdnav@
PREPARE_libdvdread = @PREPARE_libdvdread@
PREPARE_libflac = @PREPARE_libflac@
PREPARE_libfribidi = @PREPARE_libfribidi@
PREPARE_libgif = @PREPARE_libgif@
PREPARE_libiconv = @PREPARE_libiconv@
PREPARE_libid3tag = @PREPARE_libid3tag@
PREPARE_libmad = @PREPARE_libmad@
PREPARE_libmng = @PREPARE_libmng@
PREPARE_libogg = @PREPARE_libogg@
PREPARE_libpng = @PREPARE_libpng@
PREPARE_libreadline = @PREPARE_libreadline@
PREPARE_libsigc = @PREPARE_libsigc@
PREPARE_libsoup = @PREPARE_libsoup@
PREPARE_libtool = @PREPARE_libtool@
PREPARE_libungif = @PREPARE_libungif@
PREPARE_libvorbisidec = @PREPARE_libvorbisidec@
PREPARE_libxml2 = @PREPARE_libxml2@
PREPARE_libxmlccwrap = @PREPARE_libxmlccwrap@
PREPARE_libxslt = @PREPARE_libxslt@
PREPARE_libz = @PREPARE_libz@
PREPARE_lighttpd = @PREPARE_lighttpd@
PREPARE_linux = @PREPARE_linux@
PREPARE_linux23 = @PREPARE_linux23@
PREPARE_linux24 = @PREPARE_linux24@
PREPARE_linuxp0040 = @PREPARE_linuxp0040@
PREPARE_linuxp0041 = @PREPARE_linuxp0041@
PREPARE_linuxp0119 = @PREPARE_linuxp0119@
PREPARE_linuxp0123 = @PREPARE_linuxp0123@
PREPARE_linuxp0201 = @PREPARE_linuxp0201@
PREPARE_linuxp0205 = @PREPARE_linuxp0205@
PREPARE_linuxp0206 = @PREPARE_linuxp0206@
PREPARE_linuxp0207 = @PREPARE_linuxp0207@
PREPARE_linuxp0209 = @PREPARE_linuxp0209@
PREPARE_lirc = @PREPARE_lirc@
PREPARE_lite = @PREPARE_lite@
PREPARE_lm_sensors = @PREPARE_lm_sensors@
PREPARE_lsb = @PREPARE_lsb@
PREPARE_lxml = @PREPARE_lxml@
PREPARE_mc = @PREPARE_mc@
PREPARE_mencoder = @PREPARE_mencoder@
PREPARE_module_init_tools = @PREPARE_module_init_tools@
PREPARE_mplayer = @PREPARE_mplayer@
PREPARE_nano = @PREPARE_nano@
PREPARE_ncurses = @PREPARE_ncurses@
PREPARE_netio = @PREPARE_netio@
PREPARE_netkit_base = @PREPARE_netkit_base@
PREPARE_netkit_ftp = @PREPARE_netkit_ftp@
PREPARE_nfs_utils = @PREPARE_nfs_utils@
PREPARE_openrdate = @PREPARE_openrdate@
PREPARE_openssl = @PREPARE_openssl@
PREPARE_opkg = @PREPARE_opkg@
PREPARE_pixman = @PREPARE_pixman@
PREPARE_pngquant = @PREPARE_pngquant@
PREPARE_portmap = @PREPARE_portmap@
PREPARE_pyopenssl = @PREPARE_pyopenssl@
PREPARE_python = @PREPARE_python@
PREPARE_record = @PREPARE_record@
PREPARE_rsync = @PREPARE_rsync@
PREPARE_ruby = @PREPARE_ruby@
PREPARE_samba = @PREPARE_samba@
PREPARE_sdparm = @PREPARE_sdparm@
PREPARE_setuptools = @PREPARE_setuptools@
PREPARE_sg3_utils = @PREPARE_sg3_utils@
PREPARE_sqlite = @PREPARE_sqlite@
PREPARE_squashfs = @PREPARE_squashfs@
PREPARE_sysvinit = @PREPARE_sysvinit@
PREPARE_twisted = @PREPARE_twisted@
PREPARE_twistedweb2 = @PREPARE_twistedweb2@
PREPARE_util_linux = @PREPARE_util_linux@
PREPARE_vsftpd = @PREPARE_vsftpd@
PREPARE_webkitdfb = @PREPARE_webkitdfb@
PREPARE_wireless_tools = @PREPARE_wireless_tools@
PREPARE_wpa_supplicant = @PREPARE_wpa_supplicant@
PREPARE_xfsprogs = @PREPARE_xfsprogs@
PREPARE_zd1211 = @PREPARE_zd1211@
PREPARE_zope_interface = @PREPARE_zope_interface@
ROOT_PARTITION_SIZE = @ROOT_PARTITION_SIZE@
RPMDEPSCLEANUP = @RPMDEPSCLEANUP@
RPMDEPSCLEANUP_directfb_examples = @RPMDEPSCLEANUP_directfb_examples@
RPMDEPSDISTCLEANUP_directfb_examples = @RPMDEPSDISTCLEANUP_directfb_examples@
RPMDISTCLEANUP_directfb_examples = @RPMDISTCLEANUP_directfb_examples@
RPMLIST_CLEAN = @RPMLIST_CLEAN@
RPMLIST_DISTCLEAN = @RPMLIST_DISTCLEAN@
SET_MAKE = @SET_MAKE@
SG3 = @SG3@
SHELL = @SHELL@
SPARK = @SPARK@
SPARK7162 = @SPARK7162@
STRIP = @STRIP@
TARGET_CFLAGS = @TARGET_CFLAGS@
TARGET_CXXFLAGS = @TARGET_CXXFLAGS@
TARGET_LDFLAGS = @TARGET_LDFLAGS@
TF7700 = @TF7700@
TUXBOX_CHECKIMAGE = @TUXBOX_CHECKIMAGE@
TUXBOX_CUSTOMIZE = @TUXBOX_CUSTOMIZE@
TUXBOX_FLASHROOT_MODIFIED = @TUXBOX_FLASHROOT_MODIFIED@
TUXBOX_FLASH_CUSTOMIZE = @TUXBOX_FLASH_CUSTOMIZE@
TUXBOX_TOUCH = @TUXBOX_TOUCH@
TUXBOX_YAUD_CUSTOMIZE = @TUXBOX_YAUD_CUSTOMIZE@
UCODEDIR = @UCODEDIR@
UFS910 = @UFS910@
UFS912 = @UFS912@
UFS922 = @UFS922@
UNINSTALL_a52dec = @UNINSTALL_a52dec@
UNINSTALL_autofs = @UNINSTALL_autofs@
UNINSTALL_brofs = @UNINSTALL_brofs@
UNINSTALL_busybox = @UNINSTALL_busybox@
UNINSTALL_cairo = @UNINSTALL_cairo@
UNINSTALL_ccache = @UNINSTALL_ccache@
UNINSTALL_console_data = @UNINSTALL_console_data@
UNINSTALL_cramfs = @UNINSTALL_cramfs@
UNINSTALL_curl = @UNINSTALL_curl@
UNINSTALL_curlftpfs = @UNINSTALL_curlftpfs@
UNINSTALL_dfbpp = @UNINSTALL_dfbpp@
UNINSTALL_directfb = @UNINSTALL_directfb@
UNINSTALL_e2fsprogs = @UNINSTALL_e2fsprogs@
UNINSTALL_elementtree = @UNINSTALL_elementtree@
UNINSTALL_enchant = @UNINSTALL_enchant@
UNINSTALL_ethtool = @UNINSTALL_ethtool@
UNINSTALL_evebrowser = @UNINSTALL_evebrowser@
UNINSTALL_expat = @UNINSTALL_expat@
UNINSTALL_fbset = @UNINSTALL_fbset@
UNINSTALL_ffmpeg = @UNINSTALL_ffmpeg@
UNINSTALL_flashybrid = @UNINSTALL_flashybrid@
UNINSTALL_fontconfig = @UNINSTALL_fontconfig@
UNINSTALL_freetype = @UNINSTALL_freetype@
UNINSTALL_freetype_old = @UNINSTALL_freetype_old@
UNINSTALL_fuse = @UNINSTALL_fuse@
UNINSTALL_glib2 = @UNINSTALL_glib2@
UNINSTALL_grep = @UNINSTALL_grep@
UNINSTALL_gst_ffmpeg = @UNINSTALL_gst_ffmpeg@
UNINSTALL_gst_plugins_bad = @UNINSTALL_gst_plugins_bad@
UNINSTALL_gst_plugins_base = @UNINSTALL_gst_plugins_base@
UNINSTALL_gst_plugins_dvbmediasink = @UNINSTALL_gst_plugins_dvbmediasink@
UNINSTALL_gst_plugins_good = @UNINSTALL_gst_plugins_good@
UNINSTALL_gst_plugins_ugly = @UNINSTALL_gst_plugins_ugly@
UNINSTALL_gstreamer = @UNINSTALL_gstreamer@
UNINSTALL_host_python = @UNINSTALL_host_python@
UNINSTALL_icu4c = @UNINSTALL_icu4c@
UNINSTALL_ipkg = @UNINSTALL_ipkg@
UNINSTALL_ipkg_host = @UNINSTALL_ipkg_host@
UNINSTALL_ipkg_utils = @UNINSTALL_ipkg_utils@
UNINSTALL_jfsutils = @UNINSTALL_jfsutils@
UNINSTALL_jpeg = @UNINSTALL_jpeg@
UNINSTALL_lcms = @UNINSTALL_lcms@
UNINSTALL_libalsa = @UNINSTALL_libalsa@
UNINSTALL_libass = @UNINSTALL_libass@
UNINSTALL_libboost = @UNINSTALL_libboost@
UNINSTALL_libcap = @UNINSTALL_libcap@
UNINSTALL_libdvdcss = @UNINSTALL_libdvdcss@
UNINSTALL_libdvdnav = @UNINSTALL_libdvdnav@
UNINSTALL_libdvdread = @UNINSTALL_libdvdread@
UNINSTALL_libflac = @UNINSTALL_libflac@
UNINSTALL_libfribidi = @UNINSTALL_libfribidi@
UNINSTALL_libgif = @UNINSTALL_libgif@
UNINSTALL_libiconv = @UNINSTALL_libiconv@
UNINSTALL_libid3tag = @UNINSTALL_libid3tag@
UNINSTALL_libmad = @UNINSTALL_libmad@
UNINSTALL_libmng = @UNINSTALL_libmng@
UNINSTALL_libogg = @UNINSTALL_libogg@
UNINSTALL_libpng = @UNINSTALL_libpng@
UNINSTALL_libreadline = @UNINSTALL_libreadline@
UNINSTALL_libsigc = @UNINSTALL_libsigc@
UNINSTALL_libsoup = @UNINSTALL_libsoup@
UNINSTALL_libtool = @UNINSTALL_libtool@
UNINSTALL_libungif = @UNINSTALL_libungif@
UNINSTALL_libvorbisidec = @UNINSTALL_libvorbisidec@
UNINSTALL_libxml2 = @UNINSTALL_libxml2@
UNINSTALL_libxmlccwrap = @UNINSTALL_libxmlccwrap@
UNINSTALL_libxslt = @UNINSTALL_libxslt@
UNINSTALL_libz = @UNINSTALL_libz@
UNINSTALL_lighttpd = @UNINSTALL_lighttpd@
UNINSTALL_linux = @UNINSTALL_linux@
UNINSTALL_linux23 = @UNINSTALL_linux23@
UNINSTALL_linux24 = @UNINSTALL_linux24@
UNINSTALL_linuxp0040 = @UNINSTALL_linuxp0040@
UNINSTALL_linuxp0041 = @UNINSTALL_linuxp0041@
UNINSTALL_linuxp0119 = @UNINSTALL_linuxp0119@
UNINSTALL_linuxp0123 = @UNINSTALL_linuxp0123@
UNINSTALL_linuxp0201 = @UNINSTALL_linuxp0201@
UNINSTALL_linuxp0205 = @UNINSTALL_linuxp0205@
UNINSTALL_linuxp0206 = @UNINSTALL_linuxp0206@
UNINSTALL_linuxp0207 = @UNINSTALL_linuxp0207@
UNINSTALL_linuxp0209 = @UNINSTALL_linuxp0209@
UNINSTALL_lirc = @UNINSTALL_lirc@
UNINSTALL_lite = @UNINSTALL_lite@
UNINSTALL_lm_sensors = @UNINSTALL_lm_sensors@
UNINSTALL_lsb = @UNINSTALL_lsb@
UNINSTALL_lxml = @UNINSTALL_lxml@
UNINSTALL_mc = @UNINSTALL_mc@
UNINSTALL_mencoder = @UNINSTALL_mencoder@
UNINSTALL_module_init_tools = @UNINSTALL_module_init_tools@
UNINSTALL_mplayer = @UNINSTALL_mplayer@
UNINSTALL_nano = @UNINSTALL_nano@
UNINSTALL_ncurses = @UNINSTALL_ncurses@
UNINSTALL_netio = @UNINSTALL_netio@
UNINSTALL_netkit_base = @UNINSTALL_netkit_base@
UNINSTALL_netkit_ftp = @UNINSTALL_netkit_ftp@
UNINSTALL_nfs_utils = @UNINSTALL_nfs_utils@
UNINSTALL_openrdate = @UNINSTALL_openrdate@
UNINSTALL_openssl = @UNINSTALL_openssl@
UNINSTALL_opkg = @UNINSTALL_opkg@
UNINSTALL_pixman = @UNINSTALL_pixman@
UNINSTALL_pngquant = @UNINSTALL_pngquant@
UNINSTALL_portmap = @UNINSTALL_portmap@
UNINSTALL_pyopenssl = @UNINSTALL_pyopenssl@
UNINSTALL_python = @UNINSTALL_python@
UNINSTALL_record = @UNINSTALL_record@
UNINSTALL_rsync = @UNINSTALL_rsync@
UNINSTALL_ruby = @UNINSTALL_ruby@
UNINSTALL_samba = @UNINSTALL_samba@
UNINSTALL_sdparm = @UNINSTALL_sdparm@
UNINSTALL_setuptools = @UNINSTALL_setuptools@
UNINSTALL_sg3_utils = @UNINSTALL_sg3_utils@
UNINSTALL_sqlite = @UNINSTALL_sqlite@
UNINSTALL_squashfs = @UNINSTALL_squashfs@
UNINSTALL_sysvinit = @UNINSTALL_sysvinit@
UNINSTALL_twisted = @UNINSTALL_twisted@
UNINSTALL_twistedweb2 = @UNINSTALL_twistedweb2@
UNINSTALL_util_linux = @UNINSTALL_util_linux@
UNINSTALL_vsftpd = @UNINSTALL_vsftpd@
UNINSTALL_webkitdfb = @UNINSTALL_webkitdfb@
UNINSTALL_wireless_tools = @UNINSTALL_wireless_tools@
UNINSTALL_wpa_supplicant = @UNINSTALL_wpa_supplicant@
UNINSTALL_xfsprogs = @UNINSTALL_xfsprogs@
UNINSTALL_zd1211 = @UNINSTALL_zd1211@
UNINSTALL_zope_interface = @UNINSTALL_zope_interface@
VAR = @VAR@
VERSION = @VERSION@
VERSION_a52dec = @VERSION_a52dec@
VERSION_autofs = @VERSION_autofs@
VERSION_brofs = @VERSION_brofs@
VERSION_busybox = @VERSION_busybox@
VERSION_cairo = @VERSION_cairo@
VERSION_ccache = @VERSION_ccache@
VERSION_console_data = @VERSION_console_data@
VERSION_cramfs = @VERSION_cramfs@
VERSION_curl = @VERSION_curl@
VERSION_curlftpfs = @VERSION_curlftpfs@
VERSION_dfbpp = @VERSION_dfbpp@
VERSION_directfb = @VERSION_directfb@
VERSION_e2fsprogs = @VERSION_e2fsprogs@
VERSION_elementtree = @VERSION_elementtree@
VERSION_enchant = @VERSION_enchant@
VERSION_ethtool = @VERSION_ethtool@
VERSION_evebrowser = @VERSION_evebrowser@
VERSION_expat = @VERSION_expat@
VERSION_fbset = @VERSION_fbset@
VERSION_ffmpeg = @VERSION_ffmpeg@
VERSION_flashybrid = @VERSION_flashybrid@
VERSION_fontconfig = @VERSION_fontconfig@
VERSION_freetype = @VERSION_freetype@
VERSION_freetype_old = @VERSION_freetype_old@
VERSION_fuse = @VERSION_fuse@
VERSION_glib2 = @VERSION_glib2@
VERSION_grep = @VERSION_grep@
VERSION_gst_ffmpeg = @VERSION_gst_ffmpeg@
VERSION_gst_plugins_bad = @VERSION_gst_plugins_bad@
VERSION_gst_plugins_base = @VERSION_gst_plugins_base@
VERSION_gst_plugins_dvbmediasink = @VERSION_gst_plugins_dvbmediasink@
VERSION_gst_plugins_good = @VERSION_gst_plugins_good@
VERSION_gst_plugins_ugly = @VERSION_gst_plugins_ugly@
VERSION_gstreamer = @VERSION_gstreamer@
VERSION_host_python = @VERSION_host_python@
VERSION_icu4c = @VERSION_icu4c@
VERSION_ipkg = @VERSION_ipkg@
VERSION_ipkg_host = @VERSION_ipkg_host@
VERSION_ipkg_utils = @VERSION_ipkg_utils@
VERSION_jfsutils = @VERSION_jfsutils@
VERSION_jpeg = @VERSION_jpeg@
VERSION_lcms = @VERSION_lcms@
VERSION_libalsa = @VERSION_libalsa@
VERSION_libass = @VERSION_libass@
VERSION_libboost = @VERSION_libboost@
VERSION_libcap = @VERSION_libcap@
VERSION_libdvdcss = @VERSION_libdvdcss@
VERSION_libdvdnav = @VERSION_libdvdnav@
VERSION_libdvdread = @VERSION_libdvdread@
VERSION_libflac = @VERSION_libflac@
VERSION_libfribidi = @VERSION_libfribidi@
VERSION_libgif = @VERSION_libgif@
VERSION_libiconv = @VERSION_libiconv@
VERSION_libid3tag = @VERSION_libid3tag@
VERSION_libmad = @VERSION_libmad@
VERSION_libmng = @VERSION_libmng@
VERSION_libogg = @VERSION_libogg@
VERSION_libpng = @VERSION_libpng@
VERSION_libreadline = @VERSION_libreadline@
VERSION_libsigc = @VERSION_libsigc@
VERSION_libsoup = @VERSION_libsoup@
VERSION_libtool = @VERSION_libtool@
VERSION_libungif = @VERSION_libungif@
VERSION_libvorbisidec = @VERSION_libvorbisidec@
VERSION_libxml2 = @VERSION_libxml2@
VERSION_libxmlccwrap = @VERSION_libxmlccwrap@
VERSION_libxslt = @VERSION_libxslt@
VERSION_libz = @VERSION_libz@
VERSION_lighttpd = @VERSION_lighttpd@
VERSION_linux = @VERSION_linux@
VERSION_linux23 = @VERSION_linux23@
VERSION_linux24 = @VERSION_linux24@
VERSION_linuxp0040 = @VERSION_linuxp0040@
VERSION_linuxp0041 = @VERSION_linuxp0041@
VERSION_linuxp0119 = @VERSION_linuxp0119@
VERSION_linuxp0123 = @VERSION_linuxp0123@
VERSION_linuxp0201 = @VERSION_linuxp0201@
VERSION_linuxp0205 = @VERSION_linuxp0205@
VERSION_linuxp0206 = @VERSION_linuxp0206@
VERSION_linuxp0207 = @VERSION_linuxp0207@
VERSION_linuxp0209 = @VERSION_linuxp0209@
VERSION_lirc = @VERSION_lirc@
VERSION_lite = @VERSION_lite@
VERSION_lm_sensors = @VERSION_lm_sensors@
VERSION_lsb = @VERSION_lsb@
VERSION_lxml = @VERSION_lxml@
VERSION_mc = @VERSION_mc@
VERSION_mencoder = @VERSION_mencoder@
VERSION_module_init_tools = @VERSION_module_init_tools@
VERSION_mplayer = @VERSION_mplayer@
VERSION_nano = @VERSION_nano@
VERSION_ncurses = @VERSION_ncurses@
VERSION_netio = @VERSION_netio@
VERSION_netkit_base = @VERSION_netkit_base@
VERSION_netkit_ftp = @VERSION_netkit_ftp@
VERSION_nfs_utils = @VERSION_nfs_utils@
VERSION_openrdate = @VERSION_openrdate@
VERSION_openssl = @VERSION_openssl@
VERSION_opkg = @VERSION_opkg@
VERSION_pixman = @VERSION_pixman@
VERSION_pngquant = @VERSION_pngquant@
VERSION_portmap = @VERSION_portmap@
VERSION_pyopenssl = @VERSION_pyopenssl@
VERSION_python = @VERSION_python@
VERSION_record = @VERSION_record@
VERSION_rsync = @VERSION_rsync@
VERSION_ruby = @VERSION_ruby@
VERSION_samba = @VERSION_samba@
VERSION_sdparm = @VERSION_sdparm@
VERSION_setuptools = @VERSION_setuptools@
VERSION_sg3_utils = @VERSION_sg3_utils@
VERSION_sqlite = @VERSION_sqlite@
VERSION_squashfs = @VERSION_squashfs@
VERSION_sysvinit = @VERSION_sysvinit@
VERSION_twisted = @VERSION_twisted@
VERSION_twistedweb2 = @VERSION_twistedweb2@
VERSION_util_linux = @VERSION_util_linux@
VERSION_vsftpd = @VERSION_vsftpd@
VERSION_webkitdfb = @VERSION_webkitdfb@
VERSION_wireless_tools = @VERSION_wireless_tools@
VERSION_wpa_supplicant = @VERSION_wpa_supplicant@
VERSION_xfsprogs = @VERSION_xfsprogs@
VERSION_zd1211 = @VERSION_zd1211@
VERSION_zope_interface = @VERSION_zope_interface@
VIP1_V2 = @VIP1_V2@
VIP2_V1 = @VIP2_V1@
XFSPROGS = @XFSPROGS@
YACC = @YACC@
YFLAGS = @YFLAGS@
abs_builddir = @abs_builddir@
abs_srcdir = @abs_srcdir@
abs_top_builddir = @abs_top_builddir@
abs_top_srcdir = @abs_top_srcdir@
ac_ct_CC = @ac_ct_CC@
ac_ct_CXX = @ac_ct_CXX@
am__include = @am__include@
am__leading_dot = @am__leading_dot@
am__quote = @am__quote@
am__tar = @am__tar@
am__untar = @am__untar@
appsdir = @appsdir@
bindir = @bindir@
bootdir = @bootdir@
bootprefix = @bootprefix@
build = @build@
build_alias = @build_alias@
build_cpu = @build_cpu@
build_os = @build_os@
build_vendor = @build_vendor@
builddir = @builddir@
buildprefix = @buildprefix@
configprefix = @configprefix@
crossprefix = @crossprefix@
customizationsdir = @customizationsdir@
datadir = @datadir@
datarootdir = @datarootdir@
defaultserver = @defaultserver@
devkitprefix = @devkitprefix@
docdir = @docdir@
driverdir = @driverdir@
dvidir = @dvidir@
exec_prefix = @exec_prefix@
flashprefix = @flashprefix@
flashprefix_ro = @flashprefix_ro@
flashprefix_rw = @flashprefix_rw@
gnuserver = @gnuserver@
host = @host@
host_alias = @host_alias@
host_arch = @host_arch@
host_cpu = @host_cpu@
host_os = @host_os@
host_vendor = @host_vendor@
hostappsdir = @hostappsdir@
hostprefix = @hostprefix@
htmldir = @htmldir@
includedir = @includedir@
infodir = @infodir@
install_sh = @install_sh@
ipkgbuilddir = @ipkgbuilddir@
ipkprefix = @ipkprefix@
kernelprefix = @kernelprefix@
libdir = @libdir@
libexecdir = @libexecdir@
localedir = @localedir@
localstatedir = @localstatedir@
mandir = @mandir@
mkdir_p = @mkdir_p@
oldincludedir = @oldincludedir@
pdfdir = @pdfdir@
prefix = @prefix@
program_transform_name = @program_transform_name@
psdir = @psdir@
rpmdbprefix = @rpmdbprefix@
sbindir = @sbindir@
serversupport = @serversupport@
sharedstatedir = @sharedstatedir@
srcdir = @srcdir@
stockdir = @stockdir@
sysconfdir = @sysconfdir@
target = @target@
target_alias = @target_alias@
target_cpu = @target_cpu@
target_os = @target_os@
target_vendor = @target_vendor@
targetprefix = @targetprefix@
top_build_prefix = @top_build_prefix@
top_builddir = @top_builddir@
top_srcdir = @top_srcdir@
ucodesdir = @ucodesdir@
updatehttpprefix = @updatehttpprefix@
AUTOMAKE_OPTIONS = -Wno-portability
@ENABLE_CCACHE_FALSE@PATH := $(crossprefix)/bin:$(PATH):/usr/sbin
@ENABLE_CCACHE_TRUE@PATH := $(hostprefix)/ccache-bin:$(crossprefix)/bin:$(PATH):/usr/sbin
SOCKSIFY = 
CMD_CVS = $(SOCKSIFY) $(shell which cvs)
WGET = $(SOCKSIFY) wget
INSTALL_DIR = $(INSTALL) -d
INSTALL_BIN = $(INSTALL) -m 755
INSTALL_FILE = $(INSTALL) -m 644
LN_SF = $(shell which ln) -sf
CP_D = $(shell which cp) -d
CP_P = $(shell which cp) -p
CP_RD = $(shell which cp) -rd
SED = $(shell which sed)
MAKE_PATH := $(hostprefix)/bin:$(crossprefix)/bin:$(PATH)
ADAPTED_ETC_FILES = 
ETC_RW_FILES = host.conf init.d/nscd ld.so.cache ld.so.conf \
	nsswitch.conf rpc passwd passwd.org group group.org shadow \
	hosts issue.net motd profile resolv.conf inputrc issue skel \
	shells shells.conf init.d/httpd nologin hostname default/halt \
	default/tmpfs init.d/bootmisc.sh init.d/halt \
	init.d/hostname.sh init.d/mountnfs.sh init.d/rc init.d/reboot \
	init.d/rmnologin init.d/sendsigs init.d/single init.d/skeleton \
	init.d/stop-bootlogd init.d/umountfs init.d/umountnfs.sh \
	init.d/urandom init.d/rdate.sh localtime network/interfaces \
	gateways init.d/networking network network/options protocols \
	services modules init.d/module-init-tools auto.master \
	auto.ufs910 timezone.xml default/autofs init.d/autofs \
	auto.misc hosts.allow hosts.deny init.d/portmap exports \
	init.d/nfs-common init.d/nfs-kernel-server mke2fs.conf \
	default/sg_down init.d/sg_down default/swap init.d/allerlei \
	init.d/swap default/framebuffer default/ufs910-common \
	default/ufs910 init.d/ufs910-common init.d/ufs910 \
	default/vsftpd init.d/vsftpd vsftpd.conf samba/smb.conf \
	init.d/samba
# STM24
@STM22_FALSE@@STM23_FALSE@STLINUX := stlinux24
@STM22_FALSE@@STM23_TRUE@STLINUX := stlinux23
@STM22_TRUE@STLINUX := stlinux22
@STM22_FALSE@@STM23_FALSE@STM_SRC := $(STLINUX)
@STM22_FALSE@@STM23_TRUE@STM_SRC := $(STLINUX)
@STM22_TRUE@STM_SRC := stlinux23
@BLEEDING_EDGE_FALSE@STABLE = YES
@BLEEDING_EDGE_TRUE@STABLE = 

# rpm helper-"functions":
TARGETLIB = $(targetprefix)/usr/lib
PKG_CONFIG_PATH = $(targetprefix)/usr/lib/pkgconfig
REWRITE_LIBDIR = sed -i "s,^libdir=.*,libdir='$(targetprefix)/usr/lib'," $(targetprefix)/usr/lib
REWRITE_LIBDEP = sed -i -e "s,\(^dependency_libs='\| \|-L\|^dependency_libs='\)/usr/lib,\$(targetprefix)/usr/lib," $(targetprefix)/usr/lib
REWRITE_PKGCONF = sed -i "s,^prefix=.*,prefix='$(targetprefix)/usr',"
BUILDENV := \
	CC=$(target)-gcc \
	CXX=$(target)-g++ \
	LD=$(target)-ld \
	NM=$(target)-nm \
	AR=$(target)-ar \
	AS=$(target)-as \
	RANLIB=$(target)-ranlib \
	STRIP=$(target)-strip \
	OBJCOPY=$(target)-objcopy \
	OBJDUMP=$(target)-objdump \
	LN_S="ln -s" \
	CFLAGS="$(TARGET_CFLAGS)" \
	CXXFLAGS="$(TARGET_CFLAGS)" \
	LDFLAGS="$(TARGET_LDFLAGS)" \
	PKG_CONFIG_PATH="$(targetprefix)/usr/lib/pkgconfig"

#	PKG_CONFIG_PATH="$(targetprefix)/lib/pkgconfig:$(targetprefix)/usr/lib/pkgconfig"
MAKE_OPTS := \
	CC=$(target)-gcc \
	CXX=$(target)-g++ \
	LD=$(target)-ld \
	NM=$(target)-nm \
	AR=$(target)-ar \
	AS=$(target)-as \
	RANLIB=$(target)-ranlib \
	STRIP=$(target)-strip \
	OBJCOPY=$(target)-objcopy \
	OBJDUMP=$(target)-objdump \
	LN_S="ln -s" \
	ARCH=sh \
	CROSS_COMPILE=$(target)-

MAKE_ARGS := \
	CC=$(target)-gcc \
	CXX=$(target)-g++ \
	LD=$(target)-ld \
	NM=$(target)-nm \
	AR=$(target)-ar \
	AS=$(target)-as \
	RANLIB=$(target)-ranlib \
	STRIP=$(target)-strip \
	OBJCOPY=$(target)-objcopy \
	OBJDUMP=$(target)-objdump \
	LN_S="ln -s"

CONFIGURE_OPTS = --build=$(build) --host=$(target) \
	--prefix=$(targetprefix)/usr --with-driver=$(driverdir) \
	--with-dvbincludes=$(driverdir)/include --with-target=cdk \
	$(am__append_1) $(am__append_2) $(am__append_3)
CONFIGURE = \
	./autogen.sh && \
	CC=$(target)-gcc \
	CXX=$(target)-g++ \
	CFLAGS="-Wall $(TARGET_CFLAGS)" \
	CXXFLAGS="-Wall $(TARGET_CXXFLAGS)" \
	LDFLAGS="$(TARGET_LDFLAGS)" \
	./configure $(CONFIGURE_OPTS)

ACLOCAL_AMFLAGS = -I .
CONFIG_STATUS_DEPENDENCIES = \
	$(top_srcdir)/rules.pl \
	$(top_srcdir)/rules-install $(top_srcdir)/rules-install-flash \
	$(top_srcdir)/rules-make$(if $(STABLE),,.latest) \
	Makefile-archive

URLDIV1 = ftp://mirrors.kernel.org/fedora/core/6/i386/os/Fedora/RPMS
URL = ftp://ftp.stlinux.com/pub/stlinux/2.0/ST_Linux_2.0/RPM_Distribution/sh4-target-glibc-packages
URLU = ftp://ftp.stlinux.com/pub/stlinux/2.0/ST_Linux_2.0/RPM_Distribution/sh4-updates
URL2 = ftp://ftp.stlinux.com/pub/stlinux/2.2/STLinux/sh4
URL2U = ftp://ftp.stlinux.com/pub/stlinux/2.2/updates/RPMS/sh4
URL3 = ftp://ftp.stlinux.com/pub/stlinux/2.3/STLinux/sh4
URL3U = ftp://ftp.stlinux.com/pub/stlinux/2.3/updates/RPMS/sh4
URL4 = ftp://ftp.stlinux.com/pub/stlinux/2.4/STLinux/sh4
URL4U = ftp://ftp.stlinux.com/pub/stlinux/2.4/updates/RPMS/sh4
URLSH = http://ftp.stlinux.com/pub/stlinux/2.0/ST_Linux_2.0/SRPM_Distribution/host-SRPMS
URLSHU = http://ftp.stlinux.com/pub/stlinux/2.0/ST_Linux_2.0/SRPM_Distribution/sh4-SRPMS-updates
URL2SH = ftp://ftp.stlinux.com/pub/stlinux/2.2/SRPMS/
URL2SHU = ftp://ftp.stlinux.com/pub/stlinux/2.2/updates/SRPMS
URLS = ftp://ftp.stlinux.com/pub/stlinux/2.0/ST_Linux_2.0/SRPM_Distribution/sh4-SRPMS
URLSU = ftp://ftp.stlinux.com/pub/stlinux/2.0/ST_Linux_2.0/SRPM_Distribution/sh4-SRPMS-updates
URL2S = ftp://ftp.stlinux.com/pub/stlinux/2.2/SRPMS
URL2SU = ftp://ftp.stlinux.com/pub/stlinux/2.2/updates/SRPMS
URL3S = ftp://ftp.stlinux.com/pub/stlinux/2.3/SRPMS
URL3SU = ftp://ftp.stlinux.com/pub/stlinux/2.3/updates/SRPMS
URL4S = ftp://ftp.stlinux.com/pub/stlinux/2.4/SRPMS
URL4SU = ftp://ftp.stlinux.com/pub/stlinux/2.4/updates/SRPMS
#	@DISTCLEANUP_cramfs@

#
# MKSQUASHFS with LZMA support
#
@TARGETRULESET_FLASH_TRUE@MKSQUASHFS = $(hostprefix)/bin/mksquashfs
#	rm -rf @DIR_squashfs@

#
# IPKG-UTILS
#
IPKG_BUILD_BIN = $(crossprefix)/bin/ipkg-build
#       @DISTCLEANUP_ipkg_utils@

#
# IPKG-HOST
#
IPKG_BIN = $(crossprefix)/bin/ipkg
IPKG_CONF = $(crossprefix)/etc/ipkg.conf
@ENABLE_P0119_FALSE@@ENABLE_P0123_FALSE@@STM22_FALSE@@STM23_TRUE@KERNEL_DEPENDS = @DEPENDS_linux23@
@ENABLE_P0119_FALSE@@ENABLE_P0123_TRUE@@STM22_FALSE@@STM23_TRUE@KERNEL_DEPENDS = @DEPENDS_linux23@
@ENABLE_P0119_TRUE@@STM22_FALSE@@STM23_TRUE@KERNEL_DEPENDS = @DEPENDS_linux23@
@P0040_FALSE@@P0041_FALSE@@STM22_TRUE@KERNEL_DEPENDS = @DEPENDS_linux@
@P0040_FALSE@@P0041_TRUE@@STM22_TRUE@KERNEL_DEPENDS = @DEPENDS_linuxp0041@
@P0040_TRUE@@STM22_TRUE@KERNEL_DEPENDS = @DEPENDS_linuxp0040@
# if STM24
@STM22_FALSE@@STM23_FALSE@KERNEL_DEPENDS = @DEPENDS_linux24@
@ENABLE_P0119_FALSE@@ENABLE_P0123_FALSE@@STM22_FALSE@@STM23_TRUE@KERNEL_DIR = @DIR_linux23@
@ENABLE_P0119_FALSE@@ENABLE_P0123_TRUE@@STM22_FALSE@@STM23_TRUE@KERNEL_DIR = @DIR_linuxp0123@
@ENABLE_P0119_TRUE@@STM22_FALSE@@STM23_TRUE@KERNEL_DIR = @DIR_linuxp0119@
@ENABLE_P0201_FALSE@@ENABLE_P0205_FALSE@@ENABLE_P0206_FALSE@@ENABLE_P0207_FALSE@@STM22_FALSE@@STM23_FALSE@KERNEL_DIR = @DIR_linuxp0209@
@ENABLE_P0201_FALSE@@ENABLE_P0205_FALSE@@ENABLE_P0206_FALSE@@ENABLE_P0207_TRUE@@STM22_FALSE@@STM23_FALSE@KERNEL_DIR = @DIR_linuxp0207@
@ENABLE_P0201_FALSE@@ENABLE_P0205_FALSE@@ENABLE_P0206_TRUE@@STM22_FALSE@@STM23_FALSE@KERNEL_DIR = @DIR_linuxp0206@
@ENABLE_P0201_FALSE@@ENABLE_P0205_TRUE@@STM22_FALSE@@STM23_FALSE@KERNEL_DIR = @DIR_linuxp0205@
@ENABLE_P0201_TRUE@@STM22_FALSE@@STM23_FALSE@KERNEL_DIR = @DIR_linuxp0201@
@P0040_FALSE@@P0041_FALSE@@STM22_TRUE@KERNEL_DIR = @DIR_linux@
@P0040_FALSE@@P0041_TRUE@@STM22_TRUE@KERNEL_DIR = @DIR_linuxp0041@
@P0040_TRUE@@STM22_TRUE@KERNEL_DIR = @DIR_linuxp0040@
@ENABLE_P0119_FALSE@@ENABLE_P0123_FALSE@@STM22_FALSE@@STM23_TRUE@KERNEL_PREPARE = @PREPARE_linux23@
@ENABLE_P0119_FALSE@@ENABLE_P0123_TRUE@@STM22_FALSE@@STM23_TRUE@KERNEL_PREPARE = @PREPARE_linux23@
@ENABLE_P0119_TRUE@@STM22_FALSE@@STM23_TRUE@KERNEL_PREPARE = @PREPARE_linux23@
@P0040_FALSE@@P0041_FALSE@@STM22_TRUE@KERNEL_PREPARE = @PREPARE_linux@
@P0040_FALSE@@P0041_TRUE@@STM22_TRUE@KERNEL_PREPARE = @PREPARE_linuxp0041@
@P0040_TRUE@@STM22_TRUE@KERNEL_PREPARE = @PREPARE_linuxp0040@
@STM22_FALSE@@STM23_FALSE@KERNEL_PREPARE = @PREPARE_linux24@
# if STM24
@STM22_FALSE@@STM23_FALSE@STM_RELOCATE := /opt/STM/STLinux-2.4
@STM22_FALSE@@STM23_TRUE@STM_RELOCATE := /opt/STM/STLinux-2.3
# endif STM24
@STM22_TRUE@STM_RELOCATE := /opt/STM/STLinux-2.2

#
# HOST-RPMCONFIG
#
HOST_RPMCONFIG = host-rpmconfig

# if STM24
@STM22_FALSE@@STM23_FALSE@HOST_RPMCONFIG_VERSION = 2.4-21
@STM22_FALSE@@STM23_TRUE@HOST_RPMCONFIG_VERSION = 2.3-16
@STM22_TRUE@HOST_RPMCONFIG_VERSION = 2.2-10
@STM22_FALSE@@STM23_FALSE@HOST_RPMCONFIG_SPEC = stm-$(HOST_RPMCONFIG).spec
@STM22_FALSE@@STM23_TRUE@HOST_RPMCONFIG_SPEC = stm-$(HOST_RPMCONFIG).spec
@STM22_TRUE@HOST_RPMCONFIG_SPEC = stm-$(HOST_RPMCONFIG)-2.2.spec
@STM22_FALSE@@STM23_FALSE@HOST_RPMCONFIG_SPEC_PATCH = $(HOST_RPMCONFIG_SPEC)24.diff
@STM22_FALSE@@STM23_TRUE@HOST_RPMCONFIG_SPEC_PATCH = stm-$(HOST_RPMCONFIG).spec23.diff
@STM22_TRUE@HOST_RPMCONFIG_SPEC_PATCH = stm-$(HOST_RPMCONFIG).spec22.diff
@STM22_FALSE@@STM23_FALSE@HOST_RPMCONFIG_PATCHES = stm-$(HOST_RPMCONFIG)-ignore-skip-cvs-errors.patch \
@STM22_FALSE@@STM23_FALSE@			 stm-$(HOST_RPMCONFIG)-autoreconf-add-libtool-macros24.patch

@STM22_FALSE@@STM23_TRUE@HOST_RPMCONFIG_PATCHES = stm-$(HOST_RPMCONFIG)-autoreconf-add-libtool-macros23.patch \
@STM22_FALSE@@STM23_TRUE@			 stm-$(HOST_RPMCONFIG)-config_sub-dir.patch

@STM22_TRUE@HOST_RPMCONFIG_PATCHES = stm-$(HOST_RPMCONFIG)-compress_man-allways-true.patch \
@STM22_TRUE@			 stm-$(HOST_RPMCONFIG)-autoreconf-add-libtool-macros22.patch

# endif STM24
HOST_RPMCONFIG_RPM = RPMS/noarch/$(STLINUX)-$(HOST_RPMCONFIG)-$(HOST_RPMCONFIG_VERSION).noarch.rpm

#
# HOST-BASE-PASSWD
#
HOST_BASE_PASSWD = host-base-passwd
# if STM24
@STM22_FALSE@@STM23_FALSE@HOST_BASE_PASSWD_VERSION = 3.5.9-7
@STM22_FALSE@@STM23_TRUE@HOST_BASE_PASSWD_VERSION = 3.5.9-6
@STM22_TRUE@HOST_BASE_PASSWD_VERSION = 3.5.9-3
@STM22_FALSE@@STM23_FALSE@HOST_BASE_PASSWD_SPEC = stm-$(HOST_BASE_PASSWD).spec
@STM22_FALSE@@STM23_TRUE@HOST_BASE_PASSWD_SPEC = stm-$(HOST_BASE_PASSWD).spec
@STM22_TRUE@HOST_BASE_PASSWD_SPEC = stm-$(HOST_BASE_PASSWD).spec
@STM22_FALSE@@STM23_FALSE@HOST_BASE_PASSWD_SPEC_PATCH = 
@STM22_FALSE@@STM23_TRUE@HOST_BASE_PASSWD_SPEC_PATCH = 
@STM22_TRUE@HOST_BASE_PASSWD_SPEC_PATCH = $(HOST_BASE_PASSWD_SPEC)22.diff
@STM22_FALSE@@STM23_FALSE@HOST_BASE_PASSWD_PATCHES = 
@STM22_FALSE@@STM23_TRUE@HOST_BASE_PASSWD_PATCHES = 
@STM22_TRUE@HOST_BASE_PASSWD_PATCHES = 
# endif STM24
HOST_BASE_PASSWD_RPM = RPMS/sh4/$(STLINUX)-$(HOST_BASE_PASSWD)-$(HOST_BASE_PASSWD_VERSION).sh4.rpm

#
# HOST-DISTRIBUTIONUTILS
#
HOST_DISTRIBUTIONUTILS = host-distributionutils
# if STM24
@STM22_FALSE@@STM23_FALSE@HOST_DISTRIBUTIONUTILS_VERSION = 2.8.4-5
@STM22_FALSE@@STM23_TRUE@HOST_DISTRIBUTIONUTILS_VERSION = 2.8.4-4
@STM22_TRUE@HOST_DISTRIBUTIONUTILS_VERSION = 2.8.4-4
@STM22_FALSE@@STM23_FALSE@HOST_DISTRIBUTIONUTILS_SPEC = stm-$(HOST_DISTRIBUTIONUTILS).spec
@STM22_FALSE@@STM23_TRUE@HOST_DISTRIBUTIONUTILS_SPEC = stm-$(HOST_DISTRIBUTIONUTILS).spec
@STM22_TRUE@HOST_DISTRIBUTIONUTILS_SPEC = stm-$(HOST_DISTRIBUTIONUTILS).spec
@STM22_FALSE@@STM23_FALSE@HOST_DISTRIBUTIONUTILS_SPEC_PATCH = 
@STM22_FALSE@@STM23_TRUE@HOST_DISTRIBUTIONUTILS_SPEC_PATCH = 
@STM22_TRUE@HOST_DISTRIBUTIONUTILS_SPEC_PATCH = 
@STM22_FALSE@@STM23_FALSE@HOST_DISTRIBUTIONUTILS_PATCHES = 
@STM22_FALSE@@STM23_TRUE@HOST_DISTRIBUTIONUTILS_PATCHES = 
@STM22_TRUE@HOST_DISTRIBUTIONUTILS_PATCHES = 
# endif STM24
HOST_DISTRIBUTIONUTILS_RPM = RPMS/$(host_arch)/$(STLINUX)-$(HOST_DISTRIBUTIONUTILS)-$(HOST_DISTRIBUTIONUTILS_VERSION).$(host_arch).rpm

#
# HOST AUTOTOOLS
#
HOST_AUTOTOOLS = host-autotools
# if STM24
@STM22_FALSE@@STM23_FALSE@HOST_AUTOTOOLS_VERSION = dev-20091012-2
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@HOST_AUTOTOOLS_VERSION = dev-20091012-2
@STM22_TRUE@HOST_AUTOTOOLS_VERSION = 2.0-8
@STM22_FALSE@@STM23_FALSE@HOST_AUTOTOOLS_SPEC = stm-$(HOST_AUTOTOOLS)-dev.spec
@STM22_FALSE@@STM23_TRUE@HOST_AUTOTOOLS_SPEC = stm-$(HOST_AUTOTOOLS)-dev.spec
@STM22_TRUE@HOST_AUTOTOOLS_SPEC = stm-$(HOST_AUTOTOOLS).spec
@STM22_FALSE@@STM23_FALSE@HOST_AUTOTOOLS_SPEC_PATCH = 
@STM22_FALSE@@STM23_TRUE@HOST_AUTOTOOLS_SPEC_PATCH = 
@STM22_TRUE@HOST_AUTOTOOLS_SPEC_PATCH = $(HOST_AUTOTOOLS_SPEC)22.diff
@STM22_FALSE@@STM23_FALSE@HOST_AUTOTOOLS_PATCHES = 
@STM22_FALSE@@STM23_TRUE@HOST_AUTOTOOLS_PATCHES = 
@STM22_TRUE@HOST_AUTOTOOLS_PATCHES = 
# endif STM24
HOST_AUTOTOOLS_RPM = RPMS/sh4/$(STLINUX)-$(HOST_AUTOTOOLS)-$(HOST_AUTOTOOLS_VERSION).sh4.rpm

#
# HOST AUTOMAKE
#
@STM22_FALSE@HOST_AUTOMAKE = host-automake
# if STM24
@STM22_FALSE@@STM23_FALSE@HOST_AUTOMAKE_VERSION = 1.11-2
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@HOST_AUTOMAKE_VERSION = 1.11-2
@STM22_FALSE@@STM23_FALSE@HOST_AUTOMAKE_SPEC = stm-$(HOST_AUTOMAKE).spec
@STM22_FALSE@@STM23_TRUE@HOST_AUTOMAKE_SPEC = stm-$(HOST_AUTOMAKE).spec
@STM22_FALSE@@STM23_FALSE@HOST_AUTOMAKE_SPEC_PATCH = 
@STM22_FALSE@@STM23_TRUE@HOST_AUTOMAKE_SPEC_PATCH = 
@STM22_FALSE@@STM23_FALSE@HOST_AUTOMAKE_PATCHES = 
@STM22_FALSE@@STM23_TRUE@HOST_AUTOMAKE_PATCHES = 
# endif STM24
@STM22_FALSE@HOST_AUTOMAKE_RPM = RPMS/sh4/$(STLINUX)-$(HOST_AUTOMAKE)-$(HOST_AUTOMAKE_VERSION).sh4.rpm

#
# HOST AUTOCONF
#
@STM22_FALSE@HOST_AUTOCONF = host-autoconf
# if STM24
@STM22_FALSE@@STM23_FALSE@HOST_AUTOCONF_VERSION = 2.64-4
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@HOST_AUTOCONF_VERSION = 2.64-4
@STM22_FALSE@@STM23_FALSE@HOST_AUTOCONF_SPEC = stm-$(HOST_AUTOCONF).spec
@STM22_FALSE@@STM23_TRUE@HOST_AUTOCONF_SPEC = stm-$(HOST_AUTOCONF).spec
@STM22_FALSE@@STM23_FALSE@HOST_AUTOCONF_SPEC_PATCH = stm-$(HOST_AUTOCONF).$(HOST_AUTOCONF_VERSION).spec.diff
@STM22_FALSE@@STM23_TRUE@HOST_AUTOCONF_SPEC_PATCH = 
@STM22_FALSE@@STM23_FALSE@HOST_AUTOCONF_PATCHES = stm-$(HOST_AUTOCONF).$(HOST_AUTOCONF_VERSION).diff
@STM22_FALSE@@STM23_TRUE@HOST_AUTOCONF_PATCHES = 
# endif STM24
@STM22_FALSE@HOST_AUTOCONF_RPM = RPMS/sh4/$(STLINUX)-$(HOST_AUTOCONF)-$(HOST_AUTOCONF_VERSION).sh4.rpm

#
# HOST PKGCONFIG
#
@STM22_FALSE@HOST_PKGCONFIG = host-pkg-config
# if STM24
@STM22_FALSE@@STM23_FALSE@HOST_PKGCONFIG_VERSION = 0.23-2
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@HOST_PKGCONFIG_VERSION = 0.23-2
@STM22_FALSE@@STM23_FALSE@HOST_PKGCONFIG_SPEC = stm-$(HOST_PKGCONFIG).spec
@STM22_FALSE@@STM23_TRUE@HOST_PKGCONFIG_SPEC = stm-$(HOST_PKGCONFIG).spec
@STM22_FALSE@@STM23_FALSE@HOST_PKGCONFIG_SPEC_PATCH = 
@STM22_FALSE@@STM23_TRUE@HOST_PKGCONFIG_SPEC_PATCH = 
@STM22_FALSE@@STM23_FALSE@HOST_PKGCONFIG_PATCHES = 
@STM22_FALSE@@STM23_TRUE@HOST_PKGCONFIG_PATCHES = 
# endif STM24
@STM22_FALSE@HOST_PKGCONFIG_RPM = RPMS/sh4/$(STLINUX)-$(HOST_PKGCONFIG)-$(HOST_PKGCONFIG_VERSION).sh4.rpm

#
# HOST-LIBLZO
#

#
# HOST-MTD-UTILS
#
HOST_MTD_UTILS = host-mtd-utils
# if STM24
@STM22_FALSE@@STM23_FALSE@HOST_MTD_UTILS_VERSION = 1.0.1-8
@STM22_FALSE@@STM23_TRUE@HOST_MTD_UTILS_VERSION = 1.0.1-8
@STM22_TRUE@HOST_MTD_UTILS_VERSION = 1.0.1-8
@STM22_FALSE@@STM23_FALSE@HOST_MTD_UTILS_SPEC = stm-$(HOST_MTD_UTILS).spec
@STM22_FALSE@@STM23_TRUE@HOST_MTD_UTILS_SPEC = stm-$(HOST_MTD_UTILS).spec
@STM22_TRUE@HOST_MTD_UTILS_SPEC = stm-$(HOST_MTD_UTILS).spec
@STM22_FALSE@@STM23_FALSE@HOST_MTD_UTILS_SPEC_PATCH = 
@STM22_FALSE@@STM23_TRUE@HOST_MTD_UTILS_SPEC_PATCH = 
@STM22_TRUE@HOST_MTD_UTILS_SPEC_PATCH = 
@STM22_FALSE@@STM23_FALSE@HOST_MTD_UTILS_PATCHES = 
@STM22_FALSE@@STM23_TRUE@HOST_MTD_UTILS_PATCHES = 
@STM22_TRUE@HOST_MTD_UTILS_PATCHES = 
# endif STM24
HOST_MTD_UTILS_RPM = RPMS/sh4/$(STLINUX)-$(HOST_MTD_UTILS)-$(HOST_MTD_UTILS_VERSION).sh4.rpm

#
# BOOTSTRAP-CROSS
#

#
# CROSS_FILESYSTEM
#
CROSS_FILESYSTEM = cross-sh4-filesystem

#
# CROSS_DISTRIBUTIONUTILS
#
CROSS_DISTRIBUTIONUTILS = cross-sh4-distributionutils
# if STM24
@STM22_FALSE@@STM23_FALSE@CROSS_DISTRIBUTIONUTILS_VERSION = 1.14-6
@STM22_FALSE@@STM23_TRUE@CROSS_DISTRIBUTIONUTILS_VERSION = 1.14-5
@STM22_TRUE@CROSS_DISTRIBUTIONUTILS_VERSION = 1.14-3
@STM22_FALSE@@STM23_FALSE@CROSS_DISTRIBUTIONUTILS_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_DISTRIBUTIONUTILS)).spec
@STM22_FALSE@@STM23_TRUE@CROSS_DISTRIBUTIONUTILS_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_DISTRIBUTIONUTILS)).spec
@STM22_TRUE@CROSS_DISTRIBUTIONUTILS_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_DISTRIBUTIONUTILS)).spec
@STM22_FALSE@@STM23_FALSE@CROSS_DISTRIBUTIONUTILS_SPEC_PATCH = 
@STM22_FALSE@@STM23_TRUE@CROSS_DISTRIBUTIONUTILS_SPEC_PATCH = 
@STM22_TRUE@CROSS_DISTRIBUTIONUTILS_SPEC_PATCH = $(CROSS_DISTRIBUTIONUTILS_SPEC)22.diff
@STM22_FALSE@@STM23_FALSE@CROSS_DISTRIBUTIONUTILS_PATCHES = 
@STM22_FALSE@@STM23_TRUE@CROSS_DISTRIBUTIONUTILS_PATCHES = 
@STM22_TRUE@CROSS_DISTRIBUTIONUTILS_PATCHES = hardhatutils-srcdir.diff
# endif STM24
CROSS_DISTRIBUTIONUTILS_RPM = RPMS/$(host_arch)/$(STLINUX)-$(CROSS_DISTRIBUTIONUTILS)-$(CROSS_DISTRIBUTIONUTILS_VERSION).$(host_arch).rpm

#
# CROSS BINUTILS
#
CROSS_BINUTILS = cross-sh4-binutils
CROSS_BINUTILS_DEV = cross-sh4-binutils-dev
# if STM24
@STM22_FALSE@@STM23_FALSE@CROSS_BINUTILS_VERSION = 2.19.1-41
@STM22_FALSE@@STM23_TRUE@CROSS_BINUTILS_VERSION = $(if $(STABLE),2.18.50.0.8-34,2.18.50.0.8-38)
@STM22_TRUE@CROSS_BINUTILS_VERSION = 2.17.50.0.4-13
@STM22_FALSE@@STM23_FALSE@CROSS_BINUTILS_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_BINUTILS)).spec
@STM22_FALSE@@STM23_TRUE@CROSS_BINUTILS_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_BINUTILS)).spec
@STM22_TRUE@CROSS_BINUTILS_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_BINUTILS))-sh4processed.spec
@STM22_FALSE@@STM23_FALSE@CROSS_BINUTILS_SPEC_PATCH = 
@STM22_FALSE@@STM23_TRUE@CROSS_BINUTILS_SPEC_PATCH = $(CROSS_BINUTILS_SPEC)23.diff
@STM22_TRUE@CROSS_BINUTILS_SPEC_PATCH = $(CROSS_BINUTILS_SPEC)22.diff
@STM22_FALSE@@STM23_FALSE@CROSS_BINUTILS_PATCHES = 
@STM22_FALSE@@STM23_TRUE@CROSS_BINUTILS_PATCHES = stm-cross-binutils.diff
@STM22_TRUE@CROSS_BINUTILS_PATCHES = stm-cross-binutils.diff
# endif STM24
CROSS_BINUTILS_RPM = RPMS/${host_arch}/$(STLINUX)-$(CROSS_BINUTILS)-$(CROSS_BINUTILS_VERSION).${host_arch}.rpm
CROSS_BINUTILS_DEV_RPM = RPMS/${host_arch}/$(STLINUX)-$(CROSS_BINUTILS_DEV)-$(CROSS_BINUTILS_VERSION).${host_arch}.rpm
# if STM24
@STM22_FALSE@@STM23_FALSE@CROSS_GMP = cross-sh4-gmp

#
# CROSS GMP
#
@STM22_FALSE@@STM23_TRUE@CROSS_GMP = cross-sh4-gmp
@STM22_FALSE@@STM23_FALSE@CROSS_GMP_VERSION = 5.0.1-9
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@CROSS_GMP_VERSION = 4.3.2-6
@STM22_FALSE@@STM23_FALSE@CROSS_GMP_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_GMP)).spec
@STM22_FALSE@@STM23_TRUE@CROSS_GMP_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_GMP)).spec
@STM22_FALSE@@STM23_FALSE@CROSS_GMP_SPEC_PATCH = $(CROSS_GMP_SPEC).$(CROSS_GMP_VERSION).diff
@STM22_FALSE@@STM23_TRUE@CROSS_GMP_SPEC_PATCH = 
@STM22_FALSE@@STM23_FALSE@CROSS_GMP_PATCHES = 
@STM22_FALSE@@STM23_TRUE@CROSS_GMP_PATCHES = 
@STM22_FALSE@@STM23_FALSE@CROSS_GMP_RPM = RPMS/$(host_arch)/$(STLINUX)-$(CROSS_GMP)-$(CROSS_GMP_VERSION).$(host_arch).rpm
@STM22_FALSE@@STM23_TRUE@CROSS_GMP_RPM = RPMS/$(host_arch)/$(STLINUX)-$(CROSS_GMP)-$(CROSS_GMP_VERSION).$(host_arch).rpm

#
# CROSS MPFR
#
@STM22_FALSE@CROSS_MPFR = cross-sh4-mpfr
# if STM24
@STM22_FALSE@@STM23_FALSE@CROSS_MPFR_VERSION = 2.4.2-6
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@CROSS_MPFR_VERSION = 2.4.2-6
@STM22_FALSE@@STM23_FALSE@CROSS_MPFR_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_MPFR)).spec
@STM22_FALSE@@STM23_TRUE@CROSS_MPFR_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_MPFR)).spec
@STM22_FALSE@@STM23_FALSE@CROSS_MPFR_SPEC_PATCH = $(CROSS_MPFR_SPEC)24.diff
@STM22_FALSE@@STM23_TRUE@CROSS_MPFR_SPEC_PATCH = $(CROSS_MPFR_SPEC)24.diff
@STM22_FALSE@@STM23_FALSE@CROSS_MPFR_PATCHES = 
@STM22_FALSE@@STM23_TRUE@CROSS_MPFR_PATCHES = 
# endif STM24
@STM22_FALSE@CROSS_MPFR_RPM = RPMS/$(host_arch)/$(STLINUX)-$(CROSS_MPFR)-$(CROSS_MPFR_VERSION).$(host_arch).rpm

#
# CROSS MPC
#
@STM24_TRUE@CROSS_MPC = cross-sh4-mpc
@STM24_TRUE@CROSS_MPC_VERSION = 0.8.2-3
@STM24_TRUE@CROSS_MPC_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_MPC)).spec
@STM24_TRUE@CROSS_MPC_SPEC_PATCH = $(CROSS_MPC_SPEC).$(CROSS_MPC_VERSION).diff
@STM24_TRUE@CROSS_MPC_PATCHES = 
@STM24_TRUE@CROSS_MPC_RPM = RPMS/$(host_arch)/$(STLINUX)-$(CROSS_MPC)-$(CROSS_MPC_VERSION).$(host_arch).rpm

#
# CROSS LIBELF
#
@STM24_TRUE@CROSS_LIBELF = cross-sh4-libelf
@STM24_TRUE@CROSS_LIBELF_VERSION = 0.8.13-1
@STM24_TRUE@CROSS_LIBELF_SPEC = stm-$(subst cross-sh4,cross,$(CROSS_LIBELF)).spec
@STM24_TRUE@CROSS_LIBELF_SPEC_PATCH = $(CROSS_LIBELF_SPEC).$(CROSS_LIBELF_VERSION).diff
@STM24_TRUE@CROSS_LIBELF_PATCHES = 
@STM24_TRUE@CROSS_LIBELF_RPM = RPMS/$(host_arch)/$(STLINUX)-$(CROSS_LIBELF)-$(CROSS_LIBELF_VERSION).$(host_arch).rpm

#
# CROSS GCC
#
CROSS_GCC = cross-sh4-gcc
CROSS_CPP = cross-sh4-cpp
CROSS_PROTOIZE = cross-sh4-protoize
CROSS_LIBGCC = cross-sh4-libgcc
# if STM24
@STM22_FALSE@@STM23_FALSE@CROSS_GCC_VERSION = 4.5.2-78
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@CROSS_GCC_VERSION = 4.3.4-63
@STM22_TRUE@CROSS_GCC_VERSION = 4.1.1-23
@STM22_FALSE@@STM23_FALSE@CROSS_GCC_RAWVERSION = $(firstword $(subst -, ,$(CROSS_GCC_VERSION)))
@STM22_FALSE@@STM23_TRUE@CROSS_GCC_RAWVERSION = $(firstword $(subst -, ,$(CROSS_GCC_VERSION)))
@STM22_TRUE@CROSS_GCC_RAWVERSION = $(firstword $(subst -, ,$(CROSS_GCC_VERSION)))
@STM22_FALSE@@STM23_FALSE@CROSS_GCC_SPEC = stm-$(subst cross-sh4-,cross-,$(CROSS_GCC)).spec
@STM22_FALSE@@STM23_TRUE@CROSS_GCC_SPEC = stm-$(subst cross-sh4-,cross-,$(CROSS_GCC)).spec
@STM22_TRUE@CROSS_GCC_SPEC = stm-$(subst cross-sh4-,cross-,$(CROSS_GCC))-sh4processed.spec
@STM22_FALSE@@STM23_FALSE@CROSS_GCC_SPEC_PATCH = $(CROSS_GCC_SPEC).$(CROSS_GCC_VERSION).diff
@STM22_FALSE@@STM23_TRUE@CROSS_GCC_SPEC_PATCH = $(CROSS_GCC_SPEC).$(CROSS_GCC_VERSION).diff
@STM22_TRUE@CROSS_GCC_SPEC_PATCH = $(CROSS_GCC_SPEC)22.diff
@STM22_FALSE@@STM23_FALSE@CROSS_GCC_PATCHES = 
@STM22_FALSE@@STM23_TRUE@CROSS_GCC_PATCHES = 
@STM22_TRUE@CROSS_GCC_PATCHES = 
@STM22_FALSE@@STM23_FALSE@CROSS_GCC_KERNELHEADERS = linux-kernel-headers
@STM22_FALSE@@STM23_TRUE@CROSS_GCC_KERNELHEADERS = linux-kernel-headers
@STM22_TRUE@CROSS_GCC_KERNELHEADERS = kernel-headers
@STM22_FALSE@@STM23_FALSE@CROSS_GCC_INVALIDATE = 
@STM22_FALSE@@STM23_TRUE@CROSS_GCC_INVALIDATE = 
@STM22_TRUE@CROSS_GCC_INVALIDATE = YES
# endif STM24
CROSS_GCC_RPM = RPMS/$(host_arch)/$(STLINUX)-$(CROSS_GCC)-$(CROSS_GCC_VERSION).$(host_arch).rpm
CROSS_CPP_RPM = RPMS/$(host_arch)/$(STLINUX)-$(CROSS_CPP)-$(CROSS_GCC_VERSION).$(host_arch).rpm
CROSS_PROTOIZE_RPM = RPMS/$(host_arch)/$(STLINUX)-$(CROSS_PROTOIZE)-$(CROSS_GCC_VERSION).$(host_arch).rpm
CROSS_LIBGCC_RPM = RPMS/$(host_arch)/$(STLINUX)-$(CROSS_LIBGCC)-$(CROSS_GCC_VERSION).$(host_arch).rpm

#
# U-BOOT
#
HOST_U_BOOT := host-u-boot
# if STM24
@STM22_FALSE@@STM23_FALSE@HOST_U_BOOT_VERSION := sh4-1.3.1_stm24_0048-48
@STM22_FALSE@@STM23_TRUE@HOST_U_BOOT_VERSION := $(if $(STABLE),sh4-1.3.1_stm23_0038-38,sh4-1.3.1_stm23_0047-47)
@STM22_TRUE@HOST_U_BOOT_VERSION := 1.1.2_stm22_0020-20
@STM22_FALSE@@STM23_FALSE@HOST_U_BOOT_RAWVERSION := $(HOST_U_BOOT_VERSION)
@STM22_FALSE@@STM23_TRUE@HOST_U_BOOT_RAWVERSION := $(HOST_U_BOOT_VERSION)
@STM22_TRUE@HOST_U_BOOT_RAWVERSION := $(firstword $(subst -, ,$(HOST_U_BOOT_VERSION)))
@STM22_FALSE@@STM23_FALSE@HOST_U_BOOT_DIR := u-boot/u-boot-sh4-$(word 2, $(subst -, ,$(HOST_U_BOOT_VERSION)))
@STM22_FALSE@@STM23_TRUE@HOST_U_BOOT_DIR := u-boot/u-boot-sh4-$(word 2, $(subst -, ,$(HOST_U_BOOT_VERSION)))
@STM22_TRUE@HOST_U_BOOT_DIR := u-boot/u-boot-$(HOST_U_BOOT_RAWVERSION)
@STM22_FALSE@@STM23_FALSE@HOST_U_BOOT_SPEC := stm-$(HOST_U_BOOT).spec
@STM22_FALSE@@STM23_TRUE@HOST_U_BOOT_SPEC := stm-$(HOST_U_BOOT).spec
@STM22_TRUE@HOST_U_BOOT_SPEC := stm-$(HOST_U_BOOT).spec
@STM22_FALSE@@STM23_FALSE@HOST_U_BOOT_SPEC_PATCH := uboot-1.3.1_spec_stm24.patch
@STM22_FALSE@@STM23_TRUE@HOST_U_BOOT_SPEC_PATCH := 
@STM22_TRUE@HOST_U_BOOT_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@HOST_U_BOOT_PATCHES := uboot-1.3.1_lzma_stm24.patch
@STM22_FALSE@@STM23_TRUE@HOST_U_BOOT_PATCHES := 
@STM22_TRUE@HOST_U_BOOT_PATCHES := 
# endif STM24
HOST_U_BOOT_RPM := RPMS/noarch/$(STLINUX)-$(HOST_U_BOOT)-source-$(HOST_U_BOOT_VERSION).noarch.rpm
#%install
#%host_setup
#rm -rf %{buildroot}
#cd u-boot
#install -d -m 755 %{buildroot}%{_stm_binary_uboot_dir}
#cp u-boot       %{buildroot}%{_stm_binary_uboot_dir}
#cp u-boot.*     %{buildroot}%{_stm_binary_uboot_dir}
#cp setupenv*    %{buildroot}%{_stm_binary_uboot_dir}
#cp STM/localenv %{buildroot}%{_stm_binary_uboot_dir}
#cp kscript      %{buildroot}%{_stm_binary_uboot_dir}
####cp COPYING      %{buildroot}%{_stm_binary_uboot_dir}/LICENSE
####
####echo -e "ST Linux Distribution "%{_hhl_build_id}" Binary U-boot\n \
####CPU: sh4\n \
####PLATFORM: stb7100ref_27\n \
####U-BOOT VERSION: 1.1.2_st2.0\n" > \
####%{buildroot}%{_stm_binary_uboot_dir}/README.ST

#stlinux20-host-u-boot ftp://ftp.stlinux.com/pub/stlinux/2.0/ST_Linux_2.0/SRPM_Distribution/sh4-SRPMS-updates/stlinux20-host-u-boot-sh4_stb7100ref_27-2.0-14.src.rpm
HOST_U_BOOT_SH4_STB7100REF_27 := host-u-boot-sh4_stb7100ref_27
#ftp://ftp.stlinux.com/pub/stlinux/2.2/SRPMS/stlinux22-target-u-boot-sh4_stb7100ref_27-1.1.2_stm22_0017-1.src.rpm
#ftp://ftp.stlinux.com/pub/stlinux/2.2/SRPMS/stlinux22-target-u-boot-sh4_stb7100ref_30-1.1.2_stm22_0017-1.src.rpm
#ftp://ftp.stlinux.com/pub/stlinux/2.2/updates/SRPMS/stlinux22-target-u-boot-sh4_stb7100ref_27-1.1.2_stm22_0020-1.src.rpm
#ftp://ftp.stlinux.com/pub/stlinux/2.2/updates/SRPMS/stlinux22-target-u-boot-sh4_stb7100ref_30-1.1.2_stm22_0020-1.src.rpm

#
# HOST-U-BOOT-TOOLS
#
HOST_U_BOOT_TOOLS := host-u-boot-tools
# if STM24
@STM22_FALSE@@STM23_FALSE@HOST_U_BOOT_TOOLS_VERSION := 1.3.1_stm24-8
@STM22_FALSE@@STM23_TRUE@HOST_U_BOOT_TOOLS_VERSION := 1.3.1_stm23-7
@STM22_TRUE@HOST_U_BOOT_TOOLS_VERSION := 1.1.2_st2.0-3
@STM22_FALSE@@STM23_FALSE@HOST_U_BOOT_TOOLS_SPEC := stm-$(HOST_U_BOOT_TOOLS).spec
@STM22_FALSE@@STM23_TRUE@HOST_U_BOOT_TOOLS_SPEC := stm-$(HOST_U_BOOT_TOOLS).spec
@STM22_TRUE@HOST_U_BOOT_TOOLS_SPEC := stm-$(HOST_U_BOOT_TOOLS).spec
@STM22_FALSE@@STM23_FALSE@HOST_U_BOOT_TOOLS_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@HOST_U_BOOT_TOOLS_SPEC_PATCH := 
@STM22_TRUE@HOST_U_BOOT_TOOLS_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@HOST_U_BOOT_TOOLS_PATCHES := 
@STM22_FALSE@@STM23_TRUE@HOST_U_BOOT_TOOLS_PATCHES := 
@STM22_TRUE@HOST_U_BOOT_TOOLS_PATCHES := 
# endif STM24
HOST_U_BOOT_TOOLS_RPM := RPMS/sh4/$(STLINUX)-$(HOST_U_BOOT_TOOLS)-$(HOST_U_BOOT_TOOLS_VERSION).sh4.rpm

#
# Adapted etc files and etc read-write files
#
GLIBC_ADAPTED_ETC_FILES = 
BASE_PASSWD_ADAPTED_ETC_FILES = 

#BASE_FILES_ADAPTED_ETC_FILES = hosts issue.net motd profile resolv.conf
BASE_FILES_ADAPTED_ETC_FILES = fstab issue.net motd profile resolv.conf
BUSYBOX_ADAPTED_ETC_FILES = 
INITSCRIPTS_ADAPTED_ETC_FILES = hostname init.d/mountvirtfs init.d/checkroot.sh init.d/mountall.sh init.d/rcS$(if $(TF7700),_$(TF7700))$(if $(HL101),_$(HL101))$(if $(VIP1_V2),_$(VIP1_V2))$(if $(VIP2_V1),_$(VIP2_V1))$(if $(UFS922),_$(UFS922))$(if $(CUBEREVO),_$(CUBEREVO))$(if $(CUBEREVO_MINI),_$(CUBEREVO_MINI))$(if $(CUBEREVO_MINI2),_$(CUBEREVO_MINI2))$(if $(CUBEREVO_MINI_FTA),_$(CUBEREVO_MINI_FTA))$(if $(CUBEREVO_250HD),_$(CUBEREVO_250HD))$(if $(CUBEREVO_2000HD),_$(CUBEREVO_2000HD))$(if $(CUBEREVO_9500HD),_$(CUBEREVO_9500HD)) vdstandby.cfg
OPENRDATE_ADAPTED_ETC_FILES = init.d/rdate.sh
NETBASE_ADAPTED_ETC_FILES = network/interfaces
MODULE_INIT_TOOLS_ADAPTED_ETC_FILES = modules init.d/module-init-tools
SYSVINIT_ADAPTED_ETC_FILES = inittab
#ETC_RW_FILES +=
AUTOFS_ADAPTED_ETC_FILES = auto.master auto.ufs910 timezone.xml default/autofs init.d/autofs
TCP_WRAPPERS_ADAPTED_ETC_FILES = 
PORTMAP_ADAPTED_ETC_FILES = 

#NFS_UTILS_ADAPTED_ETC_FILES = exports init.d/nfs-common init.d/nfs-kernel-server
#NFS_UTILS_ADAPTED_ETC_FILES = init.d/nfs-common init.d/nfs-kernel-server
NFS_UTILS_ADAPTED_ETC_FILES = 
E2FSPROGS_ADAPTED_ETC_FILES = 
SG3_UTILS_ADAPTED_ETC_FILES = default/sg_down init.d/sg_down
DIVERSE_TOOLS_ADAPTED_ETC_FILES = default/swap init.d/allerlei init.d/swap default/framebuffer
STOCK_GUI_ADAPTED_ETC_FILES = default/ufs910-common default/ufs910 init.d/ufs910-common init.d/ufs910
FUSE_ADAPTED_ETC_FILES = init.d/fuse

#
# GLIBC
#
GLIBC := glibc
GLIBC_DEV := glibc-dev
# if STM24
@STM22_FALSE@@STM23_FALSE@GLIBC_VERSION := 2.10.1-21
@STM22_FALSE@@STM23_TRUE@GLIBC_VERSION := $(if $(STABLE),2.6.1-53,2.6.1-61)
@STM22_TRUE@GLIBC_VERSION := 2.5-27
@STM22_FALSE@@STM23_FALSE@GLIBC_RAWVERSION := $(firstword $(subst -, ,$(GLIBC_VERSION)))
@STM22_FALSE@@STM23_TRUE@GLIBC_RAWVERSION := $(firstword $(subst -, ,$(GLIBC_VERSION)))
@STM22_TRUE@GLIBC_RAWVERSION := $(firstword $(subst -, ,$(GLIBC_VERSION)))
@STM22_FALSE@@STM23_FALSE@GLIBC_SPEC := stm-target-$(GLIBC).spec
@STM22_FALSE@@STM23_TRUE@GLIBC_SPEC := stm-target-$(GLIBC).spec
@STM22_TRUE@GLIBC_SPEC := stm-target-$(GLIBC)-sh4processed.spec
@STM22_FALSE@@STM23_FALSE@GLIBC_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@GLIBC_SPEC_PATCH := $(GLIBC_SPEC)23.diff
@STM22_TRUE@GLIBC_SPEC_PATCH := $(GLIBC_SPEC)22.diff
@STM22_FALSE@@STM23_FALSE@GLIBC_PATCHES := 
@STM22_FALSE@@STM23_TRUE@GLIBC_PATCHES := stm-target-glibc-sysincludes.patch
@STM22_TRUE@GLIBC_PATCHES := glibc-2.5.patch
# endif STM24
GLIBC_RPM := RPMS/sh4/$(STLINUX)-sh4-$(GLIBC)-$(GLIBC_VERSION).sh4.rpm
GLIBC_DEV_RPM := RPMS/sh4/$(STLINUX)-sh4-$(GLIBC_DEV)-$(GLIBC_VERSION).sh4.rpm

#
# GMP
#
@STM22_FALSE@GMP := gmp
# if STM24
@STM22_FALSE@@STM23_FALSE@GMP_VERSION := 5.0.1-5
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@GMP_VERSION := 4.3.2-3
@STM22_FALSE@@STM23_FALSE@GMP_SPEC := stm-target-$(GMP).spec
@STM22_FALSE@@STM23_TRUE@GMP_SPEC := stm-target-$(GMP).spec
@STM22_FALSE@@STM23_FALSE@GMP_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@GMP_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@GMP_PATCHES := 
@STM22_FALSE@@STM23_TRUE@GMP_PATCHES := 
# endif STM24
@STM22_FALSE@GMP_RPM := RPMS/sh4/$(STLINUX)-sh4-$(GMP)-$(GMP_VERSION).sh4.rpm

#
# MPFR
#
@STM22_FALSE@MPFR := mpfr
# if STM24
@STM22_FALSE@@STM23_FALSE@MPFR_VERSION := 3.0.0-5
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@MPFR_VERSION := 2.4.2-3
@STM22_FALSE@@STM23_FALSE@MPFR_SPEC := stm-target-$(MPFR).spec
@STM22_FALSE@@STM23_TRUE@MPFR_SPEC := stm-target-$(MPFR).spec
@STM22_FALSE@@STM23_FALSE@MPFR_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@MPFR_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@MPFR_PATCHES := 
@STM22_FALSE@@STM23_TRUE@MPFR_PATCHES := 
# endif STM24
@STM22_FALSE@MPFR_RPM := RPMS/sh4/$(STLINUX)-sh4-$(MPFR)-$(MPFR_VERSION).sh4.rpm

#
# MPC
#
@STM24_TRUE@MPC := mpc
@STM24_TRUE@MPC_VERSION := 0.8.2-2
@STM24_TRUE@MPC_SPEC := stm-target-$(MPC).spec
@STM24_TRUE@MPC_SPEC_PATCH := $(MPC_SPEC).$(MPC_VERSION).diff
@STM24_TRUE@MPC_PATCHES := stm-target-$(MPC).$(MPC_VERSION).diff
@STM24_TRUE@MPC_RPM := RPMS/sh4/$(STLINUX)-sh4-$(MPC)-$(MPC_VERSION).sh4.rpm

#
# LIBELF
#
@STM24_TRUE@LIBELF := libelf
@STM24_TRUE@LIBELF_VERSION := 0.8.13-1
@STM24_TRUE@LIBELF_SPEC := stm-target-$(LIBELF).spec
@STM24_TRUE@LIBELF_SPEC_PATCH := 
@STM24_TRUE@LIBELF_PATCHES := 
@STM24_TRUE@LIBELF_RPM := RPMS/sh4/$(STLINUX)-sh4-$(LIBELF)-$(LIBELF_VERSION).sh4.rpm

#
# GCC LIBSTDC++
#
GCC := gcc
LIBSTDC := libstdc++
LIBSTDC_DEV := libstdc++-dev
LIBGCC := libgcc
# if STM24
@STM22_FALSE@@STM23_FALSE@GCC_VERSION := 4.5.2-82
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@GCC_VERSION := 4.3.4-66
@STM22_TRUE@GCC_VERSION := 4.1.1-26
@STM22_FALSE@@STM23_FALSE@GCC_SPEC := stm-target-$(GCC).spec
@STM22_FALSE@@STM23_TRUE@GCC_SPEC := stm-target-$(GCC).spec
@STM22_TRUE@GCC_SPEC := stm-target-$(GCC)-sh4processed.spec
@STM22_FALSE@@STM23_FALSE@GCC_SPEC_PATCH := $(GCC_SPEC).$(GCC_VERSION).diff
@STM22_FALSE@@STM23_TRUE@GCC_SPEC_PATCH := 
@STM22_TRUE@GCC_SPEC_PATCH := $(GCC_SPEC)22.diff
@STM22_FALSE@@STM23_FALSE@GCC_PATCHES := 
@STM22_FALSE@@STM23_TRUE@GCC_PATCHES := 
@STM22_TRUE@GCC_PATCHES := 
# endif STM24
GCC_RPM := RPMS/sh4/$(STLINUX)-sh4-$(GCC)-$(GCC_VERSION).sh4.rpm
LIBSTDC_RPM := RPMS/sh4/$(STLINUX)-sh4-$(LIBSTDC)-$(GCC_VERSION).sh4.rpm
LIBSTDC_DEV_RPM := RPMS/sh4/$(STLINUX)-sh4-$(LIBSTDC_DEV)-$(GCC_VERSION).sh4.rpm
LIBGCC_RPM := RPMS/sh4/$(STLINUX)-sh4-$(LIBGCC)-$(GCC_VERSION).sh4.rpm

#flash-libstdc++: $(flashprefix)/root/usr/lib/libstdc++.so.6.0.3
#
#$(flashprefix)/root/usr/lib/libstdc++.so.6.0.3: RPMS/sh4/$(STLINUX)-sh4-$(LIBSTDC)-$(GCC_VERSION).sh4.rpm
#	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps  -Uhv \
#		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^)
#	touch $@
#	@FLASHROOTDIR_MODIFIED@

#Wrote: RPMS/sh4/stlinux20-sh4-cpp-3.4.3-22.sh4.rpm
#Wrote: RPMS/sh4/stlinux20-sh4-cpp-doc-3.4.3-22.sh4.rpm
#Wrote: RPMS/sh4/stlinux20-sh4-g++-3.4.3-22.sh4.rpm
#Wrote: RPMS/sh4/stlinux20-sh4-gcc-doc-3.4.3-22.sh4.rpm

# END OF BOOTSTRAP

#
# LIBTERMCAP
#
LIBTERMCAP := libtermcap
LIBTERMCAP_DEV := libtermcap-dev
LIBTERMCAP_DOC := libtermcap-doc
# if STM24
@STM22_FALSE@@STM23_FALSE@LIBTERMCAP_VERSION := 2.0.8-10
@STM22_FALSE@@STM23_TRUE@LIBTERMCAP_VERSION := $(if $(STABLE),2.0.8-8,2.0.8-9)
@STM22_TRUE@LIBTERMCAP_VERSION := 2.0.8-8
@STM22_FALSE@@STM23_FALSE@LIBTERMCAP_RAWVERSION := $(firstword $(subst -, ,$(LIBTERMCAP_VERSION)))
@STM22_FALSE@@STM23_TRUE@LIBTERMCAP_RAWVERSION := $(firstword $(subst -, ,$(LIBTERMCAP_VERSION)))
@STM22_TRUE@LIBTERMCAP_RAWVERSION := $(firstword $(subst -, ,$(LIBTERMCAP_VERSION)))
@STM22_FALSE@@STM23_FALSE@LIBTERMCAP_SPEC := stm-target-$(LIBTERMCAP).spec
@STM22_FALSE@@STM23_TRUE@LIBTERMCAP_SPEC := stm-target-$(LIBTERMCAP).spec
@STM22_TRUE@LIBTERMCAP_SPEC := stm-target-$(LIBTERMCAP).spec
@STM22_FALSE@@STM23_FALSE@LIBTERMCAP_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@LIBTERMCAP_SPEC_PATCH := 
@STM22_TRUE@LIBTERMCAP_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@LIBTERMCAP_PATCHES := 
@STM22_FALSE@@STM23_TRUE@LIBTERMCAP_PATCHES := 
@STM22_TRUE@LIBTERMCAP_PATCHES := 
# endif STM24
LIBTERMCAP_RPM := RPMS/sh4/$(STLINUX)-sh4-$(LIBTERMCAP)-$(LIBTERMCAP_VERSION).sh4.rpm
LIBTERMCAP_DEV_RPM := RPMS/sh4/$(STLINUX)-sh4-$(LIBTERMCAP_DEV)-$(LIBTERMCAP_VERSION).sh4.rpm
LIBTERMCAP_DOC_RPM := RPMS/sh4/$(STLINUX)-sh4-$(LIBTERMCAP_DOC)-$(LIBTERMCAP_VERSION).sh4.rpm

#
# NCURSES
#
NCURSES := ncurses
NCURSES_BASE := ncurses-base
NCURSES_DEV := ncurses-dev
@STM22_FALSE@@STM23_FALSE@@STM24_TRUE@NCURSES_VERSION := 5.5-10
@STM22_FALSE@@STM23_TRUE@NCURSES_VERSION := 5.5-9
@STM22_TRUE@NCURSES_VERSION := 5.5-9
@STM22_FALSE@@STM23_FALSE@@STM24_TRUE@NCURSES_SPEC := stm-target-$(NCURSES).spec
@STM22_FALSE@@STM23_TRUE@NCURSES_SPEC := stm-target-$(NCURSES).spec
@STM22_TRUE@NCURSES_SPEC := stm-target-$(NCURSES).spec
@STM22_FALSE@@STM23_FALSE@@STM24_TRUE@NCURSES_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@NCURSES_SPEC_PATCH := 
@STM22_TRUE@NCURSES_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@@STM24_TRUE@NCURSES_PATCHES := 
@STM22_FALSE@@STM23_TRUE@NCURSES_PATCHES := 
@STM22_TRUE@NCURSES_PATCHES := 
NCURSES_RPM := RPMS/sh4/$(STLINUX)-sh4-$(NCURSES)-$(NCURSES_VERSION).sh4.rpm
NCURSES_BASE_RPM := RPMS/sh4/$(STLINUX)-sh4-$(NCURSES_BASE)-$(NCURSES_VERSION).sh4.rpm
NCURSES_DEV_RPM := RPMS/sh4/$(STLINUX)-sh4-$(NCURSES_DEV)-$(NCURSES_VERSION).sh4.rpm

#Wrote: RPMS/sh4/stlinux23-sh4-ncurses-dbg-5.5-9.sh4.rpm
#Wrote: RPMS/sh4/stlinux23-sh4-ncurses-pic-5.5-9.sh4.rpm
#Wrote: RPMS/sh4/stlinux23-sh4-ncurses-bin-5.5-9.sh4.rpm
#Wrote: RPMS/sh4/stlinux23-sh4-ncurses-term-5.5-9.sh4.rpm

#flash-ncurses-base: $(flashprefix)/root/usr/share/terminfo
#
#$(flashprefix)/root/usr/share/terminfo: RPMS/sh4/$(STLINUX)-sh4-$(NCURSES_BASE)-$(NCURSES_VERSION).sh4.rpm
#	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps  -Uhv \
#		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^)
#	touch $@
#	@FLASHROOTDIR_MODIFIED@
#
#flash-ncurses: flash-ncurses-base $(flashprefix)/root/lib/libncurses.so.5.4
#
#$(flashprefix)/root/lib/libncurses.so.5.4: RPMS/sh4/$(STLINUX)-sh4-$(NCURSES)-$(NCURSES_VERSION).sh4.rpm
#	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps  -Uhv \
#		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^)
#	touch $@
#	@FLASHROOTDIR_MODIFIED@

#
# BASE-PASSWD
#
BASE_PASSWD := base-passwd
# if STM24
@STM22_FALSE@@STM23_FALSE@BASE_PASSWD_VERSION := 3.5.9-9
@STM22_FALSE@@STM23_TRUE@BASE_PASSWD_VERSION := 3.5.9-7
@STM22_TRUE@BASE_PASSWD_VERSION := 3.5.9-6
@STM22_FALSE@@STM23_FALSE@BASE_PASSWD_SPEC := stm-target-$(BASE_PASSWD).spec
@STM22_FALSE@@STM23_TRUE@BASE_PASSWD_SPEC := stm-target-$(BASE_PASSWD).spec
@STM22_TRUE@BASE_PASSWD_SPEC := stm-target-$(BASE_PASSWD).spec
@STM22_FALSE@@STM23_FALSE@BASE_PASSWD_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@BASE_PASSWD_SPEC_PATCH := 
@STM22_TRUE@BASE_PASSWD_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@BASE_PASSWD_PATCHES := 
@STM22_FALSE@@STM23_TRUE@BASE_PASSWD_PATCHES := 
@STM22_TRUE@BASE_PASSWD_PATCHES := 
# endif STM24
BASE_PASSWD_RPM := RPMS/sh4/$(STLINUX)-sh4-$(BASE_PASSWD)-$(BASE_PASSWD_VERSION).sh4.rpm

#
# MAKEDEV
#
MAKEDEV := makedev
# if STM24
@STM22_FALSE@@STM23_FALSE@MAKEDEV_VERSION := 2.3.1-26
@STM22_FALSE@@STM23_TRUE@MAKEDEV_VERSION := $(if $(STABLE),2.3.1-24,2.3.1-25)
@STM22_TRUE@MAKEDEV_VERSION := 2.3.1-15
@STM22_FALSE@@STM23_FALSE@MAKEDEV_SPEC := stm-target-$(MAKEDEV).spec
@STM22_FALSE@@STM23_TRUE@MAKEDEV_SPEC := stm-target-$(MAKEDEV).spec
@STM22_TRUE@MAKEDEV_SPEC := stm-target-$(MAKEDEV).spec
@STM22_FALSE@@STM23_FALSE@MAKEDEV_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@MAKEDEV_SPEC_PATCH := 
@STM22_TRUE@MAKEDEV_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@MAKEDEV_PATCHES := 
@STM22_FALSE@@STM23_TRUE@MAKEDEV_PATCHES := 
@STM22_TRUE@MAKEDEV_PATCHES := 
# endif STM24
MAKEDEV_RPM := RPMS/sh4/$(STLINUX)-sh4-$(MAKEDEV)-$(MAKEDEV_VERSION).sh4.rpm

#
# BASE-FILES
#
BASE_FILES := base-files
# if STM24
@STM22_FALSE@@STM23_FALSE@BASE_FILES_VERSION := 2.0-8
@STM22_FALSE@@STM23_TRUE@BASE_FILES_VERSION := 2.0-7
@STM22_TRUE@BASE_FILES_VERSION := 2.0-4
@STM22_FALSE@@STM23_FALSE@BASE_FILES_SPEC := stm-target-$(BASE_FILES).spec
@STM22_FALSE@@STM23_TRUE@BASE_FILES_SPEC := stm-target-$(BASE_FILES).spec
@STM22_TRUE@BASE_FILES_SPEC := stm-target-$(BASE_FILES).spec
@STM22_FALSE@@STM23_FALSE@BASE_FILES_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@BASE_FILES_SPEC_PATCH := 
@STM22_TRUE@BASE_FILES_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@BASE_FILES_PATCHES := 
@STM22_FALSE@@STM23_TRUE@BASE_FILES_PATCHES := 
@STM22_TRUE@BASE_FILES_PATCHES := 
# endif STM24
BASE_FILES_RPM := RPMS/sh4/$(STLINUX)-sh4-$(BASE_FILES)-$(BASE_FILES_VERSION).sh4.rpm

#
# INITSCRIPTS/SYSVINIT
#
#$(DEPDIR)/sysvinit.do_prepare: @DEPENDS_sysvinit@
#	@PREPARE_sysvinit@
#	cd @DIR_sysvinit@ && \
#		gunzip -cd ../$(lastword $^) | cat > debian.patch && \
#		patch -p1 <debian.patch
#	touch $@
#
#$(DEPDIR)/sysvinit.do_compile: bootstrap $(DEPDIR)/sysvinit.do_prepare
#	cd @DIR_sysvinit@  && \
#		$(BUILDENV) \
#		./configure \
#			--build=$(build) \
#			--host=$(target) \
#			--target=$(target) \
#			--prefix= && \
#		$(MAKE)
#	touch $@
#
#$(DEPDIR)/min-sysvinit $(DEPDIR)/std-sysvinit $(DEPDIR)/max-sysvinit \
#$(DEPDIR)/sysvinit: \
#$(DEPDIR)/%sysvinit: $(DEPDIR)/sysvinit.do_compile
#	cd @DIR_sysvinit@  && \
#		@INSTALL_sysvinit@
#	@[ "x$*" = "x" ] && touch $@ || true
#	@TUXBOX_YAUD_CUSTOMIZE@
#
#if TARGETRULESET_FLASH
#
#flash-sysvinit: $(flashprefix)/root/usr/bin/hgrep
#
#$(flashprefix)/root/usr/bin/hgrep: bootstrap $(DEPDIR)/sysvinit.do_compile | $(flashprefix)/root
#	cd @DIR_sysvinit@  && \
#		$(INSTALL) src/grep $@
#	@FLASHROOTDIR_MODIFIED@
#	@TUXBOX_CUSTOMIZE@
#endif

######################################################################################################

#
# UDEV
#
UDEV := udev
# if STM24
@STM22_FALSE@@STM23_FALSE@UDEV_VERSION := 146-27
@STM22_FALSE@@STM23_TRUE@UDEV_VERSION := $(if $(STABLE),116-23,116-25)
@STM22_TRUE@UDEV_VERSION := 054-6
@STM22_FALSE@@STM23_FALSE@UDEV_SPEC := stm-target-$(UDEV).spec
@STM22_FALSE@@STM23_TRUE@UDEV_SPEC := stm-target-$(UDEV).spec
@STM22_TRUE@UDEV_SPEC := stm-target-$(UDEV).spec
@STM22_FALSE@@STM23_FALSE@UDEV_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@UDEV_SPEC_PATCH := 
@STM22_TRUE@UDEV_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@UDEV_PATCHES := 
@STM22_FALSE@@STM23_TRUE@UDEV_PATCHES := 
@STM22_TRUE@UDEV_PATCHES := 
# endif STM24
UDEV_RPM := RPMS/sh4/$(STLINUX)-sh4-$(UDEV)-$(UDEV_VERSION).sh4.rpm

#Wrote: /home/data/ufs/cvs/cdk/RPMS/sh4/stlinux20-sh4-udev-doc-054-5.sh4.rpm

#
# HOTPLUG
#
@STM22_TRUE@HOTPLUG := hotplug
@STM22_TRUE@HOTPLUG_VERSION := 2004_09_23-4
@STM22_TRUE@HOTPLUG_SPEC := stm-target-$(HOTPLUG).spec
@STM22_TRUE@HOTPLUG_SPEC_PATCH := 
@STM22_TRUE@HOTPLUG_PATCHES := 
@STM22_TRUE@HOTPLUG_RPM := RPMS/sh4/$(STLINUX)-sh4-$(HOTPLUG)-$(HOTPLUG_VERSION).sh4.rpm
COMMONPATCHES_41 = \
		linux-nosquashfs3.1_stm22.patch \
		linux-squashfs3.0_stm22.patch \
		linux-squashfs3.0_lzma_stm22.patch \
		linux-mini_fo_stm22.patch \
		linux-do-printk_stm22.patch \
		linux-ufs922_ktime_stm22.patch \
		linux-ufs922_hrtimer_stm22.patch \
		linux-ufs922_linuxdvb_stm22.patch \
		linux-ufs922_sound_stm22.patch \
		linux-ufs922_copo_stm22.patch \
		linux-ufs922_stm-dma_stm22.patch \
		linux-sched_stm22.patch \
		linux-timer_stm22.patch \
		linux-cmdline_printk_stm22.patch \
		linux-2.6.17.14-0041_make-3.82_fix.patch \
		linux-strcpy_stm22.patch

FORTISPATCHES_41 = $(COMMONPATCHES_41) \
		linux-fortis_hdbox_setup_stm22.patch \
		linux-fortis_hdbox_dvb_stm22.patch \
		linux-fortis_hdbox_sound_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch \
		linux-fortis_stboards_stm22.patch

ATEVIO7500_41 = $(COMMONPATCHES_41) \
		linux-atevio7500_setup_stm22.patch \
		linux-fortis_hdbox_dvb_stm22.patch \
		linux-fortis_hdbox_sound_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch \
		linux-atevio7500_stboards_stm22.patch

OCTAGON1008PATCHES_41 = $(COMMONPATCHES_41) \
		octagon1008_setup_p0041.diff \
		linux-fortis_hdbox_dvb_stm22.patch \
		linux-fortis_hdbox_sound_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch \
		linux-octagon1008_stboards_stm22.patch

UFS922PATCHES_41 = $(COMMONPATCHES_41) \
		linux-ufs922_stasc_stm22.patch \
		linux-ufs922_stmmac_stm22.patch \
		linux-ufs922_setup_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch \
		linux-ufs922_stboards_stm22.patch

TF7700PATCHES_41 = $(COMMONPATCHES_41) \
		linux-ufs922_stasc_stm22.patch \
		linux-tf7700_setup_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch

HL101PATCHES_41 = $(COMMONPATCHES_41) \
		linux-ufs922_stasc_stm22.patch \
		linux-hl101_setup_stm22.patch \
		linux-linuxdvb_api5_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch

VIP2PATCHES_41 = $(COMMONPATCHES_41) \
		linux-ufs922_stasc_stm22.patch \
		linux-vip2_setup_stm22.patch \
		linux-linuxdvb_api5_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch

UFS910PATCHES_41 = $(COMMONPATCHES_41) \
		linux-ufs910_smsc_stm22.patch \
		linux-ufs910_i2c_stm22.patch \
		linux-ufs910_setup_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch \
		linux-ufs910_stboards_stm22.patch

FLASHUFS910PATCHES_41 = $(COMMONPATCHES_41) \
		linux-ufs910_smsc_stm22.patch \
		linux-ufs910_i2c_stm22.patch \
		linux-ufs910_setup_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-ftdi_sio.c_stm22.patch \
		linux-ufs910_stboards_stm22.patch

IPBOX9900PATCHES_41 = $(COMMONPATCHES_41) \
		linux-ipbox_patches_stm22.patch \
		linux-ipbox_setup_stm22.patch \
		linux-linuxdvb_api5_stm22.patch \
		linux-ipbox_fdma_stm22.patch \
		linux-ipbox_i2c_stm22.patch \
		linux-ipbox_rtl8201_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch \
		linux-ipbox_lirc_stm22.patch

IPBOX99PATCHES_41 = $(COMMONPATCHES_41) \
		linux-ipbox_patches_stm22.patch \
		linux-ipbox_setup_stm22.patch \
		linux-linuxdvb_api5_stm22.patch \
		linux-ipbox_fdma_stm22.patch \
		linux-ipbox_i2c_stm22.patch \
		linux-ipbox_rtl8201_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch \
		linux-ipbox_lirc_stm22.patch

IPBOX55PATCHES_41 = $(COMMONPATCHES_41) \
		linux-ipbox_patches_stm22.patch \
		linux-ipbox_setup_stm22.patch \
		linux-linuxdvb_api5_stm22.patch \
		linux-ipbox_fdma_stm22.patch \
		linux-ipbox_i2c_stm22.patch \
		linux-ipbox_rtl8201_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch \
		linux-ipbox_lirc_stm22.patch


# IMPORTANT: it is expected that only one define is set
CUBEMOD = $(CUBEREVO)$(CUBEREVO_MINI)$(CUBEREVO_MINI2)$(CUBEREVO_MINI_FTA)$(CUBEREVO_250HD)$(CUBEREVO_2000HD)$(CUBEREVO_9500HD)
CUBEPATCHES_041 = $(COMMONPATCHES_41) \
		linux-cuberevo_patches_stm22.patch \
		linux-cuberevo_fdma_stm22.patch \
		linux-cuberevo_i2c_stm22.patch \
		linux-cuberevo_rtl8201_stm22.patch \
		linux-$(CUBEMOD)_setup_stm22.patch \
		linux-fat_stm22.patch \
		linux-fuse_stm22.patch \
		linux-net_stm22.patch \
		linux-tune_stm22.patch \
		linux-usbwait123_stm22.patch \
		linux-jffs2-lzma_stm22.patch \
		linux-ftdi_sio.c_stm22.patch

HS5101PATCHES_41 = $(COMMONPATCHES_41) \
		$(UFS910PATCHES_41) \
		linux-hs5101_setup_stm22.patch \
		linux-hs5101_stasc_stm22.patch

KERNELPATCHES_41 = \
		$(if $(TF7700),$(TF7700PATCHES_41)) \
		$(if $(HL101),$(HL101PATCHES_41)) \
		$(if $(VIP1_V2),$(VIP2PATCHES_41)) \
		$(if $(VIP2_V1),$(VIP2PATCHES_41)) \
		$(if $(UFS922),$(UFS922PATCHES_41)) \
		$(if $(CUBEMOD),$(CUBEPATCHES_041)) \
		$(if $(UFS910),$(UFS910PATCHES_41)) \
		$(if $(FLASH_UFS910),$(FLASHUFS910PATCHES_41)) \
		$(if $(FORTIS_HDBOX),$(FORTISPATCHES_41)) \
		$(if $(ATEVIO7500),$(ATEVIO7500_41)) \
		$(if $(OCTAGON1008),$(OCTAGON1008PATCHES_41)) \
		$(if $(HOMECAST5101),$(HS5101PATCHES_41)) \
		$(if $(IPBOX9900),$(IPBOX9900PATCHES_41)) \
		$(if $(IPBOX99),$(IPBOX99PATCHES_41)) \
		$(if $(IPBOX55),$(IPBOX55PATCHES_41)) \
		$(if $(PLAYER179),linux-v4l.patch)

@ENABLE_HAVANA_P0207_5_TRUE@PATCH_STR = _0207_5
@ENABLE_P0119_FALSE@@ENABLE_P0123_TRUE@PATCH_STR = _0123

############ Patches Kernel 23 ###############
@ENABLE_P0119_TRUE@PATCH_STR = _0119

############ Patches Kernel 23 End ###############

############ Patches Kernel 24 ###############
@ENABLE_P0201_TRUE@PATCH_STR = _0201
@ENABLE_P0205_TRUE@PATCH_STR = _0205
@ENABLE_P0206_TRUE@PATCH_STR = _0206
@ENABLE_P0207_TRUE@PATCH_STR = _0207
@ENABLE_P0209_TRUE@PATCH_STR = _0209
@ENABLE_ADB_BOX_FALSE@@ENABLE_HL101_FALSE@@ENABLE_IPBOX55_FALSE@@ENABLE_IPBOX9900_FALSE@@ENABLE_IPBOX99_FALSE@@ENABLE_VIP1_V2_FALSE@@ENABLE_VIP2_V1_FALSE@STM23_DVB_PATCH = linux-sh4-linuxdvb_stm23$(PATCH_STR).patch
@ENABLE_ADB_BOX_FALSE@@ENABLE_HL101_FALSE@@ENABLE_IPBOX55_TRUE@@ENABLE_IPBOX9900_FALSE@@ENABLE_IPBOX99_FALSE@@ENABLE_VIP1_V2_FALSE@@ENABLE_VIP2_V1_FALSE@STM23_DVB_PATCH = linux-sh4-linuxdvb_api5_stm23.patch
@ENABLE_ADB_BOX_FALSE@@ENABLE_HL101_FALSE@@ENABLE_IPBOX9900_FALSE@@ENABLE_IPBOX99_TRUE@@ENABLE_VIP1_V2_FALSE@@ENABLE_VIP2_V1_FALSE@STM23_DVB_PATCH = linux-sh4-linuxdvb_api5_stm23.patch
@ENABLE_ADB_BOX_FALSE@@ENABLE_HL101_FALSE@@ENABLE_IPBOX9900_TRUE@@ENABLE_VIP1_V2_FALSE@@ENABLE_VIP2_V1_FALSE@STM23_DVB_PATCH = linux-sh4-linuxdvb_api5_stm23.patch
@ENABLE_ADB_BOX_FALSE@@ENABLE_HL101_FALSE@@ENABLE_VIP1_V2_FALSE@@ENABLE_VIP2_V1_TRUE@STM23_DVB_PATCH = linux-sh4-linuxdvb_api5_stm23.patch
@ENABLE_ADB_BOX_FALSE@@ENABLE_HL101_FALSE@@ENABLE_VIP1_V2_TRUE@STM23_DVB_PATCH = linux-sh4-linuxdvb_api5_stm23.patch
@ENABLE_ADB_BOX_FALSE@@ENABLE_HL101_TRUE@STM23_DVB_PATCH = linux-sh4-linuxdvb_api5_stm23.patch
@ENABLE_ADB_BOX_TRUE@STM23_DVB_PATCH = linux-sh4-linuxdvb_api5_stm23.patch
COMMONPATCHES_23 = \
		linux-squashfs3.0_lzma_stm23.patch \
		linux-sh4-cpp_stm23.patch \
		linux-sh4-time_stm23.patch \
		linux-sh4-cmdline-printk_stm23.patch \
		linux-sh4-shksyms-gcc43_stm23.patch \
		$(if $(P0123),linux-sh4-mtd_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-strcpy_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-asm_mov_0xffffff_stm23$(PATCH_STR).patch) \
		linux-sh4-cifs-unaligned-mem-access-kernel_stm23.patch \
		linux-tune_stm23.patch \
		linux-ftdi_sio.c_stm23.patch \
		$(STM23_DVB_PATCH)

UFS912PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-ufs912_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-ufs912_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		fortis_hdbox_dvb_core_stm23.patch

SPARKPATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-spark_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-spark_sound_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-spark_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-spark_sound_stm23$(PATCH_STR).patch) \
		fortis_hdbox_dvb_core_stm23.patch

SPARK7162PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-spark7162_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-spark7162_sound_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-spark7162_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-spark7162_sound_stm23$(PATCH_STR).patch) \
		fortis_hdbox_dvb_core_stm23.patch

UFS922PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-ufs922_setup_stm23$(PATCH_STR).patch) \
	    	$(if $(P0123),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
	    	$(if $(P0123),linux-sh4-ufs922_setup_stm23$(PATCH_STR).patch)

FORTISPATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-fdma_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-sound_stm23$(PATCH_STR).patch) \
		$(if $(P0119),fortis_hdbox_setup_stm23.diff) \
		$(if $(P0119),fortis_hdbox_dvb_core_stm23.patch) \
		$(if $(P0123),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-fortis_hdbox_setup_stm23$(PATCH_STR).patch) \
		fortis_hdbox_dvb_core_stm23.patch

ATEVIO7500PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-atevio7500_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-atevio7500_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		fortis_hdbox_dvb_core_stm23.patch

OCTAGON1008PATCHES_23 = $(COMMONPATCHES_23) \
	        $(if $(P0123),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-octagon_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-octagon_setup_stm23$(PATCH_STR).patch) \
		fortis_hdbox_dvb_core_stm23.patch

HS7810APATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-hs7810a_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-hs7810a_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		fortis_hdbox_dvb_core_stm23.patch

HS7110PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-hs7110_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-hs7110_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		fortis_hdbox_dvb_core_stm23.patch

TF7700PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-fdma_stm23$(PATCH_STR).patch) \
		linux-sh4-sound_stm23$(PATCH_STR).patch \
		tf7700_setup_stm23$(PATCH_STR).patch

HL101PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-fdma_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-stmmac_stm23$(PATCH_STR)_hl101.patch) \
		linux-sh4-sound_stm23$(PATCH_STR).patch \
		linux-sh4-hl101_setup_stm23$(PATCH_STR).patch

VIP2PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-fdma_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-stmmac_stm23$(PATCH_STR)_vip2.patch) \
		linux-sh4-sound_stm23$(PATCH_STR).patch \
		linux-sh4-vip2_setup_stm23$(PATCH_STR).patch

ADB_BOXPATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-fdma_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-adb_box_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-adb_box_stb7100_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-adb_box_sata1_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-adb_box_sata2_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-adb_box_sata3_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-adb_box_pio_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-adb_box_soc_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-adb_box_net1_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-adb_box_net2_stm23$(PATCH_STR).patch) \
		$(if $(P0119),linux-sh4-adb_box_nand_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch)\
		linux-sh4-ufs910_pcmplayer_stm23.patch \
		$(if $(P0123),stx7100_fdma_fix_stm23_123.patch) \
		linux-sh4-ufs910_reboot_stm23.patch \
		$(if $(P0123),linux-sh4-adb_box_setup_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-adb_box_stb7100_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-adb_box_sata1_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-adb_box_sata2_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-adb_box_sata3_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-adb_box_net_stm23$(PATCH_STR).patch)

UFS910PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		$(if $(P0123),linux-sh4-ufs912_sound_stm23$(PATCH_STR).patch) \
		linux-sh4-ufs910_setup_stm23$(PATCH_STR).patch \
		linux-sh4-ufs910_pcmplayer_stm23.patch \
		$(if $(P0123),stx7100_fdma_fix_stm23_123.patch) \
		linux-sh4-ufs910_reboot_stm23.patch

FLASHUFS910PATCHES_23 = $(UFS910PATCHES_23)
IPBOX9900PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-fdma_stm23$(PATCH_STR).patch) \
		linux-sh4-sound_stm23$(PATCH_STR).patch \
		linux-sh4-ipbox_setup_stm23$(PATCH_STR).patch \
		linux-sh4-ipbox_rtl8201_stm23$(PATCH_STR).patch

IPBOX99PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-fdma_stm23$(PATCH_STR).patch) \
		linux-sh4-sound_stm23$(PATCH_STR).patch \
		linux-sh4-ipbox_setup_stm23$(PATCH_STR).patch \
		linux-sh4-ipbox_rtl8201_stm23$(PATCH_STR).patch

IPBOX55PATCHES_23 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-fdma_stm23$(PATCH_STR).patch) \
		linux-sh4-sound_stm23$(PATCH_STR).patch \
		linux-sh4-ipbox_setup_stm23$(PATCH_STR).patch \
		linux-sh4-ipbox_rtl8201_stm23$(PATCH_STR).patch

CUBEPATCHES_023 = $(COMMONPATCHES_23) \
		$(if $(P0119),linux-sh4-fdma_stm23$(PATCH_STR).patch) \
		linux-sh4-sound_stm23$(PATCH_STR).patch \
		linux-sh4-cuberevo_patches_stm23$(PATCH_STR).patch \
		linux-sh4-cuberevo_rtl8201_stm23$(PATCH_STR).patch \
		linux-sh4-$(CUBEMOD)_setup_stm23$(PATCH_STR).patch

HS5101PATCHES_23 = $(UFS910PATCHES_23)
KERNELPATCHES_23 = $(if $(TF7700),$(TF7700PATCHES_23)) \
		$(if $(HL101),$(HL101PATCHES_23)) \
		$(if $(VIP1_V2),$(VIP2PATCHES_23)) \
		$(if $(VIP2_V1),$(VIP2PATCHES_23)) \
		$(if $(UFS912),$(UFS912PATCHES_23)) \
		$(if $(SPARK),$(SPARKPATCHES_23)) \
		$(if $(SPARK7162),$(SPARK7162PATCHES_23)) \
		$(if $(UFS922),$(UFS922PATCHES_23)) \
		$(if $(CUBEMOD),$(CUBEPATCHES_023)) \
		$(if $(UFS910),$(UFS910PATCHES_23)) \
		$(if $(FLASH_UFS910),$(FLASHUFS910PATCHES_23)) \
		$(if $(FORTIS_HDBOX),$(FORTISPATCHES_23)) \
		$(if $(ATEVIO7500),$(ATEVIO7500PATCHES_23)) \
		$(if $(OCTAGON1008),$(OCTAGON1008PATCHES_23)) \
		$(if $(HS7810A),$(HS7810APATCHES_23)) \
		$(if $(HS7110),$(HS7110PATCHES_23)) \
		$(if $(HOMECAST5101),$(HS5101PATCHES_23)) \
		$(if $(ADB_BOX),$(ADB_BOXPATCHES_23)) \
		$(if $(IPBOX9900),$(IPBOX9900PATCHES_23)) \
		$(if $(IPBOX99),$(IPBOX99PATCHES_23)) \
                $(if $(IPBOX55),$(IPBOX55PATCHES_23))

@ENABLE_HAVANA_P0207_5_TRUE@GIT_STR = 207-5
STM24_DVB_PATCH = linux-sh4-linuxdvb_stm24$(PATCH_STR).patch
COMMONPATCHES_24 = \
		$(STM24_DVB_PATCH) \
		linux-sh4-sound_stm24$(PATCH_STR).patch \
		linux-sh4-time_stm24$(PATCH_STR).patch \
		linux-sh4-init_mm_stm24$(PATCH_STR).patch \
		linux-sh4-copro_stm24$(PATCH_STR).patch \
		$(if $(P0207),linux-sh4-strcpy_stm24$(PATCH_STR).patch) \
		$(if $(P0207),linux-squashfs-lzma_stm24$(PATCH_STR).patch) \
		$(if $(P0207),linux-sh4-ext23_as_ext4_stm24$(PATCH_STR).patch) \
		bpa2_procfs_stm24$(PATCH_STR).patch \
		$(if $(P0207),xchg_fix_stm24$(PATCH_STR).patch) \
		$(if $(P0207),mm_cache_update_stm24$(PATCH_STR).patch) \
		$(if $(P0207),linux-sh4-ehci_stm24$(PATCH_STR).patch) \
		$(if $(P0207),linux-ftdi_sio.c_stm24$(PATCH_STR).patch) \
		$(if $(P0207),linux-sh4-lzma-fix_stm24$(PATCH_STR).patch) \
		$(if $(P0207),linux-tune_stm24.patch)

TF7700PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-tf7700_setup_stm24$(PATCH_STR).patch \
		linux-usbwait123_stm24.patch \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch \
		linux-sh4-sata-v06_stm24$(PATCH_STR).patch

UFS910PATCHES_24 = $(COMMONPATCHES_24) \
		stx7100_fdma_fix_stm24$(PATCH_STR).patch \
		sata_32bit_fix_stm24$(PATCH_STR).patch \
		sata_stx7100_B4Team_fix_stm24_0207.patch \
		linux-sh4-ufs910_setup_stm24$(PATCH_STR).patch \
		linux-usbwait123_stm24.patch \
		linux-sh4-ufs910_reboot_stm24.patch \
		linux-sh4-smsc911x_dma_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch \
		linux-sh4-pcm_noise_fix_stm24$(PATCH_STR).patch \
		mini_fo_stm24$(PATCH_STR).patch

FLASHUFS910PATCHES_24 = $(UFS910PATCHES_24)
UFS912PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-ufs912_setup_stm24$(PATCH_STR).patch \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch \
		linux-sh4-lmb_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-stm-downgrade_stm24$(PATCH_STR).patch

OCTAGON1008PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-octagon1008_setup_stm24$(PATCH_STR).patch \
		linux-usbwait123_stm24.patch \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch

ATEVIO7500PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-lmb_stm24$(PATCH_STR).patch \
		linux-sh4-atevio7500_setup_stm24$(PATCH_STR).patch \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch

HS7810APATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-lmb_stm24$(PATCH_STR).patch \
		linux-sh4-hs7810a_setup_stm24$(PATCH_STR).patch \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-stm-downgrade_stm24$(PATCH_STR).patch

HS7110PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch \
		linux-sh4-lmb_stm24$(PATCH_STR).patch \
		linux-sh4-hs7110_setup_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-stm-downgrade_stm24$(PATCH_STR).patch

UFS922PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-ufs922_setup_stm24$(PATCH_STR).patch \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch \
		$(if $(P0207),linux-sh4-fortis_hdbox_i2c_st40_stm24$(PATCH_STR).patch)

HL101_PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-hl101_setup_stm24$(PATCH_STR).patch \
		linux-usbwait123_stm24.patch \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch \
		$(if $(P0207),linux-sh4-fortis_hdbox_i2c_st40_stm24$(PATCH_STR).patch)

VIP2_PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-vip2_setup_stm24$(PATCH_STR).patch \
		linux-usbwait123_stm24.patch \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch \
		$(if $(P0207),linux-sh4-fortis_hdbox_i2c_st40_stm24$(PATCH_STR).patch)

SPARK_PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch \
		linux-sh4-lmb_stm24$(PATCH_STR).patch \
		linux-sh4-spark_setup_stm24$(PATCH_STR).patch \
		$(if $(P0207),linux-sh4-i2c-stm-downgrade_stm24$(PATCH_STR).patch) \
		$(if $(P0209),linux-sh4-linux_yaffs2_stm24_0209.patch)

SPARK7162_PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch \
		linux-sh4-lmb_stm24$(PATCH_STR).patch \
		linux-sh4-spark7162_setup_stm24$(PATCH_STR).patch

FORTISPATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-fortis_hdbox_setup_stm24$(PATCH_STR).patch \
		linux-usbwait123_stm24.patch \
		linux-sh4-stmmac_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch \
		$(if $(P0207),linux-sh4-fortis_hdbox_i2c_st40_stm24$(PATCH_STR).patch)

ADB_BOXPATCHES_24 = $(COMMONPATCHES_24) \
		stx7100_fdma_fix_stm24$(PATCH_STR).patch \
		sata_32bit_fix_stm24$(PATCH_STR).patch \
		linux-sh4-adb_box_setup_stm24$(PATCH_STR).patch \
		linux-usbwait123_stm24.patch \
		linux-sh4-ufs910_reboot_stm24.patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch \
		linux-sh4-pcm_noise_fix_stm24$(PATCH_STR).patch \
		mini_fo_stm24$(PATCH_STR).patch

IPBOX9900PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-ipbox9900_setup_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch  \
		linux-sh4-ipbox_bdinfo_stm24$(PATCH_STR).patch \
                linux-sh4-ipbox_dvb_ca_stm24$(PATCH_STR).patch

IPBOX99PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-ipbox99_setup_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch \
		linux-sh4-ipbox_bdinfo_stm24$(PATCH_STR).patch

IPBOX55PATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-ipbox55_setup_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch \
		linux-sh4-ipbox_bdinfo_stm24$(PATCH_STR).patch

CUBEREVOPATCHES_24 = $(COMMONPATCHES_24) \
		linux-sh4-$(CUBEMOD)_setup_stm24$(PATCH_STR).patch \
		linux-sh4-i2c-st40-pio_stm24$(PATCH_STR).patch \
		linux-sh4-cuberevo_rtl8201_stm24$(PATCH_STR).patch

KERNELPATCHES_24 = \
		$(if $(UFS910),$(UFS910PATCHES_24)) \
		$(if $(FLASH_UFS910),$(FLASHUFS910PATCHES_24)) \
		$(if $(UFS912),$(UFS912PATCHES_24)) \
		$(if $(UFS922),$(UFS922PATCHES_24)) \
		$(if $(TF7700),$(TF7700PATCHES_24)) \
		$(if $(HL101),$(HL101_PATCHES_24)) \
		$(if $(VIP1_V2),$(VIP2_PATCHES_24)) \
		$(if $(VIP2_V1),$(VIP2_PATCHES_24)) \
		$(if $(SPARK),$(SPARK_PATCHES_24)) \
		$(if $(SPARK7162),$(SPARK7162_PATCHES_24)) \
		$(if $(FORTIS_HDBOX),$(FORTISPATCHES_24)) \
		$(if $(HS7810A),$(HS7810APATCHES_24)) \
		$(if $(HS7110),$(HS7110PATCHES_24)) \
		$(if $(ATEVIO7500),$(ATEVIO7500PATCHES_24)) \
		$(if $(OCTAGON1008),$(OCTAGON1008PATCHES_24)) \
		$(if $(ADB_BOX),$(ADB_BOXPATCHES_24)) \
		$(if $(IPBOX9900),$(IPBOX9900PATCHES_24)) \
		$(if $(IPBOX99),$(IPBOX99PATCHES_24)) \
		$(if $(IPBOX55),$(IPBOX55PATCHES_24)) \
		$(if $(CUBEMOD),$(CUBEREVOPATCHES_24))


############ Patches Kernel 24 End ###############

############ Patches Havana ###############
HAVANA_STM24_DVB_PATCH = linux-sh4-linuxdvb_havana_stm24$(PATCH_STR).patch
COMMONPATCHES_HAVANA_STM24 = \
		$(HAVANA_STM24_DVB_PATCH) \
		linux-sh4-init_mm_havana_stm24$(PATCH_STR).patch

ATEVIO7500PATCHES_HAVANA_STM24 = $(COMMONPATCHES_HAVANA_STM24) \
		linux-sh4-lmb_havana_stm24$(PATCH_STR).patch \
		linux-sh4-atevio7500_setup_havana_stm24$(PATCH_STR).patch \
		linux-sh4-stmmac_havana_stm24$(PATCH_STR).patch

UFS912PATCHES_HAVANA_STM24 = $(COMMONPATCHES_HAVANA_STM24) \
		linux-sh4-lmb_havana_stm24$(PATCH_STR).patch \
		linux-sh4-ufs912_setup_havana_stm24$(PATCH_STR).patch \
		linux-sh4-stmmac_havana_stm24$(PATCH_STR).patch

IPBOX9900PATCHES_HAVANA_STM24 = $(COMMONPATCHES_HAVANA_STM24) \
		linux-sh4-lmb_havana_stm24$(PATCH_STR).patch \
		linux-sh4-ipbox_setup_havana_stm24$(PATCH_STR).patch \
		linux-sh4-stmmac_havana_stm24$(PATCH_STR).patch

IPBOX99PATCHES_HAVANA_STM24 = $(COMMONPATCHES_HAVANA_STM24) \
		linux-sh4-lmb_havana_stm24$(PATCH_STR).patch \
		linux-sh4-ipbox_setup_havana_stm24$(PATCH_STR).patch \
		linux-sh4-stmmac_havana_stm24$(PATCH_STR).patch

IPBOX55PATCHES_HAVANA_STM24 = $(COMMONPATCHES_HAVANA_STM24) \
		linux-sh4-lmb_havana_stm24$(PATCH_STR).patch \
		linux-sh4-ipbox_setup_havana_stm24$(PATCH_STR).patch \
		linux-sh4-stmmac_havana_stm24$(PATCH_STR).patch

KERNELPATCHES_HAVANA_STM24 = \
		$(if $(ATEVIO7500),$(ATEVIO7500PATCHES_HAVANA_STM24)) \
		$(if $(UFS912),$(UFS912PATCHES_HAVANA_STM24)) \
		$(if $(IPBOX9900),$(IPBOX9900PATCHES_HAVANA_STM24)) \
		$(if $(IPBOX99),$(IPBOX99PATCHES_HAVANA_STM24))	\
		$(if $(IPBOX55),$(IPBOX55PATCHES_HAVANA_STM24))

@STM22_FALSE@KERNELHEADERS := linux-kernel-headers
@ENABLE_HAVANA_P0207_5_FALSE@@ENABLE_P0205_FALSE@@ENABLE_P0206_FALSE@@ENABLE_P0207_FALSE@@ENABLE_P0209_FALSE@@STM22_FALSE@@STM23_FALSE@KERNELHEADERS_VERSION := 2.6.32.10_stm24_0201-42
@ENABLE_HAVANA_P0207_5_TRUE@@ENABLE_P0205_FALSE@@ENABLE_P0206_FALSE@@ENABLE_P0207_FALSE@@ENABLE_P0209_FALSE@@STM22_FALSE@@STM23_FALSE@KERNELHEADERS_VERSION := 2.6.32.16-44
# STM23 && !ENABLE_P0119
@ENABLE_P0119_FALSE@@STM22_FALSE@@STM23_TRUE@KERNELHEADERS_VERSION := 2.6.23.17_stm23_0123-41
# STM23 && ENABLE_P0119
@ENABLE_P0119_TRUE@@STM22_FALSE@@STM23_TRUE@KERNELHEADERS_VERSION := 2.6.23.17_stm23_0119-41
@ENABLE_P0205_FALSE@@ENABLE_P0206_FALSE@@ENABLE_P0207_FALSE@@ENABLE_P0209_TRUE@@STM22_FALSE@@STM23_FALSE@KERNELHEADERS_VERSION := 2.6.32.16-44
@ENABLE_P0205_FALSE@@ENABLE_P0206_FALSE@@ENABLE_P0207_TRUE@@STM22_FALSE@@STM23_FALSE@KERNELHEADERS_VERSION := 2.6.32.16-44
@ENABLE_P0205_FALSE@@ENABLE_P0206_TRUE@@STM22_FALSE@@STM23_FALSE@KERNELHEADERS_VERSION := 2.6.32.16-44
# if STM24
@ENABLE_P0205_TRUE@@STM22_FALSE@@STM23_FALSE@KERNELHEADERS_VERSION := 2.6.32.16_stm24_0205-43
@ENABLE_P0119_FALSE@@STM22_FALSE@@STM23_TRUE@KERNELHEADERS_SPEC := stm-target-kernel-headers-kbuild.spec
@ENABLE_P0119_TRUE@@STM22_FALSE@@STM23_TRUE@KERNELHEADERS_SPEC := stm-target-kernel-headers-kbuild.spec
@STM22_FALSE@@STM23_FALSE@KERNELHEADERS_SPEC := stm-target-kernel-headers-kbuild.spec
@ENABLE_P0119_FALSE@@STM22_FALSE@@STM23_TRUE@KERNELHEADERS_SPEC_PATCH := stm-target-kernel-headers-kbuild_0123.spec.diff
@ENABLE_P0119_TRUE@@STM22_FALSE@@STM23_TRUE@KERNELHEADERS_SPEC_PATCH := stm-target-kernel-headers-kbuild.spec.diff
@STM22_FALSE@@STM23_FALSE@KERNELHEADERS_SPEC_PATCH := 
@ENABLE_P0119_FALSE@@STM22_FALSE@@STM23_TRUE@KERNELHEADERS_PATCHES := 
@ENABLE_P0119_TRUE@@STM22_FALSE@@STM23_TRUE@KERNELHEADERS_PATCHES := 
@STM22_FALSE@@STM23_FALSE@KERNELHEADERS_PATCHES := 
# endif STM24
@STM22_FALSE@KERNELHEADERS_RPM := RPMS/noarch/$(STLINUX)-sh4-$(KERNELHEADERS)-$(KERNELHEADERS_VERSION).noarch.rpm

#
# HOST-KERNEL
#

# IMPORTANT: it is expected that only one define is set
MODNAME = $(UFS910)$(UFS912)$(SPARK)$(SPARK7162)$(UFS922)$(TF7700)$(HL101)$(VIP1_V2)$(VIP2_V1)$(CUBEMOD)$(FORTIS_HDBOX)$(ATEVIO7500)$(OCTAGON1008)$(HS7810A)$(HS7110)$(FLASH_UFS910)$(HOMECAST5101)$(IPBOX9900)$(IPBOX99)$(IPBOX55)$(ADB_BOX)
@DEBUG_FALSE@DEBUG_STR = 
@DEBUG_TRUE@DEBUG_STR = .debug
HOST_KERNEL := host-kernel
@ENABLE_HAVANA_P0207_5_TRUE@@ENABLE_P0201_FALSE@@ENABLE_P0205_FALSE@@ENABLE_P0206_FALSE@@ENABLE_P0207_FALSE@@ENABLE_P0209_FALSE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_VERSION := 2.6.32.28$(KERNELSTMLABEL)-$(KERNELLABEL)
@ENABLE_P0201_FALSE@@ENABLE_P0205_FALSE@@ENABLE_P0206_FALSE@@ENABLE_P0207_FALSE@@ENABLE_P0209_TRUE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_VERSION := 2.6.32.46$(KERNELSTMLABEL)-$(KERNELLABEL)
@ENABLE_P0201_FALSE@@ENABLE_P0205_FALSE@@ENABLE_P0206_FALSE@@ENABLE_P0207_TRUE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_VERSION := 2.6.32.28$(KERNELSTMLABEL)-$(KERNELLABEL)
@ENABLE_P0201_FALSE@@ENABLE_P0205_FALSE@@ENABLE_P0206_TRUE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_VERSION := 2.6.32.28$(KERNELSTMLABEL)-$(KERNELLABEL)
@ENABLE_P0201_FALSE@@ENABLE_P0205_TRUE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_VERSION := 2.6.32.16$(KERNELSTMLABEL)-$(KERNELLABEL)
# if STM24
@ENABLE_P0201_TRUE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_VERSION := 2.6.32.10$(KERNELSTMLABEL)-$(KERNELLABEL)
@STM22_FALSE@@STM23_TRUE@HOST_KERNEL_VERSION := 2.6.23.17$(KERNELSTMLABEL)-$(KERNELLABEL)
@STM22_TRUE@HOST_KERNEL_VERSION := 2.6.17.14_stm22_0041-41
@ENABLE_HAVANA_P0207_5_FALSE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_SPEC := stm-$(HOST_KERNEL)-sh4.spec
@STM22_FALSE@@STM23_TRUE@HOST_KERNEL_SPEC := stm-$(HOST_KERNEL)-sh4.spec
@STM22_TRUE@HOST_KERNEL_SPEC := stm-$(HOST_KERNEL).spec
@ENABLE_HAVANA_P0207_5_FALSE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@HOST_KERNEL_SPEC_PATCH := 
@STM22_TRUE@HOST_KERNEL_SPEC_PATCH := 
@ENABLE_HAVANA_P0207_5_FALSE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_PATCHES := $(KERNELPATCHES_24)
@STM22_FALSE@@STM23_TRUE@HOST_KERNEL_PATCHES := $(KERNELPATCHES_23)
@STM22_TRUE@HOST_KERNEL_PATCHES := $(KERNELPATCHES_41)
@ENABLE_HAVANA_P0207_5_FALSE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_CONFIG := linux-sh4-$(subst _stm24_,-,$(KERNELVERSION))_$(MODNAME).config$(DEBUG_STR)
@STM22_FALSE@@STM23_TRUE@HOST_KERNEL_CONFIG := linux-sh4-$(subst _stm23_,-,$(KERNELVERSION))_$(MODNAME).config$(DEBUG_STR)
@STM22_TRUE@HOST_KERNEL_CONFIG := linux-$(subst _stm22_,-,$(KERNELVERSION))_$(MODNAME).config$(DEBUG_STR)
@ENABLE_HAVANA_P0207_5_FALSE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_SRC_RPM := $(STLINUX)-$(HOST_KERNEL)-source-sh4-$(HOST_KERNEL_VERSION).src.rpm
@STM22_FALSE@@STM23_TRUE@HOST_KERNEL_SRC_RPM := $(STLINUX)-$(HOST_KERNEL)-source-sh4-$(HOST_KERNEL_VERSION).src.rpm
@STM22_TRUE@HOST_KERNEL_SRC_RPM := $(STLINUX)-$(HOST_KERNEL)-source-$(HOST_KERNEL_VERSION).src.rpm
@ENABLE_HAVANA_P0207_5_FALSE@@STM22_FALSE@@STM23_FALSE@HOST_KERNEL_RPM := RPMS/noarch/$(STLINUX)-$(HOST_KERNEL)-source-sh4-$(HOST_KERNEL_VERSION).noarch.rpm
@STM22_FALSE@@STM23_TRUE@HOST_KERNEL_RPM := RPMS/noarch/$(STLINUX)-$(HOST_KERNEL)-source-sh4-$(HOST_KERNEL_VERSION).noarch.rpm
@STM22_TRUE@HOST_KERNEL_RPM := RPMS/noarch/$(STLINUX)-$(HOST_KERNEL)-source-$(HOST_KERNEL_VERSION).noarch.rpm

# endif STM24
@ENABLE_HAVANA_P0207_5_TRUE@HAVANA_STM24_KERNEL_PATCHES := $(KERNELPATCHES_HAVANA_STM24)
@ENABLE_HAVANA_P0207_5_TRUE@HAVANA_STM24_KERNEL_CONFIG := linux-sh4-$(subst _stm24_,-,$(KERNELVERSION))_havana_$(MODNAME).config$(DEBUG_STR)
NFS_FLASH_SED_CONF = $(foreach param,XCONFIG_NFS_FS XCONFIG_LOCKD XCONFIG_SUNRPC,-e s"/^.*$(param)[= ].*/$(param)=m/")
@ENABLE_XFS_FALSE@XFS_SED_CONF = -e ""
@ENABLE_XFS_TRUE@XFS_SED_CONF = $(foreach param,CONFIG_XFS_FS,-e s"/^.*$(param)[= ].*/$(param)=m/")
@ENABLE_NFSSERVER_FALSE@NFSSERVER_SED_CONF = -e ""

#NFSSERVER_SED_CONF=$(foreach param,CONFIG_NFSD CONFIG_NFSD_V3 CONFIG_NFSD_TCP,-e s"/^.*$(param)[= ].*/$(param)=y/")
@ENABLE_NFSSERVER_TRUE@NFSSERVER_SED_CONF = $(foreach param,CONFIG_NFSD,-e s"/^.*$(param)[= ].*/$(param)=y\nCONFIG_NFSD_V3=y\n\# CONFIG_NFSD_V3_ACL is not set\n\# CONFIG_NFSD_V4 is not set\nCONFIG_NFSD_TCP=y/")
@ENABLE_NTFS_FALSE@NTFS_SED_CONF = -e ""
@ENABLE_NTFS_TRUE@NTFS_SED_CONF = $(foreach param,CONFIG_NTFS_FS,-e s"/^.*$(param)[= ].*/$(param)=m/")

#
# LIBZ
#
@STM22_FALSE@LIBZ_ORDER = binutils-dev

#
# SYSVINIT/INITSCRIPTS
#
SYSVINIT := sysvinit
INITSCRIPTS := initscripts
# if STM24
@STM22_FALSE@@STM23_FALSE@SYSVINIT_VERSION := 2.86-10
@STM22_FALSE@@STM23_TRUE@SYSVINIT_VERSION := 2.86-9
@STM22_TRUE@SYSVINIT_VERSION := 2.86-6
@STM22_FALSE@@STM23_FALSE@SYSVINIT_SPEC := stm-target-$(SYSVINIT).spec
@STM22_FALSE@@STM23_TRUE@SYSVINIT_SPEC := stm-target-$(SYSVINIT).spec
@STM22_TRUE@SYSVINIT_SPEC := stm-target-$(SYSVINIT).spec
@STM22_FALSE@@STM23_FALSE@SYSVINIT_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@SYSVINIT_SPEC_PATCH := 
@STM22_TRUE@SYSVINIT_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@SYSVINIT_PATCHES := 
@STM22_FALSE@@STM23_TRUE@SYSVINIT_PATCHES := 
@STM22_TRUE@SYSVINIT_PATCHES := 
# endif STM24
SYSVINIT_RPM := RPMS/sh4/$(STLINUX)-sh4-$(SYSVINIT)-$(SYSVINIT_VERSION).sh4.rpm
INITSCRIPTS_RPM := RPMS/sh4/$(STLINUX)-sh4-$(INITSCRIPTS)-$(SYSVINIT_VERSION).sh4.rpm

#
# NETBASE
#
#ftp://ftp.stlinux.com/pub/stlinux/2.3/SRPMS/stlinux23-target-netbase-4.07-5.src.rpm
NETBASE := netbase
# if STM24
@STM22_FALSE@@STM23_FALSE@NETBASE_VERSION := 4.34-8
@STM22_FALSE@@STM23_TRUE@NETBASE_VERSION := 4.34-7
@STM22_TRUE@NETBASE_VERSION := 4.07-4
@STM22_FALSE@@STM23_FALSE@NETBASE_SPEC := stm-target-$(NETBASE).spec
@STM22_FALSE@@STM23_TRUE@NETBASE_SPEC := stm-target-$(NETBASE).spec
@STM22_TRUE@NETBASE_SPEC := stm-target-$(NETBASE).spec
@STM22_FALSE@@STM23_FALSE@NETBASE_SPEC_PATCHES := 
@STM22_FALSE@@STM23_TRUE@NETBASE_SPEC_PATCHES := 
@STM22_TRUE@NETBASE_SPEC_PATCHES := 
@STM22_FALSE@@STM23_FALSE@NETBASE_PATCHES := 
@STM22_FALSE@@STM23_TRUE@NETBASE_PATCHES := 
@STM22_TRUE@NETBASE_PATCHES := 
# endif STM24
NETBASE_RPM := RPMS/sh4/$(STLINUX)-sh4-$(NETBASE)-$(NETBASE_VERSION).sh4.rpm

#
# BC
#
#ftp://ftp.stlinux.com/pub/stlinux/2.3/SRPMS/stlinux23-target-bc-1.06-4.src.rpm
BC := bc
# if STM24
@STM22_FALSE@@STM23_FALSE@BC_VERSION := 1.06-5
@STM22_FALSE@@STM23_TRUE@BC_VERSION := 1.06-4
@STM22_TRUE@BC_VERSION := 1.06-3
@STM22_FALSE@@STM23_FALSE@BC_SPEC := stm-target-$(BC).spec
@STM22_FALSE@@STM23_TRUE@BC_SPEC := stm-target-$(BC).spec
@STM22_TRUE@BC_SPEC := stm-target-$(BC).spec
@STM22_FALSE@@STM23_FALSE@BC_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@BC_SPEC_PATCH := 
@STM22_TRUE@BC_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@BC_PATCHES := 
@STM22_FALSE@@STM23_TRUE@BC_PATCHES := 
@STM22_TRUE@BC_PATCHES := 
# endif STM24
BC_RPM := RPMS/sh4/$(STLINUX)-sh4-$(BC)-$(BC_VERSION).sh4.rpm

#
# FINDUTILS
#
FINDUTILS := findutils
# if STM24
@STM22_FALSE@@STM23_FALSE@FINDUTILS_VERSION := 4.1.20-13
@STM22_FALSE@@STM23_TRUE@FINDUTILS_VERSION := 4.1.7-4
@STM22_TRUE@FINDUTILS_VERSION := 4.1.7-4
@STM22_FALSE@@STM23_FALSE@FINDUTILS_SPEC := stm-target-$(FINDUTILS).spec
@STM22_FALSE@@STM23_TRUE@FINDUTILS_SPEC := stm-target-$(FINDUTILS).spec
@STM22_TRUE@FINDUTILS_SPEC := stm-target-$(FINDUTILS).spec
@STM22_FALSE@@STM23_FALSE@FINDUTILS_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@FINDUTILS_SPEC_PATCH := 
@STM22_TRUE@FINDUTILS_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@FINDUTILS_PATCHES := 
@STM22_FALSE@@STM23_TRUE@FINDUTILS_PATCHES := 
@STM22_TRUE@FINDUTILS_PATCHES := 
# endif STM24
FINDUTILS_RPM := RPMS/sh4/$(STLINUX)-sh4-$(FINDUTILS)-$(FINDUTILS_VERSION).sh4.rpm

#
# DISTRIBUTIONUTILS
#
DISTRIBUTIONUTILS := distributionutils
DISTRIBUTIONUTILS_DOC := distributionutils-doc
# if STM24
@STM22_FALSE@@STM23_FALSE@DISTRIBUTIONUTILS_VERSION := 3.2.1-9
@STM22_FALSE@@STM23_TRUE@DISTRIBUTIONUTILS_VERSION := 2.17-7
@STM22_TRUE@DISTRIBUTIONUTILS_VERSION := 2.17-6
@STM22_FALSE@@STM23_FALSE@DISTRIBUTIONUTILS_SPEC := stm-target-$(DISTRIBUTIONUTILS).spec
@STM22_FALSE@@STM23_TRUE@DISTRIBUTIONUTILS_SPEC := stm-target-$(DISTRIBUTIONUTILS).spec
@STM22_TRUE@DISTRIBUTIONUTILS_SPEC := stm-target-$(DISTRIBUTIONUTILS).spec
@STM22_FALSE@@STM23_FALSE@DISTRIBUTIONUTILS_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@DISTRIBUTIONUTILS_SPEC_PATCH := $(DISTRIBUTIONUTILS_SPEC)23.diff
@STM22_TRUE@DISTRIBUTIONUTILS_SPEC_PATCH := $(DISTRIBUTIONUTILS_SPEC)22.diff
@STM22_FALSE@@STM23_FALSE@DISTRIBUTIONUTILS_PATCHES := 
@STM22_FALSE@@STM23_TRUE@DISTRIBUTIONUTILS_PATCHES := 
@STM22_TRUE@DISTRIBUTIONUTILS_PATCHES := 
# endif STM24
DISTRIBUTIONUTILS_RPM := RPMS/sh4/$(STLINUX)-sh4-$(DISTRIBUTIONUTILS)-$(DISTRIBUTIONUTILS_VERSION).sh4.rpm
DISTRIBUTIONUTILS_DOC_RPM := RPMS/sh4/$(STLINUX)-sh4-$(DISTRIBUTIONUTILS_DOC)-$(DISTRIBUTIONUTILS_VERSION).sh4.rpm

#
# HOST-MTD-UTILS
#
MTD_UTILS := mtd-utils
# if STM24
@STM22_FALSE@@STM23_FALSE@MTD_UTILS_VERSION := TODO
@STM22_FALSE@@STM23_TRUE@MTD_UTILS_VERSION := 1.0.1-9
@STM22_TRUE@MTD_UTILS_VERSION := 1.0.1-9
@STM22_FALSE@@STM23_FALSE@MTD_UTILS_SPEC := stm-target-$(MTD_UTILS).spec
@STM22_FALSE@@STM23_TRUE@MTD_UTILS_SPEC := stm-target-$(MTD_UTILS).spec
@STM22_TRUE@MTD_UTILS_SPEC := stm-target-$(MTD_UTILS).spec
@STM22_FALSE@@STM23_FALSE@MTD_UTILS_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@MTD_UTILS_SPEC_PATCH := 
@STM22_TRUE@MTD_UTILS_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@MTD_UTILS_PATCHES := 
@STM22_FALSE@@STM23_TRUE@MTD_UTILS_PATCHES := 
@STM22_TRUE@MTD_UTILS_PATCHES := 
# endif STM24
MTD_UTILS_RPM := RPMS/sh4/$(STLINUX)-sh4-$(MTD_UTILS)-$(MTD_UTILS_VERSION).sh4.rpm

##################################################################################################

#
# BASH
#
BASH := bash
# if STM24
@STM22_FALSE@@STM23_FALSE@BASH_VERSION := 3.0-16
@STM22_FALSE@@STM23_TRUE@BASH_VERSION := 3.0-6
@STM22_TRUE@BASH_VERSION := 3.0-6
@STM22_FALSE@@STM23_FALSE@BASH_SPEC := stm-target-$(BASH).spec
@STM22_FALSE@@STM23_TRUE@BASH_SPEC := stm-target-$(BASH).spec
@STM22_TRUE@BASH_SPEC := stm-target-$(BASH).spec
@STM22_FALSE@@STM23_FALSE@BASH_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@BASH_SPEC_PATCH := $(BASH_SPEC).diff
@STM22_TRUE@BASH_SPEC_PATCH := $(BASH_SPEC).diff
@STM22_FALSE@@STM23_FALSE@BASH_PATCHES := 
@STM22_FALSE@@STM23_TRUE@BASH_PATCHES := 
@STM22_TRUE@BASH_PATCHES := 
# endif STM24
BASH_RPM := RPMS/sh4/$(STLINUX)-sh4-$(BASH)-$(BASH_VERSION).sh4.rpm

#
# COREUTILS
#
COREUTILS := coreutils
# if STM24
@STM22_FALSE@@STM23_FALSE@COREUTILS_VERSION := 5.2.1-14
@STM22_FALSE@@STM23_TRUE@COREUTILS_VERSION := 5.2.1-9
@STM22_TRUE@COREUTILS_VERSION := 5.2.1-9
@STM22_FALSE@@STM23_FALSE@COREUTILS_SPEC := stm-target-$(COREUTILS).spec 
@STM22_FALSE@@STM23_TRUE@COREUTILS_SPEC := stm-target-$(COREUTILS).spec 
@STM22_TRUE@COREUTILS_SPEC := stm-target-$(COREUTILS).spec 
@STM22_FALSE@@STM23_FALSE@COREUTILS_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@COREUTILS_SPEC_PATCH := $(COREUTILS_SPEC).diff
@STM22_TRUE@COREUTILS_SPEC_PATCH := $(COREUTILS_SPEC).diff
@STM22_FALSE@@STM23_FALSE@COREUTILS_PATCHES := 
@STM22_FALSE@@STM23_TRUE@COREUTILS_PATCHES := 
@STM22_TRUE@COREUTILS_PATCHES := 
# endif STM24
COREUTILS_RPM := RPMS/sh4/$(STLINUX)-sh4-$(COREUTILS)-$(COREUTILS_VERSION).sh4.rpm

#
# NET-TOOLS
#
NET_TOOLS := net-tools
# if STM24
@STM22_FALSE@@STM23_FALSE@NET_TOOLS_VERSION := 1.60-9
@STM22_FALSE@@STM23_TRUE@NET_TOOLS_VERSION := 1.60-4
@STM22_TRUE@NET_TOOLS_VERSION := 1.60-4
@STM22_FALSE@@STM23_FALSE@NET_TOOLS_SPEC := stm-target-$(NET_TOOLS).spec
@STM22_FALSE@@STM23_TRUE@NET_TOOLS_SPEC := stm-target-$(NET_TOOLS).spec
@STM22_TRUE@NET_TOOLS_SPEC := stm-target-$(NET_TOOLS).spec
@STM22_FALSE@@STM23_FALSE@NET_TOOLS_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@NET_TOOLS_SPEC_PATCH := 
@STM22_TRUE@NET_TOOLS_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@NET_TOOLS_PATCHES := 
@STM22_FALSE@@STM23_TRUE@NET_TOOLS_PATCHES := 
@STM22_TRUE@NET_TOOLS_PATCHES := 
# endif STM24
NET_TOOLS_RPM = RPMS/sh4/$(STLINUX)-sh4-$(NET_TOOLS)-$(NET_TOOLS_VERSION).sh4.rpm

#
# SED
#
SEDX := sed
# if STM24
@STM22_FALSE@@STM23_FALSE@SED_VERSION := 4.1.5-13
@STM22_FALSE@@STM23_TRUE@SED_VERSION := 4.0.7-6
@STM22_TRUE@SED_VERSION := 4.0.7-6
@STM22_FALSE@@STM23_FALSE@SED_SPEC := stm-target-$(SEDX).spec
@STM22_FALSE@@STM23_TRUE@SED_SPEC := stm-target-$(SEDX).spec
@STM22_TRUE@SED_SPEC := stm-target-$(SEDX).spec
@STM22_FALSE@@STM23_FALSE@SED_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@SED_SPEC_PATCH := 
@STM22_TRUE@SED_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@SED_PATCHES := 
@STM22_FALSE@@STM23_TRUE@SED_PATCHES := 
@STM22_TRUE@SED_PATCHES := 
# endif STM24
SED_RPM = RPMS/sh4/$(STLINUX)-sh4-$(SEDX)-$(SED_VERSION).sh4.rpm

#
# DIFF
#
DIFF := diff
DIFF_DOC := diff-doc
# if STM24
@STM22_FALSE@@STM23_FALSE@DIFF_VERSION := 2.8.1-10
@STM22_FALSE@@STM23_TRUE@DIFF_VERSION := 2.7-3
@STM22_TRUE@DIFF_VERSION := 2.7-3
@STM22_FALSE@@STM23_FALSE@DIFF_SPEC := stm-target-$(DIFF).spec
@STM22_FALSE@@STM23_TRUE@DIFF_SPEC := stm-target-$(DIFF).spec
@STM22_TRUE@DIFF_SPEC := stm-target-$(DIFF).spec
@STM22_FALSE@@STM23_FALSE@DIFF_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@DIFF_SPEC_PATCH := 
@STM22_TRUE@DIFF_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@DIFF_PATCHES := 
@STM22_FALSE@@STM23_TRUE@DIFF_PATCHES := 
@STM22_TRUE@DIFF_PATCHES := 
# endif STM24
DIFF_RPM := RPMS/sh4/$(STLINUX)-sh4-$(DIFF)-$(DIFF_VERSION).sh4.rpm
DIFF_DOC_RPM := RPMS/sh4/$(STLINUX)-sh4-$(DIFF)-doc-$(SED_VERSION).sh4.rpm

#
# FILE
#
FILE := file
# if STM24
@STM22_FALSE@@STM23_FALSE@FILE_VERSION := 4.17-7
@STM22_FALSE@@STM23_TRUE@FILE_VERSION := 4.17-3
@STM22_TRUE@FILE_VERSION := 4.17-3
@STM22_FALSE@@STM23_FALSE@FILE_SPEC := stm-target-$(FILE).spec
@STM22_FALSE@@STM23_TRUE@FILE_SPEC := stm-target-$(FILE).spec
@STM22_TRUE@FILE_SPEC := stm-target-$(FILE).spec
@STM22_FALSE@@STM23_FALSE@FILE_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@FILE_SPEC_PATCH := $(FILE_SPEC).diff
@STM22_TRUE@FILE_SPEC_PATCH := $(FILE_SPEC).diff
@STM22_FALSE@@STM23_FALSE@FILE_PATCHES := 
@STM22_FALSE@@STM23_TRUE@FILE_PATCHES := 
@STM22_TRUE@FILE_PATCHES := 
# endif STM24
FILE_RPM := RPMS/sh4/stlinux20-sh4-file-4.17-3.sh4.rpm

#
# TAR
#
TAR := tar
# if STM24
@STM22_FALSE@@STM23_FALSE@TAR_VERSION := 1.18-11
@STM22_FALSE@@STM23_TRUE@TAR_VERSION := 1.16.1-7
@STM22_TRUE@TAR_VERSION := 1.16.1-7
@STM22_FALSE@@STM23_FALSE@TAR_SPEC := stm-target-$(TAR).spec
@STM22_FALSE@@STM23_TRUE@TAR_SPEC := stm-target-$(TAR).spec
@STM22_TRUE@TAR_SPEC := stm-target-$(TAR).spec
@STM22_FALSE@@STM23_FALSE@TAR_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@TAR_SPEC_PATCH := $(TAR_SPEC).diff
@STM22_TRUE@TAR_SPEC_PATCH := $(TAR_SPEC).diff
@STM22_FALSE@@STM23_FALSE@TAR_PATCHES := 
@STM22_FALSE@@STM23_TRUE@TAR_PATCHES := 
@STM22_TRUE@TAR_PATCHES := 
# endif STM24
TAR_RPM := RPMS/sh4/$(STLINUX)-sh4-$(TAR)-$(TAR_VERSION).sh4.rpm

#
# STRACE
#
STRACE := strace
# if STM24
@STM22_FALSE@@STM23_FALSE@STRACE_VERSION := 4.5.16-21
@STM22_FALSE@@STM23_TRUE@STRACE_VERSION := 4.5.14-10
@STM22_TRUE@STRACE_VERSION := 4.5.14-10
@STM22_FALSE@@STM23_FALSE@STRACE_SPEC := stm-target-$(STRACE).spec
@STM22_FALSE@@STM23_TRUE@STRACE_SPEC := stm-target-$(STRACE).spec
@STM22_TRUE@STRACE_SPEC := stm-target-$(STRACE).spec
@STM22_FALSE@@STM23_FALSE@STRACE_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@STRACE_SPEC_PATCH := 
@STM22_TRUE@STRACE_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@STRACE_PATCHES := 
@STM22_FALSE@@STM23_TRUE@STRACE_PATCHES := 
@STM22_TRUE@STRACE_PATCHES := 
# endif STM24
STRACE_RPM := RPMS/sh4/$(STLINUX)-sh4-$(STRACE)-$(STRACE_VERSION).sh4.rpm

#
# UTIL LINUX
# 
@STM24_TRUE@UTIL_LINUX = util-linux
@STM24_TRUE@UTIL_LINUX_VERSION = 2.16.1-22
@STM24_TRUE@UTIL_LINUX_SPEC = stm-target-$(UTIL_LINUX).spec
@STM24_TRUE@UTIL_LINUX_SPEC_PATCH = 
@STM24_TRUE@UTIL_LINUX_PATCHES = 
@STM24_TRUE@UTIL_LINUX_RPM := RPMS/sh4/$(STLINUX)-sh4-$(UTIL_LINUX)-$(UTIL_LINUX_VERSION).sh4.rpm

#
# ZD1211
#
CONFIG_ZD1211B := 
vsftpd_ADAPTED_FILES = /etc/default/vsftpd /etc/init.d/vsftpd /etc/vsftpd.conf
vsftpd_INITD_FILES = vsftpd
VSFTPD_ADAPTED_ETC_FILES = default/vsftpd init.d/vsftpd vsftpd.conf
samba_ADAPTED_FILES = /etc/samba/smb.conf /etc/init.d/samba
samba_INITD_FILES = samba

#
# STGFB
#
DEPMOD = /sbin/depmod
STGFB_DIR := stgfb-2.0_stm22_0006
HOST_STGFB := host-stgfb-source
HOST_STGFB_VERSION := 2.0_stm22_0006-22

#ftp://ftp.stlinux.com/pub/stlinux/2.2/SRPMS/stlinux22-target-console-data-1999.08.29-4.src.rpm
#ftp://ftp.stlinux.com/pub/stlinux/2.2/SRPMS/stlinux22-target-console-tools-0.2.3-6.src.rpm
#
# CONSOLE-DATA
#
CONSOLE_DATAA := console-data
CONSOLE_DATA_VERSION := 1999.08.29-4

#
# CONSOLE-TOOLS
#
CONSOLE_TOOLS := console-tools
CONSOLE_TOOLS_VERSION := 0.2.3-6

########################################

#
# ICE
#
ICE := ICE
ICE_VERSION := 6.8.1-2

#
# SM
#
SM := SM
SM_VERSION := 6.8.1-2

#
# XPROTO
#
XPROTO := Xproto
XPROTO_VERSION := 6.8.1-2

#
# XEXTENSIONS
#
XEXTENSIONS := XExtensions
XEXTENSIONS_VERSION := 6.8.1-2

#
# XT
#
XT := Xt
XT_VERSION := 6.8.1-2

#
# XTRANS
#
XTRANS := xtrans
XTRANS_VERSION := 6.8.1-2

#
# XAU
#
XAU := Xau
XAU_VERSION := 6.8.1-2

#
# X11
#
X11 := X11
X11_VERSION := 6.8.1-4

########################################

#
# LIRC-APPS
#
LIRC_APPS := lirc-apps
LIRC_APPS_VERSION := 0.7.2pre1-7
#
# DIRECTFB
#
#stlinux22-target-directfb-1.0.0-18.src.rpm
#ftp://ftp.stlinux.com/pub/stlinux/2.2/updates/SRPMS/stlinux22-target-directfb-1.0.0-19.src.rpm
DIRECTFB := directfbx
DIRECTFB_DEV := directfb-dev
DIRECTFB_VERSION := 1.0.0-19

#
# DIRECTFB-EXAMPLES
#
DIRECTFB_EXAMPLES := directfb-examples
DIRECTFB_EXAMPLES_VERSION := 0.9.22_stcvs20050810-7
LIRCD_CONF := lircd_spark.conf

#
# SPLASHUTILS
#
SPLASHUTILS := splashutils
# if STM24
@STM22_FALSE@@STM23_FALSE@SPLASHUTILS_VERSION := 1.5.4.3-7
@STM22_FALSE@@STM23_TRUE@SPLASHUTILS_VERSION := 1.5.3.2-4
@STM22_TRUE@SPLASHUTILS_VERSION := 1.5.3.2-4
@STM22_FALSE@@STM23_FALSE@SPLASHUTILS_SPEC := stm-target-$(SPLASHUTILS).spec
@STM22_FALSE@@STM23_TRUE@SPLASHUTILS_SPEC := stm-target-$(SPLASHUTILS).spec
@STM22_TRUE@SPLASHUTILS_SPEC := stm-target-$(SPLASHUTILS).spec
@STM22_FALSE@@STM23_FALSE@SPLASHUTILS_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@SPLASHUTILS_SPEC_PATCH := $(SPLASHUTILS_SPEC).diff
@STM22_TRUE@SPLASHUTILS_SPEC_PATCH := $(SPLASHUTILS_SPEC).diff
@STM22_FALSE@@STM23_FALSE@SPLASHUTILS_PATCHES := 
@STM22_FALSE@@STM23_TRUE@SPLASHUTILS_PATCHES := 
@STM22_TRUE@SPLASHUTILS_PATCHES := 
# endif STM24
SPLASHUTILS_RPM := RPMS/sh4/$(STLINUX)-sh4-$(SPLASHUTILS)-$(SPLASHUTILS_VERSION).sh4.rpm

#
# BINUTILS
#
BINUTILS := binutils
BINUTILS_DEV := binutils-dev
# if STM24
@STM22_FALSE@@STM23_FALSE@BINUTILS_VERSION := 2.19.1-41
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@BINUTILS_VERSION := 2.19.1-41
@STM22_TRUE@BINUTILS_VERSION := 2.17.50.0.4-14
@STM22_FALSE@@STM23_FALSE@BINUTILS_SPEC := stm-target-$(BINUTILS).spec
@STM22_FALSE@@STM23_TRUE@BINUTILS_SPEC := stm-target-$(BINUTILS).spec
@STM22_TRUE@BINUTILS_SPEC := stm-target-$(BINUTILS)-sh4processed.spec
@STM22_FALSE@@STM23_FALSE@BINUTILS_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@BINUTILS_SPEC_PATCH := 
@STM22_TRUE@BINUTILS_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@BINUTILS_PATCHES := 
@STM22_FALSE@@STM23_TRUE@BINUTILS_PATCHES := 
@STM22_TRUE@BINUTILS_PATCHES := 
# endif STM24
BINUTILS_RPM := RPMS/sh4/$(STLINUX)-sh4-$(BINUTILS)-$(BINUTILS_VERSION).sh4.rpm
BINUTILS_DEV_RPM := RPMS/sh4/$(STLINUX)-sh4-$(BINUTILS_DEV)-$(BINUTILS_VERSION).sh4.rpm

#
# STSLAVE
#
STSLAVE := stslave
# if STM24
@STM22_FALSE@@STM23_FALSE@STSLAVE_VERSION := 0.7-18
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@STSLAVE_VERSION := 0.7-18
@STM22_TRUE@STSLAVE_VERSION := 0.6-8
@STM22_FALSE@@STM23_FALSE@STSLAVE_SPEC := stm-target-$(STSLAVE).spec
@STM22_FALSE@@STM23_TRUE@STSLAVE_SPEC := stm-target-$(STSLAVE).spec
@STM22_TRUE@STSLAVE_SPEC := stm-target-$(STSLAVE).spec
@STM22_FALSE@@STM23_FALSE@STSLAVE_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@STSLAVE_SPEC_PATCH := 
@STM22_TRUE@STSLAVE_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@STSLAVE_PATCHES := 
@STM22_FALSE@@STM23_TRUE@STSLAVE_PATCHES := 
@STM22_TRUE@STSLAVE_PATCHES := 
# endif STM24
STSLAVE_RPM := RPMS/sh4/$(STLINUX)-sh4-$(STSLAVE)-$(STSLAVE_VERSION).sh4.rpm

#
# OPENSSL
#
OPENSSL := openssl
OPENSSL_DEV := openssl-dev
# if STM24
@STM22_FALSE@@STM23_FALSE@OPENSSL_VERSION := 0.9.8l-16
@STM22_FALSE@@STM23_TRUE@OPENSSL_VERSION := 0.9.8h-11
@STM22_TRUE@OPENSSL_VERSION := 0.9.8-6
@STM22_FALSE@@STM23_FALSE@OPENSSL_SPEC := stm-target-$(OPENSSL).spec
@STM22_FALSE@@STM23_TRUE@OPENSSL_SPEC := stm-target-$(OPENSSL).spec
@STM22_TRUE@OPENSSL_SPEC := stm-target-$(OPENSSL).spec
@STM22_FALSE@@STM23_FALSE@OPENSSL_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@OPENSSL_SPEC_PATCH := 
@STM22_TRUE@OPENSSL_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@OPENSSL_PATCHES := 
@STM22_FALSE@@STM23_TRUE@OPENSSL_PATCHES := 
@STM22_TRUE@OPENSSL_PATCHES := 
# endif STM24
OPENSSL_RPM := RPMS/sh4/$(STLINUX)-sh4-$(OPENSSL)-$(OPENSSL_VERSION).sh4.rpm
OPENSSL_DEV_RPM := RPMS/sh4/$(STLINUX)-sh4-$(OPENSSL_DEV)-$(OPENSSL_VERSION).sh4.rpm

#
# ALSALIB
#
ALSALIB := alsa-lib
ALSALIB_DEV := alsa-lib-dev
# if STM24
@STM22_FALSE@@STM23_FALSE@ALSALIB_VERSION := 1.0.21a-23
@STM22_FALSE@@STM23_TRUE@ALSALIB_VERSION := $(if $(STABLE),1.0.16-16,1.0.21a-22)
@STM22_TRUE@ALSALIB_VERSION := 1.0.12-9
@STM22_FALSE@@STM23_FALSE@ALSALIB_SPEC := stm-target-$(ALSALIB).spec
@STM22_FALSE@@STM23_TRUE@ALSALIB_SPEC := stm-target-$(ALSALIB).spec
@STM22_TRUE@ALSALIB_SPEC := stm-target-$(ALSALIB)-sh4processed.spec
@STM22_FALSE@@STM23_FALSE@ALSALIB_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@ALSALIB_SPEC_PATCH := $(ALSALIB_SPEC)23.diff
@STM22_TRUE@ALSALIB_SPEC_PATCH := stm-target-$(ALSALIB).spec22.diff
@STM22_FALSE@@STM23_FALSE@ALSALIB_PATCHES := 
@STM22_FALSE@@STM23_TRUE@ALSALIB_PATCHES := 
@STM22_TRUE@ALSALIB_PATCHES := 
# endif STM24
ALSALIB_RPM := RPMS/sh4/$(STLINUX)-sh4-$(ALSALIB)-$(ALSALIB_VERSION).sh4.rpm
ALSALIB_DEV_RPM := RPMS/sh4/$(STLINUX)-sh4-$(ALSALIB_DEV)-$(ALSALIB_VERSION).sh4.rpm

#
# ALSAUTILS
#
ALSAUTILS := alsa-utils
# if STM24
@STM22_FALSE@@STM23_FALSE@ALSAUTILS_VERSION := 1.0.16-16
@STM22_FALSE@@STM23_TRUE@ALSAUTILS_VERSION := $(if $(STABLE),1.0.16-14,1.0.21-17)
@STM22_TRUE@ALSAUTILS_VERSION := 1.0.12-7
@STM22_FALSE@@STM23_FALSE@ALSAUTILS_SPEC := stm-target-$(ALSAUTILS).spec
@STM22_FALSE@@STM23_TRUE@ALSAUTILS_SPEC := stm-target-$(ALSAUTILS).spec
@STM22_TRUE@ALSAUTILS_SPEC := stm-target-$(ALSAUTILS).spec
@STM22_FALSE@@STM23_FALSE@ALSAUTILS_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@ALSAUTILS_SPEC_PATCH := $(if $(STABLE),,$(ALSAUTILS_SPEC)23.diff)
@STM22_TRUE@ALSAUTILS_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@ALSAUTILS_PATCHES := 
@STM22_FALSE@@STM23_TRUE@ALSAUTILS_PATCHES := 
@STM22_TRUE@ALSAUTILS_PATCHES := 
# endif STM24
ALSAUTILS_RPM := RPMS/sh4/$(STLINUX)-sh4-$(ALSAUTILS)-$(ALSAUTILS_VERSION).sh4.rpm

#
# ALSAPLAYER
#
ALSAPLAYER := alsaplayer
ALSAPLAYER_DEV := alsaplayer-dev
# if STM24
@STM22_FALSE@@STM23_FALSE@ALSAPLAYER_VERSION := 0.99.77-15
# Due to libtool errors of target-gcc, the stm24 version is used instead of stm23
@STM22_FALSE@@STM23_TRUE@ALSAPLAYER_VERSION := 0.99.77-16
@STM22_TRUE@ALSAPLAYER_VERSION := 0.99.76-5
@STM22_FALSE@@STM23_FALSE@ALSAPLAYER_SPEC := stm-target-$(ALSAPLAYER).spec
@STM22_FALSE@@STM23_TRUE@ALSAPLAYER_SPEC := stm-target-$(ALSAPLAYER).spec
@STM22_TRUE@ALSAPLAYER_SPEC := stm-target-$(ALSAPLAYER).spec
@STM22_FALSE@@STM23_FALSE@ALSAPLAYER_SPEC_PATCH := 
@STM22_FALSE@@STM23_TRUE@ALSAPLAYER_SPEC_PATCH := 
@STM22_TRUE@ALSAPLAYER_SPEC_PATCH := 
@STM22_FALSE@@STM23_FALSE@ALSAPLAYER_PATCHES := 
@STM22_FALSE@@STM23_TRUE@ALSAPLAYER_PATCHES := 
@STM22_TRUE@ALSAPLAYER_PATCHES := 
# endif STM24
ALSAPLAYER_RPM := RPMS/sh4/$(STLINUX)-sh4-$(ALSAPLAYER)-$(ALSAPLAYER_VERSION).sh4.rpm
ALSAPLAYER_DEV_RPM := RPMS/sh4/$(STLINUX)-sh4-$(ALSAPLAYER_DEV)-$(ALSAPLAYER_VERSION).sh4.rpm
EXTRA_DIST = \
	rules.pl rules-archive.pl rules-downcheck.pl.in \
	rules-archive \
	rules-install rules-install-flash \
	rules-make$(if $(STABLE),,.latest)

@STM22_FALSE@kernelpath = "linux-sh4"
@STM22_TRUE@kernelpath = "linux-sh4"

#
#
#
release_dir = "release_neutrino_nightly"

#Trick ALPHA-Version ;)
USERS = $(shell which sudo)
EVOLUXVERSION = $(shell cat $(prefix)/release_with_dev/etc/changelog.txt | grep -m1 Version | cut -d = -f2)
all: all-am

.SUFFIXES:
am--refresh:
	@:
$(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/make/buildenv.mk $(srcdir)/make/archive-specs.mk $(srcdir)/make/hostapps.mk $(srcdir)/make/ipkg.mk $(srcdir)/make/bootstrap.mk $(srcdir)/make/u-boot.mk $(srcdir)/make/root-etc.mk $(srcdir)/make/bare-os.mk $(srcdir)/make/linux-kernel.mk $(srcdir)/make/busybox.mk $(srcdir)/make/contrib-libs.mk $(srcdir)/make/contrib-apps-specs.mk $(srcdir)/make/contrib-apps.mk $(srcdir)/make/net-apps.mk $(srcdir)/make/diverse-tools.mk $(srcdir)/make/misc_libs.mk $(srcdir)/make/misc_tools.mk $(srcdir)/make/plugins.mk $(srcdir)/make/stock.mk $(srcdir)/make/enigma2.mk $(srcdir)/make/enigma2-nightly.mk $(srcdir)/make/neutrino.mk $(srcdir)/make/libtuxbox.mk $(srcdir)/make/yaud.mk $(srcdir)/make/record.mk $(srcdir)/make/prog.mk $(srcdir)/make/development.mk $(srcdir)/make/stg-framebuffer-specs.mk $(srcdir)/make/misc-specs.mk $(srcdir)/make/reduce-libs.mk $(srcdir)/make/cleantargets.mk $(srcdir)/make/phony.mk $(srcdir)/make/tags.mk $(srcdir)/make/disttargets.mk $(srcdir)/make/release.mk $(srcdir)/make/release_neutrino.mk $(srcdir)/make/release_neutrino_nightly.mk $(srcdir)/make/release_evolux.mk $(srcdir)/make/release_neutrino_static.mk $(am__configure_deps)
	@for dep in $?; do \
	  case '$(am__configure_deps)' in \
	    *$$dep*) \
	      echo ' cd $(srcdir) && $(AUTOMAKE) --gnu'; \
	      $(am__cd) $(srcdir) && $(AUTOMAKE) --gnu \
		&& exit 0; \
	      exit 1;; \
	  esac; \
	done; \
	echo ' cd $(top_srcdir) && $(AUTOMAKE) --gnu Makefile'; \
	$(am__cd) $(top_srcdir) && \
	  $(AUTOMAKE) --gnu Makefile
.PRECIOUS: Makefile
Makefile: $(srcdir)/Makefile.in $(top_builddir)/config.status
	@case '$?' in \
	  *config.status*) \
	    echo ' $(SHELL) ./config.status'; \
	    $(SHELL) ./config.status;; \
	  *) \
	    echo ' cd $(top_builddir) && $(SHELL) ./config.status $@ $(am__depfiles_maybe)'; \
	    cd $(top_builddir) && $(SHELL) ./config.status $@ $(am__depfiles_maybe);; \
	esac;

$(top_builddir)/config.status: $(top_srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
	$(SHELL) ./config.status --recheck

$(top_srcdir)/configure: @MAINTAINER_MODE_TRUE@ $(am__configure_deps)
	$(am__cd) $(srcdir) && $(AUTOCONF)
$(ACLOCAL_M4): @MAINTAINER_MODE_TRUE@ $(am__aclocal_m4_deps)
	$(am__cd) $(srcdir) && $(ACLOCAL) $(ACLOCAL_AMFLAGS)
$(am__aclocal_m4_deps):
rules-downcheck.pl: $(top_builddir)/config.status $(srcdir)/rules-downcheck.pl.in
	cd $(top_builddir) && $(SHELL) ./config.status $@
tags: TAGS
TAGS:

ctags: CTAGS
CTAGS:


distdir: $(DISTFILES)
	$(am__remove_distdir)
	test -d "$(distdir)" || mkdir "$(distdir)"
	@srcdirstrip=`echo "$(srcdir)" | sed 's/[].[^$$\\*]/\\\\&/g'`; \
	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's/[].[^$$\\*]/\\\\&/g'`; \
	list='$(DISTFILES)'; \
	  dist_files=`for file in $$list; do echo $$file; done | \
	  sed -e "s|^$$srcdirstrip/||;t" \
	      -e "s|^$$topsrcdirstrip/|$(top_builddir)/|;t"`; \
	case $$dist_files in \
	  */*) $(MKDIR_P) `echo "$$dist_files" | \
			   sed '/\//!d;s|^|$(distdir)/|;s,/[^/]*$$,,' | \
			   sort -u` ;; \
	esac; \
	for file in $$dist_files; do \
	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
	  if test -d $$d/$$file; then \
	    dir=`echo "/$$file" | sed -e 's,/[^/]*$$,,'`; \
	    if test -d "$(distdir)/$$file"; then \
	      find "$(distdir)/$$file" -type d ! -perm -700 -exec chmod u+rwx {} \;; \
	    fi; \
	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
	      cp -fpR $(srcdir)/$$file "$(distdir)$$dir" || exit 1; \
	      find "$(distdir)/$$file" -type d ! -perm -700 -exec chmod u+rwx {} \;; \
	    fi; \
	    cp -fpR $$d/$$file "$(distdir)$$dir" || exit 1; \
	  else \
	    test -f "$(distdir)/$$file" \
	    || cp -p $$d/$$file "$(distdir)/$$file" \
	    || exit 1; \
	  fi; \
	done
	-test -n "$(am__skip_mode_fix)" \
	|| find "$(distdir)" -type d ! -perm -755 \
		-exec chmod u+rwx,go+rx {} \; -o \
	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
	  ! -type d ! -perm -444 -exec $(install_sh) -c -m a+r {} {} \; \
	|| chmod -R a+r "$(distdir)"
dist-gzip: distdir
	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
	$(am__remove_distdir)

dist-bzip2: distdir
	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
	$(am__remove_distdir)

dist-lzma: distdir
	tardir=$(distdir) && $(am__tar) | lzma -9 -c >$(distdir).tar.lzma
	$(am__remove_distdir)

dist-xz: distdir
	tardir=$(distdir) && $(am__tar) | xz -c >$(distdir).tar.xz
	$(am__remove_distdir)

dist-tarZ: distdir
	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
	$(am__remove_distdir)

dist-shar: distdir
	shar $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).shar.gz
	$(am__remove_distdir)

dist-zip: distdir
	-rm -f $(distdir).zip
	zip -rq $(distdir).zip $(distdir)
	$(am__remove_distdir)

dist dist-all: distdir
	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
	$(am__remove_distdir)

# This target untars the dist file and tries a VPATH configuration.  Then
# it guarantees that the distribution is self-contained by making another
# tarfile.
distcheck: dist
	case '$(DIST_ARCHIVES)' in \
	*.tar.gz*) \
	  GZIP=$(GZIP_ENV) gzip -dc $(distdir).tar.gz | $(am__untar) ;;\
	*.tar.bz2*) \
	  bzip2 -dc $(distdir).tar.bz2 | $(am__untar) ;;\
	*.tar.lzma*) \
	  lzma -dc $(distdir).tar.lzma | $(am__untar) ;;\
	*.tar.xz*) \
	  xz -dc $(distdir).tar.xz | $(am__untar) ;;\
	*.tar.Z*) \
	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
	*.shar.gz*) \
	  GZIP=$(GZIP_ENV) gzip -dc $(distdir).shar.gz | unshar ;;\
	*.zip*) \
	  unzip $(distdir).zip ;;\
	esac
	chmod -R a-w $(distdir); chmod a+w $(distdir)
	mkdir $(distdir)/_build
	mkdir $(distdir)/_inst
	chmod a-w $(distdir)
	test -d $(distdir)/_build || exit 0; \
	dc_install_base=`$(am__cd) $(distdir)/_inst && pwd | sed -e 's,^[^:\\/]:[\\/],/,'` \
	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
	  && am__cwd=`pwd` \
	  && $(am__cd) $(distdir)/_build \
	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
	    $(DISTCHECK_CONFIGURE_FLAGS) \
	  && $(MAKE) $(AM_MAKEFLAGS) \
	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
	  && $(MAKE) $(AM_MAKEFLAGS) check \
	  && $(MAKE) $(AM_MAKEFLAGS) install \
	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
	        distuninstallcheck \
	  && chmod -R a-w "$$dc_install_base" \
	  && ({ \
	       (cd ../.. && umask 077 && mkdir "$$dc_destdir") \
	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
	  && rm -rf "$$dc_destdir" \
	  && $(MAKE) $(AM_MAKEFLAGS) dist \
	  && rm -rf $(DIST_ARCHIVES) \
	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck \
	  && cd "$$am__cwd" \
	  || exit 1
	$(am__remove_distdir)
	@(echo "$(distdir) archives ready for distribution: "; \
	  list='$(DIST_ARCHIVES)'; for i in $$list; do echo $$i; done) | \
	  sed -e 1h -e 1s/./=/g -e 1p -e 1x -e '$$p' -e '$$x'
distuninstallcheck:
	@$(am__cd) '$(distuninstallcheck_dir)' \
	&& test `$(distuninstallcheck_listfiles) | wc -l` -le 1 \
	   || { echo "ERROR: files left after uninstall:" ; \
	        if test -n "$(DESTDIR)"; then \
	          echo "  (check DESTDIR support)"; \
	        fi ; \
	        $(distuninstallcheck_listfiles) ; \
	        exit 1; } >&2
distcleancheck: distclean
	@if test '$(srcdir)' = . ; then \
	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
	  exit 1 ; \
	fi
	@test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
	  || { echo "ERROR: files left in build directory after distclean:" ; \
	       $(distcleancheck_listfiles) ; \
	       exit 1; } >&2
check-am: all-am
check: check-am
all-am: Makefile
installdirs:
install: install-am
install-exec: install-exec-am
install-data: install-data-am
uninstall: uninstall-am

install-am: all-am
	@$(MAKE) $(AM_MAKEFLAGS) install-exec-am install-data-am

installcheck: installcheck-am
install-strip:
	$(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM="$(INSTALL_STRIP_PROGRAM)" \
	  install_sh_PROGRAM="$(INSTALL_STRIP_PROGRAM)" INSTALL_STRIP_FLAG=-s \
	  `test -z '$(STRIP)' || \
	    echo "INSTALL_PROGRAM_ENV=STRIPPROG='$(STRIP)'"` install
mostlyclean-generic:

clean-generic:

distclean-generic:
	-test -z "$(CONFIG_CLEAN_FILES)" || rm -f $(CONFIG_CLEAN_FILES)
	-test . = "$(srcdir)" || test -z "$(CONFIG_CLEAN_VPATH_FILES)" || rm -f $(CONFIG_CLEAN_VPATH_FILES)

maintainer-clean-generic:
	@echo "This command is intended for maintainers to use"
	@echo "it deletes files that may require special tools to rebuild."
clean: clean-am

clean-am: clean-generic clean-local mostlyclean-am

distclean: distclean-am
	-rm -f $(am__CONFIG_DISTCLEAN_FILES)
	-rm -f Makefile
distclean-am: clean-am distclean-generic distclean-local

dvi: dvi-am

dvi-am:

html: html-am

html-am:

info: info-am

info-am:

install-data-am:

install-dvi: install-dvi-am

install-dvi-am:

install-exec-am:

install-html: install-html-am

install-html-am:

install-info: install-info-am

install-info-am:

install-man:

install-pdf: install-pdf-am

install-pdf-am:

install-ps: install-ps-am

install-ps-am:

installcheck-am:

maintainer-clean: maintainer-clean-am
	-rm -f $(am__CONFIG_DISTCLEAN_FILES)
	-rm -rf $(top_srcdir)/autom4te.cache
	-rm -f Makefile
maintainer-clean-am: distclean-am maintainer-clean-generic

mostlyclean: mostlyclean-am

mostlyclean-am: mostlyclean-generic mostlyclean-local

pdf: pdf-am

pdf-am:

ps: ps-am

ps-am:

uninstall-am:

.MAKE: install-am install-strip

.PHONY: all all-am am--refresh check check-am clean clean-generic \
	clean-local dist dist-all dist-bzip2 dist-gzip dist-lzma \
	dist-shar dist-tarZ dist-xz dist-zip distcheck distclean \
	distclean-generic distclean-local distcleancheck distdir \
	distuninstallcheck dvi dvi-am html html-am info info-am \
	install install-am install-data install-data-am install-dvi \
	install-dvi-am install-exec install-exec-am install-html \
	install-html-am install-info install-info-am install-man \
	install-pdf install-pdf-am install-ps install-ps-am \
	install-strip installcheck installcheck-am installdirs \
	maintainer-clean maintainer-clean-generic mostlyclean \
	mostlyclean-generic mostlyclean-local pdf pdf-am ps ps-am \
	uninstall uninstall-am

export CFLAGS
export CXXFLAGS

export DRPM
export DRPMBUILD
export STABLE

min-query std-query max-query query: \
%query:
	rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) -qa

query-%:
	@for i in sh4 noarch ${host_arch} ; do \
		FOUND=`ls RPMS/$$i | grep $*` || true && \
		( for j in $$FOUND ; do \
			echo "RPMS/$$i/$$j:" && \
			rpm $(DRPM) -qplv --scripts RPMS/$$i/$$j || true; echo;done ) || true ; done

Archive/bash-3.1-16.1.i386.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URLDIV1)/$(notdir $@)) || true
Archive/stlinux20-sh4-%.sh4.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URL)/$(notdir $@) || $(WGET) $(URLU)/$(notdir $@)) || true
Archive/stlinux22-sh4-%.sh4.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URL2)/$(notdir $@) || $(WGET) $(URL2U)/$(notdir $@)) || true
Archive/stlinux23-sh4-%.sh4.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URL3)/$(notdir $@) || $(WGET) $(URL3U)/$(notdir $@)) || true
Archive/stlinux24-sh4-%.sh4.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URL4)/$(notdir $@) || $(WGET) $(URL4U)/$(notdir $@)) || true

Archive/stlinux20-host-%.src.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URLSH)/$(notdir $@) || $(WGET) $(URLSHU)/$(notdir $@)) || true
Archive/stlinux22-host-%.src.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URL2SH)/$(notdir $@) || $(WGET) $(URL2SHU)/$(notdir $@)) || true
Archive/stlinux23-host-%.src.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URL3S)/$(notdir $@) || $(WGET) $(URL3SU)/$(notdir $@)) || true
Archive/stlinux24-host-%.src.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URL4S)/$(notdir $@) || $(WGET) $(URL4SU)/$(notdir $@)) || true
Archive/stlinux20-cross-%.src.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URLSH)/$(notdir $@) || $(WGET) $(URLSHU)/$(notdir $@)) || true
Archive/stlinux22-cross-%.src.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URL2SH)/$(notdir $@) || $(WGET) $(URL2SHU)/$(notdir $@)) || true
Archive/stlinux23-cross-%.src.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URL3S)/$(notdir $@) || $(WGET) $(URL3SU)/$(notdir $@)) || true
Archive/stlinux24-cross-%.src.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URL4S)/$(notdir $@) || $(WGET) $(URL4SU)/$(notdir $@)) || true
Archive/stlinux20-target-%.src.rpm:
	[ ! -f Archive/$(notdir $@) ] && \
	(cd Archive && $(WGET) $(URLS)/$(notdir $@) || $(WGET) $(URLSU)/$(notdir $@)) || true
Archive/stlinux22-target-%.src.rpm:
	[ ! -f Archive/$@ ] && \
	(cd Archive && $(WGET) $(URL2S)/$(notdir $@) || $(WGET) $(URL2SU)/$(notdir $@)) || true
Archive/stlinux23-target-%.src.rpm:
	[ ! -f Archive/$@ ] && \
	(cd Archive && $(WGET) $(URL3S)/$(notdir $@) || $(WGET) $(URL3SU)/$(notdir $@)) || true
Archive/stlinux24-target-%.src.rpm:
	[ ! -f Archive/$@ ] && \
	(cd Archive && $(WGET) $(URL4S)/$(notdir $@) || $(WGET) $(URL4SU)/$(notdir $@)) || true

$(hostappsdir)/config.status: bootstrap
	cd $(hostappsdir) && \
	./autogen.sh && \
	./configure --prefix=$(hostprefix)

hostapps: $(hostappsdir)/config.status
	$(MAKE) -C $(hostappsdir)
#	touch $@

@ENABLE_CCACHE_TRUE@$(hostprefix)/bin/ccache: @DEPENDS_ccache@
@ENABLE_CCACHE_TRUE@	@PREPARE_ccache@
@ENABLE_CCACHE_TRUE@	cd @DIR_ccache@ && \
@ENABLE_CCACHE_TRUE@		./configure \
@ENABLE_CCACHE_TRUE@ 			--build=$(build) \
@ENABLE_CCACHE_TRUE@			--host=$(build) \
@ENABLE_CCACHE_TRUE@			--prefix= && \
@ENABLE_CCACHE_TRUE@			$(MAKE) all && \
@ENABLE_CCACHE_TRUE@			@INSTALL_ccache@
#	@CLEANUP_ccache@

#
# MKCRAMFS
#
@TARGETRULESET_FLASH_TRUE@mkcramfs: @MKCRAMFS@

@TARGETRULESET_FLASH_TRUE@$(hostprefix)/bin/mkcramfs: @DEPENDS_cramfs@
@TARGETRULESET_FLASH_TRUE@	@PREPARE_cramfs@
@TARGETRULESET_FLASH_TRUE@	cd @DIR_cramfs@ && \
@TARGETRULESET_FLASH_TRUE@		$(MAKE) mkcramfs && \
@TARGETRULESET_FLASH_TRUE@		@INSTALL_cramfs@

@TARGETRULESET_FLASH_TRUE@mksquashfs: $(MKSQUASHFS)

@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@$(hostprefix)/bin/mksquashfs: @DEPENDS_squashfs@
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	rm -rf @DIR_squashfs@
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	mkdir -p @DIR_squashfs@
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	cd @DIR_squashfs@ && \
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	bunzip2 -cd ../Archive/lzma442.tar.bz2 | TAPE=- tar -x && \
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	patch -p1 < ../Patches/lzma_zlib-stream.diff && \
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	gunzip -cd ../Archive/squashfs3.0.tar.gz | TAPE=- tar -x && \
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	cd squashfs3.0 && patch -p1 < ../../Patches/mksquashfs_lzma.diff
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	$(MAKE) -C @DIR_squashfs@/C/7zip/Compress/LZMA_Lib
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	$(MAKE) -C @DIR_squashfs@/squashfs3.0/squashfs-tools
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -d $(@D)
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -m755 @DIR_squashfs@/squashfs3.0/squashfs-tools/mksquashfs $@
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -m755 @DIR_squashfs@/squashfs3.0/squashfs-tools/unsquashfs $(@D)
#	rm -rf @DIR_squashfs@
@STM22_FALSE@@TARGETRULESET_FLASH_TRUE@$(hostprefix)/bin/mksquashfs: @DEPENDS_squashfs@
@STM22_FALSE@@TARGETRULESET_FLASH_TRUE@	rm -rf @DIR_squashfs@
@STM22_FALSE@@TARGETRULESET_FLASH_TRUE@	mkdir -p @DIR_squashfs@
@STM22_FALSE@@TARGETRULESET_FLASH_TRUE@	cd @DIR_squashfs@ && \
@STM22_FALSE@@TARGETRULESET_FLASH_TRUE@	bunzip2 -cd ../Archive/lzma465.tar.bz2 | TAPE=- tar -x && \
@STM22_FALSE@@TARGETRULESET_FLASH_TRUE@	gunzip -cd ../Archive/squashfs4.0.tar.gz | TAPE=- tar -x && \
@STM22_FALSE@@TARGETRULESET_FLASH_TRUE@	cd squashfs4.0/squashfs-tools && patch -p1 < ../../../Patches/squashfs-tools-4.0-lzma.patch
@STM22_FALSE@@TARGETRULESET_FLASH_TRUE@	$(MAKE) -C @DIR_squashfs@/squashfs4.0/squashfs-tools
@STM22_FALSE@@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -d $(@D)
@STM22_FALSE@@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -m755 @DIR_squashfs@/squashfs4.0/squashfs-tools/mksquashfs $@
@STM22_FALSE@@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -m755 @DIR_squashfs@/squashfs4.0/squashfs-tools/unsquashfs $(@D)

ipkg-utils: $(IPKG_BUILD_BIN)

$(crossprefix)/bin/ipkg-build: @DEPENDS_ipkg_utils@ | $(ipkprefix)
	@PREPARE_ipkg_utils@
	cd @DIR_ipkg_utils@ && \
		$(MAKE) all PREFIX=$(crossprefix) && \
		$(MAKE) install PREFIX=$(crossprefix)

ipkg-host: $(IPKG_BIN)

$(crossprefix)/bin/ipkg: @DEPENDS_ipkg_host@
	@PREPARE_ipkg_host@
	cd @DIR_ipkg_host@/ipkg-@VERSION_ipkg_host@ && \
		./configure \
			--prefix=$(crossprefix) && \
		$(MAKE) && \
		$(MAKE) install && \
	$(LN_SF) ipkg-cl $@
	echo "dest root $(flashprefix)/root" >$(IPKG_CONF)
	( echo "lists_dir ext $(flashprefix)/root/usr/lib/ipkg"; \
	  echo "arch sh4 10"; \
	  echo "arch all 1"; \
	  echo "src/gz cross file://$(ipkprefix)" ) >>$(IPKG_CONF)

#	$(INSTALL_DIR) $(crossprefix)/etc/ipkg
#	echo "src/gz cross file://$(ipkprefix)" >$(crossprefix)/etc/ipkg/cross-feed.conf

#
# PYTHON-HOST
#
$(DEPDIR)/host-python: @DEPENDS_host_python@
	@PREPARE_host_python@ && \
	( cd @DIR_host_python@ && \
		rm -rf config.cache; \
		CONFIG_SITE= \
		OPT="$(HOST_CFLAGS)" \
		./configure --without-cxx-main --without-threads && \
		$(MAKE) python Parser/pgen && \
		mv python ./hostpython && \
		mv Parser/pgen ./hostpgen && \
		\
		$(MAKE) distclean && \
		./configure \
			--prefix=$(crossprefix) \
			--sysconfdir=$(crossprefix)/etc \
			--without-cxx-main \
			--without-threads && \
		$(MAKE) \
			TARGET_OS=$(build) \
			PYTHON_MODULES_INCLUDE="$(crossprefix)/include" \
			PYTHON_MODULES_LIB="$(crossprefix)/lib" \
			HOSTPYTHON=./hostpython \
			HOSTPGEN=./hostpgen \
			all install && \
		cp ./hostpgen $(crossprefix)/bin/pgen ) && \
	touch $@

# Variables to be exported to packages Makefiles
#
export INCLUDE_DIR=@buildprefix@/make
export IPKPREFIX=@ipkprefix@
export IPKGBUILDDIR=@ipkgbuilddir@
export CDKPREFIX=@cdkprefix@
export DEPSDIR=@buildprefix@/.deps
export BUILDPREFIX=@buildprefix@
export APPSDIR=@appsdir@
export TARGET=@target@
export TARGETPREFIX=@targetprefix@
export FLASHPREFIX=@flashprefix@
export FLASHROOT_MODIFIED=@FLASHROOT_MODIFIED@
export FLASH_CUSTOMIZE=@FLASH_CUSTOMIZE@
export TMP_INSTALL_DIR=@prefix@/tmpinst-cdkroot

export DEPMOD
export INSTALL_DIR
export INSTALL_BIN
export INSTALL_FILE
export LN_SF
export CP_D
export CP_P
export CP_RD
export SED

export MAKE_PATH

export IPKG_BUILD_BIN
export IPKG_BIN
export IPKG_CONF

# Fill ipk directory with packages
#
packages: $(IPKG_BUILD_BIN) \
	make pkg-netio \
	make pkg-nano \
	make pkg-pngquant \
	make pkg-libncurses \
	make pkg-libncurses-extra \
	make pkg-ncurses-terminfo \
	make pkg-libglib2 \
	make pkg-mc \
	make pkg-libcurl \
	make pkg-curl \
	make pkg-libfuse \
	make pkg-fuse-utils \
	make pkg-curlftpfs \
	make pkg-libfreetype \
	make pkg-libjpeg \
	make pkg-libjpeg-dev \
	make pkg-jpeg-tools \
	make pkg-libpng \
	make pkg-libpng-dev \
	make pkg-libungif \
	make pkg-libungif-dev \
	make pkg-liblirc \
	make pkg-liblirc-dev \
	make pkg-lirc-tools
	( cd $(ipkprefix) && \
		$(crossprefix)/bin/ipkg-make-index . >Packages \
	)
	$(CP_P) $(ipkprefix)/Packages $(ipkprefix)/Packages_unzipped && \
	gzip -f $(ipkprefix)/Packages && \
	mv $(ipkprefix)/Packages_unzipped $(ipkprefix)/Packages

#	make pkg-libfreetype-dev \
#

packages-small: $(IPKG_BUILD_BIN) \
	make pkg-netio \
	make pkg-nano \
	make pkg-pngquant \
	make pkg-libncurses \
	make pkg-libncurses-extra \
	make pkg-ncurses-terminfo \
	make pkg-libglib2 \
	make pkg-mc \
	make pkg-libcurl \
	make pkg-curl \
	make pkg-libfuse \
	make pkg-fuse-utils \
	make pkg-curlftpfs \
	make pkg-libfreetype \
	make pkg-libjpeg \
	make pkg-libjpeg-dev \
	make pkg-jpeg-tools \
	make pkg-libpng \
	make pkg-libpng-dev \
	make pkg-libungif \
	make pkg-libungif-dev \
	make pkg-liblirc \
	make pkg-liblirc-dev \
	make pkg-lirc-tools
	( cd $(ipkprefix) && \
		$(crossprefix)/bin/ipkg-make-index . >Packages \
	)
	$(CP_P) $(ipkprefix)/Packages $(ipkprefix)/Packages_unzipped && \
	gzip -f $(ipkprefix)/Packages && \
	mv $(ipkprefix)/Packages_unzipped $(ipkprefix)/Packages

pkg-index:
	@( cd $(ipkprefix) && \
		$(crossprefix)/bin/ipkg-make-index . >Packages \
	) && \
	$(CP_P) $(ipkprefix)/Packages $(ipkprefix)/Packages_unzipped && \
	gzip -f $(ipkprefix)/Packages && \
	mv $(ipkprefix)/Packages_unzipped $(ipkprefix)/Packages
	@ls -l $(ipkprefix)/*

# Helper targets for packages status
#
flashstatus:
	@D=true $(IPKG_BIN) -conf $(IPKG_CONF) status

flashupdate:
	@D=true $(IPKG_BIN) -conf $(IPKG_CONF) update

flashupgrade:
	@D=true $(IPKG_BIN) -conf $(IPKG_CONF) upgrade

flashlistinstalled:
	@D=true $(IPKG_BIN) -conf $(IPKG_CONF) list_installed

flashhelp:
	@D=true $(IPKG_BIN) -conf $(IPKG_CONF) --help

$(ipkprefix):
	$(INSTALL) -d $@

$(ipkgbuilddir): | $(ipkprefix)
	-rm -rf $@
	$(INSTALL) -d $@

############################

define Install/Default
	$(if $($(1)/install/pre),$$($(1)/install/pre),)
	cd $$(DIR_$(1)) && \
		$$(INSTALL_$(1))
	$(if $($(1)/install/post),$$($(1)/install/post),)
endef

define Install/Default/pre
	@echo "N/A"
endef

define Install/AdaptFiles
	cd root && \
		for s in $$($(1)_ADAPTED_FILES); do \
			i="$$$${s#/}" && \
			$(INSTALL_DIR) $$(prefix)/$$*cdkroot/$$$${i%/*}; \
			[ -f $$$$i ] && $(INSTALL) -m644 $$$$i $$(prefix)/$$*cdkroot/$$$$i || true; \
			[ "$$$${i%/*}" = "etc/init.d" ] && chmod 755 $$(prefix)/$$*cdkroot/$$$$i || true; \
		done
endef

define Install/UpdateRc
	$(INSTALL_DIR) $$(prefix)/$$*cdkroot/etc/rc.d/rc{S,3}.d
	$(LN_SF) ../init.d $$(prefix)/$$*cdkroot/etc/rc.d/init.d
	export HHL_CROSS_TARGET_DIR=$$(prefix)/$$*cdkroot && \
	cd $$(prefix)/$$*cdkroot/etc/init.d && \
		for s in $$($(1)_INITD_FILES) ; do \
			$$(hostprefix)/bin/target-initdconfig --add $$$$s \
				|| echo "Unable to enable initd service: $$$$s" ; \
		done && \
		rm *rpmsave 2>/dev/null || true
endef

# call Cdkroot/Install,<Package $(1)>,<Depends %$(3)>,<Depends $(4)>
#
define Cdkroot
  $(DEPDIR)/min-$(1) $(DEPDIR)/std-$(1) $(DEPDIR)/max-$(1) \
  $(DEPDIR)/$(1): \
  $(DEPDIR)/%$(1): $$($(1)_ADAPTED_FILES:%=root/%) \
		$(addprefix %,$(2)) $(3) $(1).do_compile
	$(if $($(1)/install),$$($(1)/install),$(Install/Default))
    ifdef $(1)_ADAPTED_FILES
	$(Install/AdaptFiles)
    endif
    ifdef $(1)_INITD_FILES
	$(Install/UpdateRc)
    endif
#	$$(DISTCLEANUP_$(1))
	@[ "x$$*" = "x" ] && touch $$@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

  $(DEPDIR)/tmpinst-$(1): \
  $(DEPDIR)/%$(1): $(1).do_compile
	rm -rf $(TMP_INSTALL_DIR)/
	$(INSTALL_DIR) $(TMP_INSTALL_DIR)
	$(if $($(1)/install),$$($(1)/install),$(Install/Default))
    ifdef $(1)_ADAPTED_FILES
	@echo "Adapted files: $$($(1)_ADAPTED_FILES)"
	$(Install/AdaptFiles)
    endif
    ifdef $(1)_INITD_FILES
	@echo "Initd files: $$($(1)_INITD_FILES)"
	$(Install/UpdateRc)
    endif

endef

# call Package,<Source Package $(1)>,<Package $(2)>,<Depends $(3)>
#
define Package
  pkg-$(2) \
  flash-$(2) flashinstall-$(2) \
  flashuninstall-$(2) \
  flashstatus-$(2) flashinfo-$(2) flashwhatdepends-$(2): \
  %$(2): bootstrap $(1).do_compile $(3) | $(IPKG_BUILD_BIN) $(IPKG_BIN)
	make -C packages/$(1) $(subst $$*,,$$@) \
		PKG_VERSION=$(VERSION_$(1)) \
		BUILD_DIR=$(buildprefix)/$(DIR_$(1))
endef

.PHONY: $(ipkgbuilddir) packages packages-small
# endif STM24

#
# BOOTSTRAP-HOST
#

#
# CCACHE
#
$(hostprefix)/ccache-bin:
	$(INSTALL) -d $@
	$(INSTALL) -d $(hostprefix)/bin

ccache: | $(hostprefix)/ccache-bin/gcc
	touch .deps/$(notdir $@)

$(hostprefix)/ccache-bin/gcc: | $(CCACHE)
	make $(hostprefix)/ccache-bin
	ln -sf $| $@
	ln -sf $| $(@D)/g++
	ln -sf $| $(@D)/$(target)-gcc
	ln -sf $| $(@D)/$(target)-g++
	ln -sf $| $(hostprefix)/bin/$(target)-gcc
	ln -sf $| $(hostprefix)/bin/$(target)-g++

$(HOST_RPMCONFIG_RPM): \
		$(if $(HOST_RPMCONFIG_SPEC_PATCH),Patches/$(HOST_RPMCONFIG_SPEC_PATCH)) \
		$(if $(HOST_RPMCONFIG_PATCHES),$(HOST_RPMCONFIG_PATCHES:%=Patches/%)) \
 		Archive/$(STLINUX)-$(HOST_RPMCONFIG)-$(HOST_RPMCONFIG_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(HOST_RPMCONFIG_SPEC_PATCH),( cd SPECS && patch -p1 $(HOST_RPMCONFIG_SPEC) < ../Patches/$(HOST_RPMCONFIG_SPEC_PATCH) ) &&) \
	$(if $(HOST_RPMCONFIG_PATCHES),cp $(HOST_RPMCONFIG_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOST_RPMCONFIG_SPEC)

$(HOST_RPMCONFIG): $(HOST_RPMCONFIG_RPM)
	@rpm $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(STM_RELOCATE)=$(prefix) $< && \
	touch .deps/$(notdir $@)

$(HOST_BASE_PASSWD_RPM): \
		$(if $(HOST_BASE_PASSWD_SPEC_PATCH),Patches/$(HOST_BASE_PASSWD_SPEC_PATCH)) \
		$(if $(HOST_BASE_PASSWD_PATCHES),$(HOST_BASE_PASSWD_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-$(HOST_BASE_PASSWD)-$(HOST_BASE_PASSWD_VERSION).src.rpm
	rpm  $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(HOST_BASE_PASSWD_SPEC_PATCH),( cd SPECS && patch -p1 $(HOST_BASE_PASSWD_SPEC) < ../Patches/$(HOST_BASE_PASSWD_SPEC_PATCH) ) &&) \
	$(if $(HOST_BASE_PASSWD_PATCHES),cp $(HOST_BASE_PASSWD_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOST_BASE_PASSWD_SPEC)

$(HOST_BASE_PASSWD): $(HOST_BASE_PASSWD_RPM)
	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
	touch .deps/$(notdir $@)

$(HOST_DISTRIBUTIONUTILS_RPM): \
		$(if $(HOST_DISTRIBUTIONUTILS_SPEC_PATCH),Patches/$(HOST_DISTRIBUTIONUTILS_SPEC_PATCH)) \
		$(if $(HOST_DISTRIBUTIONUTILS_PATCHES),$(HOST_DISTRIBUTIONUTILS_PATCHES:%=Patches/%)) \
		Archive/$(STM_SRC)-$(HOST_DISTRIBUTIONUTILS)-$(HOST_DISTRIBUTIONUTILS_VERSION).src.rpm
	rpm  $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(HOST_DISTRIBUTIONUTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(HOST_DISTRIBUTIONUTILS_SPEC) < ../Patches/$(HOST_DISTRIBUTIONUTILS_SPEC_PATCH) ) &&) \
	$(if $(HOST_DISTRIBUTIONUTILS_PATCHES),cp $(HOST_DISTRIBUTIONUTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOST_DISTRIBUTIONUTILS_SPEC)

$(HOST_DISTRIBUTIONUTILS): $(HOST_DISTRIBUTIONUTILS_RPM)
	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
	touch .deps/$(notdir $@)

#
# HOST-FILESYSTEM
#

host-filesystem:
	$(INSTALL) -d $(prefix)
	$(INSTALL) -d $(configprefix)
	$(INSTALL) -d $(devkitprefix)
	$(INSTALL) -d $(devkitprefix)/sources
	$(INSTALL) -d $(devkitprefix)/sources/kernel
	$(INSTALL) -d $(hostprefix)
	$(INSTALL) -d $(hostprefix)/{bin,doc,etc,include,info,lib,man,share,var}
	$(INSTALL) -d $(hostprefix)/man/man{1,2,3,4,5,6,7,8,9}
	touch .deps/$@

$(HOST_AUTOTOOLS_RPM): \
		$(addprefix Patches/,$(HOST_AUTOTOOLS_SPEC_PATCH) $(HOST_AUTOTOOLS_PATCHES)) \
		Archive/$(STLINUX:%23=%24)-$(HOST_AUTOTOOLS)-$(HOST_AUTOTOOLS_VERSION).src.rpm
	rpm  $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(HOST_AUTOTOOLS_SPEC_PATCH),( cd SPECS && patch -p1 $(HOST_AUTOTOOLS_SPEC) < ../Patches/$(HOST_AUTOTOOLS_SPEC_PATCH) ) &&) \
	$(if $(HOST_AUTOTOOLS_PATCHES),cp $(addprefix Patches/,$(HOST_AUTOTOOLS_PATCHES)) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOST_AUTOTOOLS_SPEC)

$(DEPDIR)/$(HOST_AUTOTOOLS): $(HOST_AUTOTOOLS_RPM)
	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
	touch $@

@STM22_FALSE@$(HOST_AUTOMAKE_RPM): \
@STM22_FALSE@		$(addprefix Patches/,$(HOST_AUTOMAKE_SPEC_PATCH) $(HOST_AUTOMAKE_PATCHES)) \
@STM22_FALSE@		Archive/$(STLINUX:%23=%24)-$(HOST_AUTOMAKE)-$(HOST_AUTOMAKE_VERSION).src.rpm
@STM22_FALSE@	rpm  $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM22_FALSE@	$(if $(HOST_AUTOMAKE_SPEC_PATCH),( cd SPECS && patch -p1 $(HOST_AUTOMAKE_SPEC) < ../Patches/$(HOST_AUTOMAKE_SPEC_PATCH) ) &&) \
@STM22_FALSE@	$(if $(HOST_AUTOMAKE_PATCHES),cp $(addprefix Patches/,$(HOST_AUTOMAKE_PATCHES)) SOURCES/ &&) \
@STM22_FALSE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM22_FALSE@	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOST_AUTOMAKE_SPEC)

@STM22_FALSE@$(DEPDIR)/$(HOST_AUTOMAKE): $(HOST_AUTOMAKE_RPM)
@STM22_FALSE@	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
@STM22_FALSE@	touch $@

@STM22_FALSE@$(HOST_AUTOCONF_RPM): \
@STM22_FALSE@		$(addprefix Patches/,$(HOST_AUTOCONF_SPEC_PATCH) $(HOST_AUTOCONF_PATCHES)) \
@STM22_FALSE@		Archive/$(STLINUX:%23=%24)-$(HOST_AUTOCONF)-$(HOST_AUTOCONF_VERSION).src.rpm
@STM22_FALSE@	rpm  $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM22_FALSE@	$(if $(HOST_AUTOCONF_SPEC_PATCH),( cd SPECS && patch -p1 $(HOST_AUTOCONF_SPEC) < ../Patches/$(HOST_AUTOCONF_SPEC_PATCH) ) &&) \
@STM22_FALSE@	$(if $(HOST_AUTOCONF_PATCHES),cp $(addprefix Patches/,$(HOST_AUTOCONF_PATCHES)) SOURCES/ &&) \
@STM22_FALSE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM22_FALSE@	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOST_AUTOCONF_SPEC)

@STM22_FALSE@$(DEPDIR)/$(HOST_AUTOCONF): $(HOST_AUTOCONF_RPM)
@STM22_FALSE@	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
@STM22_FALSE@	touch $@

@STM22_FALSE@$(HOST_PKGCONFIG_RPM): \
@STM22_FALSE@		$(addprefix Patches/,$(HOST_PKGCONFIG_SPEC_PATCH) $(HOST_PKGCONFIG_PATCHES)) \
@STM22_FALSE@		Archive/$(STLINUX:%23=%24)-$(HOST_PKGCONFIG)-$(HOST_PKGCONFIG_VERSION).src.rpm
@STM22_FALSE@	rpm  $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM22_FALSE@	$(if $(HOST_PKGCONFIG_SPEC_PATCH),( cd SPECS && patch -p1 $(HOST_PKGCONFIG_SPEC) < ../Patches/$(HOST_PKGCONFIG_SPEC_PATCH) ) &&) \
@STM22_FALSE@	$(if $(HOST_PKGCONFIG_PATCHES),cp $(addprefix Patches/,$(HOST_PKGCONFIG_PATCHES)) SOURCES/ &&) \
@STM22_FALSE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM22_FALSE@	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOST_PKGCONFIG_SPEC)

@STM22_FALSE@$(DEPDIR)/$(HOST_PKGCONFIG): $(HOST_PKGCONFIG_RPM)
@STM22_FALSE@	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
@STM22_FALSE@	touch $@

# Workaround for stm24, where is the host-lzo package available?
@STM24_TRUE@$(HOST_MTD_UTILS_RPM): \
@STM24_TRUE@		$(if $(HOST_MTD_UTILS_SPEC_PATCH),Patches/$(HOST_MTD_UTILS_SPEC_PATCH)) \
@STM24_TRUE@		$(if $(HOST_MTD_UTILS_PATCHES),$(HOST_MTD_UTILS_PATCHES:%=Patches/%)) \
@STM24_TRUE@		Archive/stlinux23-$(HOST_MTD_UTILS)-$(HOST_MTD_UTILS_VERSION).src.rpm
@STM24_TRUE@	rpm  $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM24_TRUE@	$(if $(HOST_MTD_UTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(HOST_MTD_UTILS_SPEC) < ../Patches/$(HOST_MTD_UTILS_SPEC_PATCH) ) &&) \
@STM24_TRUE@	$(if $(HOST_MTD_UTILS_PATCHES),cp $(HOST_MTD_UTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
@STM24_TRUE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM24_TRUE@	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOST_MTD_UTILS_SPEC)
@STM24_FALSE@$(HOST_MTD_UTILS_RPM): \
@STM24_FALSE@		$(if $(HOST_MTD_UTILS_SPEC_PATCH),Patches/$(HOST_MTD_UTILS_SPEC_PATCH)) \
@STM24_FALSE@		$(if $(HOST_MTD_UTILS_PATCHES),$(HOST_MTD_UTILS_PATCHES:%=Patches/%)) \
@STM24_FALSE@		Archive/$(STM_SRC)-$(HOST_MTD_UTILS)-$(HOST_MTD_UTILS_VERSION).src.rpm
@STM24_FALSE@	rpm  $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM24_FALSE@	$(if $(HOST_MTD_UTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(HOST_MTD_UTILS_SPEC) < ../Patches/$(HOST_MTD_UTILS_SPEC_PATCH) ) &&) \
@STM24_FALSE@	$(if $(HOST_MTD_UTILS_PATCHES),cp $(HOST_MTD_UTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
@STM24_FALSE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM24_FALSE@	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOST_MTD_UTILS_SPEC)

$(HOST_MTD_UTILS): $(HOST_MTD_UTILS_RPM)
	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
	touch .deps/$(notdir $@)

#
# BOOTSTRAP-HOST
#
$(DEPDIR)/bootstrap-host: | \
		$(CCACHE_BIN) host-rpmconfig host-base-passwd host-distributionutils \
		host-filesystem host-autotools $(HOST_AUTOMAKE) $(HOST_AUTOCONF) $(HOST_PKGCONFIG) \
		$(HOST_MTD_UTILS)
	$(if $(HOST_MTD_UTILS_RPM),[ "x$*" = "x" ] && touch -r $(HOST_MTD_UTILS_RPM) $@ || true)

cross-sh4-filesystem:
	$(INSTALL) -d $(targetprefix)
	$(INSTALL) -d $(crossprefix)
	$(INSTALL) -d $(crossprefix)/{bin,doc,etc,include,lib,man,sh4-linux,share,var}
	$(INSTALL) -d $(crossprefix)/man/man{1,2,3,4,5,6,7,8,9}
	$(INSTALL) -d $(crossprefix)/sh4-linux/{bin,include,lib}
	touch .deps/$@

$(CROSS_DISTRIBUTIONUTILS_RPM): \
		$(if $(CROSS_DISTRIBUTIONUTILS_SPEC_PATCH),Patches/$(CROSS_DISTRIBUTIONUTILS_SPEC_PATCH)) \
		$(if $(CROSS_DISTRIBUTIONUTILS_PATCHES),$(CROSS_DISTRIBUTIONUTILS_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-$(subst cross-sh4,cross,$(CROSS_DISTRIBUTIONUTILS))-$(CROSS_DISTRIBUTIONUTILS_VERSION).src.rpm
	rpm  $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(CROSS_DISTRIBUTIONUTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(CROSS_DISTRIBUTIONUTILS_SPEC) < ../Patches/$(CROSS_DISTRIBUTIONUTILS_SPEC_PATCH) ) &&) \
	$(if $(CROSS_DISTRIBUTIONUTILS_PATCHES),cp $(CROSS_DISTRIBUTIONUTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(CROSS_DISTRIBUTIONUTILS_SPEC)

@STM22_TRUE@$(CROSS_DISTRIBUTIONUTILS): $(CROSS_DISTRIBUTIONUTILS_RPM)
@STM22_TRUE@	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
@STM22_TRUE@	$(LN_SF) $(hostprefix)/bin/target-initdconfig $(crossprefix)/bin/target-initdconfig
@STM22_TRUE@	touch .deps/$(notdir $@)
@STM22_FALSE@$(CROSS_DISTRIBUTIONUTILS): $(CROSS_DISTRIBUTIONUTILS_RPM)
@STM22_FALSE@	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
@STM22_FALSE@	touch .deps/$(notdir $@)

$(CROSS_BINUTILS_RPM) $(CROSS_BINUTILS_DEV_RPM) : \
		$(if $(CROSS_BINUTILS_SPEC_PATCH),Patches/$(CROSS_BINUTILS_SPEC_PATCH)) \
		$(if $(CROSS_BINUTILS_PATCHES),$(CROSS_BINUTILS_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-$(subst cross-sh4-,cross-,$(CROSS_BINUTILS))-$(CROSS_BINUTILS_VERSION).src.rpm
	rpm  $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(CROSS_BINUTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(CROSS_BINUTILS_SPEC) < ../Patches/$(CROSS_BINUTILS_SPEC_PATCH) ) &&) \
	$(if $(CROSS_BINUTILS_PATCHES),cp $(CROSS_BINUTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(CROSS_BINUTILS_SPEC)

$(CROSS_BINUTILS): $(CROSS_BINUTILS_RPM)
	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
	touch .deps/$(notdir $@)

$(CROSS_BINUTILS_DEV): $(CROSS_BINUTILS_DEV_RPM)
	@rpm  $(DRPM) --ignorearch --nodeps --noscripts -Uhv $< && \
	touch .deps/$(notdir $@)
# endif STM24

@STM22_FALSE@$(CROSS_GMP_RPM): \
@STM22_FALSE@		$(addprefix Patches/,$(CROSS_GMP_SPEC_PATCH) $(CROSS_GMP_PATCHES)) \
@STM22_FALSE@		Archive/$(STLINUX:%23=%24)-$(subst cross-sh4-,cross-,$(CROSS_GMP))-$(CROSS_GMP_VERSION).src.rpm
@STM22_FALSE@	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM22_FALSE@	$(if $(CROSS_GMP_SPEC_PATCH),( cd SPECS && patch -p1 $(CROSS_GMP_SPEC) < ../Patches/$(CROSS_GMP_SPEC_PATCH) ) &&) \
@STM22_FALSE@	$(if $(CROSS_GMP_PATCHES),cp $(addprefix Patches/,$(CROSS_GMP_PATCHES)) SOURCES/ &&) \
@STM22_FALSE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM22_FALSE@	rpmbuild $(DRPMBUILD) -bb -v --target=sh4-linux SPECS/$(CROSS_GMP_SPEC)

@STM22_FALSE@$(DEPDIR)/$(CROSS_GMP): $(CROSS_GMP_RPM)
@STM22_FALSE@	@rpm $(DRPM) --nodeps -Uhv $(lastword $^) && \
@STM22_FALSE@	touch $@

@STM22_FALSE@$(CROSS_MPFR_RPM): \
@STM22_FALSE@		$(CROSS_GMP_RPM) \
@STM22_FALSE@		$(addprefix Patches/,$(CROSS_MPFR_SPEC_PATCH) $(CROSS_MPFR_PATCHES)) \
@STM22_FALSE@		Archive/$(STLINUX:%23=%24)-$(subst cross-sh4-,cross-,$(CROSS_MPFR))-$(CROSS_MPFR_VERSION).src.rpm
@STM22_FALSE@	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM22_FALSE@	$(if $(CROSS_MPFR_SPEC_PATCH),( cd SPECS && patch -p1 $(CROSS_MPFR_SPEC) < ../Patches/$(CROSS_MPFR_SPEC_PATCH) ) &&) \
@STM22_FALSE@	$(if $(CROSS_MPFR_PATCHES),cp $(addprefix Patches/,$(CROSS_MPFR_PATCHES)) SOURCES/ &&) \
@STM22_FALSE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM22_FALSE@	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(CROSS_MPFR_SPEC)

@STM22_FALSE@$(DEPDIR)/$(CROSS_MPFR): $(CROSS_GMP) $(CROSS_MPFR_RPM)
@STM22_FALSE@	@rpm $(DRPM) --nodeps -Uhv $(lastword $^) && \
@STM22_FALSE@	touch $@

@STM24_TRUE@$(CROSS_MPC_RPM): \
@STM24_TRUE@		$(addprefix Patches/,$(CROSS_MPC_SPEC_PATCH) $(CROSS_MPC_PATCHES)) \
@STM24_TRUE@		Archive/$(STLINUX:%23=%24)-$(subst cross-sh4-,cross-,$(CROSS_MPC))-$(CROSS_MPC_VERSION).src.rpm
@STM24_TRUE@	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM24_TRUE@	$(if $(CROSS_MPC_SPEC_PATCH),( cd SPECS && patch -p1 $(CROSS_MPC_SPEC) < ../Patches/$(CROSS_MPC_SPEC_PATCH) ) &&) \
@STM24_TRUE@	$(if $(CROSS_MPC_PATCHES),cp $(addprefix Patches/,$(CROSS_MPC_PATCHES)) SOURCES/ &&) \
@STM24_TRUE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM24_TRUE@	rpmbuild $(DRPMBUILD) -bb -v --target=sh4-linux SPECS/$(CROSS_MPC_SPEC)

@STM24_TRUE@$(DEPDIR)/$(CROSS_MPC): $(CROSS_MPC_RPM)
@STM24_TRUE@	@rpm $(DRPM) --nodeps -Uhv $(lastword $^) && \
@STM24_TRUE@	touch $@

@STM24_TRUE@$(CROSS_LIBELF_RPM): \
@STM24_TRUE@		$(addprefix Patches/,$(CROSS_LIBELF_SPEC_PATCH) $(CROSS_LIBELF_PATCHES)) \
@STM24_TRUE@		Archive/$(STLINUX:%23=%24)-$(subst cross-sh4-,cross-,$(CROSS_LIBELF))-$(CROSS_LIBELF_VERSION).src.rpm
@STM24_TRUE@	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM24_TRUE@	$(if $(CROSS_LIBELF_SPEC_PATCH),( cd SPECS && patch -p1 $(CROSS_LIBELF_SPEC) < ../Patches/$(CROSS_LIBELF_SPEC_PATCH) ) &&) \
@STM24_TRUE@	$(if $(CROSS_LIBELF_PATCHES),cp $(addprefix Patches/,$(CROSS_LIBELF_PATCHES)) SOURCES/ &&) \
@STM24_TRUE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM24_TRUE@	rpmbuild $(DRPMBUILD) -bb -v --target=sh4-linux SPECS/$(CROSS_LIBELF_SPEC)

@STM24_TRUE@$(DEPDIR)/$(CROSS_LIBELF): $(CROSS_LIBELF_RPM)
@STM24_TRUE@	@rpm $(DRPM) --nodeps -Uhv $(lastword $^) && \
@STM24_TRUE@	touch $@
CROSS_G++ = cross-sh4-g++
CROSS_G++_RPM = RPMS/$(host_arch)/$(STLINUX)-$(CROSS_G++)-$(CROSS_GCC_VERSION).$(host_arch).rpm

$(CROSS_GCC_RPM) $(CROSS_CPP_RPM) $(CROSS_G++_RPM) $(CROSS_PROTOIZE_RPM) $(CROSS_LIBGCC_RPM): \
		$(if $(CROSS_GCC_SPEC_PATCH),Patches/$(CROSS_GCC_SPEC_PATCH)) \
		$(if $(CROSS_GCC_PATCHES),$(CROSS_GCC_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX:%23=%24)-$(subst cross-sh4-,cross-,$(CROSS_GCC))-$(CROSS_GCC_VERSION).src.rpm \
		| Archive/$(STLINUX)-sh4-$(GLIBC)-$(GLIBC_VERSION).sh4.rpm \
		Archive/$(STLINUX)-sh4-$(GLIBC_DEV)-$(GLIBC_VERSION).sh4.rpm \
		$(if $(CROSS_MPFR),$(CROSS_MPFR)) \
		$(if $(CROSS_MPC),$(CROSS_MPC)) \
		$(if $(CROSS_LIBELF),$(CROSS_LIBELF)) \
		$(if $(KERNELHEADERS),$(KERNELHEADERS)) \
		kernel-headers
	rpm $(DRPM) --nosignature --ignorearch --nodeps --force -Uhv \
		--badreloc --relocate $(STM_RELOCATE)/devkit/sh4/target=$(targetprefix) $(word 1,$|) && \
	rpm $(DRPM) --nosignature --ignorearch --nodeps --force -Uhv \
		--badreloc --relocate $(STM_RELOCATE)/devkit/sh4/target=$(targetprefix) $(word 2,$|)
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(CROSS_GCC_SPEC_PATCH),( cd SPECS && patch -p1 $(CROSS_GCC_SPEC) < ../Patches/$(CROSS_GCC_SPEC_PATCH) ) &&) \
	$(if $(CROSS_GCC_PATCHES),cp $(CROSS_GCC_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild  $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(CROSS_GCC_SPEC)
	rpm $(DRPM) --nodeps -ev $(STLINUX)-sh4-$(GLIBC_DEV) && \
	rpm $(DRPM) --nodeps -ev $(STLINUX)-sh4-$(GLIBC)

$(CROSS_GCC): $(CROSS_GCC_RPM)
	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
	$(if $(CROSS_GCC_INVALIDATE),sh4-linux-objcopy -v --redefine-sym __ic_invalidate_syscall=__ic_invalidate $(prefix)/devkit/sh4/lib/gcc/sh4-linux/$(CROSS_GCC_RAWVERSION)/libgcc.a &&) \
	touch .deps/$(notdir $@)

$(CROSS_CPP): $(CROSS_CPP_RPM)
	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
	touch .deps/$(notdir $@)

$(CROSS_G++): $(CROSS_G++_RPM)
	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
	touch .deps/$(notdir $@)

$(DEPDIR)/min-$(CROSS_LIBGCC) $(DEPDIR)/std-$(CROSS_LIBGCC) $(DEPDIR)/max-$(CROSS_LIBGCC) \
$(DEPDIR)/$(CROSS_LIBGCC): \
$(DEPDIR)/%$(CROSS_LIBGCC): $(CROSS_LIBGCC_RPM) | $(DEPDIR)/%$(GLIBC)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb  $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(CROSS_PROTOIZE): $(CROSS_PROTOIZE_RPM)
	@rpm  $(DRPM) --ignorearch --nodeps -Uhv $< && \
	touch .deps/$(notdir $@)

#flash-cross-sh4-libgcc: $(flashprefix)/root/lib/libgcc_s-$(CROSS_GCC_RAWVERSION).so.1
#
#$(flashprefix)/root/lib/libgcc_s-$(CROSS_GCC_RAWVERSION).so.1: $(CROSS_LIBGCC_RPM)
#	@rpm --dbpath $(flashprefix)-rpmdb  $(DRPM) --ignorearch --nodeps  -Uhv \
#		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $<
#	touch $@
#	@FLASHROOTDIR_MODIFIED@

#
# BOOTSTRAP-CROSS
#
$(DEPDIR)/bootstrap-cross: | \
		bootstrap-host cross-sh4-distributionutils cross-sh4-filesystem cross-sh4-binutils cross-sh4-binutils-dev \
		cross-sh4-cpp cross-sh4-gcc cross-sh4-g++ cross-sh4-libgcc
	[ "x$*" = "x" ] && touch -r $(CROSS_G++_RPM) $@ || true

$(DEPDIR)/setup-cross-doc: \
	cross-binutils-doc cross-sh4-cpp-doc cross-sh4-gcc-doc cross-sh4-g++-doc

$(DEPDIR)/setup-cross-optional: \
	cross-sh4-protoize

#
# LIBTOOL
#
$(DEPDIR)/libtool.do_prepare: @DEPENDS_libtool@
	@PREPARE_libtool@
	touch $@

$(DEPDIR)/libtool.do_compile: $(DEPDIR)/libtool.do_prepare
	cd @DIR_libtool@ && \
	./configure --prefix=$(hostprefix) && \
	$(MAKE)
	touch $@

$(DEPDIR)/libtool: $(DEPDIR)/libtool.do_compile
	cd @DIR_libtool@ && \
	@INSTALL_libtool@
	touch $@

$(HOST_U_BOOT_RPM): \
		$(if $(HOST_U_BOOT_SPEC_PATCH),Patches/$(HOST_U_BOOT_SPEC_PATCH)) \
		$(if $(HOST_U_BOOT_PATCHES),$(HOST_U_BOOT_PATCHES:%=Patches/%)) \
 		Archive/$(STLINUX)-$(HOST_U_BOOT)-source-$(HOST_U_BOOT_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(HOST_U_BOOT_SPEC_PATCH),( cd SPECS && patch -p1 $(HOST_U_BOOT_SPEC) < ../Patches/$(HOST_U_BOOT_SPEC_PATCH) ) &&) \
	$(if $(HOST_U_BOOT_PATCHES),cp $(HOST_U_BOOT_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOST_U_BOOT_SPEC)

$(DEPDIR)/u-boot.do_prepare: $(HOST_U_BOOT_RPM)
	@rpm $(DRPM) --ignorearch --nodeps -Uhv $< && \
	touch $@

@STM22_TRUE@$(DEPDIR)/u-boot.do_compile: \
@STM22_TRUE@		$(DEPDIR)/u-boot.do_prepare
@STM22_TRUE@	cd $(HOST_U_BOOT_DIR) && \
@STM22_TRUE@		$(MAKE) ARCH=sh4 CROSS_COMPILE=$(target)- mrproper && \
@STM22_TRUE@		$(MAKE) $(MAKE_OPTS) stb7100ref_27_config && \
@STM22_TRUE@		$(MAKE) ARCH=sh4 CROSS_COMPILE=$(target)-
@STM22_TRUE@	cd $(HOST_U_BOOT_DIR) && \
@STM22_TRUE@		./STM/mkenv stb7100ref_27 setupenv && \
@STM22_TRUE@		sed -e "s/set uversion.*/set uversion $(HOST_U_BOOT_RAWVERSION)/" \
@STM22_TRUE@		-e "s/set kversion.*/set kversion /" \
@STM22_TRUE@		-i setupenv && \
@STM22_TRUE@		sed -e "s/define uversion.*/define uversion $(HOST_U_BOOT_RAWVERSION)/" \
@STM22_TRUE@		./STM/kscript > kscript && \
@STM22_TRUE@		./tools/mkimage -A sh4 -O u-boot -T script -C none -a 0 -e 0 -d setupenv setupenv.ub
@STM22_TRUE@	touch $@

@STM22_TRUE@$(DEPDIR)/u-boot-utils.do_compile: bootstrap $(DEPDIR)/u-boot.do_prepare
@STM22_TRUE@	cd $(HOST_U_BOOT_DIR) && \
@STM22_TRUE@		$(MAKE) -C STM/env ARCH=sh4 CROSS_COMPILE=$(target)- clean TARGETS=fw_printenv TARGETDIR=$(targetprefix) && \
@STM22_TRUE@		$(MAKE) -C STM/env ARCH=sh4 CROSS_COMPILE=$(target)- all TARGETS=fw_printenv TARGETDIR=$(targetprefix)
@STM22_TRUE@	touch $@

@STM22_TRUE@$(DEPDIR)/min-u-boot-utils $(DEPDIR)/std-u-boot-utils $(DEPDIR)/max-u-boot-utils \
@STM22_TRUE@$(DEPDIR)/u-boot-utils: \
@STM22_TRUE@$(DEPDIR)/%u-boot-utils: $(DEPDIR)/u-boot-utils.do_compile
@STM22_TRUE@	$(INSTALL) -d $(prefix)/$*cdkroot/{etc,usr/sbin} && \
@STM22_TRUE@	cd $(HOST_U_BOOT_DIR) && \
@STM22_TRUE@		$(INSTALL) -m 755 STM/env/fw_printenv $(prefix)/$*cdkroot/usr/sbin && \
@STM22_TRUE@		$(LN_SF) fw_printenv $(prefix)/$*cdkroot/usr/sbin/fw_setenv
@STM22_TRUE@	$(INSTALL) -m 644 $(buildprefix)/root/etc/fw_env.config $(prefix)/$*cdkroot/etc/
@STM22_TRUE@	[ "x$*" = "x" ] && touch $@ || true
@STM22_TRUE@	@TUXBOX_YAUD_CUSTOMIZE@
### TO be fixed
@STM22_FALSE@$(DEPDIR)/u-boot-utils.do_compile: bootstrap $(DEPDIR)/u-boot.do_prepare
#	cd $(HOST_U_BOOT_DIR) && \
#		$(MAKE) -C tools/env TOPDIR=$(buildprefix)/$(HOST_U_BOOT_DIR) ARCH=sh4 CROSS_COMPILE=$(target)- clean TARGETS=fw_printenv TARGETDIR=$(targetprefix) && \
#		$(MAKE) -C tools/env TOPDIR=$(buildprefix)/$(HOST_U_BOOT_DIR) ARCH=sh4 CROSS_COMPILE=$(target)- all TARGETS=fw_printenv TARGETDIR=$(targetprefix)
@STM22_FALSE@	touch $@

@STM22_FALSE@$(DEPDIR)/min-u-boot-utils $(DEPDIR)/std-u-boot-utils $(DEPDIR)/max-u-boot-utils \
@STM22_FALSE@$(DEPDIR)/u-boot-utils: \
@STM22_FALSE@$(DEPDIR)/%u-boot-utils: $(DEPDIR)/u-boot-utils.do_compile
#	$(INSTALL) -d $(prefix)/$*cdkroot/{etc,usr/sbin} && \
#	cd $(HOST_U_BOOT_DIR) && \
#		$(INSTALL) -m 755 tools/env/fw_printenv $(prefix)/$*cdkroot/usr/sbin && \
#		$(LN_SF) fw_printenv $(prefix)/$*cdkroot/usr/sbin/fw_setenv
#	$(INSTALL) -m 644 $(buildprefix)/root/etc/fw_env.config $(prefix)/$*cdkroot/etc/
@STM22_FALSE@	[ "x$*" = "x" ] && touch $@ || true
@STM22_FALSE@	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-u-boot-utils: $(flashprefix)/root/usr/sbin/fw_printenv

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/sbin/fw_printenv: $(DEPDIR)/u-boot-utils.do_compile
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -d $(flashprefix)/root/{etc,usr/sbin} && \
@TARGETRULESET_FLASH_TRUE@	cd $(HOST_U_BOOT_DIR) && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 755 STM/env/fw_printenv $@ && \
@TARGETRULESET_FLASH_TRUE@		$(LN_SF) fw_printenv $(flashprefix)/root/usr/sbin/fw_setenv
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -m 644 $(buildprefix)/root/etc/fw_env.config $(flashprefix)/root/etc/
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

$(DEPDIR)/u-boot: $(DEPDIR)/u-boot.do_compile
RPMS/sh4/stlinux20-$(HOST_U_BOOT_SH4_STB7100REF_27)-2.0-14.sh4.rpm: Archive/stlinux20-$(HOST_U_BOOT_SH4_STB7100REF_27)-2.0-14.src.rpm
	rpm $(DRPM) --nosignature -Uhv $< && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-$(HOST_U_BOOT_SH4_STB7100REF_27).spec
$(HOST_U_BOOT_SH4_STB7100REF_27): RPMS/sh4/stlinux20-$(HOST_U_BOOT_SH4_STB7100REF_27)-2.0-14.sh4.rpm
	@rpm $(DRPM) --ignorearch --nodeps -Uhv $< && \
	touch .deps/$(notdir $@)

$(HOST_U_BOOT_TOOLS_RPM): \
		$(if $(HOST_U_BOOT_TOOLS_SPEC_PATCH),Patches/$(HOST_U_BOOT_TOOLS_SPEC_PATCH)) \
		$(if $(HOST_U_BOOT_TOOLS_PATCHES),$(HOST_U_BOOT_TOOLS_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-$(HOST_U_BOOT_TOOLS)-$(HOST_U_BOOT_TOOLS_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(HOST_U_BOOT_TOOLS_SPEC_PATCH),( cd SPECS && patch -p1 $(HOST_U_BOOT_TOOLS_SPEC) < ../Patches/$(HOST_U_BOOT_TOOLS_SPEC_PATCH) ) &&) \
	$(if $(HOST_U_BOOT_TOOLS_PATCHES),cp $(HOST_U_BOOT_TOOLS_PATCHES:%=Patches/%) SOURCES/ &&) \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOST_U_BOOT_TOOLS_SPEC)

@STM22_TRUE@$(DEPDIR)/$(HOST_U_BOOT_TOOLS): $(HOST_U_BOOT_TOOLS_RPM) | bootstrap-cross
@STM22_TRUE@	@rpm $(DRPM) --ignorearch --nodeps -Uhv $(lastword $^) && \
@STM22_TRUE@	touch $@
@STM22_FALSE@$(DEPDIR)/$(HOST_U_BOOT_TOOLS): u-boot.do_prepare $(HOST_U_BOOT_TOOLS_RPM) | bootstrap-cross
@STM22_FALSE@	@rpm $(DRPM) --ignorearch --nodeps -Uhv $(lastword $^) && \
@STM22_FALSE@	touch $@
#ETC_RW_FILES +=

#
# Functions for copying customized etc files from cvs/cdk/root/etc into yaud and flash targets and
# for updating init scripts in runlevel for yaud and flash targets
#
define adapted-etc-files
	cd root/etc && \
	for i in $(1); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(prefix)/$*cdkroot/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(prefix)/$*cdkroot/etc/$$i || true; \
	done
endef

define adapted-etc-flashfiles
	cd root/etc && \
		for i in $(1); do \
			[ -f $$i ] && $(INSTALL) -m644 $$i $(flashprefix)/root/etc/$$i || true; \
			[ "$${i%%/*}" = "init.d" ] && chmod 755 $(flashprefix)/root/etc/$$i || true; \
		done
endef

define initdconfig
	export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && \
	cd $(prefix)/$*cdkroot/etc/init.d && \
		for s in $(1) ; do \
			$(hostprefix)/bin/target-initdconfig --add $$s || echo "Unable to enable initd service: $$s" ; \
		done && \
		rm *rpmsave 2>/dev/null || true
endef

define initdconfig-flash
	export HHL_CROSS_TARGET_DIR=$(flashprefix)/root && \
	cd $(prefix)/$*cdkroot/etc/init.d && \
		for s in $(1) ; do \
			$(hostprefix)/bin/target-initdconfig --add $$s || echo "Unable to enable initd service: $$s" ; \
		done && \
		rm *rpmsave 2>/dev/null || true
endef

$(DEPDIR)/min-filesystem $(DEPDIR)/std-filesystem $(DEPDIR)/max-filesystem \
$(DEPDIR)/filesystem: \
$(DEPDIR)/%filesystem: bootstrap-cross
	$(INSTALL) -d $(targetprefix)/{bin,boot,dev,dev.static,etc,home,lib,mnt,opt,proc,root,sbin,sys,tmp,usr,var}
	$(INSTALL) -d $(targetprefix)/etc/{default,opt}
	$(INSTALL) -d $(targetprefix)/usr/{bin,include,lib,local,sbin,share,src}
	$(INSTALL) -d $(targetprefix)/usr/lib/X11
	$(INSTALL) -d $(targetprefix)/usr/local/{bin,include,lib,man,sbin,share,src}
	$(INSTALL) -d $(targetprefix)/usr/local/man/{man1,man2,man3,man4,man5,man6,man7,man8}
	$(INSTALL) -d $(targetprefix)/usr/share/{aclocal,doc,info,locale,man,misc,nls}
	$(INSTALL) -d $(targetprefix)/usr/share/man/{man0p,man1,man1p,man2,man3,man3p,man4,man5,man6,man7,man8,man9}
	$(INSTALL) -d $(targetprefix)/var/{backups,cache,lib,local,lock,log,mail,opt,run,spool}
	ln -s /tmp $(targetprefix)/var/tmp
	$(INSTALL) -d $(targetprefix)/var/lib/misc
	$(INSTALL) -d $(targetprefix)/var/lock/subsys
#	$(LN_S) ../mail $(targetprefix)/var/spool/mail
	ln -sf ../mail $(targetprefix)/var/spool/mail
	$(INSTALL) -d $(targetprefix)/etc/{init.d,rc.d}
	$(INSTALL) -d $(targetprefix)/etc/rc.d/{rc3.d,rcS.d}
	ln -s ../init.d $(targetprefix)/etc/rc.d/init.d
	$(INSTALL) -d $(targetprefix)/jffs
	$(INSTALL) -d $(targetprefix)/media
#	$(INSTALL) -d $(targetprefix)/include
	$(INSTALL) -d $(targetprefix)/ram
	$(INSTALL) -d $(targetprefix)/rom
#	$(INSTALL) -d $(targetprefix)/share/{doc,info,locale,man,misc,nls}
	$(INSTALL) -d $(targetprefix)/srv
	$(INSTALL) -d $(targetprefix)/srv/www
	$(INSTALL) -d $(targetprefix)/var/bin
	[ "x$*" = "x" ] && touch $@ || true

$(GLIBC_RPM) $(GLIBC_DEV_RPM): \
		$(if $(GLIBC_SPEC_PATCH),Patches/$(GLIBC_SPEC_PATCH)) \
		$(if $(GLIBC_PATCHES),$(GLIBC_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(GLIBC)-$(GLIBC_VERSION).src.rpm \
		| filesystem
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(GLIBC_SPEC_PATCH),( cd SPECS && patch -p1 $(GLIBC_SPEC) < ../Patches/$(GLIBC_SPEC_PATCH) ) &&) \
	$(if $(GLIBC_PATCHES),cp $(GLIBC_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --nodeps --target=sh4-linux SPECS/$(GLIBC_SPEC)

$(DEPDIR)/min-$(GLIBC) $(DEPDIR)/std-$(GLIBC) $(DEPDIR)/max-$(GLIBC) \
$(DEPDIR)/$(GLIBC): \
$(DEPDIR)/%$(GLIBC): $(GLIBC_RPM) | $(DEPDIR)/%filesystem
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps  -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true

$(DEPDIR)/min-$(GLIBC_DEV) $(DEPDIR)/std-$(GLIBC_DEV) $(DEPDIR)/max-$(GLIBC_DEV) \
$(DEPDIR)/$(GLIBC_DEV): \
$(DEPDIR)/%$(GLIBC_DEV): $(DEPDIR)/%$(GLIBC) $(GLIBC_DEV_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true

#Wrote: RPMS/sh4/stlinux23-sh4-glibc-prof-2.5-27.sh4.rpm
#Wrote: RPMS/sh4/stlinux23-sh4-glibc-locales-2.5-27.sh4.rpm
#Wrote: RPMS/sh4/stlinux23-sh4-glibc-i18ndata-2.5-27.sh4.rpm
#Wrote: RPMS/sh4/stlinux23-sh4-glibc-nscd-2.5-27.sh4.rpm
#Wrote: RPMS/sh4/stlinux23-sh4-glibc-doc-2.5-27.sh4.rpm

flash-glibc: $(flashprefix)/root/lib/libc-$(GLIBC_RAWVERSION).so

$(flashprefix)/root/lib/libc-$(GLIBC_RAWVERSION).so: $(GLIBC_RPM)
	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps  -Uhv \
		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^)
	touch $@
	@FLASHROOTDIR_MODIFIED@

@STM22_FALSE@$(GMP_RPM): \
@STM22_FALSE@		$(addprefix Patches/,$(GMP_SPEC_PATCH) $(GMP_PATCHES)) \
@STM22_FALSE@		Archive/$(STLINUX:%23=%24)-target-$(GMP)-$(GMP_VERSION).src.rpm
@STM22_FALSE@	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM22_FALSE@	$(if $(GMP_SPEC_PATCH),( cd SPECS && patch -p1 $(GMP_SPEC) < ../Patches/$(GMP_SPEC_PATCH) ) &&) \
@STM22_FALSE@	$(if $(GMP_PATCHES),cp $(addprefix Patches/,$(GMP_PATCHES)) SOURCES/ &&) \
@STM22_FALSE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM22_FALSE@	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(GMP_SPEC)

@STM22_FALSE@$(DEPDIR)/$(GMP): $(GMP_RPM)
@STM22_FALSE@	@rpm $(DRPM) --ignorearch --nodeps -Uhv $(lastword $^) && \
@STM22_FALSE@	sed -i "/^libdir/s|'/usr/lib'|'$(targetprefix)/usr/lib'|" $(targetprefix)/usr/lib/libgmp.la
@STM22_FALSE@	sed -i "/^dependency_libs/s|-L/usr/lib -L/lib ||" $(targetprefix)/usr/lib/libgmp.la
@STM22_FALSE@	touch $@

@STM22_FALSE@$(MPFR_RPM): \
@STM22_FALSE@		$(GMP) \
@STM22_FALSE@		$(addprefix Patches/,$(MPFR_SPEC_PATCH) $(MPFR_PATCHES)) \
@STM22_FALSE@		Archive/$(STLINUX:%23=%24)-target-$(MPFR)-$(MPFR_VERSION).src.rpm
@STM22_FALSE@	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM22_FALSE@	$(if $(MPFR_SPEC_PATCH),( cd SPECS && patch -p1 $(MPFR_SPEC) < ../Patches/$(MPFR_SPEC_PATCH) ) &&) \
@STM22_FALSE@	$(if $(MPFR_PATCHES),cp $(addprefix Patches/,$(MPFR_PATCHES)) SOURCES/ &&) \
@STM22_FALSE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM22_FALSE@	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(MPFR_SPEC)

@STM22_FALSE@$(DEPDIR)/$(MPFR): $(MPFR_RPM)
@STM22_FALSE@	@rpm $(DRPM) --ignorearch --nodeps -Uhv $(lastword $^) && \
@STM22_FALSE@	sed -i "/^libdir/s|'/usr/lib'|'$(targetprefix)/usr/lib'|" $(targetprefix)/usr/lib/libmpfr.la
@STM22_FALSE@	sed -i "/^dependency_libs/s|-L/usr/lib -L/lib ||" $(targetprefix)/usr/lib/libmpfr.la
@STM22_FALSE@	touch .deps/$(notdir $@)

@STM24_TRUE@$(MPC_RPM): \
@STM24_TRUE@		$(MPFR) \
@STM24_TRUE@		$(addprefix Patches/,$(MPC_SPEC_PATCH) $(MPC_PATCHES)) \
@STM24_TRUE@		Archive/$(STLINUX:%23=%24)-target-$(MPC)-$(MPC_VERSION).src.rpm
@STM24_TRUE@	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM24_TRUE@	$(if $(MPC_SPEC_PATCH),( cd SPECS && patch -p1 $(MPC_SPEC) < ../Patches/$(MPC_SPEC_PATCH) ) &&) \
@STM24_TRUE@	$(if $(MPC_PATCHES),cp $(addprefix Patches/,$(MPC_PATCHES)) SOURCES/ &&) \
@STM24_TRUE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM24_TRUE@	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(MPC_SPEC)

@STM24_TRUE@$(DEPDIR)/$(MPC): $(MPC_RPM)
@STM24_TRUE@	@rpm $(DRPM) --ignorearch --nodeps -Uhv $(lastword $^) && \
@STM24_TRUE@	sed -i "/^libdir/s|'/usr/lib'|'$(targetprefix)/usr/lib'|" $(targetprefix)/usr/lib/libmpc.la
@STM24_TRUE@	sed -i "/^dependency_libs/s|-L/usr/lib -L/lib ||" $(targetprefix)/usr/lib/libmpc.la
@STM24_TRUE@	touch $@

@STM24_TRUE@$(LIBELF_RPM): \
@STM24_TRUE@		$(addprefix Patches/,$(LIBELF_SPEC_PATCH) $(LIBELF_PATCHES)) \
@STM24_TRUE@		Archive/$(STLINUX:%23=%24)-target-$(LIBELF)-$(LIBELF_VERSION).src.rpm
@STM24_TRUE@	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM24_TRUE@	$(if $(LIBELF_SPEC_PATCH),( cd SPECS && patch -p1 $(LIBELF_SPEC) < ../Patches/$(LIBELF_SPEC_PATCH) ) &&) \
@STM24_TRUE@	$(if $(LIBELF_PATCHES),cp $(addprefix Patches/,$(LIBELF_PATCHES)) SOURCES/ &&) \
@STM24_TRUE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM24_TRUE@	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(LIBELF_SPEC)

@STM24_TRUE@$(DEPDIR)/$(LIBELF): $(LIBELF_RPM)
@STM24_TRUE@	@rpm $(DRPM) --ignorearch --nodeps -Uhv $(lastword $^) && \
@STM24_TRUE@	touch $@

$(GCC_RPM) $(LIBSTDC_RPM) $(LIBSTDC_DEV_RPM) $(LIBGCC_RPM): \
		$(addprefix Patches/,$(GCC_SPEC_PATCH) $(GCC_PATCHES)) \
		Archive/$(STLINUX:%23=%24)-target-$(GCC)-$(GCC_VERSION).src.rpm \
		| $(DEPDIR)/$(GLIBC_DEV) $(MPFR) $(MPC) $(LIBELF)
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(GCC_SPEC_PATCH),( cd SPECS && patch -p1 $(GCC_SPEC) < ../Patches/$(GCC_SPEC_PATCH) ) &&) \
	$(if $(GCC_PATCHES),cp $(addprefix Patches/,$(GCC_PATCHES)) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb --clean --target=sh4-linux SPECS/$(GCC_SPEC)

$(DEPDIR)/min-$(GCC) $(DEPDIR)/std-$(GCC) $(DEPDIR)/max-$(GCC) $(DEPDIR)/$(GCC): \
$(DEPDIR)/%$(GCC): $(DEPDIR)/%$(GLIBC_DEV) $(GCC_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true

$(DEPDIR)/min-$(LIBSTDC) $(DEPDIR)/std-$(LIBSTDC) $(DEPDIR)/max-$(LIBSTDC) $(DEPDIR)/$(LIBSTDC): \
$(DEPDIR)/%$(LIBSTDC): $(DEPDIR)/%$(CROSS_LIBGCC) $(LIBSTDC_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true

$(DEPDIR)/min-$(LIBSTDC_DEV) $(DEPDIR)/std-$(LIBSTDC_DEV) $(DEPDIR)/max-$(LIBSTDC_DEV) $(DEPDIR)/$(LIBSTDC_DEV): \
$(DEPDIR)/%$(LIBSTDC_DEV): $(DEPDIR)/%$(LIBSTDC) $(LIBSTDC_DEV_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true
	sed -i "/^libdir/s|'/usr/lib'|'$(targetprefix)/usr/lib'|" $(targetprefix)/usr/lib/lib{std,sup}c++.la
	sed -i "/^dependency_libs/s|-L/usr/lib -L/lib ||" $(targetprefix)/usr/lib/lib{std,sup}c++.la

$(DEPDIR)/min-$(LIBGCC) $(DEPDIR)/std-$(LIBGCC) $(DEPDIR)/max-$(LIBGCC) $(DEPDIR)/$(LIBGCC): \
$(DEPDIR)/%$(LIBGCC): $(LIBGCC_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true

$(LIBTERMCAP_RPM) $(LIBTERMCAP_DEV_RPM) $(LIBTERMCAP_DOC_RPM): \
		$(if $(LIBTERMCAP_SPEC_PATCH),Patches/$(LIBTERMCAP_SPEC_PATCH)) \
		$(if $(LIBTERMCAP_PATCHES),$(LIBTERMCAP_PATCHES:%=Patches/%)) \
		Archive/$(STM_SRC)-target-$(LIBTERMCAP)-$(LIBTERMCAP_VERSION).src.rpm \
		| $(DEPDIR)/$(GLIBC_DEV)
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(LIBTERMCAP_SPEC_PATCH),( cd SPECS && patch -p1 $(LIBTERMCAP_SPEC) < ../Patches/$(LIBTERMCAP_SPEC_PATCH) ) &&) \
	$(if $(LIBTERMCAP_PATCHES),cp $(LIBTERMCAP_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(LIBTERMCAP_SPEC)

$(DEPDIR)/min-$(LIBTERMCAP) $(DEPDIR)/std-$(LIBTERMCAP) $(DEPDIR)/max-$(LIBTERMCAP) \
$(DEPDIR)/$(LIBTERMCAP): \
$(DEPDIR)/%$(LIBTERMCAP): bootstrap $(LIBTERMCAP_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	ln -sf libtermcap.so.2 $(prefix)/$*cdkroot/usr/lib/libtermcap.so && \
	$(INSTALL) -m 644 $(buildprefix)/root/etc/termcap $(prefix)/$*cdkroot/etc && \
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/min-$(LIBTERMCAP_DEV) $(DEPDIR)/std-$(LIBTERMCAP_DEV) $(DEPDIR)/max-$(LIBTERMCAP_DEV) \
$(DEPDIR)/$(LIBTERMCAP_DEV): \
$(DEPDIR)/%$(LIBTERMCAP_DEV): $(DEPDIR)/%$(LIBTERMCAP) $(LIBTERMCAP_DEV_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/min-$(LIBTERMCAP_DOC) $(DEPDIR)/std-$(LIBTERMCAP_DOC) $(DEPDIR)/max-$(LIBTERMCAP_DOC) \
$(DEPDIR)/$(LIBTERMCAP_DOC): \
$(DEPDIR)/%$(LIBTERMCAP_DOC): $(LIBTERMCAP_DOC_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-libtermcap: $(flashprefix)/root/usr/lib/libtermcap.so.$(LIBTERMCAP_RAWVERSION)

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/lib/libtermcap.so.$(LIBTERMCAP_RAWVERSION): $(NCURSES) $(LIBTERMCAP_RPM)
@TARGETRULESET_FLASH_TRUE@	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps  -Uhv \
@TARGETRULESET_FLASH_TRUE@		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^)
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -m 644 $(buildprefix)/root/etc/termcap $(flashprefix)/root/etc && \
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

$(DEPDIR)/ncurses.do_compile \
$(NCURSES_RPM) $(NCURSES_BASE_RPM) $(NCURSES_DEV_RPM): \
		$(if $(NCURSES_SPEC_PATCH),Patches/$(NCURSES_SPEC_PATCH)) \
		$(if $(NCURSES_PATCHES),$(NCURSES_PATCHES:%=Patches/%)) \
		Archive/$(STM_SRC)-target-$(NCURSES)-$(NCURSES_VERSION).src.rpm \
		| $(DEPDIR)/$(LIBSTDC_DEV)
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(NCURSES_SPEC_PATCH),( cd SPECS && patch -p1 $(NCURSES_SPEC) < ../Patches/$(NCURSES_SPEC_PATCH) ) &&) \
	$(if $(NCURSES_PATCHES),cp $(NCURSES_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(NCURSES_SPEC)
	touch $(DEPDIR)/ncurses.do_compile

$(DEPDIR)/min-$(NCURSES_BASE) $(DEPDIR)/std-$(NCURSES_BASE) $(DEPDIR)/max-$(NCURSES_BASE) \
$(DEPDIR)/$(NCURSES_BASE): \
$(DEPDIR)/%$(NCURSES_BASE): $(NCURSES_BASE_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $<)
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/min-$(NCURSES) $(DEPDIR)/std-$(NCURSES) $(DEPDIR)/max-$(NCURSES) \
$(DEPDIR)/$(NCURSES): \
$(DEPDIR)/%$(NCURSES): $(DEPDIR)/%$(NCURSES_BASE) $(NCURSES_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/min-$(NCURSES_DEV) $(DEPDIR)/std-$(NCURSES_DEV) $(DEPDIR)/max-$(NCURSES_DEV) \
$(DEPDIR)/$(NCURSES_DEV): \
$(DEPDIR)/%$(NCURSES_DEV): $(DEPDIR)/%$(NCURSES_BASE) $(NCURSES_DEV_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# Evaluate packages
$(eval $(call Packages,ncurses))

$(BASE_PASSWD_RPM): \
		$(if $(BASE_PASSWD_SPEC_PATCH),Patches/$(BASE_PASSWD_SPEC_PATCH)) \
		$(if $(BASE_PASSWD_PATCHES),$(BASE_PASSWD_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(BASE_PASSWD)-$(BASE_PASSWD_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(BASE_PASSWD_SPEC_PATCH),( cd SPECS && patch -p1 $(BASE_PASSWD_SPEC) < ../Patches/$(BASE_PASSWD_SPEC_PATCH) ) &&) \
	$(if $(BASE_PASSWD_PATCHES),cp $(BASE_PASSWD_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(BASE_PASSWD_SPEC)

$(DEPDIR)/min-$(BASE_PASSWD) $(DEPDIR)/std-$(BASE_PASSWD) $(DEPDIR)/max-$(BASE_PASSWD) \
$(DEPDIR)/$(BASE_PASSWD): \
$(DEPDIR)/%$(BASE_PASSWD): $(BASE_FILES_ADAPTED_ETC_FILES:%=root/etc/%) \
		$(BASE_PASSWD_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps  --nopost -Uhv \
		--replacepkgs --badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
        $(hostprefix)/bin/update-passwd -L -p $(prefix)/$*cdkroot/usr/share/base-passwd/passwd.master \
               	-g $(prefix)/$*cdkroot/usr/share/base-passwd/group.master -P $(prefix)/$*cdkroot/etc/passwd \
               	-S $(prefix)/$*cdkroot/etc/shadow -G $(prefix)/$*cdkroot/etc/group && \
	chmod 600 $(prefix)/$*cdkroot/etc/shadow && \
	( cd $(prefix)/$*cdkroot/etc && sed -e "s|/bin/bash|/bin/sh|g" -i passwd ) && \
	rm -f $(prefix)/$*cdkroot/etc/shadow
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-base-passwd: $(flashprefix)/root/usr/sbin/update-passwd

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/sbin/update-passwd: \
@TARGETRULESET_FLASH_TRUE@		$(BASE_PASSWD_RPM)
@TARGETRULESET_FLASH_TRUE@	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps --nopost -Uhv \
@TARGETRULESET_FLASH_TRUE@		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^) && \
@TARGETRULESET_FLASH_TRUE@        $(hostprefix)/bin/update-passwd -L -p $(flashprefix)/root/usr/share/base-passwd/passwd.master \
@TARGETRULESET_FLASH_TRUE@               	-g $(flashprefix)/root/usr/share/base-passwd/group.master -P $(flashprefix)/root/etc/passwd \
@TARGETRULESET_FLASH_TRUE@               	-S $(flashprefix)/root/etc/shadow -G $(flashprefix)/root/etc/group && \
@TARGETRULESET_FLASH_TRUE@	chmod 600 $(flashprefix)/root/etc/shadow && \
@TARGETRULESET_FLASH_TRUE@	( cd $(flashprefix)/root/etc && sed -e "s|/bin/bash|/bin/sh|g" -i passwd )
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

$(MAKEDEV_RPM): \
		$(if $(MAKEDEV_SPEC_PATCH),Patches/$(MAKEDEV_SPEC_PATCH)) \
		$(if $(MAKEDEV_PATCHES),$(MAKEDEV_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(MAKEDEV)-$(MAKEDEV_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(MAKEDEV_SPEC_PATCH),( cd SPECS && patch -p1 $(MAKEDEV_SPEC) < ../Patches/$(MAKEDEV_SPEC_PATCH) ) &&) \
	$(if $(MAKEDEV_PATCHES),cp $(MAKEDEV_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(MAKEDEV_SPEC)

$(DEPDIR)/min-$(MAKEDEV) $(DEPDIR)/std-$(MAKEDEV) $(DEPDIR)/max-$(MAKEDEV) \
$(DEPDIR)/$(MAKEDEV): \
$(DEPDIR)/%$(MAKEDEV): root/sbin/MAKEDEV $(MAKEDEV_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps --nopost -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	$(INSTALL) -m 755 root/sbin/MAKEDEV $(prefix)/$*cdkroot/sbin
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@
	$(INSTALL) -m 755 root/sbin/MAKEDEV_no_CI $(prefix)/$*cdkroot/sbin
	$(INSTALL) -m 755 root/sbin/MAKEDEV_dual_tuner $(prefix)/$*cdkroot/sbin
	$(INSTALL) -m 755 root/sbin/MAKEDEV_adb_box $(prefix)/$*cdkroot/sbin

@TARGETRULESET_FLASH_TRUE@flash-makedev: $(flashprefix)/root/sbin/MAKEDEV

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/sbin/MAKEDEV: root/sbin/MAKEDEV $(MAKEDEV_RPM)
@TARGETRULESET_FLASH_TRUE@	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps --nopost -Uhv \
@TARGETRULESET_FLASH_TRUE@		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^) && \
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -m 755 root/sbin/MAKEDEV_flash $(flashprefix)/root/sbin/MAKEDEV
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

$(BASE_FILES_RPM): \
		$(if $(BASE_FILES_SPEC_PATCH),Patches/$(BASE_FILES_SPEC_PATCH)) \
		$(if $(BASE_FILES_PATCHES),$(BASE_FILES_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(BASE_FILES)-$(BASE_FILES_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(BASE_FILES_SPEC_PATCH),( cd SPECS && patch -p1 $(BASE_FILES_SPEC) < ../Patches/$(BASE_FILES_SPEC_PATCH) ) &&) \
	$(if $(BASE_FILES_PATCHES),cp $(BASE_FILES_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(BASE_FILES_SPEC)

$(DEPDIR)/min-$(BASE_FILES) $(DEPDIR)/std-$(BASE_FILES) $(DEPDIR)/max-$(BASE_FILES) $(DEPDIR)/$(BASE_FILES): \
$(DEPDIR)/%$(BASE_FILES): $(BASE_FILES_ADAPTED_ETC_FILES:%=root/etc/%) \
		$(BASE_FILES_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  -Uhv \
		--replacepkgs --badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	( cd root/etc && for i in $(BASE_FILES_ADAPTED_ETC_FILES); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(prefix)/$*cdkroot/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(prefix)/$*cdkroot/etc/$$i || true; done ) && \
	echo "proc          /proc               proc    defaults                        0 0" >> $(prefix)/$*cdkroot/etc/fstab && \
	echo "tmpfs         /tmp                tmpfs   defaults                        0 0" >> $(prefix)/$*cdkroot/etc/fstab && \
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-base-files: $(flashprefix)/root/etc/fstab

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/etc/fstab: $(BASE_FILES_ADAPTED_ETC_FILES:%=root/etc/%) \
@TARGETRULESET_FLASH_TRUE@		$(BASEFILES_RPM)
@TARGETRULESET_FLASH_TRUE@	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps  -Uhv \
@TARGETRULESET_FLASH_TRUE@		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^) && \
@TARGETRULESET_FLASH_TRUE@	( cd root/etc && for i in $(BASE_FILES_ADAPTED_ETC_FILES); do \
@TARGETRULESET_FLASH_TRUE@		[ -f $$i ] && $(INSTALL) -m644 $$i $(flashprefix)/root/etc/$$i || true; done ) && \
@TARGETRULESET_FLASH_TRUE@	echo "proc          /proc               proc    defaults                        0 0" >> $(flashprefix)/root/etc/fstab && \
@TARGETRULESET_FLASH_TRUE@	echo "tmpfs         /tmp                tmpfs   defaults                        0 0" >> $(flashprefix)/root/etc/fstab && \
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

$(UDEV_RPM): \
		$(if $(UDEV_SPEC_PATCH),Patches/$(UDEV_SPEC_PATCH)) \
		$(if $(UDEV_PATCHES),$(UDEV_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(UDEV)-$(UDEV_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(UDEV_SPEC_PATCH),( cd SPECS && patch -p1 $(UDEV_SPEC) < ../Patches/$(UDEV_SPEC_PATCH) ) &&) \
	$(if $(UDEV_PATCHES),cp $(UDEV_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(UDEV_SPEC)

$(DEPDIR)/min-$(UDEV) $(DEPDIR)/std-$(UDEV) $(DEPDIR)/max-$(UDEV) $(DEPDIR)/$(UDEV): \
$(DEPDIR)/%$(UDEV): $(UDEV_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps --noscripts -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
		for s in sysfs udev ; do \
			$(hostprefix)/bin/target-initdconfig --add $$s || \
			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true )
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@STM22_TRUE@$(HOTPLUG_RPM): \
@STM22_TRUE@		$(if $(HOTPLUG_SPEC_PATCH),Patches/$(HOTPLUG_SPEC_PATCH)) \
@STM22_TRUE@		$(if $(HOTPLUG_PATCHES),$(HOTPLUG_PATCHES:%=Patches/%)) \
@STM22_TRUE@		Archive/$(STLINUX)-target-$(HOTPLUG)-$(HOTPLUG_VERSION).src.rpm
@STM22_TRUE@	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM22_TRUE@	$(if $(HOTPLUG_SPEC_PATCH),( cd SPECS && patch -p1 $(HOTPLUG_SPEC) < ../Patches/$(HOTPLUG_SPEC_PATCH) ) &&) \
@STM22_TRUE@	$(if $(HOTPLUG_PATCHES),cp $(HOTPLUG_PATCHES:%=Patches/%) SOURCES/ &&) \
@STM22_TRUE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM22_TRUE@	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(HOTPLUG_SPEC)

@STM22_TRUE@$(DEPDIR)/min-$(HOTPLUG) $(DEPDIR)/std-$(HOTPLUG) $(DEPDIR)/max-$(HOTPLUG) $(DEPDIR)/$(HOTPLUG): \
@STM22_TRUE@$(DEPDIR)/%$(HOTPLUG): $(HOTPLUG_RPM)
@STM22_TRUE@	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps --noscripts -Uhv \
@STM22_TRUE@		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
@STM22_TRUE@	( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
@STM22_TRUE@		for s in hotplug ; do \
@STM22_TRUE@			$(hostprefix)/bin/target-initdconfig --add $$s || \
@STM22_TRUE@			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true )
@STM22_TRUE@	[ "x$*" = "x" ] && touch $@ || true
@STM22_TRUE@	@TUXBOX_YAUD_CUSTOMIZE@

@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@flash-hotplug: $(flashprefix)/root/sbin/hotplug

@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/sbin/hotplug: $(HOTPLUG_RPM)
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps --nopost -Uhv \
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^) && \
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	touch $@
@STM22_TRUE@@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

############ Patches Havana End ###############

#
# KERNEL-HEADERS
#
$(DEPDIR)/kernel-headers: linux-kernel.do_prepare
	cd $(KERNEL_DIR) && \
		$(INSTALL) -d $(targetprefix)/usr/include && \
		cp -a include/linux $(targetprefix)/usr/include && \
		cp -a include/asm-sh $(targetprefix)/usr/include/asm && \
		cp -a include/asm-generic $(targetprefix)/usr/include && \
		cp -a include/mtd $(targetprefix)/usr/include
	touch $@

@STM22_FALSE@$(KERNELHEADERS_RPM): \
@STM22_FALSE@		$(if $(KERNELHEADERS_SPEC_PATCH),Patches/$(KERNELHEADERS_SPEC_PATCH)) \
@STM22_FALSE@		$(if $(KERNELHEADERS_PATCHES),$(KERNELHEADERS_PATCHES:%=Patches/%)) \
@STM22_FALSE@		Archive/$(STLINUX)-target-$(KERNELHEADERS)-$(KERNELHEADERS_VERSION).src.rpm \
@STM22_FALSE@		| linux-kernel.do_prepare
@STM22_FALSE@	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM22_FALSE@	$(if $(KERNELHEADERS_SPEC_PATCH),( cd SPECS && patch -p1 $(KERNELHEADERS_SPEC) < ../Patches/$(KERNELHEADERS_SPEC_PATCH) ) &&) \
@STM22_FALSE@	$(if $(KERNELHEADERS_PATCHES),cp $(KERNELHEADERS_PATCHES:%=Patches/%) SOURCES/ &&) \
@STM22_FALSE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM22_FALSE@	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(KERNELHEADERS_SPEC)

@STM22_FALSE@$(DEPDIR)/max-$(KERNELHEADERS) \
@STM22_FALSE@$(DEPDIR)/$(KERNELHEADERS): \
@STM22_FALSE@$(DEPDIR)/%$(KERNELHEADERS): $(KERNELHEADERS_RPM)
@STM22_FALSE@	@rpm $(DRPM) --ignorearch --nodeps -Uhv \
@STM22_FALSE@		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
@STM22_FALSE@	touch $@

@ENABLE_HAVANA_P0207_5_TRUE@$(DEPDIR)/linux-kernel.do_prepare:
#close if necessary
@ENABLE_HAVANA_P0207_5_TRUE@	[ -d "$(KERNEL_DIR)" ] || \
@ENABLE_HAVANA_P0207_5_TRUE@	git clone git://git.stlinux.com/havana/com.st.havana.kernel.git $(KERNEL_DIR);
#reset and checkout everytime
@ENABLE_HAVANA_P0207_5_TRUE@	cd $(KERNEL_DIR) && \
@ENABLE_HAVANA_P0207_5_TRUE@	git reset --hard && \
@ENABLE_HAVANA_P0207_5_TRUE@	git checkout com.st.havana.kernel-$(GIT_STR);
#if not exist make a clean copy so we can make patches easier
@ENABLE_HAVANA_P0207_5_TRUE@	[ -d "$(KERNEL_DIR).orig" ] || \
@ENABLE_HAVANA_P0207_5_TRUE@	cp -ra $(KERNEL_DIR) $(KERNEL_DIR).orig
#if not exist create symlink
@ENABLE_HAVANA_P0207_5_TRUE@	[ -d "linux-sh4" ] || \
@ENABLE_HAVANA_P0207_5_TRUE@	ln -s $(KERNEL_DIR) linux-sh4
@ENABLE_HAVANA_P0207_5_TRUE@	$(if $(HAVANA_STM24_KERNEL_PATCHES),cd $(KERNEL_DIR) && cat $(HAVANA_STM24_KERNEL_PATCHES:%=../Patches/%) | patch -p1)
@ENABLE_HAVANA_P0207_5_TRUE@	$(INSTALL) -m644 Patches/$(HAVANA_STM24_KERNEL_CONFIG) $(KERNEL_DIR)/.config
@ENABLE_HAVANA_P0207_5_TRUE@	-rm $(KERNEL_DIR)/localversion*
@ENABLE_HAVANA_P0207_5_TRUE@	echo "$(KERNELSTMLABEL)" > $(KERNEL_DIR)/localversion-stm
@ENABLE_HAVANA_P0207_5_TRUE@	$(MAKE) -C $(KERNEL_DIR) ARCH=sh oldconfig
@ENABLE_HAVANA_P0207_5_TRUE@	$(MAKE) -C $(KERNEL_DIR) ARCH=sh include/asm
@ENABLE_HAVANA_P0207_5_TRUE@	$(MAKE) -C $(KERNEL_DIR) ARCH=sh include/linux/version.h
@ENABLE_HAVANA_P0207_5_TRUE@	rm $(KERNEL_DIR)/.config
@ENABLE_HAVANA_P0207_5_TRUE@	touch $@

@ENABLE_HAVANA_P0207_5_TRUE@$(DEPDIR)/linux-kernel.do_compile: \
@ENABLE_HAVANA_P0207_5_TRUE@		bootstrap-cross \
@ENABLE_HAVANA_P0207_5_TRUE@		linux-kernel.do_prepare \
@ENABLE_HAVANA_P0207_5_TRUE@		Patches/$(HAVANA_STM24_KERNEL_CONFIG) \
@ENABLE_HAVANA_P0207_5_TRUE@		config.status \
@ENABLE_HAVANA_P0207_5_TRUE@		| $(HOST_U_BOOT_TOOLS)
@ENABLE_HAVANA_P0207_5_TRUE@	-rm $(DEPDIR)/linux-kernel*.do_compile
@ENABLE_HAVANA_P0207_5_TRUE@	cd $(KERNEL_DIR) && \
@ENABLE_HAVANA_P0207_5_TRUE@		export PATH=$(hostprefix)/bin:$(PATH) && \
@ENABLE_HAVANA_P0207_5_TRUE@		$(MAKE) ARCH=sh CROSS_COMPILE=$(target)- mrproper && \
@ENABLE_HAVANA_P0207_5_TRUE@		@M4@ ../Patches/$(HAVANA_STM24_KERNEL_CONFIG) > .config && \
@ENABLE_HAVANA_P0207_5_TRUE@		$(MAKE) $(if $(TF7700),TF7700=y) ARCH=sh CROSS_COMPILE=$(target)- uImage modules
@ENABLE_HAVANA_P0207_5_TRUE@	touch $@

@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@$(DEPDIR)/linux-kernel.do_prepare:
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	rm -rf $(KERNEL_DIR)
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	git clone git://git.stlinux.com/havana/com.st.havana.kernel.git $(KERNEL_DIR);
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	$(INSTALL) -m644 Patches/mb618se_defconfig $(KERNEL_DIR)/.config
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	-rm $(KERNEL_DIR)/localversion*
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	echo "$(KERNELSTMLABEL)" > $(KERNEL_DIR)/localversion-stm
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	$(MAKE) -C $(KERNEL_DIR) ARCH=sh oldconfig
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	$(MAKE) -C $(KERNEL_DIR) ARCH=sh include/asm
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	$(MAKE) -C $(KERNEL_DIR) ARCH=sh include/linux/version.h
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	rm $(KERNEL_DIR)/.config
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	touch $@

@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@$(DEPDIR)/linux-kernel.do_compile: \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@		bootstrap-cross \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@		linux-kernel.do_prepare \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@		Patches/mb618se_defconfig \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@		config.status \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@		| $(HOST_U_BOOT_TOOLS)
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	-rm $(DEPDIR)/linux-kernel*.do_compile
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	cd $(KERNEL_DIR) && \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@		export PATH=$(hostprefix)/bin:$(PATH) && \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@		$(MAKE) ARCH=sh CROSS_COMPILE=$(target)- mrproper && \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@		@M4@ ../$(word 3,$^)	> .config && \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@		$(MAKE) $(if $(TF7700),TF7700=y) ARCH=sh CROSS_COMPILE=$(target)- uImage modules
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_TRUE@	touch $@

##################################################################################
#stlinux23

@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@$(HOST_KERNEL_RPM): \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		$(if $(HOST_KERNEL_SPEC_PATCH),Patches/$(HOST_KERNEL_SPEC_PATCH)) \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		Archive/$(HOST_KERNEL_SRC_RPM)
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	rpm $(DRPM) --nosignature --nodeps -Uhv $(lastword $^) && \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	$(if $(HOST_KERNEL_SPEC_PATCH),( cd SPECS; patch -p1 $(HOST_KERNEL_SPEC) < ../Patches/$(HOST_KERNEL_SPEC_PATCH) ) &&) \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	rpmbuild $(DRPMBUILD) -ba -v --clean --target=sh4-linux SPECS/$(HOST_KERNEL_SPEC)

@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@$(DEPDIR)/linux-kernel.do_prepare: \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		$(if $(HOST_KERNEL_PATCHES),$(HOST_KERNEL_PATCHES:%=Patches/%)) \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		$(HOST_KERNEL_RPM)
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	@rpm $(DRPM) -ev $(HOST_KERNEL_SRC_RPM:%.src.rpm=%) || true
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	rm -rf $(KERNEL_DIR)
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	rm -rf linux{,-sh4}
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	rpm $(DRPM) --ignorearch --nodeps -Uhv $(lastword $^)
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	$(if $(HOST_KERNEL_PATCHES),cd $(KERNEL_DIR) && cat $(HOST_KERNEL_PATCHES:%=../Patches/%) | patch -p1)
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	$(INSTALL) -m644 Patches/$(HOST_KERNEL_CONFIG) $(KERNEL_DIR)/.config
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	-rm $(KERNEL_DIR)/localversion*
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	echo "$(KERNELSTMLABEL)" > $(KERNEL_DIR)/localversion-stm
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	$(MAKE) -C $(KERNEL_DIR) ARCH=sh oldconfig
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	$(MAKE) -C $(KERNEL_DIR) ARCH=sh include/asm
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	$(MAKE) -C $(KERNEL_DIR) ARCH=sh include/linux/version.h
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	rm $(KERNEL_DIR)/.config
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	touch $@

#dagobert: without stboard ->not sure if we need this
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@$(DEPDIR)/linux-kernel.do_compile: \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		bootstrap-cross \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		linux-kernel.do_prepare \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		Patches/$(HOST_KERNEL_CONFIG) \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		config.status \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		| $(HOST_U_BOOT_TOOLS)
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	-rm $(DEPDIR)/linux-kernel*.do_compile
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	cd $(KERNEL_DIR) && \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		export PATH=$(hostprefix)/bin:$(PATH) && \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		$(MAKE) ARCH=sh CROSS_COMPILE=$(target)- mrproper && \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		@M4@ ../Patches/$(HOST_KERNEL_CONFIG) > .config && \
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@		$(MAKE) $(if $(TF7700),TF7700=y) ARCH=sh CROSS_COMPILE=$(target)- uImage modules
@ENABLE_HAVANA_P0207_5_FALSE@@STM23_HAVANA_FALSE@	touch $@

$(DEPDIR)/linux-kernel.cramfs.do_compile $(DEPDIR)/linux-kernel.squashfs.do_compile \
$(DEPDIR)/linux-kernel.jffs2.do_compile $(DEPDIR)/linux-kernel.usb.do_compile \
$(DEPDIR)/linux-kernel.focramfs.do_compile $(DEPDIR)/linux-kernel.fosquashfs.do_compile:
$(DEPDIR)/linux-kernel.%.do_compile: \
		bootstrap-cross \
		linux-kernel.do_prepare \
		Patches/linux-sh4-$(KERNELVERSION).stboards.c.m4 \
		Patches/$(HOST_KERNEL_CONFIG) \
		config.status \
		| $(DEPDIR)/$(HOST_U_BOOT_TOOLS)
	-rm $(DEPDIR)/linux-kernel*.do_compile
	cd $(KERNEL_DIR) && \
		export PATH=$(hostprefix)/bin:$(PATH) && \
		$(MAKE) ARCH=sh CROSS_COMPILE=$(target)- mrproper && \
		@M4@ -Drootfs=$* --define=rootsize=$(ROOT_PARTITION_SIZE) --define=datasize=$(DATA_PARTITION_SIZE) ../$(word 3,$^) \
					> drivers/mtd/maps/stboards.c && \
		@M4@ --define=btldrdef=$* ../Patches/$(HOST_KERNEL_CONFIG) \
					> .config && \
		sed $(NFS_FLASH_SED_CONF) -i .config && \
		sed $(XFS_SED_CONF) $(NFSSERVER_SED_CONF) $(NTFS_SED_CONF) -i .config && \
		$(MAKE) ARCH=sh CROSS_COMPILE=$(target)- uImage modules
	touch $@

$(DEPDIR)/min-linux-kernel $(DEPDIR)/std-linux-kernel $(DEPDIR)/max-linux-kernel \
$(DEPDIR)/linux-kernel: \
$(DEPDIR)/%linux-kernel: bootstrap $(DEPDIR)/linux-kernel.do_compile
	@$(INSTALL) -d $(prefix)/$*cdkroot/boot && \
	$(INSTALL) -d $(prefix)/$*$(notdir $(bootprefix)) && \
	$(INSTALL) -m644 $(KERNEL_DIR)/arch/sh/boot/uImage $(prefix)/$*$(notdir $(bootprefix))/vmlinux.ub && \
	$(INSTALL) -m644 $(KERNEL_DIR)/vmlinux $(prefix)/$*cdkroot/boot/vmlinux-sh4-$(KERNELVERSION) && \
	$(INSTALL) -m644 $(KERNEL_DIR)/System.map $(prefix)/$*cdkroot/boot/System.map-sh4-$(KERNELVERSION) && \
	$(INSTALL) -m644 $(KERNEL_DIR)/COPYING $(prefix)/$*cdkroot/boot/LICENSE
	cp $(KERNEL_DIR)/arch/sh/boot/uImage $(prefix)/$*cdkroot/boot/
#if STM22
	echo -e "ST Linux Distribution - Binary Kernel\n \
	CPU: sh4\n \
	$(if $(FORTIS_HDBOX),PLATFORM: stb7109ref\n) \
	$(if $(ATEVIO7500),PLATFORM: stb7105ref\n) \
	$(if $(OCTAGON1008),PLATFORM: stb7109ref\n) \
	$(if $(UFS922),PLATFORM: stb7109ref\n) \
	$(if $(TF7700),PLATFORM: stb7109ref\n) \
	$(if $(HL101),PLATFORM: stb7109ref\n) \
	$(if $(VIP1_V2),PLATFORM: stb7109ref\n) \
	$(if $(VIP2_V1),PLATFORM: stb7109ref\n) \
	$(if $(UFS910),PLATFORM: stb7100ref\n) \
	$(if $(FLASH_UFS910),PLATFORM: stb7100ref\n) \
	$(if $(CUBEREVO),PLATFORM: stb7109ref\n) \
	$(if $(CUBEREVO_MINI),PLATFORM: stb7109ref\n) \
	$(if $(CUBEREVO_MINI2),PLATFORM: stb7109ref\n) \
	$(if $(CUBEREVO_MINI_FTA),PLATFORM: stb7109ref\n) \
	$(if $(CUBEREVO_250HD),PLATFORM: stb7109ref\n) \
	$(if $(CUBEREVO_2000HD),PLATFORM: stb7109ref\n) \
	$(if $(CUBEREVO_9500HD),PLATFORM: stb7109ref\n) \
	$(if $(HOMECAST5101),PLATFORM: stb7109ref\n) \
	$(if $(ADB_BOX),PLATFORM: stb7100ref\n) \
	$(if $(IPBOX9900),PLATFORM: stb7109ref\n) \
	$(if $(IPBOX99),PLATFORM: stb7109ref\n) \
	$(if $(IPBOX55),PLATFORM: stb7109ref\n) \
	KERNEL VERSION: $(KERNELVERSION)\n" > $(prefix)/$*cdkroot/README.ST && \
	$(MAKE) -C $(KERNEL_DIR) ARCH=sh INSTALL_MOD_PATH=$(prefix)/$*cdkroot modules_install && \
	rm $(prefix)/$*cdkroot/lib/modules/$(KERNELVERSION)/build || true && \
	rm $(prefix)/$*cdkroot/lib/modules/$(KERNELVERSION)/source || true
#else
#endif
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/driver: $(driverdir)/Makefile linux-kernel.do_compile
#	$(MAKE) -C $(KERNEL_DIR) $(MAKE_OPTS) ARCH=sh modules_prepare
	$(if $(PLAYER131),cp $(driverdir)/stgfb/stmfb/Linux/video/stmfb.h $(targetprefix)/usr/include/linux)
	$(if $(PLAYER179),cp $(driverdir)/stgfb/stmfb/linux/drivers/video/stmfb.h $(targetprefix)/usr/include/linux)
	$(if $(PLAYER191),cp $(driverdir)/stgfb/stmfb/linux/drivers/video/stmfb.h $(targetprefix)/usr/include/linux)
	$(if $(PLAYER191),cp $(driverdir)/stgfb/stmfb/linux/drivers/video/stmfb.h $(targetprefix)/usr/include/linux)
	cp $(driverdir)/player2/linux/include/linux/dvb/stm_ioctls.h $(targetprefix)/usr/include/linux/dvb
	$(MAKE) -C $(driverdir) ARCH=sh \
		KERNEL_LOCATION=$(buildprefix)/$(KERNEL_DIR) \
		$(if $(UFS910),UFS910=$(UFS910)) \
		$(if $(FLASH_UFS910),FLASH_UFS910=$(FLASH_UFS910)) \
		$(if $(FORTIS_HDBOX),FORTIS_HDBOX=$(FORTIS_HDBOX)) \
		$(if $(ATEVIO7500),ATEVIO7500=$(ATEVIO7500)) \
		$(if $(OCTAGON1008),OCTAGON1008=$(OCTAGON1008)) \
 		$(if $(HS7810A),HS7810A=$(HS7810A)) \
 		$(if $(HS7110),HS7110=$(HS7110)) \
		$(if $(TF7700),TF7700=$(TF7700)) \
		$(if $(HL101),HL101=$(HL101)) \
		$(if $(VIP1_V2),VIP1_V2=$(VIP1_V2)) \
		$(if $(VIP2_V1),VIP2_V1=$(VIP2_V1)) \
		$(if $(UFS922),UFS922=$(UFS922)) \
 		$(if $(UFS912),UFS912=$(UFS912)) \
 		$(if $(SPARK),SPARK=$(SPARK)) \
 		$(if $(SPARK7162),SPARK7162=$(SPARK7162)) \
		$(if $(ADB_BOX),ADB_BOX=$(ADB_BOX)) \
		$(if $(CUBEREVO),CUBEREVO=$(CUBEREVO)) \
		$(if $(CUBEREVO_MINI),CUBEREVO_MINI=$(CUBEREVO_MINI)) \
		$(if $(CUBEREVO_MINI2),CUBEREVO_MINI2=$(CUBEREVO_MINI2)) \
		$(if $(CUBEREVO_MINI_FTA),CUBEREVO_MINI_FTA=$(CUBEREVO_MINI_FTA)) \
		$(if $(CUBEREVO_250HD),CUBEREVO_250HD=$(CUBEREVO_250HD)) \
		$(if $(CUBEREVO_2000HD),CUBEREVO_2000HD=$(CUBEREVO_2000HD)) \
		$(if $(CUBEREVO_9500HD),CUBEREVO_9500HD=$(CUBEREVO_9500HD)) \
		$(if $(HOMECAST5101),HOMECAST5101=$(HOMECAST5101)) \
		$(if $(IPBOX9900),IPBOX9900=$(IPBOX9900)) \
		$(if $(IPBOX99),IPBOX99=$(IPBOX99)) \
		$(if $(IPBOX55),IPBOX55=$(IPBOX55)) \
		$(if $(PLAYER131),PLAYER131=$(PLAYER131)) \
		$(if $(PLAYER179),PLAYER179=$(PLAYER179)) \
		$(if $(PLAYER191),PLAYER191=$(PLAYER191)) \
		$(if $(HAVANA_P0207_5),HAVANA_P0207_5=$(HAVANA_P0207_5)) \
		CROSS_COMPILE=$(target)-
	$(MAKE) -C $(driverdir) ARCH=sh \
		KERNEL_LOCATION=$(buildprefix)/$(KERNEL_DIR) \
		BIN_DEST=$(targetprefix)/bin \
		INSTALL_MOD_PATH=$(targetprefix) \
		$(if $(UFS910),UFS910=$(UFS910)) \
		$(if $(FLASH_UFS910),FLASH_UFS910=$(FLASH_UFS910)) \
		$(if $(FORTIS_HDBOX),FORTIS_HDBOX=$(FORTIS_HDBOX)) \
		$(if $(ATEVIO7500),ATEVIO7500=$(ATEVIO7500)) \
		$(if $(OCTAGON1008),OCTAGON1008=$(OCTAGON1008)) \
 		$(if $(HS7810A),HS7810A=$(HS7810A)) \
 		$(if $(HS7110),HS7110=$(HS7110)) \
		$(if $(TF7700),TF7700=$(TF7700)) \
		$(if $(HL101),HL101=$(HL101)) \
		$(if $(VIP1_V2),VIP1_V2=$(VIP1_V2)) \
		$(if $(VIP2_V1),VIP2_V1=$(VIP2_V1)) \
		$(if $(UFS922),UFS922=$(UFS922)) \
 		$(if $(UFS912),UFS912=$(UFS912)) \
 		$(if $(SPARK),SPARK=$(SPARK)) \
 		$(if $(SPARK7162),SPARK7162=$(SPARK7162)) \
		$(if $(ADB_BOX),ADB_BOX=$(ADB_BOX)) \
		$(if $(CUBEREVO),CUBEREVO=$(CUBEREVO)) \
		$(if $(CUBEREVO_MINI),CUBEREVO_MINI=$(CUBEREVO_MINI)) \
		$(if $(CUBEREVO_MINI2),CUBEREVO_MINI2=$(CUBEREVO_MINI2)) \
		$(if $(CUBEREVO_MINI_FTA),CUBEREVO_MINI_FTA=$(CUBEREVO_MINI_FTA)) \
		$(if $(CUBEREVO_250HD),CUBEREVO_250HD=$(CUBEREVO_250HD)) \
		$(if $(CUBEREVO_2000HD),CUBEREVO_2000HD=$(CUBEREVO_2000HD)) \
		$(if $(CUBEREVO_9500HD),CUBEREVO_9500HD=$(CUBEREVO_9500HD)) \
		$(if $(HOMECAST5101),HOMECAST5101=$(HOMECAST5101)) \
		$(if $(IPBOX9900),IPBOX9900=$(IPBOX9900)) \
		$(if $(IPBOX99),IPBOX99=$(IPBOX99)) \
		$(if $(IPBOX55),IPBOX55=$(IPBOX55)) \
		$(if $(PLAYER131),PLAYER131=$(PLAYER131)) \
		$(if $(PLAYER179),PLAYER179=$(PLAYER179)) \
		$(if $(PLAYER191),PLAYER191=$(PLAYER191)) \
		$(if $(HAVANA_P0207_5),HAVANA_P0207_5=$(HAVANA_P0207_5)) \
		install
	$(DEPMOD) -ae -b $(targetprefix) -F $(buildprefix)/$(KERNEL_DIR)/System.map -r $(KERNELVERSION)
	touch $@
	@TUXBOX_YAUD_CUSTOMIZE@

driver-clean:
	rm -f $(DEPDIR)/driver
	$(MAKE) -C $(driverdir) ARCH=sh \
		KERNEL_LOCATION=$(buildprefix)/$(KERNEL_DIR) \
		distclean

#------------------- Helper

linux-kernel.menuconfig linux-kernel.xconfig: \
linux-kernel.%:
	$(MAKE) -C $(KERNEL_DIR) ARCH=sh CROSS_COMPILE=sh4-linux- $*
	@echo
	@echo "You have to edit m a n u a l l y Patches/linux-$(KERNELVERSION).config to make changes permanent !!!"
	@echo ""
	diff linux/.config.old linux/.config

#-------------------

$(flashprefix)/root-cramfs/lib \
$(flashprefix)/root-squashfs/lib \
$(flashprefix)/root-jffs2/lib \
$(flashprefix)/root-usb/lib \
$(flashprefix)/root-focramfs/lib \
$(flashprefix)/root-fosquashfs/lib: \
$(flashprefix)/root-%/lib: \
		$(DEPDIR)/linux-kernel.%.do_compile
	-rm -rf $(flashprefix)/root-$*
	$(MAKE) -C $(KERNEL_DIR) ARCH=sh INSTALL_MOD_PATH=$(flashprefix)/root-$* modules_install
	-rm $(flashprefix)/root-$*/lib/modules/$(KERNELVERSION)/build
	-rm $(flashprefix)/root-$*/lib/modules/$(KERNELVERSION)/source
	@TUXBOX_CUSTOMIZE@

$(flashprefix)/root-disk/lib: \
$(flashprefix)/root-%/lib: \
		$(DEPDIR)/linux-kernel.do_compile
#		$(DEPDIR)/linux-kernel.%.do_compile
	-rm -rf $(flashprefix)/root-$*
	$(INSTALL_DIR) $(dir $@)/{boot,lib/firmware} && \
	$(INSTALL_FILE) $(KERNEL_DIR)/arch/sh/boot/uImage $(dir $@)/boot/vmlinux.ub && \
	$(CP_D) root/boot/ACF_*x.elf $(dir $@)/boot/ && \
	$(CP_D) root/boot/vid_*.elf $(dir $@)/boot/ && \
	$(CP_D) root/firmware/dvb-fe-cx24116.fw $(dir $@)/lib/firmware/ && \
	$(CP_D) root/firmware/dvb-fe-cx21143.fw $(dir $@)/lib/firmware/ && \
	$(MAKE) -C $(KERNEL_DIR) ARCH=sh INSTALL_MOD_PATH=$(flashprefix)/root-$* modules_install
	$(MAKE) -C $(driverdir) ARCH=sh KERNEL_LOCATION=$(buildprefix)/$(KERNEL_DIR) INSTALL_MOD_PATH=$(flashprefix)/root-$* install
	-rm $(flashprefix)/root-$*/lib/modules/$(KERNELVERSION)/build
	-rm $(flashprefix)/root-$*/lib/modules/$(KERNELVERSION)/source
	@TUXBOX_CUSTOMIZE@

#
# busybox
#
$(DEPDIR)/busybox.do_prepare: @DEPENDS_busybox@
	@PREPARE_busybox@
	cd @DIR_busybox@ && \
		patch -p1 < ../Patches/busybox-1.19.3/busybox-1.19.3-getty.patch && \
		patch -p1 < ../Patches/busybox-1.19.3/busybox-1.19.3-modinfo.patch && \
		patch -p1 < ../Patches/busybox-1.19.3/busybox-1.19.3-wget.patch
	touch $@

$(DEPDIR)/busybox.do_compile: bootstrap $(DEPDIR)/busybox.do_prepare Patches/busybox-1.19.3/busybox-1.19.3.config | $(DEPDIR)/$(GLIBC_DEV)
	cd @DIR_busybox@ && \
		export CROSS_COMPILE=$(target)- && \
		$(MAKE) mrproper && \
		$(INSTALL) -m644 ../$(lastword $^) .config && \
		$(MAKE) all \
			CROSS_COMPILE=$(target)- \
			CFLAGS_EXTRA="$(TARGET_CFLAGS)"
	touch $@

$(DEPDIR)/min-busybox $(DEPDIR)/std-busybox $(DEPDIR)/max-busybox \
$(DEPDIR)/busybox: \
$(DEPDIR)/%busybox: $(DEPDIR)/busybox.do_compile
	cd @DIR_busybox@ && \
		export CROSS_COMPILE=$(target)- && \
		@INSTALL_busybox@
#		@CLEANUP_busybox@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

flash-busybox: $(flashprefix)/root/bin/busybox

$(flashprefix)/root/bin/busybox: $(DEPDIR)/busybox.do_compile
	@cd @DIR_busybox@ && \
		export CROSS_COMPILE=$(target)- && \
		$(MAKE) install CONFIG_PREFIX=$(flashprefix)/root && \
		export HHL_CROSS_TARGET_DIR=$(flashprefix)/root && $(hostprefix)/bin/target-shellconfig --add /bin/ash 5 && \
		( cd $(flashprefix)/root && \
			[ -f linuxrc ] && rm linuxrc || true ) && \
	touch $@
	@FLASHROOTDIR_MODIFIED@

#.PHONY: flash-busybox

#
# LIBBOOST
#
$(DEPDIR)/libboost: bootstrap @DEPENDS_libboost@
	@PREPARE_libboost@
	cd @DIR_libboost@ && \
		@INSTALL_libboost@
#	@CLEANUP_libboost@
	touch $@

$(DEPDIR)/libz.do_prepare: bootstrap @DEPENDS_libz@ $(if $(LIBZ_ORDER),| $(LIBZ_ORDER))
	@PREPARE_libz@
	touch $@

$(DEPDIR)/libz.do_compile: $(DEPDIR)/libz.do_prepare
	cd @DIR_libz@ && \
		$(BUILDENV) \
		./configure \
			--prefix=/usr \
			--shared && \
		$(MAKE) all libz.a AR="$(target)-ar rc" CFLAGS="-fpic -O2"
	touch $@

$(DEPDIR)/min-libz $(DEPDIR)/std-libz $(DEPDIR)/max-libz \
$(DEPDIR)/libz: \
$(DEPDIR)/%libz: $(DEPDIR)/libz.do_compile
	cd @DIR_libz@ && \
		@INSTALL_libz@
#	@DISTCLEANUP_libz@
	@[ "x$*" = "x" ] && touch $@ || true

#
# LIBREADLINE
#
$(DEPDIR)/libreadline.do_prepare: bootstrap @DEPENDS_libreadline@
	@PREPARE_libreadline@
	touch $@

$(DEPDIR)/libreadline.do_compile: ncurses-dev $(DEPDIR)/libreadline.do_prepare
	cd @DIR_libreadline@ && \
		autoconf && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr && \
		$(MAKE) all
	touch $@

$(DEPDIR)/min-libreadline $(DEPDIR)/std-libreadline $(DEPDIR)/max-libreadline \
$(DEPDIR)/libreadline: \
$(DEPDIR)/%libreadline: $(DEPDIR)/libreadline.do_compile
	cd @DIR_libreadline@ && \
		@INSTALL_libreadline@
#	@DISTCLEANUP_libreadline@
	@[ "x$*" = "x" ] && touch $@ || true

#
# FREETYPE_OLD
#
$(DEPDIR)/freetype-old.do_prepare: bootstrap @DEPENDS_freetype_old@
	@PREPARE_freetype_old@
	touch $@

$(DEPDIR)/freetype-old.do_compile: $(DEPDIR)/freetype-old.do_prepare
	cd @DIR_freetype_old@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr && \
		$(MAKE) all
	touch $@

$(DEPDIR)/freetype-old: $(DEPDIR)/freetype-old.do_compile
	cd @DIR_freetype_old@ && \
		@INSTALL_freetype_old@
	cd freetype-2.1.4; \
		$(INSTALL_DIR) $(crossprefix)/bin; \
		cp install_dir/usr/bin/freetype-config $(crossprefix)/bin/freetype-old-config; \
		$(INSTALL_DIR) $(targetprefix)/usr/include/freetype-old; \
		$(CP_RD) install_dir/usr/include/* $(targetprefix)/usr/include/freetype-old/; \
		$(INSTALL_DIR) $(targetprefix)/usr/lib/freetype-old; \
		$(CP_RD) install_dir/usr/lib/libfreetype.{a,so*} $(targetprefix)/usr/lib/freetype-old/; \
		sed 's,-I$${prefix}/include/freetype2,-I$(targetprefix)/usr/include/freetype-old -I$(targetprefix)/usr/include/freetype-old/freetype2,g' -i $(crossprefix)/bin/freetype-old-config; \
		sed 's,/usr/include/freetype2/,$(targetprefix)/usr/include/freetype-old/freetype2/,g' -i $(crossprefix)/bin/freetype-old-config
#	@DISTCLEANUP_freetype_old@
	@[ "x$*" = "x" ] && touch $@ || true

#
# FREETYPE
#
$(DEPDIR)/freetype.do_prepare: bootstrap @DEPENDS_freetype@
	@PREPARE_freetype@
	touch $@

$(DEPDIR)/freetype.do_compile: $(DEPDIR)/freetype.do_prepare
	cd @DIR_freetype@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr && \
		$(MAKE) all
	touch $@

define freetype/install/post
	cd @DIR_freetype@ && \
		sed -e "s,^prefix=,prefix=$(targetprefix)," < builds/unix/freetype-config > $(crossprefix)/bin/freetype-config && \
		ln -sf freetype-config $(target)-freetype-config && \
		chmod 755 $(crossprefix)/bin/freetype-config
		ln -sf $(targetprefix)/usr/include/freetype2/freetype $(targetprefix)/usr/include/freetype
endef

# Evaluate yaud and temporary package install
$(eval $(call Cdkroot,freetype))

# Evaluate packages
$(eval $(call Package,freetype,libfreetype))
$(eval $(call Package,freetype,libfreetype-dev))

#
# LIRC
#
$(DEPDIR)/lirc.do_prepare: bootstrap @DEPENDS_lirc@
	@PREPARE_lirc@
	touch $@

$(DEPDIR)/lirc.do_compile: $(DEPDIR)/lirc.do_prepare
	cd @DIR_lirc@ && \
		$(BUILDENV) \
		ac_cv_path_LIBUSB_CONFIG= \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--sbindir=\$${exec_prefix}/bin \
			--mandir=\$${prefix}/share/man \
			--with-kerneldir=$(buildprefix)/$(KERNEL_DIR) \
			--without-x \
			--with-driver=userspace \
			--with-syslog=LOG_DAEMON \
			--enable-sandboxed && \
		$(MAKE) all
	touch $@

# Evaluate yaud and temporary package install
$(eval $(call Cdkroot,lirc))

flash-lircd: $(flashprefix)/root/usr/bin/lircd

$(flashprefix)/root/usr/bin/lircd: lirc.do_compile
	( cd @DIR_lirc@ && \
		$(MAKE) install DESTDIR=$(flashprefix)/root ) && \
	touch $@ && \
	@FLASHROOTDIR_MODIFIED@

#
# JPEG
#
$(DEPDIR)/jpeg.do_prepare: bootstrap @DEPENDS_jpeg@
	@PREPARE_jpeg@
	touch $@

$(DEPDIR)/jpeg.do_compile: $(DEPDIR)/jpeg.do_prepare
	cd @DIR_jpeg@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--enable-shared \
			--enable-static \
			--prefix=/usr && \
		$(MAKE) all
	touch $@

define jpeg/install/pre
	$(INSTALL_DIR) $(prefix)/$*cdkroot/usr/bin
	$(INSTALL_DIR) $(prefix)/$*cdkroot/usr/lib
	$(INSTALL_DIR) $(prefix)/$*cdkroot/usr/include
	$(INSTALL_DIR) $(prefix)/$*cdkroot/usr/man/man1
endef

# Evaluate yaud and temporary package install
$(eval $(call Cdkroot,jpeg))

# Evaluate packages
$(eval $(call Package,jpeg,libjpeg))
$(eval $(call Package,jpeg,libjpeg-dev))
$(eval $(call Package,jpeg,jpeg-tools))

#
# LIBPNG
#
$(DEPDIR)/libpng.do_prepare: bootstrap @DEPENDS_libpng@
	@PREPARE_libpng@
	touch $@

$(DEPDIR)/libpng.do_compile: libz $(DEPDIR)/libpng.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_libpng@ && \
		./autogen.sh && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr && \
		export ECHO="echo" && \
		echo "Echo cmd =" $(ECHO) && \
		$(MAKE) all
	touch $@

define libpng/install/post
	cd @DIR_libpng@ && \
		sed -e "s,^prefix=\",prefix=\"$(targetprefix)," < libpng-config > $(crossprefix)/bin/libpng-config && \
		chmod 755 $(crossprefix)/bin/libpng-config
endef

# Evaluate yaud and temporary package install
$(eval $(call Cdkroot,libpng,libz))

# Evaluate packages
$(eval $(call Package,libpng,libpng))
$(eval $(call Package,libpng,libpng-dev))

#
# LIBUNGIF
#
$(DEPDIR)/libungif.do_prepare: bootstrap @DEPENDS_libungif@
	@PREPARE_libungif@
	touch $@

$(DEPDIR)/libungif.do_compile: $(DEPDIR)/libungif.do_prepare
	cd @DIR_libungif@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--without-x && \
		$(MAKE)
	touch $@

# Evaluate yaud and temporary package install
$(eval $(call Cdkroot,libungif))

# Evaluate packages
$(eval $(call Package,libungif,libungif))
$(eval $(call Package,libungif,libungif-utils))
$(eval $(call Package,libungif,libungif-dev))

#
# LIBGIF
#
$(DEPDIR)/libgif.do_prepare: bootstrap @DEPENDS_libgif@
	@PREPARE_libgif@
	touch $@

$(DEPDIR)/libgif.do_compile: $(DEPDIR)/libgif.do_prepare
	cd @DIR_libgif@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--without-x && \
		$(MAKE)
	touch $@

# Evaluate yaud and temporary package install
$(eval $(call Cdkroot,libgif))

#
# LIBCURL
#
$(DEPDIR)/curl.do_prepare: @DEPENDS_curl@
	@PREPARE_curl@
	touch $@

$(DEPDIR)/curl.do_compile: bootstrap libz $(DEPDIR)/curl.do_prepare
	cd @DIR_curl@ && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--mandir=/usr/share/man \
			--with-random && \
		$(MAKE) all
	touch $@

define curl/install/post
	cd @DIR_curl@ && \
		sed -e "s,^prefix=,prefix=$(targetprefix)," < curl-config > $(crossprefix)/bin/curl-config && \
		chmod 755 $(crossprefix)/bin/curl-config
endef

# Evaluate yaud and temporary package install
$(eval $(call Cdkroot,curl,libz))

# Evaluate packages
$(eval $(call Package,curl,libcurl))
$(eval $(call Package,curl,curl))

#
# LIBFRIBIDI
#
$(DEPDIR)/libfribidi.do_prepare: bootstrap @DEPENDS_libfribidi@
	@PREPARE_libfribidi@
	touch $@

$(DEPDIR)/libfribidi.do_compile: $(DEPDIR)/libfribidi.do_prepare
	cd @DIR_libfribidi@ && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--enable-memopt && \
		$(MAKE) all
	touch $@

$(DEPDIR)/min-libfribidi $(DEPDIR)/std-libfribidi $(DEPDIR)/max-libfribidi \
$(DEPDIR)/libfribidi: \
$(DEPDIR)/%libfribidi: $(DEPDIR)/libfribidi.do_compile
	cd @DIR_libfribidi@ && \
		@INSTALL_libfribidi@
#	@DISTCLEANUP_libfribidi@
	@[ "x$*" = "x" ] && touch $@ || true

#
# LIBSIGC
#
$(DEPDIR)/libsigc.do_prepare: bootstrap @DEPENDS_libsigc@
	@PREPARE_libsigc@
	touch $@

$(DEPDIR)/libsigc.do_compile: libstdc++-dev $(DEPDIR)/libsigc.do_prepare
	cd @DIR_libsigc@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--disable-checks && \
		$(MAKE) all
	touch $@

$(DEPDIR)/min-libsigc $(DEPDIR)/std-libsigc $(DEPDIR)/max-libsigc \
$(DEPDIR)/libsigc: \
$(DEPDIR)/%libsigc: $(DEPDIR)/libsigc.do_compile
	cd @DIR_libsigc@ && \
		@INSTALL_libsigc@
#	@DISTCLEANUP_libsigc@
	@[ "x$*" = "x" ] && touch $@ || true

#
# LIBMAD
#
$(DEPDIR)/libmad.do_prepare: bootstrap @DEPENDS_libmad@
	@PREPARE_libmad@
	touch $@

$(DEPDIR)/libmad.do_compile: $(DEPDIR)/libmad.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_libmad@ && \
		aclocal -I $(hostprefix)/share/aclocal && \
		autoconf && \
		autoheader && \
		automake --foreign && \
		libtoolize --force && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--disable-debugging \
			--enable-shared=yes \
			--enable-speed \
			--enable-sso && \
		$(MAKE) all
	touch $@

$(DEPDIR)/min-libmad $(DEPDIR)/std-libmad $(DEPDIR)/max-libmad \
$(DEPDIR)/libmad: \
$(DEPDIR)/%libmad: $(DEPDIR)/libmad.do_compile
	cd @DIR_libmad@ && \
		@INSTALL_libmad@
#	@DISTCLEANUP_libmad@
	@[ "x$*" = "x" ] && touch $@ || true

#
# LIBID3TAG
#
$(DEPDIR)/libid3tag.do_prepare: bootstrap @DEPENDS_libid3tag@
	@PREPARE_libid3tag@
	touch $@

$(DEPDIR)/libid3tag.do_compile: libz $(DEPDIR)/libid3tag.do_prepare
	cd @DIR_libid3tag@ && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--enable-shared=yes && \
		$(MAKE) all
	touch $@

$(DEPDIR)/min-libid3tag $(DEPDIR)/std-libid3tag $(DEPDIR)/max-libid3tag \
$(DEPDIR)/libid3tag: \
$(DEPDIR)/%libid3tag: %libz $(DEPDIR)/libid3tag.do_compile
	cd @DIR_libid3tag@ && \
		@INSTALL_libid3tag@
#	@DISTCLEANUP_libid3tag@
	@[ "x$*" = "x" ] && touch $@ || true

#
# LIBXML2
#
$(DEPDIR)/libxml2.do_prepare: bootstrap @DEPENDS_libxml2@
	@PREPARE_libxml2@
	touch $@

$(DEPDIR)/libxml2.do_compile: libxml2.do_prepare
	cd @DIR_libxml2@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--mandir=/usr/share/man \
			--with-python=$(crossprefix) \
			--without-c14n \
			--without-debug \
			--without-mem-debug && \
		$(MAKE) all 
	touch $@

$(DEPDIR)/min-libxml2 $(DEPDIR)/std-libxml2 $(DEPDIR)/max-libxml2 \
$(DEPDIR)/libxml2: \
$(DEPDIR)/%libxml2: libxml2.do_compile
	cd @DIR_libxml2@ && \
		@INSTALL_libxml2@; \
		[ -f "$(targetprefix)/usr/lib/python2.6/site-packages/libxml2mod.la" ] && \
		sed -e "/^dependency_libs/ s,/usr/lib/libxml2.la,$(targetprefix)/usr/lib/libxml2.la,g" -i $(targetprefix)/usr/lib/python2.6/site-packages/libxml2mod.la; \
		sed -e "s,^prefix=,prefix=$(targetprefix)," < xml2-config > $(crossprefix)/bin/xml2-config; \
		chmod 755 $(crossprefix)/bin/xml2-config; \
		sed -e "/^XML2_LIBDIR/ s,/usr/lib,$(targetprefix)/usr/lib,g" -i $(targetprefix)/usr/lib/xml2Conf.sh; \
		sed -e "/^XML2_INCLUDEDIR/ s,/usr/include,$(targetprefix)/usr/include,g" -i $(targetprefix)/usr/lib/xml2Conf.sh
	@[ "x$*" = "x" ] && touch $@ || true

flash-libxml2-enigma2: $(flashprefix)/root-enigma2/usr/lib/libxml2mod.so

$(flashprefix)/root-enigma2/usr/lib/libxml2mod.so: \
%/usr/lib/libxml2mod.so: libxml2.do_compile
	( cd @DIR_libxml2@ && \
		$(MAKE) install DESTDIR=$* ) && \
	rm $*/usr/bin/{xml2-config,xmlcatalog,xmllint} && \
	rm $*/usr/lib/python2.6/site-packages/libxml2mod.a && \
	touch $@ && \
	@TUXBOX_CUSTOMIZE@

#
# LIBXSLT
#
$(DEPDIR)/libxslt.do_prepare: @DEPENDS_libxslt@
	@PREPARE_libxslt@
	touch $@

$(DEPDIR)/libxslt.do_compile: bootstrap libxml2 libxslt.do_prepare
	cd @DIR_libxslt@ && \
		$(BUILDENV) \
		CPPFLAGS="$(CPPFLAGS) -I$(targetprefix)/usr/include/libxml2 -Os" \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--with-libxml-prefix="$(crossprefix)" \
			--with-libxml-include-prefix="$(targetprefix)/usr/include" \
			--with-libxml-libs-prefix="$(targetprefix)/usr/lib" \
			--with-python=$(crossprefix) \
			--without-crypto \
			--without-debug \
			--without-mem-debug && \
		$(MAKE) all
	touch $@

$(DEPDIR)/min-libxslt $(DEPDIR)/std-libxslt $(DEPDIR)/max-libxslt \
$(DEPDIR)/libxslt: \
$(DEPDIR)/%libxslt: %libxml2 libxslt.do_compile
	cd @DIR_libxslt@ && \
		@INSTALL_libxslt@ && \
		sed -e "/^dependency_libs/ s,/usr/lib/libxslt.la,$(targetprefix)/usr/lib/libxslt.la,g" -i $(targetprefix)/usr/lib/python2.6/site-packages/libxsltmod.la && \
		sed -e "/^dependency_libs/ s,/usr/lib/libexslt.la,$(targetprefix)/usr/lib/libexslt.la,g" -i $(targetprefix)/usr/lib/python2.6/site-packages/libxsltmod.la && \
		sed -e "s,^prefix=,prefix=$(targetprefix)," < xslt-config > $(crossprefix)/bin/xslt-config && \
		chmod 755 $(crossprefix)/bin/xslt-config && \
		sed -e "/^dependency_libs/ s,/usr/lib/libxslt.la,$(targetprefix)/usr/lib/libxslt.la,g" -i $(targetprefix)/usr/lib/libexslt.la && \
		sed -e "/^XML2_LIBDIR/ s,/usr/lib,$(targetprefix)/usr/lib,g" -i $(targetprefix)/usr/lib/xsltConf.sh && \
		sed -e "/^XML2_INCLUDEDIR/ s,/usr/include,$(targetprefix)/usr/include,g" -i $(targetprefix)/usr/lib/xsltConf.sh
	@[ "x$*" = "x" ] && touch $@ || true

flash-libxslt-enigma2: $(flashprefix)/root-enigma2/usr/lib/libxsltmod.so

$(flashprefix)/root-enigma2/usr/lib/libxsltmod.so: \
%/usr/lib/libxsltmod.so: libxslt.do_compile
	( cd @DIR_libxslt@ && \
		$(MAKE) install DESTDIR=$* ) && \
	rm $*/usr/bin/{xslt-config,xsltproc} && \
	rm $*/usr/lib/python2.6/site-packages/libxsltmod.a && \
	touch $@ && \
	@TUXBOX_CUSTOMIZE@

#
# LIBVORBISIDEC
#

$(DEPDIR)/libvorbisidec.do_prepare: @DEPENDS_libvorbisidec@
	@PREPARE_libvorbisidec@
	touch $@

$(DEPDIR)/libvorbisidec.do_compile: bootstrap $(DEPDIR)/libvorbisidec.do_prepare
	cd @DIR_libvorbisidec@ && \
		$(BUILDENV) \
		./autogen.sh \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr && \
		$(MAKE)
	touch $@

$(DEPDIR)/libvorbisidec: $(DEPDIR)/libvorbisidec.do_compile
	cd @DIR_libvorbisidec@ && \
		@INSTALL_libvorbisidec@
#	@DISTCLEANUP_libvorbisidec@
	@[ "x$*" = "x" ] && touch $@ || true

#
# GLIB2
# You need libglib2.0-dev on host system
#
$(DEPDIR)/glib2.do_prepare: @DEPENDS_glib2@
	@PREPARE_glib2@
	touch $@

$(DEPDIR)/glib2.do_compile: bootstrap libz $(DEPDIR)/glib2.do_prepare
	echo "glib_cv_va_copy=no" > @DIR_glib2@/config.cache
	echo "glib_cv___va_copy=yes" >> @DIR_glib2@/config.cache
	echo "glib_cv_va_val_copy=yes" >> @DIR_glib2@/config.cache
	echo "ac_cv_func_posix_getpwuid_r=yes" >> @DIR_glib2@/config.cache
	echo "ac_cv_func_posix_getgrgid_r=yes" >> @DIR_glib2@/config.cache
	echo "glib_cv_stack_grows=no" >> @DIR_glib2@/config.cache
	echo "glib_cv_uscore=no" >> @DIR_glib2@/config.cache
	cd @DIR_glib2@ && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		LDFLAGS="$(TARGET_LDFLAGS) -L\$(targetprefix)/usr/lib" \
		./configure \
			--cache-file=config.cache \
			--disable-gtk-doc \
			--with-threads="posix" \
			--enable-static \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--mandir=/usr/share/man && \
		$(MAKE) all
	touch $@

$(DEPDIR)/min-glib2 $(DEPDIR)/std-glib2 $(DEPDIR)/max-glib2 \
$(DEPDIR)/glib2: \
$(DEPDIR)/%glib2: $(DEPDIR)/glib2.do_compile
	cd @DIR_glib2@ && \
		@INSTALL_glib2@
#	@DISTCLEANUP_glib2@
	@[ "x$*" = "x" ] && touch $@ || true

# Evaluate package glib2
# call MacroName,Source Package,Package
$(eval $(call Package,glib2,libglib2))

#
# LIBICONV
#
$(DEPDIR)/libiconv.do_prepare: bootstrap @DEPENDS_libiconv@
	@PREPARE_libiconv@
	touch $@

$(DEPDIR)/libiconv.do_compile: $(DEPDIR)/libiconv.do_prepare
	cd @DIR_libiconv@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr && \
		$(MAKE)
	touch $@

$(DEPDIR)/min-libiconv $(DEPDIR)/std-libiconv $(DEPDIR)/max-libiconv $(DEPDIR)/ipk-libiconv \
$(DEPDIR)/libiconv: \
$(DEPDIR)/%libiconv: $(DEPDIR)/libiconv.do_compile
	cd @DIR_libiconv@ && \
		@INSTALL_libiconv@
#	@DISTCLEANUP_libiconv@
	@[ "x$*" = "x" ] && touch $@ || true

#
# LIBMNG
#
$(DEPDIR)/libmng.do_prepare: @DEPENDS_libmng@
	@PREPARE_libmng@
	touch $@

$(DEPDIR)/libmng.do_compile: bootstrap libz jpeg lcms libmng.do_prepare
	cd @DIR_libmng@ && \
		cat unmaintained/autogen.sh | tr -d \\r > autogen.sh && chmod 755 autogen.sh && \
		[ ! -x ./configure ] && ./autogen.sh --help || true && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--enable-shared \
			--enable-static \
			--with-zlib \
			--with-jpeg \
			--with-gnu-ld \
			--with-lcms && \
		$(MAKE)
	touch $@

# Evaluate yaud and temporary package install
$(eval $(call Cdkroot,libmng))

#
# LCMS
#
$(DEPDIR)/lcms.do_prepare: @DEPENDS_lcms@
	@PREPARE_lcms@
	touch $@

$(DEPDIR)/lcms.do_compile: bootstrap libz jpeg lcms.do_prepare
	cd @DIR_lcms@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--enable-shared \
			--enable-static && \
		$(MAKE)
	touch $@

# Evaluate yaud and temporary package install
$(eval $(call Cdkroot,lcms))

#
# DirectFB
#
$(DEPDIR)/directfb.do_prepare: @DEPENDS_directfb@
	@PREPARE_directfb@
	touch $@

$(DEPDIR)/directfb.do_compile: bootstrap freetype directfb.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_directfb@ && \
		libtoolize -f -c && \
		autoreconf --verbose --force --install -I$(hostprefix)/share/aclocal && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--enable-static \
			--disable-sdl \
			--disable-x11 \
			--disable-devmem \
			--disable-multi \
			--with-gfxdrivers=stgfx \
			--enable-mme=yes && \
			export top_builddir=`pwd` && \
		$(MAKE) LD=$(target)-ld
	touch $@

$(DEPDIR)/directfb: directfb.do_compile
	cd @DIR_directfb@ && \
		@INSTALL_directfb@
	touch $@

#
# DFB++
#
$(DEPDIR)/dfbpp.do_prepare: @DEPENDS_dfbpp@
	@PREPARE_dfbpp@
	touch $@

$(DEPDIR)/dfbpp.do_compile: bootstrap libz jpeg directfb dfbpp.do_prepare
	cd @DIR_dfbpp@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr && \
			export top_builddir=`pwd` && \
		$(MAKE) all
	touch $@
#		$(BUILDENV) PKG_CONFIG=$(hostprefix)/bin/pkg-config \
#

$(DEPDIR)/dfbpp: dfbpp.do_compile
	cd @DIR_dfbpp@ && \
		@INSTALL_dfbpp@
#	sed -e "s, /usr/lib, $(targetprefix)/usr/lib,g" -i $(targetprefix)/usr/lib/libdfb++.la
	touch $@

#
# EXPAT
#
$(DEPDIR)/expat.do_prepare: @DEPENDS_expat@
	@PREPARE_expat@
	touch $@

$(DEPDIR)/expat.do_compile: bootstrap expat.do_prepare
	cd @DIR_expat@ && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr && \
		$(MAKE) all
	touch $@

$(DEPDIR)/expat: expat.do_compile
	cd @DIR_expat@ && \
		@INSTALL_expat@
	touch $@

#
# FONTCONFIG
#
$(DEPDIR)/fontconfig.do_prepare: @DEPENDS_fontconfig@
	@PREPARE_fontconfig@
	touch $@

$(DEPDIR)/fontconfig.do_compile: bootstrap libz fontconfig.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_fontconfig@ && \
		libtoolize -f -c && \
		autoreconf --verbose --force --install -I$(hostprefix)/share/aclocal && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--with-arch=sh4 \
			--with-freetype-config=$(crossprefix)/bin/freetype-config \
			--with-expat-includes=$(targetprefix)/usr/include \
			--with-expat-lib=$(targetprefix)/usr/lib \
			--sysconfdir=/etc \
			--localstatedir=/var \
			--disable-docs \
			--without-add-fonts && \
		$(MAKE)
	touch $@

$(DEPDIR)/fontconfig: fontconfig.do_compile
	cd @DIR_fontconfig@ && \
		@INSTALL_fontconfig@
	touch $@

#
# Python
#
$(DEPDIR)/python.do_prepare: host-python @DEPENDS_python@
	@PREPARE_python@ && \
	touch $@

$(DEPDIR)/python.do_compile: openssl openssl-dev sqlite bootstrap python.do_prepare
	( cd @DIR_python@ && \
		CONFIG_SITE= \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--target=$(target) \
			--prefix=/usr \
			--sysconfdir=/etc \
			--enable-shared \
			--disable-ipv6 \
			--without-cxx-main \
			--with-threads \
			HOSTPYTHON=$(crossprefix)/bin/python \
			OPT="$(TARGET_CFLAGS)" && \
		$(MAKE) $(MAKE_ARGS) \
			TARGET_OS=$(target) \
			PYTHON_DISABLE_MODULES="_tkinter" \
			PYTHON_MODULES_INCLUDE="$(prefix)/$*cdkroot/usr/include" \
			PYTHON_MODULES_LIB="$(prefix)/$*cdkroot/usr/lib" \
			CROSS_COMPILE=yes \
			CFLAGS="$(TARGET_CFLAGS) -fno-inline" \
			LDFLAGS="$(TARGET_LDFLAGS)" \
			LD="$(target)-gcc" \
			HOSTPYTHON=$(crossprefix)/bin/python \
			HOSTPGEN=$(crossprefix)/bin/pgen \
			all ) && \
	touch $@

$(DEPDIR)/min-python $(DEPDIR)/std-python $(DEPDIR)/max-python \
$(DEPDIR)/python: \
$(DEPDIR)/%python: python.do_compile
	( cd @DIR_python@ && \
		$(MAKE) $(MAKE_ARGS) \
			TARGET_OS=$(target) \
			HOSTPYTHON=$(crossprefix)/bin/python \
			HOSTPGEN=$(crossprefix)/bin/pgen \
			install DESTDIR=$(prefix)/$*cdkroot ) && \
	$(LN_SF) ../../libpython2.6.so.1.0 $(prefix)/$*cdkroot/usr/lib/python2.6/config/libpython2.6.so && \
	[ "x$*" = "x" ] && touch $@ || true

flash-python-enigma2: $(flashprefix)/root-enigma2/usr/bin/python

$(flashprefix)/root-enigma2/usr/bin/python: \
%/usr/bin/python: python.do_compile
	( cd @DIR_python@ && \
		$(MAKE) $(MAKE_ARGS) \
			HOSTPYTHON=$(crossprefix)/bin/python \
			HOSTPGEN=$(crossprefix)/bin/pgen \
			install DESTDIR=$* ) && \
	rm $*/usr/bin/{python,idle,pydoc,python2.6-config,python-config,smtpd.py} && \
	$(LN_SF) python2.6 $@ && \
	chmod 755 $*/usr/lib/libpython2.6.so.1.0 && \
	rm -rf $*/usr/lib/python2.6/config/ && \
	touch $@ && \
	@TUXBOX_CUSTOMIZE@

#
# ELEMENTTREE
#
$(DEPDIR)/elementtree.do_prepare: @DEPENDS_elementtree@
	@PREPARE_elementtree@
	touch $@

$(DEPDIR)/elementtree.do_compile: bootstrap elementtree.do_prepare
	touch $@

$(DEPDIR)/min-elementtree $(DEPDIR)/std-elementtree $(DEPDIR)/max-elementtree \
$(DEPDIR)/elementtree: \
$(DEPDIR)/%elementtree: %python elementtree.do_compile
	cd @DIR_elementtree@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONHOME=$(targetprefix)/usr \
		$(crossprefix)/bin/python ./setup.py install --root=$(targetprefix) --prefix=/usr
	[ "x$*" = "x" ] && touch $@ || true
#		PYTHONPATH=$(targetprefix)/usr/lib/python2.6/site-packages \
#

flash-elementtree-enigma2: $(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/elementtree

$(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/elementtree: \
%/usr/lib/python2.6/site-packages/elementtree: elementtree.do_compile
	( cd @DIR_elementtree@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$*/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py install --root=$* --prefix=/usr ) && \
	touch $@ && \
	@TUXBOX_CUSTOMIZE@

#
# LXML
#
$(DEPDIR)/lxml.do_prepare: @DEPENDS_lxml@
	@PREPARE_lxml@
	touch $@

$(DEPDIR)/lxml.do_compile: bootstrap python lxml.do_prepare
	cd @DIR_lxml@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$(targetprefix)/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py build \
			--with-xml2-config=$(crossprefix)/bin/xml2-config \
			--with-xslt-config=$(crossprefix)/bin/xslt-config
	touch $@

$(DEPDIR)/min-lxml $(DEPDIR)/std-lxml $(DEPDIR)/max-lxml \
$(DEPDIR)/lxml: \
$(DEPDIR)/%lxml: lxml.do_compile
	cd @DIR_lxml@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$(targetprefix)/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py install --root=$(targetprefix) --prefix=/usr
	[ "x$*" = "x" ] && touch $@ || true

flash-lxml-enigma2: $(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/lxml

$(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/lxml: \
%/usr/lib/python2.6/site-packages/lxml: lxml.do_compile
	( cd @DIR_lxml@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$*/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py install --root=$* --prefix=/usr ) && \
	touch $@ && \
	@TUXBOX_CUSTOMIZE@

#
# LIBXMLCCWRAP
#
$(DEPDIR)/libxmlccwrap.do_prepare: @DEPENDS_libxmlccwrap@
	@PREPARE_libxmlccwrap@
	touch $@

$(DEPDIR)/libxmlccwrap.do_compile: bootstrap libxmlccwrap.do_prepare
	cd @DIR_libxmlccwrap@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--target=$(target) \
			--prefix=/usr && \
		$(MAKE) all
	touch $@

$(DEPDIR)/min-libxmlccwrap $(DEPDIR)/std-libxmlccwrap $(DEPDIR)/max-libxmlccwrap \
$(DEPDIR)/libxmlccwrap: \
$(DEPDIR)/%libxmlccwrap: libxmlccwrap.do_compile
	cd @DIR_libxmlccwrap@ && \
		@INSTALL_libxmlccwrap@ && \
		sed -e "/^dependency_libs/ s,-L/usr/lib,-L$(targetprefix)/usr/lib,g" -i $(targetprefix)/usr/lib/libxmlccwrap.la && \
		sed -e "/^dependency_libs/ s, /usr/lib, $(targetprefix)/usr/lib,g" -i $(targetprefix)/usr/lib/libxmlccwrap.la
	[ "x$*" = "x" ] && touch $@ || true

flash-libxmlccwrap-enigma2: $(flashprefix)/root-enigma2/usr/lib/libxmlccwrap.so

$(flashprefix)/root-enigma2/usr/lib/libxmlccwrap.so: \
%/usr/lib/libxmlccwrap.so: libxmlccwrap.do_compile
	( cd @DIR_libxmlccwrap@ && \
		$(MAKE) install DESTDIR=$* ) && \
	touch $@ && \
	@TUXBOX_CUSTOMIZE@

#
# SETUPTOOLS
#
$(DEPDIR)/setuptools.do_prepare: @DEPENDS_setuptools@
	@PREPARE_setuptools@
	touch $@

$(DEPDIR)/setuptools.do_compile: bootstrap setuptools.do_prepare
	cd @DIR_setuptools@ && \
		$(crossprefix)/bin/python ./setup.py build
	touch $@

$(DEPDIR)/min-setuptools $(DEPDIR)/std-setuptools $(DEPDIR)/max-setuptools \
$(DEPDIR)/setuptools: \
$(DEPDIR)/%setuptools: setuptools.do_compile
	cd @DIR_setuptools@ && \
		$(crossprefix)/bin/python ./setup.py install --root=$(targetprefix) --prefix=/usr
	[ "x$*" = "x" ] && touch $@ || true

#
# ZOPE INTERFACE
#
$(DEPDIR)/zope-interface.do_prepare: @DEPENDS_zope_interface@
	@PREPARE_zope_interface@
	touch $@

$(DEPDIR)/zope-interface.do_compile: bootstrap setuptools zope-interface.do_prepare
	cd @DIR_zope_interface@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$(targetprefix)/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py build
	touch $@

$(DEPDIR)/min-zope-interface $(DEPDIR)/std-zope-interface $(DEPDIR)/max-zope-interface \
$(DEPDIR)/zope-interface: \
$(DEPDIR)/%zope-interface: zope-interface.do_compile
	cd @DIR_zope_interface@ && \
		PYTHONPATH=$(targetprefix)/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py install --root=$(targetprefix) --prefix=/usr
	[ "x$*" = "x" ] && touch $@ || true

flash-zope-interface-enigma2: $(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/zope/interface

$(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/zope/interface: \
%/usr/lib/python2.6/site-packages/zope/interface: zope-interface.do_compile
	( cd @DIR_zope_interface@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$*/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py install --root=$* --prefix=/usr ) && \
	touch $@ && \
	@TUXBOX_CUSTOMIZE@

#
# TWISTED
#
$(DEPDIR)/twisted.do_prepare: @DEPENDS_twisted@
	@PREPARE_twisted@
	touch $@

$(DEPDIR)/twisted.do_compile: bootstrap setuptools twisted.do_prepare
	cd @DIR_twisted@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$(targetprefix)/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python -c "import setuptools; execfile('setup.py')" build
	touch $@

$(DEPDIR)/min-twisted $(DEPDIR)/std-twisted $(DEPDIR)/max-twisted \
$(DEPDIR)/twisted: \
$(DEPDIR)/%twisted: twisted.do_prepare
	cd @DIR_twisted@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$(targetprefix)/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py install --root=$(targetprefix) --prefix=/usr
	[ "x$*" = "x" ] && touch $@ || true

flash-twisted-enigma2: $(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/twisted

$(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/twisted: \
%/usr/lib/python2.6/site-packages/twisted: twisted.do_compile
	( cd @DIR_twisted@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$*/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py install --root=$* --prefix=/usr ) && \
	rm $*/usr/bin/{tap2deb,tapconvert,manhole,tap2rpm,t-im,pyhtmlizer,trial,mktap,twistd,bookify,lore,mailmail,ckeygen,tkconch,conch,cftp,im} && \
	touch $@ && \
	@TUXBOX_CUSTOMIZE@

#
# TWISTEDWEB2
#
$(DEPDIR)/twistedweb2.do_prepare: @DEPENDS_twistedweb2@
	@PREPARE_twistedweb2@
	touch $@

$(DEPDIR)/twistedweb2.do_compile: bootstrap setuptools twistedweb2.do_prepare
	cd @DIR_twistedweb2@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$(targetprefix)/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python -c "import setuptools; execfile('setup.py')" build
	touch $@

$(DEPDIR)/min-twistedweb2 $(DEPDIR)/std-twistedweb2 $(DEPDIR)/max-twistedweb2 \
$(DEPDIR)/twistedweb2: \
$(DEPDIR)/%twistedweb2: twistedweb2.do_prepare
	cd @DIR_twistedweb2@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$(targetprefix)/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py install --root=$(targetprefix) --prefix=/usr
	[ "x$*" = "x" ] && touch $@ || true

flash-twistedweb2-enigma2: $(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/twisted/web2

$(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/twisted/web2: \
%/usr/lib/python2.6/site-packages/twisted/web2: twisted.do_compile
	( cd @DIR_twistedweb2@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$*/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py install --root=$* --prefix=/usr ) && \
	touch $@ && \
	@TUXBOX_CUSTOMIZE@

#
# A52DEC
#
$(DEPDIR)/a52dec.do_prepare: @DEPENDS_a52dec@
	@PREPARE_a52dec@
	touch $@

$(DEPDIR)/a52dec.do_compile: bootstrap a52dec.do_prepare
	cd @DIR_a52dec@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=$(targetprefix)/usr && \
		$(MAKE) install
	touch $@

$(DEPDIR)/a52dec: a52dec.do_compile
	cd @DIR_a52dec@ && \
		@INSTALL_a52dec@
	touch $@

#
# LIBDVDCSS
#
$(DEPDIR)/libdvdcss.do_prepare: @DEPENDS_libdvdcss@
	@PREPARE_libdvdcss@
	touch $@

$(DEPDIR)/libdvdcss.do_compile: bootstrap libdvdcss.do_prepare
	cd @DIR_libdvdcss@ && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr && \
		$(MAKE) all
	touch $@

$(DEPDIR)/libdvdcss: libdvdcss.do_compile
	cd @DIR_libdvdcss@ && \
		@INSTALL_libdvdcss@
	touch $@

#
# LIBDVDNAV
#
$(DEPDIR)/libdvdnav.do_prepare: @DEPENDS_libdvdnav@
	@PREPARE_libdvdnav@
	touch $@

$(DEPDIR)/libdvdnav.do_compile: bootstrap libdvdread libdvdnav.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_libdvdnav@ && \
		cp $(hostprefix)/share/libtool/config/ltmain.sh . && \
		autoreconf -f -i -I$(hostprefix)/share/aclocal && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--enable-static \
			--enable-shared \
			--with-dvdread-config=$(targetprefix)/usr/bin/dvdread-config && \
		$(MAKE) all
	touch $@

$(DEPDIR)/libdvdnav: libdvdnav.do_compile
	cd @DIR_libdvdnav@ && \
		@INSTALL_libdvdnav@
	touch $@

#
# LIBDVDREAD
#
$(DEPDIR)/libdvdread.do_prepare: @DEPENDS_libdvdread@
	@PREPARE_libdvdread@
	touch $@

$(DEPDIR)/libdvdread.do_compile: bootstrap libdvdread.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_libdvdread@ && \
		cp $(hostprefix)/share/libtool/config/ltmain.sh . && \
		cp $(hostprefix)/share/libtool/config/ltmain.sh .. && \
		autoreconf -f -i -I$(hostprefix)/share/aclocal && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--enable-static \
			--enable-shared \
			--prefix=/usr && \
		$(MAKE) all
	echo '#!/bin/sh' > $(buildprefix)/libdvdread-4.1.3/misc/dvdread-config
	echo 'prefix='$(targetprefix)/usr >> $(buildprefix)/libdvdread-4.1.3/misc/dvdread-config
	echo 'libdir='$(targetprefix)/usr/lib >> $(buildprefix)/libdvdread-4.1.3/misc/dvdread-config
	echo >> $(buildprefix)/libdvdread-4.1.3/misc/dvdread-config
	cat $(buildprefix)/libdvdread-4.1.3/misc/dvdread-config.sh >> $(buildprefix)/libdvdread-4.1.3/misc/dvdread-config
	chmod 0755 $(buildprefix)/libdvdread-4.1.3/misc/dvdread-config
	touch $@

$(DEPDIR)/libdvdread: libdvdread.do_compile
	cd @DIR_libdvdread@ && \
		@INSTALL_libdvdread@
	sed 's!/usr/lib!$(targetprefix)/usr/lib!g' $(targetprefix)/usr/lib/libdvdread.la > $(targetprefix)/usr/lib/libdvdread.la1
	cp $(targetprefix)/usr/lib/libdvdread.la1 $(targetprefix)/usr/lib/libdvdread.la
	rm $(targetprefix)/usr/lib/libdvdread.la1
	touch $@

#
# PYOPENSSL
#
$(DEPDIR)/pyopenssl.do_prepare: @DEPENDS_pyopenssl@
	@PREPARE_pyopenssl@
	touch $@

$(DEPDIR)/pyopenssl.do_compile: bootstrap setuptools pyopenssl.do_prepare
	cd @DIR_pyopenssl@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$(targetprefix)/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py build
	touch $@

$(DEPDIR)/min-pyopenssl $(DEPDIR)/std-pyopenssl $(DEPDIR)/max-pyopenssl \
$(DEPDIR)/pyopenssl: \
$(DEPDIR)/%pyopenssl: pyopenssl.do_compile
	cd @DIR_pyopenssl@ && \
		PYTHONPATH=$(targetprefix)/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py install --root=$(targetprefix) --prefix=/usr
	[ "x$*" = "x" ] && touch $@ || true

flash-pyopenssl-enigma2: $(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/OpenSSL

$(flashprefix)/root-enigma2/usr/lib/python2.6/site-packages/OpenSSL: \
%/usr/lib/python2.6/site-packages/OpenSSL: pyopenssl.do_compile
	( cd @DIR_pyopenssl@ && \
		CC='$(target)-gcc' LDSHARED='$(target)-gcc -shared' \
		PYTHONPATH=$*/usr/lib/python2.6/site-packages \
		$(crossprefix)/bin/python ./setup.py install --root=$* --prefix=/usr ) && \
	rm $*/usr/lib/python2.6/site-packages/OpenSSL/test && \
	touch $@ && \
	@TUXBOX_CUSTOMIZE@

#
# ffmpeg
#
$(DEPDIR)/ffmpeg.do_prepare: bootstrap libass @DEPENDS_ffmpeg@
	@PREPARE_ffmpeg@
@STM23_TRUE@	cd @DIR_ffmpeg@ && \
@STM23_TRUE@	patch -p1 < ../Patches/ffmpeg.patch;
	touch $@

#$(DEPDIR)/ffmpeg.do_compile: $(DEPDIR)/ffmpeg.do_prepare
#	export PATH=$(hostprefix)/bin:$(PATH) && \
#	cd @DIR_ffmpeg@ && \
#	$(BUILDENV) \
#	./configure \
#		--enable-parsers --disable-decoders --disable-encoders --enable-demuxers \
#		--disable-muxers --disable-ffplay --disable-ffmpeg --disable-ffserver \
#		--disable-devices \
#		--disable-protocols --enable-protocol=file --enable-bsfs \
#		--disable-mpegaudio-hp --disable-zlib --enable-bzlib \
#		--disable-static --enable-shared \
#		--enable-cross-compile \
#		--cross-prefix=$(target)- \
#		--target-os=linux \
#		--arch=sh4 \
#		--extra-cflags=-fno-strict-aliasing \
#		--enable-stripping \
#		--prefix=/usr
#	touch $@

$(DEPDIR)/ffmpeg.do_compile: bootstrap libass $(DEPDIR)/ffmpeg.do_prepare
	cd @DIR_ffmpeg@ && \
	$(BUILDENV) \
	./configure \
		--disable-static --enable-shared \
		--enable-cross-compile \
		--disable-ffserver \
		--disable-altivec \
		--disable-debug \
		--disable-asm \
		--disable-amd3dnow \
		--disable-amd3dnowext \
		--disable-mmx \
		--disable-mmx2 \
		--disable-sse \
		--disable-ssse3 \
		--disable-armv5te \
		--disable-armv6 \
		--disable-armv6t2 \
		--disable-armvfp \
		--disable-iwmmxt \
		--disable-mmi \
		--disable-neon \
		--disable-vis \
		--disable-yasm \
		--disable-indevs \
		--disable-outdevs \
		--disable-muxers \
		--enable-muxer=ogg \
		--enable-muxer=flac \
		--enable-muxer=aac \
		--enable-muxer=mp3 \
		--enable-muxer=h261 \
		--enable-muxer=h263 \
		--enable-muxer=h264 \
		--enable-muxer=mpeg1video \
		--enable-muxer=image2 \
		--disable-encoders \
		--enable-encoder=aac \
		--enable-encoder=mp3 \
		--enable-encoder=theora \
		--enable-encoder=h261 \
		--enable-encoder=h263 \
		--enable-encoder=h263p \
		--enable-encoder=ljpeg \
		--enable-encoder=mjpeg \
		--enable-encoder=png \
		--enable-encoder=mpeg1video \
		--disable-decoders \
		--enable-decoder=aac \
		--enable-decoder=mp3 \
		--enable-decoder=theora \
		--enable-decoder=h261 \
		--enable-decoder=h263 \
		--enable-decoder=h263i \
		--enable-decoder=h264 \
		--enable-decoder=mpeg2video \
		--enable-decoder=png \
		--enable-decoder=ljpeg \
		--enable-decoder=mjpeg \
		--enable-decoder=vorbis \
		--enable-decoder=flac \
		--enable-small \
		--enable-decoder=dvbsub \
		--enable-decoder=iff_byterun1 \
		--enable-pthreads \
		--enable-bzlib \
		--cross-prefix=$(target)- \
		--target-os=linux \
		--arch=sh4 \
		--extra-cflags=-fno-strict-aliasing \
		--enable-stripping \
		--prefix=/usr
	touch $@

$(DEPDIR)/min-ffmpeg $(DEPDIR)/std-ffmpeg $(DEPDIR)/max-ffmpeg \
$(DEPDIR)/ffmpeg: \
$(DEPDIR)/%ffmpeg: $(DEPDIR)/ffmpeg.do_compile
	cd @DIR_ffmpeg@ && \
		@INSTALL_ffmpeg@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# libass
#
$(DEPDIR)/libass.do_prepare: bootstrap freetype @DEPENDS_libass@
	@PREPARE_libass@
	touch $@

$(DEPDIR)/libass.do_compile: $(DEPDIR)/libass.do_prepare
	cd @DIR_libass@ && \
	$(BUILDENV) \
	CFLAGS="$(TARGET_CFLAGS) -Os" \
	./configure \
                --host=$(target) \
                --disable-fontconfig \
		        --prefix=/usr
	touch $@

$(DEPDIR)/min-libass $(DEPDIR)/std-libass $(DEPDIR)/max-libass \
$(DEPDIR)/libass: \
$(DEPDIR)/%libass: $(DEPDIR)/libass.do_compile
	cd @DIR_libass@ && \
		@INSTALL_libass@
	echo "libdir='$(targetprefix)/usr/lib'" >> $(targetprefix)/usr/lib/libass.la
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# WebKitDFB
#
$(DEPDIR)/webkitdfb.do_prepare: bootstrap glib2 icu4c libxml2 enchant lite curl fontconfig sqlite libsoup cairo jpeg @DEPENDS_webkitdfb@
	@PREPARE_webkitdfb@
	touch $@

#
$(DEPDIR)/webkitdfb.do_compile: $(DEPDIR)/webkitdfb.do_prepare
	export PATH=$(BUILDPREFIX)/@DIR_icu4c@/host/config:$(PATH) && \
	cd @DIR_webkitdfb@ && \
	$(BUILDENV) \
	./autogen.sh --with-target=directfb --without-gtkplus \
		--host=$(target) \
		--prefix=/usr \
		--with-cairo-directfb \
		--disable-shared-workers \
		--enable-optimizations	\
		--disable-channel-messaging	\
		--disable-javascript-debugger	\
		--enable-offline-web-applications	\
		--enable-dom-storage	\
		--enable-database	\
		--disable-eventsource	\
		--enable-icon-database	\
		--enable-datalist	\
		--disable-video	\
		--enable-svg	\
		--enable-xpath	\
		--disable-xslt	\
		--disable-dashboard-support \
		--disable-geolocation \
		--disable-workers	\
		--disable-web-sockets	\
		--with-networking-backend=soup
	touch $@

$(DEPDIR)/min-webkitdfb $(DEPDIR)/std-webkitdfb $(DEPDIR)/max-webkitdfb \
$(DEPDIR)/webkitdfb: \
$(DEPDIR)/%webkitdfb: $(DEPDIR)/webkitdfb.do_compile
	cd @DIR_webkitdfb@ && \
		@INSTALL_webkitdfb@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/icu4c.do_prepare: bootstrap @DEPENDS_icu4c@
	@PREPARE_icu4c@
	cd @DIR_icu4c@ && \
		rm data/mappings/ucm*.mk; \
		patch -p1 < ../../Patches/icu4c-4_4_1_locales.patch;
	touch $@

$(DEPDIR)/icu4c.do_compile: $(DEPDIR)/icu4c.do_prepare
	echo "Building host icu"
	mkdir -p @DIR_icu4c@/host && \
	cd @DIR_icu4c@/host && \
	sh ../configure --disable-samples --disable-tests && \
	unset TARGET && \
	make
	echo "Building cross icu"
	cd @DIR_icu4c@ && \
	$(BUILDENV) \
	./configure \
		--with-cross-build=$(BUILDPREFIX)/@DIR_icu4c@/host \
		--host=$(target) \
		--prefix=/usr \
		--disable-extras \
		--disable-layout \
		--disable-tests \
		--disable-samples
	touch $@

$(DEPDIR)/min-icu4c $(DEPDIR)/std-icu4c $(DEPDIR)/max-icu4c \
$(DEPDIR)/icu4c: \
$(DEPDIR)/%icu4c: $(DEPDIR)/icu4c.do_compile
	cd @DIR_icu4c@ && \
	   unset TARGET && \
		@INSTALL_icu4c@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/enchant.do_prepare: bootstrap @DEPENDS_enchant@
	@PREPARE_enchant@
	touch $@

#	libtoolize -f -c && \
#	autoreconf --verbose --force --install -I$(hostprefix)/share/aclocal

$(DEPDIR)/enchant.do_compile: $(DEPDIR)/enchant.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_enchant@ && \
	libtoolize -f -c && \
	autoreconf --verbose --force --install -I$(hostprefix)/share/aclocal && \
	$(BUILDENV)  \
	./configure --disable-aspell --disable-ispell --disable-myspell --disable-zemberek \
	--host=$(target) \
	--prefix=/usr && \
	$(MAKE) LD=$(target)-ld
	touch $@

$(DEPDIR)/min-enchant $(DEPDIR)/std-enchant $(DEPDIR)/max-enchant \
$(DEPDIR)/enchant: \
$(DEPDIR)/%enchant: $(DEPDIR)/enchant.do_compile
	cd @DIR_enchant@ && \
		@INSTALL_enchant@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# lite
#
$(DEPDIR)/lite.do_prepare: bootstrap directfb @DEPENDS_lite@
	@PREPARE_lite@
	touch $@

$(DEPDIR)/lite.do_compile: $(DEPDIR)/lite.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_lite@ && \
	cp $(hostprefix)/share/libtool/config/ltmain.sh .. && \
	libtoolize -f -c && \
	autoreconf --verbose --force --install -I$(hostprefix)/share/aclocal && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr \
      --disable-debug
	touch $@

$(DEPDIR)/min-lite $(DEPDIR)/std-lite $(DEPDIR)/max-lite \
$(DEPDIR)/lite: \
$(DEPDIR)/%lite: $(DEPDIR)/lite.do_compile
	cd @DIR_lite@ && \
		@INSTALL_lite@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# sqlite
#
$(DEPDIR)/sqlite.do_prepare: bootstrap @DEPENDS_sqlite@
	@PREPARE_sqlite@
	touch $@

$(DEPDIR)/sqlite.do_compile: $(DEPDIR)/sqlite.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_sqlite@ && \
	libtoolize -f -c && \
	autoreconf --verbose --force --install -I$(hostprefix)/share/aclocal && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr \
		--disable-tcl \
		--disable-debug
	touch $@

$(DEPDIR)/min-sqlite $(DEPDIR)/std-sqlite $(DEPDIR)/max-sqlite \
$(DEPDIR)/sqlite: \
$(DEPDIR)/%sqlite: $(DEPDIR)/sqlite.do_compile
	cd @DIR_sqlite@ && \
		@INSTALL_sqlite@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# libsoup
#
$(DEPDIR)/libsoup.do_prepare: bootstrap @DEPENDS_libsoup@
	@PREPARE_libsoup@
	touch $@

$(DEPDIR)/libsoup.do_compile: $(DEPDIR)/libsoup.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_libsoup@ && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr \
		--disable-more-warnings \
		--without-gnome
	touch $@

$(DEPDIR)/min-libsoup $(DEPDIR)/std-libsoup $(DEPDIR)/max-libsoup \
$(DEPDIR)/libsoup: \
$(DEPDIR)/%libsoup: $(DEPDIR)/libsoup.do_compile
	cd @DIR_libsoup@ && \
		@INSTALL_libsoup@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# pixman
#
$(DEPDIR)/pixman.do_prepare: bootstrap @DEPENDS_pixman@
	@PREPARE_pixman@
	touch $@

$(DEPDIR)/pixman.do_compile: $(DEPDIR)/pixman.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_pixman@ && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr
	touch $@

$(DEPDIR)/min-pixman $(DEPDIR)/std-pixman $(DEPDIR)/max-pixman \
$(DEPDIR)/pixman: \
$(DEPDIR)/%pixman: $(DEPDIR)/pixman.do_compile
	cd @DIR_pixman@ && \
		@INSTALL_pixman@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# cairo
#
$(DEPDIR)/cairo.do_prepare: bootstrap libpng pixman @DEPENDS_cairo@
	@PREPARE_cairo@
	touch $@

$(DEPDIR)/cairo.do_compile: $(DEPDIR)/cairo.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_cairo@ && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr \
		--disable-gtk-doc \
		--enable-ft=yes \
		--enable-png=yes \
		--enable-ps=no \
		--enable-pdf=no \
		--enable-svg=no \
		--disable-glitz \
		--disable-xcb \
		--disable-xlib \
		--enable-directfb \
		--program-suffix=-directfb
	touch $@

$(DEPDIR)/min-cairo $(DEPDIR)/std-cairo $(DEPDIR)/max-cairo \
$(DEPDIR)/cairo: \
$(DEPDIR)/%cairo: $(DEPDIR)/cairo.do_compile
	cd @DIR_cairo@ && \
		@INSTALL_cairo@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# libogg
$(DEPDIR)/libogg.do_prepare: bootstrap  @DEPENDS_libogg@
	@PREPARE_libogg@
	touch $@

$(DEPDIR)/libogg.do_compile: $(DEPDIR)/libogg.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_libogg@ && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr
	touch $@

$(DEPDIR)/min-libogg $(DEPDIR)/std-libogg $(DEPDIR)/max-libogg \
$(DEPDIR)/libogg: \
$(DEPDIR)/%libogg: $(DEPDIR)/libogg.do_compile
	cd @DIR_libogg@ && \
		@INSTALL_libogg@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# libflac
$(DEPDIR)/libflac.do_prepare: bootstrap  @DEPENDS_libflac@
	@PREPARE_libflac@
	touch $@

$(DEPDIR)/libflac.do_compile: $(DEPDIR)/libflac.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_libflac@ && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr \
		--disable-ogg \
		--disable-oggtest \
		--disable-id3libtest \
		--disable-asm-optimizations \
		--disable-doxygen-docs \
		--disable-xmms-plugin \
		--without-xmms-prefix \
		--without-xmms-exec-prefix \
		--without-libiconv-prefix \
		--without-id3lib \
		--with-ogg-includes=. \
		--disable-cpplibs
	touch $@

$(DEPDIR)/min-libflac $(DEPDIR)/std-libflac $(DEPDIR)/max-libflac \
$(DEPDIR)/libflac: \
$(DEPDIR)/%libflac: $(DEPDIR)/libflac.do_compile
	cd @DIR_libflac@ && \
		@INSTALL_libflac@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
#
# GSTREAMER + PLUGINS
# This will become the "libeplayer4"
#

# GSTREAMER
$(DEPDIR)/gstreamer.do_prepare: bootstrap glib2 libxml2 @DEPENDS_gstreamer@
	@PREPARE_gstreamer@
	touch $@

$(DEPDIR)/gstreamer.do_compile: $(DEPDIR)/gstreamer.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_gstreamer@ && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr
	touch $@

$(DEPDIR)/min-gstreamer $(DEPDIR)/std-gstreamer $(DEPDIR)/max-gstreamer \
$(DEPDIR)/gstreamer: \
$(DEPDIR)/%gstreamer: $(DEPDIR)/gstreamer.do_compile
	cd @DIR_gstreamer@ && \
		@INSTALL_gstreamer@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# GST-PLUGINS-BASE
$(DEPDIR)/gst_plugins_base.do_prepare: bootstrap glib2 gstreamer libogg libalsa @DEPENDS_gst_plugins_base@
	@PREPARE_gst_plugins_base@
	touch $@

$(DEPDIR)/gst_plugins_base.do_compile: $(DEPDIR)/gst_plugins_base.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_gst_plugins_base@ && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr \
		--disable-theora --disable-pango --disable-vorbis
	touch $@

$(DEPDIR)/min-gst_plugins_base $(DEPDIR)/std-gst_plugins_base $(DEPDIR)/max-gst_plugins_base \
$(DEPDIR)/gst_plugins_base: \
$(DEPDIR)/%gst_plugins_base: $(DEPDIR)/gst_plugins_base.do_compile
	cd @DIR_gst_plugins_base@ && \
		@INSTALL_gst_plugins_base@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# GST-PLUGINS-GOOD
$(DEPDIR)/gst_plugins_good.do_prepare: bootstrap gstreamer gst_plugins_base libsoup libflac @DEPENDS_gst_plugins_good@
	@PREPARE_gst_plugins_good@
	touch $@

$(DEPDIR)/gst_plugins_good.do_compile: $(DEPDIR)/gst_plugins_good.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_gst_plugins_good@ && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr \
		--disable-esd --disable-esdtest \
		--disable-shout2 --disable-shout2test
	touch $@

$(DEPDIR)/min-gst_plugins_good $(DEPDIR)/std-gst_plugins_good $(DEPDIR)/max-gst_plugins_good \
$(DEPDIR)/gst_plugins_good: \
$(DEPDIR)/%gst_plugins_good: $(DEPDIR)/gst_plugins_good.do_compile
	cd @DIR_gst_plugins_good@ && \
		@INSTALL_gst_plugins_good@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# GST-PLUGINS-BAD
$(DEPDIR)/gst_plugins_bad.do_prepare: bootstrap gstreamer gst_plugins_base @DEPENDS_gst_plugins_bad@
	@PREPARE_gst_plugins_bad@
	touch $@

$(DEPDIR)/gst_plugins_bad.do_compile: $(DEPDIR)/gst_plugins_bad.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_gst_plugins_bad@ && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr
	touch $@

$(DEPDIR)/min-gst_plugins_bad $(DEPDIR)/std-gst_plugins_bad $(DEPDIR)/max-gst_plugins_bad \
$(DEPDIR)/gst_plugins_bad: \
$(DEPDIR)/%gst_plugins_bad: $(DEPDIR)/gst_plugins_bad.do_compile
	cd @DIR_gst_plugins_bad@ && \
		@INSTALL_gst_plugins_bad@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# GST-PLUGINS-UGLY
$(DEPDIR)/gst_plugins_ugly.do_prepare: bootstrap gstreamer gst_plugins_base @DEPENDS_gst_plugins_ugly@
	@PREPARE_gst_plugins_ugly@
	touch $@

$(DEPDIR)/gst_plugins_ugly.do_compile: $(DEPDIR)/gst_plugins_ugly.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_gst_plugins_ugly@ && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr
	touch $@

$(DEPDIR)/min-gst_plugins_ugly $(DEPDIR)/std-gst_plugins_ugly $(DEPDIR)/max-gst_plugins_ugly \
$(DEPDIR)/gst_plugins_ugly: \
$(DEPDIR)/%gst_plugins_ugly: $(DEPDIR)/gst_plugins_ugly.do_compile
	cd @DIR_gst_plugins_ugly@ && \
		@INSTALL_gst_plugins_ugly@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# GST-FFMPEG
$(DEPDIR)/gst_ffmpeg.do_prepare: bootstrap gstreamer gst_plugins_base @DEPENDS_gst_ffmpeg@
	@PREPARE_gst_ffmpeg@
	touch $@

#configuring included Libav instance with args --prefix=/usr --disable-ffserver --disable-ffplay        --disable-ffmpeg --disable-ffprobe --enable-postproc --enable-gpl --enable-static --enable-pic 	--disable-encoder=flac --disable-decoder=cavs --disable-protocols --disable-devices	--disable-network --disable-hwaccels --disable-filters --disable-doc	--enable-optimizations --enable-cross-compile         --target-os=linux --arch=sh4 --cross-prefix=sh4-linux-
$(DEPDIR)/gst_ffmpeg.do_compile: $(DEPDIR)/gst_ffmpeg.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_gst_ffmpeg@ && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr \
		\
		--with-ffmpeg-extra-configure=" \
		--disable-ffserver \
		--disable-ffplay \
		--disable-ffmpeg \
		--disable-ffprobe \
		--enable-postproc \
		--enable-gpl \
		--enable-static \
		--enable-pic \
		--disable-protocols \
		--disable-devices \
		--disable-network \
		--disable-hwaccels \
		--disable-filters \
		--disable-doc \
		--enable-optimizations \
		--enable-cross-compile \
		--target-os=linux \
		--arch=sh4 \
		--cross-prefix=$(target)- \
		\
		--disable-muxers \
		--disable-encoders \
		--disable-decoders \
		--enable-decoder=ogg \
		--enable-decoder=vorbis \
		--enable-decoder=flac \
		\
		--disable-demuxers \
		--enable-demuxer=ogg \
		--enable-demuxer=vorbis \
		--enable-demuxer=flac \
		\
		--disable-parsers \
		--enable-parser=ogg \
		--enable-parser=vorbis \
		--enable-parser=flac \
		\
		--disable-bsfs \
		--enable-small \
		--enable-pthreads \
		--enable-bzlib"
	touch $@

$(DEPDIR)/min-gst_ffmpeg $(DEPDIR)/std-gst_ffmpeg $(DEPDIR)/max-gst_ffmpeg \
$(DEPDIR)/gst_ffmpeg: \
$(DEPDIR)/%gst_ffmpeg: $(DEPDIR)/gst_ffmpeg.do_compile
	cd @DIR_gst_ffmpeg@ && \
		@INSTALL_gst_ffmpeg@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# GST-PLUGINS-DVBMEDIASINK
$(DEPDIR)/gst_plugins_dvbmediasink.do_prepare: bootstrap gstreamer gst_plugins_base gst_plugins_good gst_plugins_bad gst_plugins_ugly @DEPENDS_gst_plugins_dvbmediasink@
	@PREPARE_gst_plugins_dvbmediasink@
	touch $@

$(DEPDIR)/gst_plugins_dvbmediasink.do_compile: $(DEPDIR)/gst_plugins_dvbmediasink.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_gst_plugins_dvbmediasink@ && \
	aclocal -I $(hostprefix)/share/aclocal -I m4 && \
	autoheader && \
	autoconf && \
	automake --foreign && \
	libtoolize --force && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr
	touch $@

$(DEPDIR)/min-gst_plugins_dvbmediasink $(DEPDIR)/std-gst_plugins_dvbmediasink $(DEPDIR)/max-gst_plugins_dvbmediasink \
$(DEPDIR)/gst_plugins_dvbmediasink: \
$(DEPDIR)/%gst_plugins_dvbmediasink: $(DEPDIR)/gst_plugins_dvbmediasink.do_compile
	cd @DIR_gst_plugins_dvbmediasink@ && \
		@INSTALL_gst_plugins_dvbmediasink@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# eve-browser
#
$(DEPDIR)/evebrowser.do_prepare: webkitdfb @DEPENDS_evebrowser@
	svn checkout https://eve-browser.googlecode.com/svn/trunk/ @DIR_evebrowser@
	touch $@

$(DEPDIR)/evebrowser.do_compile: $(DEPDIR)/evebrowser.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_evebrowser@ && \
	aclocal -I $(hostprefix)/share/aclocal -I m4 && \
	autoheader && \
	autoconf && \
	automake --foreign && \
	libtoolize --force && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr && \
	$(MAKE) all
	touch $@

$(DEPDIR)/min-evebrowser $(DEPDIR)/std-evebrowser $(DEPDIR)/max-evebrowser \
$(DEPDIR)/evebrowser: \
$(DEPDIR)/%evebrowser: $(DEPDIR)/evebrowser.do_compile
	@[ "x$*" = "x" ] && touch $@ || true
	cd @DIR_evebrowser@ && \
		@INSTALL_evebrowser@ && \
		cp -ar enigma2/HbbTv $(targetprefix)/usr/lib/enigma2/python/Plugins/SystemPlugins/
	@TUXBOX_YAUD_CUSTOMIZE@

#
# brofs
#
$(DEPDIR)/brofs.do_prepare:  @DEPENDS_brofs@
	@PREPARE_brofs@
	touch $@

$(DEPDIR)/brofs.do_compile: $(DEPDIR)/brofs.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_brofs@ && \
	$(BUILDENV) \
	$(MAKE) all
	touch $@

$(DEPDIR)/min-brofs $(DEPDIR)/std-brofs $(DEPDIR)/max-brofs \
$(DEPDIR)/brofs: \
$(DEPDIR)/%brofs: $(DEPDIR)/brofs.do_compile
	@[ "x$*" = "x" ] && touch $@ || true
	cd @DIR_brofs@ && \
		@INSTALL_brofs@
	@TUXBOX_YAUD_CUSTOMIZE@

#
# libcap
#
$(DEPDIR)/libcap.do_prepare:  @DEPENDS_libcap@
	@PREPARE_libcap@
	touch $@

$(DEPDIR)/libcap.do_compile: $(DEPDIR)/libcap.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_libcap@ && \
	$(MAKE) \
	DESTDIR=$(prefix)/cdkroot \
	PREFIX=$(prefix)/cdkroot/usr \
	LIBDIR=$(prefix)/cdkroot/usr/lib \
	SBINDIR=$(prefix)/cdkroot/usr/sbin \
	INCDIR=$(prefix)/cdkroot/usr/include \
	BUILD_CC=gcc \
	PAM_CAP=no \
	LIBATTR=no \
	CC=sh4-linux-gcc
	touch $@

$(DEPDIR)/min-libcap $(DEPDIR)/std-libcap $(DEPDIR)/max-libcap \
$(DEPDIR)/libcap: \
$(DEPDIR)/%libcap: $(DEPDIR)/libcap.do_compile
	@[ "x$*" = "x" ] && touch $@ || true
	cd @DIR_libcap@ && \
		@INSTALL_libcap@ \
		DESTDIR=$(prefix)/cdkroot \
		PREFIX=$(prefix)/cdkroot/usr \
		LIBDIR=$(prefix)/cdkroot/usr/lib \
		SBINDIR=$(prefix)/cdkroot/usr/sbin \
		INCDIR=$(prefix)/cdkroot/usr/include \
		BUILD_CC=gcc \
		PAM_CAP=no \
		LIBATTR=no \
		CC=sh4-linux-gcc
	@TUXBOX_YAUD_CUSTOMIZE@

#
# alsa-lib
#
$(DEPDIR)/libalsa.do_prepare:  @DEPENDS_libalsa@
	@PREPARE_libalsa@
	touch $@

$(DEPDIR)/libalsa.do_compile: $(DEPDIR)/libalsa.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_libalsa@ && \
	aclocal -I $(hostprefix)/share/aclocal -I m4 && \
	autoheader && \
	autoconf && \
	automake --foreign && \
	libtoolize --force && \
	$(BUILDENV) \
	./configure \
		--host=$(target) \
		--prefix=/usr \
		--with-debug=no \
		--enable-static \
		--disable-python && \
	$(MAKE) all
	touch $@

$(DEPDIR)/min-libalsa $(DEPDIR)/std-libalsa $(DEPDIR)/max-libalsa \
$(DEPDIR)/libalsa: \
$(DEPDIR)/%libalsa: $(DEPDIR)/libalsa.do_compile
	@[ "x$*" = "x" ] && touch $@ || true
	cd @DIR_libalsa@ && \
		@INSTALL_libalsa@
	@TUXBOX_YAUD_CUSTOMIZE@

#
# CONSOLE_DATA
#
$(DEPDIR)/console_data: bootstrap @DEPENDS_console_data@
	@PREPARE_console_data@
	cd @DIR_console_data@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=$(targetprefix) \
			--with-main_compressor=gzip && \
		@INSTALL_console_data@
#	@CLEANUP_console_data@
	touch $@

$(SYSVINIT_RPM) $(INITSCRIPTS_RPM): \
		$(if $(SYSVINIT_SPEC_PATCH),Patches/$(SYSVINIT_SPEC_PATCH)) \
		$(if $(SYSVINIT_PATCHES),$(SYSVINIT_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(SYSVINIT)-$(SYSVINIT_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(SYSVINIT_SPEC_PATCH),( cd SPECS && patch -p1 $(SYSVINIT_SPEC) < ../Patches/$(SYSVINIT_SPEC_PATCH) ) &&) \
	$(if $(SYSVINIT_PATCHES),cp $(SYSVINIT_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(SYSVINIT_SPEC)

$(DEPDIR)/min-$(SYSVINIT) $(DEPDIR)/std-$(SYSVINIT) $(DEPDIR)/max-$(SYSVINIT) \
$(DEPDIR)/$(SYSVINIT): \
$(DEPDIR)/%$(SYSVINIT): $(SYSVINIT_ADAPTED_ETC_FILES:%=root/etc/%) \
		$(SYSVINIT_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps --force -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	( cd root/etc && for i in $(SYSVINIT_ADAPTED_ETC_FILES); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(prefix)/$*cdkroot/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(prefix)/$*cdkroot/etc/$$i || true; done )
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-sysvinit: $(flashprefix)/root/etc/inittab

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/etc/inittab: $(SYSVINIT_ADAPTED_ETC_FILES:%=root/etc/%) \
@TARGETRULESET_FLASH_TRUE@		$(SYSVINIT_RPM)
@TARGETRULESET_FLASH_TRUE@	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps --force --noscripts -Uhv \
@TARGETRULESET_FLASH_TRUE@		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^) && \
@TARGETRULESET_FLASH_TRUE@	( cd root/etc && for i in $(SYSVINIT_ADAPTED_ETC_FILES); do \
@TARGETRULESET_FLASH_TRUE@		[ -f $$i ] && $(INSTALL) -m644 $$i $(flashprefix)/root/etc/$$i || true; \
@TARGETRULESET_FLASH_TRUE@		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(flashprefix)/root/etc/$$i || true; done )
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

$(DEPDIR)/min-$(INITSCRIPTS) $(DEPDIR)/std-$(INITSCRIPTS) $(DEPDIR)/max-$(INITSCRIPTS) \
$(DEPDIR)/$(INITSCRIPTS): \
$(DEPDIR)/%$(INITSCRIPTS): $(INITSCRIPTS_ADAPTED_ETC_FILES:%=root/etc/%) \
		$(INITSCRIPTS_RPM) \
		| $(DEPDIR)/%filesystem
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps --force --nopost -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	( cd $(prefix)/$*cdkroot/etc/init.d/ && \
		sed -e "s|-uid 0 ||g" -i bootclean.sh && \
		sed -e "s|-empty ||g" -i bootclean.sh && \
		sed -e "s/chmod \-f/chmod/g" -i bootmisc.sh && \
		sed -e "s/chown \-f/chown/g" -i bootmisc.sh && \
		sed -e "s|/etc/nologin|/var/tmp/nologin|g" -i bootmisc.sh && \
		sed -e "s|PATH=/lib/init:/bin:/sbin|PATH=/lib/init:/bin:/sbin:/usr/bin:/usr/sbin|g" -i checkroot.sh && \
		sed -e "s/hostname \-\-file/hostname \-F/g" -i hostname.sh && \
		sed -e "s|PATH=/lib/init:/sbin:/bin|PATH=/lib/init:/bin:/sbin:/usr/bin:/usr/sbin|g" -i rmnologin && \
		sed -e "s|# chkconfig: 2345 99 0|# chkconfig: 2345 69 0|" -i rmnologin && \
		sed -e "s|readlink -f /etc/nologin|readlink -f /var/tmp/nologin|g" -i rmnologin ) 
	( cd $(prefix)/$*cdkroot/etc/default/ && \
		sed -e "s|EDITMOTD=yes|EDITMOTD=no|g" -i rcS )
	( cd root/etc && for i in $(INITSCRIPTS_ADAPTED_ETC_FILES); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(prefix)/$*cdkroot/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(prefix)/$*cdkroot/etc/$$i || true; done ) || true 
	( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
		for s in init.d/mountvirtfs bootlogd checkroot.sh checkfs.sh mountall.sh \
		hostname.sh mountnfs.sh bootmisc.sh urandom \
		sendsigs umountnfs.sh umountfs halt reboot \
		rmnologin single stop-bootlogd ; do \
			$(hostprefix)/bin/target-initdconfig --add $${s#init.d/} || \
			echo "Unable to enable initd service: $${s#init.d/}" ; done && rm *rpmsave *.orig 2>/dev/null || true )
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-initscripts: $(flashprefix)/root/etc/init.d/rc

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/etc/init.d/rc: $(INITSCRIPTS_ADAPTED_ETC_FILES:%=root/etc/%) \
@TARGETRULESET_FLASH_TRUE@		$(INITSCRIPTS_RPM)
@TARGETRULESET_FLASH_TRUE@	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps --force --noscripts --nopost -Uhv \
@TARGETRULESET_FLASH_TRUE@		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^)
@TARGETRULESET_FLASH_TRUE@	( cd $(flashprefix)/root/etc/init.d/ && \
@TARGETRULESET_FLASH_TRUE@		sed -e "s|-uid 0 ||g" -i bootclean.sh && \
@TARGETRULESET_FLASH_TRUE@		sed -e "s|-empty ||g" -i bootclean.sh && \
@TARGETRULESET_FLASH_TRUE@		sed -e "s/chmod \-f/chmod/g" -i bootmisc.sh && \
@TARGETRULESET_FLASH_TRUE@		sed -e "s/chown \-f/chown/g" -i bootmisc.sh && \
@TARGETRULESET_FLASH_TRUE@		sed -e "s|/etc/nologin|/var/tmp/nologin|g" -i bootmisc.sh && \
@TARGETRULESET_FLASH_TRUE@		sed -e "s|PATH=/lib/init:/bin:/sbin|PATH=/lib/init:/bin:/sbin:/usr/bin:/usr/sbin|g" -i checkroot.sh && \
@TARGETRULESET_FLASH_TRUE@		sed -e "s/hostname \-\-file/hostname \-F/g" -i hostname.sh && \
@TARGETRULESET_FLASH_TRUE@		sed -e "s|PATH=/lib/init:/sbin:/bin|PATH=/lib/init:/bin:/sbin:/usr/bin:/usr/sbin|g" -i rmnologin && \
@TARGETRULESET_FLASH_TRUE@		sed -e "s|# chkconfig: 2345 99 0|# chkconfig: 2345 69 0|" -i rmnologin && \
@TARGETRULESET_FLASH_TRUE@		sed -e "s|readlink -f /etc/nologin|readlink -f /var/tmp/nologin|g" -i rmnologin ) 
@TARGETRULESET_FLASH_TRUE@	( cd $(flashprefix)/root/etc/default/ && \
@TARGETRULESET_FLASH_TRUE@		sed -e "s|EDITMOTD=yes|EDITMOTD=no|g" -i rcS )
@TARGETRULESET_FLASH_TRUE@	( cd root/etc && for i in $(INITSCRIPTS_ADAPTED_ETC_FILES); do \
@TARGETRULESET_FLASH_TRUE@		[ -f $$i ] && $(INSTALL) -m644 $$i $(flashprefix)/root/etc/$$i || true; \
@TARGETRULESET_FLASH_TRUE@		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(flashprefix)/root/etc/$$i || true; done ) && \
@TARGETRULESET_FLASH_TRUE@	( export HHL_CROSS_TARGET_DIR=$(flashprefix)/root && cd $(flashprefix)/root/etc/init.d && \
@TARGETRULESET_FLASH_TRUE@		for s in mountvirtfs bootlogd checkroot.sh checkfs.sh mountall.sh \
@TARGETRULESET_FLASH_TRUE@		hostname.sh mountnfs.sh bootmisc.sh urandom \
@TARGETRULESET_FLASH_TRUE@		sendsigs umountnfs.sh umountfs halt reboot \
@TARGETRULESET_FLASH_TRUE@		rmnologin single stop-bootlogd ; do \
@TARGETRULESET_FLASH_TRUE@			$(hostprefix)/bin/target-initdconfig --add $${s#init.d/} || \
@TARGETRULESET_FLASH_TRUE@			echo "Unable to enable initd service: $${s#init.d/}" ; done && rm *rpmsave *.orig 2>/dev/null || true )
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

$(NETBASE_RPM): \
		$(if $(NETBASE_SPEC_PATCH),Patches/$(NETBASE_SPEC_PATCH)) \
		$(if $(NETBASE_PATCHES),$(NETBASE_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(NETBASE)-$(NETBASE_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $< && \
	$(if $(NETBASE_SPEC_PATCH),( cd SPECS && patch -p1 $(NETBASE_SPEC) < ../Patches/$(NETBASE_PATCH) ) &&) \
	$(if $(NETBASE_PATCHES),cp $(NETBASE_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(NETBASE).spec

$(DEPDIR)/min-$(NETBASE) $(DEPDIR)/std-$(NETBASE) $(DEPDIR)/max-$(NETBASE) \
$(DEPDIR)/$(NETBASE): \
$(DEPDIR)/%$(NETBASE): \
		$(NETBASE_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps --force --nopost -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	( cd root/etc/network && $(INSTALL) interfaces_yaud $(prefix)/$*cdkroot/etc/network/interfaces || true ) && \
	( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
		for s in networking ; do \
			$(hostprefix)/bin/target-initdconfig --add $${s#init.d/} || \
			echo "Unable to enable initd service: $${s#init.d/}" ; \
		done && rm *rpmsave 2>/dev/null || true ) && \
	( cd $(prefix)/$*cdkroot/etc/network && \
		for i in if-down.d if-post-down.d if-pre-up.d if-up.d run; do \
			$(INSTALL) -d $$i; \
		done )
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-netbase: $(flashprefix)/root/etc/init.d/networking

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/etc/init.d/networking: $(NETBASE_ADAPTED_ETC_FILES:%=root/etc/%) \
@TARGETRULESET_FLASH_TRUE@		$(NETBASE_RPM)
@TARGETRULESET_FLASH_TRUE@	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps --nopost -Uhv \
@TARGETRULESET_FLASH_TRUE@		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^) && \
@TARGETRULESET_FLASH_TRUE@	( cd root/etc && for i in $(NETBASE_ADAPTED_ETC_FILES); do \
@TARGETRULESET_FLASH_TRUE@		[ -f $$i ] && $(INSTALL) -m644 $$i $(flashprefix)/root/etc/$$i || true; \
@TARGETRULESET_FLASH_TRUE@		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(flashprefix)/root/etc/$$i || true; done ) && \
@TARGETRULESET_FLASH_TRUE@	( export HHL_CROSS_TARGET_DIR=$(flashprefix)/root && cd $(flashprefix)/root/etc/init.d && \
@TARGETRULESET_FLASH_TRUE@		for s in networking ; do \
@TARGETRULESET_FLASH_TRUE@			$(hostprefix)/bin/target-initdconfig --add $${s#init.d/} || \
@TARGETRULESET_FLASH_TRUE@			echo "Unable to enable initd service: $${s#init.d/}" ; \
@TARGETRULESET_FLASH_TRUE@		done && rm *rpmsave 2>/dev/null || true ) && \
@TARGETRULESET_FLASH_TRUE@	( cd $(flashprefix)/root/etc/network && \
@TARGETRULESET_FLASH_TRUE@		for i in if-down.d if-post-down.d if-pre-up.d if-up.d run; do \
@TARGETRULESET_FLASH_TRUE@			$(INSTALL) -d $$i; \
@TARGETRULESET_FLASH_TRUE@		done )
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

$(BC_RPM): \
		$(if $(BC_SPEC_PATCH),Patches/$(BC_SPEC_PATCH)) \
		$(if $(BC_PATCHES),$(BC_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(BC)-$(BC_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(BC_SPEC_PATCH),( cd SPECS && patch -p1 $(BC_SPEC) < ../Patches/$(BC_PATCH) ) &&) \
	$(if $(BC_PATCHES),cp $(BC_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(BC_SPEC)

$(DEPDIR)/min-$(BC) $(DEPDIR)/std-$(BC) $(DEPDIR)/max-$(BC) \
$(DEPDIR)/$(BC): \
$(DEPDIR)/%$(BC): $(BC_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps --force --noscripts -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-bc: $(flashprefix)/root/usr/bin/bc

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/bin/bc: $(BC_RPM)
@TARGETRULESET_FLASH_TRUE@	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps --force --noscripts -Uhv \
@TARGETRULESET_FLASH_TRUE@		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^)
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

$(FINDUTILS_RPM): \
		$(if $(FINDUTILS_SPEC_PATCH),Patches/$(FINDUTILS_SPEC_PATCH)) \
		$(if $(FINDUTILS_PATCHES),$(FINDUTILS_PATCHES:%=Patches/%)) \
		$(DEPDIR)/$(GLIBC_DEV) \
		Archive/$(STLINUX)-target-$(FINDUTILS)-$(FINDUTILS_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(FINDUTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(FINDUTILS_SPEC) < ../Patches/$(FINDUTILS_PATCH) ) &&) \
	$(if $(FINDUTILS_PATCHES),cp $(FINDUTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(FINDUTILS_SPEC)

$(DEPDIR)/min-$(FINDUTILS) $(DEPDIR)/std-$(FINDUTILS) $(DEPDIR)/max-$(FINDUTILS) $(DEPDIR)/$(FINDUTILS): \
$(DEPDIR)/%$(FINDUTILS): $(FINDUTILS_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps  -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $<
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

flash-findutils: $(flashprefix)/root/usr/bin/find

$(flashprefix)/root/usr/bin/find: RPMS/sh4/$(STLINUX)-sh4-$(FINDUTILS)-$(FINDUTILS_VERSION).sh4.rpm
	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps --force --noscripts -Uhv \
		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^)
	touch $@
	@FLASHROOTDIR_MODIFIED@

$(DISTRIBUTIONUTILS_RPM) $(DISTRIBUTIONUTILS_DOC_RPM): \
		$(if $(DISTRIBUTIONUTILS_SPEC_PATCH),Patches/$(DISTRIBUTIONUTILS_SPEC_PATCH)) \
		$(if $(DISTRIBUTIONUTILS_PATCHES),$(DISTRIBUTIONUTILS_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(DISTRIBUTIONUTILS)-$(DISTRIBUTIONUTILS_VERSION).src.rpm \
		| $(DEPDIR)/$(GLIBC_DEV)
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(DISTRIBUTIONUTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(DISTRIBUTIONUTILS_SPEC) < ../Patches/$(DISTRIBUTIONUTILS_SPEC_PATCH) ) &&) \
	$(if $(DISTRIBUTIONUTILS_PATCHES),cp $(DISTRIBUTIONUTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(DISTRIBUTIONUTILS_SPEC)

$(DEPDIR)/min-$(DISTRIBUTIONUTILS) $(DEPDIR)/std-$(DISTRIBUTIONUTILS) $(DEPDIR)/max-$(DISTRIBUTIONUTILS) \
$(DEPDIR)/$(DISTRIBUTIONUTILS): \
$(DEPDIR)/%$(DISTRIBUTIONUTILS): $(DISTRIBUTIONUTILS_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps --force -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/min-$(DISTRIBUTIONUTILS_DOC) $(DEPDIR)/std-$(DISTRIBUTIONUTILS_DOC) $(DEPDIR)/max-$(DISTRIBUTIONUTILS_DOC) \
$(DEPDIR)/$(DISTRIBUTIONUTILS_DOC): \
$(DEPDIR)/%$(DISTRIBUTIONUTILS_DOC): $(DISTRIBUTIONUTILS_DOC_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  --force -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true

@TARGETRULESET_FLASH_TRUE@flash-distributionutils: $(flashprefix)/root/usr/sbin/initdconfig

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/sbin/initdconfig: $(DISTRIBUTIONUTILS_RPM)
@TARGETRULESET_FLASH_TRUE@	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps --force --noscripts -Uhv \
@TARGETRULESET_FLASH_TRUE@		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^)
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

$(MTD_UTILS_RPM): \
		$(if $(MTD_UTILS_SPEC_PATCH),Patches/$(MTD_UTILS_SPEC_PATCH)) \
		$(if $(MTD_UTILS_PATCHES),$(MTD_UTILS_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(MTD_UTILS)-$(MTD_UTILS_VERSION).src.rpm libz
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(MTD_UTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(MTD_UTILS_SPEC) < ../Patches/$(MTD_UTILS_PATCH) ) &&) \
	$(if $(MTD_UTILS_PATCHES),cp $(MTD_UTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --nodeps --target=sh4-linux SPECS/$(MTD_UTILS_SPEC)

$(DEPDIR)/min-$(MTD_UTILS) $(DEPDIR)/std-$(MTD_UTILS) $(DEPDIR)/max-$(MTD_UTILS) \
$(DEPDIR)/$(MTD_UTILS): \
$(DEPDIR)/%$(MTD_UTILS): $(MTD_UTILS_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps --force -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^)
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-mtd-utils: $(flashprefix)/root/usr/sbin/flash_info

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/sbin/flash_info: $(MTD_UTILS_RPM)
@TARGETRULESET_FLASH_TRUE@	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps --force --noscripts -Uhv \
@TARGETRULESET_FLASH_TRUE@		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^) && \
@TARGETRULESET_FLASH_TRUE@	rm -rf $(flashprefix)/root/usr/share && \
@TARGETRULESET_FLASH_TRUE@	rm $(flashprefix)/root/usr/sbin/{doc_loadbios,docfdisk,flash_otp_dump,flash_otp_info,ftl_check,ftl_format} && \
@TARGETRULESET_FLASH_TRUE@	rm $(flashprefix)/root/usr/sbin/{jffs2dump,mkfs.jffs,mkfs.jffs2,nanddump,nandwrite,nftl_format,nftldump,rfddump,rfdformat,sumtool}
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

$(BASH_RPM): \
		$(if $(BASH_SPEC_PATCH),Patches/$(BASH_SPEC_PATCH)) \
		$(if $(BASH_PATCHES),$(BASH_PATCHES:%=Patches/%)) \
		$(DEPDIR)/$(GLIBC_DEV) \
		$(DEPDIR)/$(LIBTERMCAP_DEV) \
		Archive/$(STLINUX)-target-$(BASH)-$(BASH_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(BASH_SPEC_PATCH),( cd SPECS && patch -p1 $(BASH_SPEC) < ../Patches/$(BASH_PATCH) ) &&) \
	$(if $(BASH_PATCHES),cp $(BASH_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(BASH_SPEC)

$(DEPDIR)/min-$(BASH) $(DEPDIR)/std-$(BASH) $(DEPDIR)/max-$(BASH) $(DEPDIR)/$(BASH): \
$(DEPDIR)/%$(BASH): $(DEPDIR)/%$(GLIBC) $(DEPDIR)/%$(LIBTERMCAP) $(BASH_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps --noscripts --force -Uhvv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

min-$(BASH).do_clean std-$(BASH).do_clean max-$(BASH).do_clean $(BASH).do_clean: \
%$(BASH).do_clean:
	export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && \
	$(hostprefix)/bin/target-shellconfig --list || true && \
	( $(hostprefix)/bin/target-shellconfig --del /bin/bash ) &> /dev/null || echo "Unable to unregister shell" && \
	$(hostprefix)/bin/target-shellconfig --list && \
	rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) -ev --noscripts $(STLINUX)-sh4-$(BASH) || true && \
	[ "x$*" = "x" ] && [ -f .deps/$(subst -clean,,$@) ] && rm .deps/$(subst -clean,,$@) || true

$(COREUTILS_RPM): \
		$(if $(COREUTILS_SPEC_PATCH),Patches/$(COREUTILS_SPEC_PATCH)) \
		$(if $(COREUTILS_PATCHES),$(COREUTILS_PATCHES:%=Patches/%)) \
		$(DEPDIR)/$(GLIBC_DEV) \
		Archive/$(STLINUX)-target-$(COREUTILS)-$(COREUTILS_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(COREUTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(COREUTILS_SPEC) < ../Patches/$(COREUTILS_PATCH) ) &&) \
	$(if $(COREUTILS_PATCHES),cp $(COREUTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(COREUTILS_SPEC)

$(DEPDIR)/min-$(COREUTILS) $(DEPDIR)/std-$(COREUTILS) $(DEPDIR)/max-$(COREUTILS) $(DEPDIR)/$(COREUTILS): \
$(DEPDIR)/%$(COREUTILS): $(DEPDIR)/%$(GLIBC) $(COREUTILS_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --force -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(NET_TOOLS_RPM): \
		$(if $(NET_TOOLS_SPEC_PATCH),Patches/$(NET_TOOLS_SPEC_PATCH)) \
		$(if $(NET_TOOLS_PATCHES),$(NET_TOOLS_PATCHES:%=Patches/%)) \
		$(DEPDIR)/$(GLIBC_DEV) \
		Archive/$(STLINUX)-target-$(NET_TOOLS)-$(NET_TOOLS_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(NET_TOOLS_SPEC_PATCH),( cd SPECS && patch -p1 $(NET_TOOLS_SPEC) < ../Patches/$(NET_TOOLS_PATCH) ) &&) \
	$(if $(NET_TOOLS_PATCHES),cp $(NET_TOOLS_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(NET_TOOLS_SPEC)

$(DEPDIR)/min-$(NET_TOOLS) $(DEPDIR)/std-$(NET_TOOLS) $(DEPDIR)/max-$(NET_TOOLS) $(DEPDIR)/$(NET_TOOLS): \
$(DEPDIR)/%$(NET_TOOLS): $(DEPDIR)/%$(GLIBC) $(NET_TOOLS_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --force -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(SED_RPM): \
		$(if $(SED_SPEC_PATCH),Patches/$(SED_SPEC_PATCH)) \
		$(if $(SED_PATCHES),$(SED_PATCHES:%=Patches/%)) \
		$(DEPDIR)/$(GLIBC_DEV) \
		Archive/$(STLINUX)-target-$(SEDX)-$(SED_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(SED_SPEC_PATCH),( cd SPECS && patch -p1 $(SED_SPEC) < ../Patches/$(SED_PATCH) ) &&) \
	$(if $(SED_PATCHES),cp $(SED_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(SED_SPEC)

$(DEPDIR)/min-$(SEDX) $(DEPDIR)/std-$(SEDX) $(DEPDIR)/max-$(SEDX) $(DEPDIR)/$(SEDX): \
$(DEPDIR)/%$(SEDX): $(DEPDIR)/%$(GLIBC) $(SED_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  --force -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DIFF_RPM) $(DIFF_DOC_RPM): \
		$(if $(DIFF_SPEC_PATCH),Patches/$(DIFF_SPEC_PATCH)) \
		$(if $(DIFF_PATCHES),$(DIFF_PATCHES:%=Patches/%)) \
		$(DEPDIR)/$(GLIBC_DEV) \
		Archive/$(STLINUX)-target-$(DIFF)-$(DIFF_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(DIFF_SPEC_PATCH),( cd SPECS && patch -p1 $(DIFF_SPEC) < ../Patches/$(DIFF_PATCH) ) &&) \
	$(if $(DIFF_PATCHES),cp $(DIFF_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(DIFF_SPEC)

$(DEPDIR)/min-$(DIFF) $(DEPDIR)/std-$(DIFF) $(DEPDIR)/max-$(DIFF) $(DEPDIR)/$(DIFF): \
$(DEPDIR)/%$(DIFF): $(DEPDIR)/%$(GLIBC) $(DIFF_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  --force -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) .deps/$(notdir $@) || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/min-$(DIFF_DOC) $(DEPDIR)/std-$(DIFF_DOC) $(DEPDIR)/max-$(DIFF_DOC) $(DEPDIR)/$(DIFF_DOC): \
$(DEPDIR)/%$(DIFF_DOC): $(DIFF_DOC_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  --force -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(FILE_RPM): \
		$(if $(FILE_SPEC_PATCH),Patches/$(FILE_SPEC_PATCH)) \
		$(if $(FILE_PATCHES),$(FILE_PATCHES:%=Patches/%)) \
		Archive/stlinux22-target-$(FILE)-$(FILE_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(FILE_SPEC_PATCH),( cd SPECS && patch -p1 $(FILE_SPEC) < ../Patches/$(FILE_PATCH) ) &&) \
	$(if $(FILE_PATCHES),cp $(FILE_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(FILE_SPEC)

$(DEPDIR)/min-$(FILE) $(DEPDIR)/std-$(FILE) $(DEPDIR)/max-$(FILE) $(DEPDIR)/$(FILE): \
$(DEPDIR)/%$(FILE): $(FILE_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  --force -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(TAR_RPM): \
		$(if $(TAR_SPEC_PATCH),Patches/$(TAR_SPEC_PATCH)) \
		$(if $(TAR_PATCHES),$(TAR_PATCHES:%=Patches/%)) \
		$(DEPDIR)/$(GLIBC_DEV) \
		Archive/$(STLINUX)-target-$(TAR)-$(TAR_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(TAR_SPEC_PATCH),( cd SPECS && patch -p1 $(TAR_SPEC) < ../Patches/$(TAR_PATCH) ) &&) \
	$(if $(TAR_PATCHES),cp $(TAR_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(TAR_SPEC)

$(DEPDIR)/min-$(TAR) $(DEPDIR)/std-$(TAR) $(DEPDIR)/max-$(TAR) $(DEPDIR)/$(TAR): \
$(DEPDIR)/%$(TAR): $(DEPDIR)/%$(GLIBC) $(TAR_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  --force -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(STRACE_RPM): \
		$(if $(STRACE_SPEC_PATCH),Patches/$(STRACE_SPEC_PATCH)) \
		$(if $(STRACE_PATCHES),$(STRACE_PATCHES:%=Patches/%)) \
		$(DEPDIR)/$(GLIBC_DEV) \
		Archive/$(STLINUX)-target-$(STRACE)-$(STRACE_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(STRACE_SPEC_PATCH),( cd SPECS && patch -p1 $(STRACE_SPEC) < ../Patches/$(STRACE_PATCH) ) &&) \
	$(if $(STRACE_PATCHES),cp $(STRACE_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(STRACE_SPEC)

$(DEPDIR)/min-$(STRACE) $(DEPDIR)/std-$(STRACE) $(DEPDIR)/max-$(STRACE) $(DEPDIR)/$(STRACE): \
$(DEPDIR)/%$(STRACE): $(DEPDIR)/%$(GLIBC) $(STRACE_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch  --force --noscripts -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

flash-strace: $(flashprefix)/root/usr/bin/strace

$(flashprefix)/root/usr/bin/strace: $(STRACE_RPM)
	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps --force --noscripts -Uhv \
		--replacepkgs --badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^)
	touch $@
	@FLASHROOTDIR_MODIFIED@

@STM24_TRUE@$(UTIL_LINUX_RPM): \
@STM24_TRUE@		$(if $(UTIL_LINUX_SPEC_PATCH),Patches/$(UTIL_LINUX_SPEC_PATCH)) \
@STM24_TRUE@		$(if $(UTIL_LINUX_PATCHES),$(UTIL_LINUX_PATCHES:%=Patches/%)) \
@STM24_TRUE@		Archive/$(STLINUX)-target-$(UTIL_LINUX)-$(UTIL_LINUX_VERSION).src.rpm \
@STM24_TRUE@		| $(NCURSES_DEV)
@STM24_TRUE@	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
@STM24_TRUE@	$(if $(UTIL_LINUX_SPEC_PATCH),( cd SPECS && patch -p1 $(UTIL_LINUX_SPEC) < ../Patches/$(UTIL_LINUX_SPEC_PATCH) ) &&) \
@STM24_TRUE@	$(if $(UTIL_LINUX_PATCHES),cp $(UTIL_LINUX_PATCHES:%=Patches/%) SOURCES/ &&) \
@STM24_TRUE@	export PATH=$(hostprefix)/bin:$(PATH) && \
@STM24_TRUE@	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(UTIL_LINUX_SPEC)

@STM24_TRUE@$(DEPDIR)/$(UTIL_LINUX): $(UTIL_LINUX_RPM)
@STM24_TRUE@	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps --force -Uhv \
@STM24_TRUE@		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
@STM24_TRUE@	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
@STM24_TRUE@	$(REWRITE_PKGCONF) $(PKG_CONFIG_PATH)/uuid.pc
@STM24_TRUE@	$(REWRITE_PKGCONF) $(PKG_CONFIG_PATH)/blkid.pc
@STM24_TRUE@	$(REWRITE_LIBDEP)/lib{blkid,uuid}.la
@STM24_TRUE@	$(REWRITE_LIBDIR)/lib{blkid,uuid}.la
@STM24_TRUE@	@TUXBOX_YAUD_CUSTOMIZE@

##################################################################################################

.PHONY: flash-tcp-wrappers

#
# MODULE-INIT-TOOLS
#
$(DEPDIR)/module-init-tools.do_prepare: @DEPENDS_module_init_tools@
	@PREPARE_module_init_tools@
	touch $@

$(DEPDIR)/module-init-tools.do_compile: bootstrap $(DEPDIR)/module-init-tools.do_prepare
	cd @DIR_module_init_tools@  && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix= && \
		$(MAKE)
	touch $@
#			--enable-zlib \
#

$(DEPDIR)/min-module-init-tools $(DEPDIR)/std-module-init-tools $(DEPDIR)/max-module-init-tools \
$(DEPDIR)/module-init-tools: \
$(DEPDIR)/%module-init-tools: $(DEPDIR)/%lsb $(MODULE_INIT_TOOLS:%=root/etc/%) $(DEPDIR)/module-init-tools.do_compile
	cd @DIR_module_init_tools@  && \
		@INSTALL_module_init_tools@
	$(call adapted-etc-files,$(MODULE_INIT_TOOLS_ADAPTED_ETC_FILES))
	$(call initdconfig,module-init-tools)
#	@DISTCLEANUP_module_init_tools@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-module-init-tools: $(flashprefix)/root/sbin/depmod

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/sbin/depmod: flash-lsb $(MODULE_INIT_TOOLS:%=root/etc/%) $(DEPDIR)/module-init-tools.do_compile | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_module_init_tools@  && \
@TARGETRULESET_FLASH_TRUE@		for i in depmod modinfo ; do \
@TARGETRULESET_FLASH_TRUE@			$(INSTALL) -m 755 $$i $(@D) ; done
@TARGETRULESET_FLASH_TRUE@	$(call adapted-etc-flashfiles,$(MODULE_INIT_TOOLS_ADAPTED_ETC_FILES))
@TARGETRULESET_FLASH_TRUE@	$(call initdconfig-flash,module-init-tools)
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# GREP
#
$(DEPDIR)/grep.do_prepare: @DEPENDS_grep@
	@PREPARE_grep@
	cd @DIR_grep@ && \
		gunzip -cd ../$(lastword $^) | cat > debian.patch && \
		patch -p1 <debian.patch
	touch $@

$(DEPDIR)/grep.do_compile: bootstrap $(DEPDIR)/grep.do_prepare
	cd @DIR_grep@  && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--disable-nls \
			--disable-perl-regexp \
			--libdir=$(targetprefix)/usr/lib \
			--prefix=/usr && \
		$(MAKE)
	touch $@

$(DEPDIR)/min-grep $(DEPDIR)/std-grep $(DEPDIR)/max-grep \
$(DEPDIR)/grep: \
$(DEPDIR)/%grep: $(DEPDIR)/grep.do_compile
	cd @DIR_grep@  && \
		@INSTALL_grep@
#	@DISTCLEANUP_grep@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-grep: $(flashprefix)/root/usr/bin/grep

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/bin/grep: $(DEPDIR)/grep.do_compile | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_grep@  && \
@TARGETRULESET_FLASH_TRUE@		for i in src/{grep,egrep,fgrep} ; do \
@TARGETRULESET_FLASH_TRUE@			$(INSTALL) -m 755 $$i $(@D) ; done
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# LSB
#
$(DEPDIR)/lsb.do_prepare: @DEPENDS_lsb@
	@PREPARE_lsb@
	touch $@

$(DEPDIR)/lsb.do_compile: bootstrap $(DEPDIR)/lsb.do_prepare
	touch $@

$(DEPDIR)/min-lsb $(DEPDIR)/std-lsb $(DEPDIR)/max-lsb \
$(DEPDIR)/lsb: \
$(DEPDIR)/%lsb: $(DEPDIR)/lsb.do_compile
	cd @DIR_lsb@  && \
		@INSTALL_lsb@
#	@DISTCLEANUP_lsb@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-lsb: $(flashprefix)/root/lib/lsb/init-functions

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/lib/lsb/init-functions: $(DEPDIR)/lsb.do_compile | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_lsb@  && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -d $(@D) && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 644 init-functions $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# PORTMAP
#
$(DEPDIR)/portmap.do_prepare: @DEPENDS_portmap@
	@PREPARE_portmap@
	cd @DIR_portmap@ && \
		gunzip -cd ../$(lastword $^) | cat > debian.patch && \
		patch -p1 <debian.patch && \
		sed -e 's/### BEGIN INIT INFO/# chkconfig: S 41 10\n### BEGIN INIT INFO/g' -i debian/init.d
	touch $@

$(DEPDIR)/portmap.do_compile: bootstrap $(DEPDIR)/portmap.do_prepare
	cd @DIR_portmap@  && \
		$(BUILDENV) \
		$(MAKE)
	touch $@

$(DEPDIR)/min-portmap $(DEPDIR)/std-portmap $(DEPDIR)/max-portmap \
$(DEPDIR)/portmap: \
$(DEPDIR)/%portmap: $(DEPDIR)/%lsb $(PORTMAP_ADAPTED_ETC_FILES:%=root/etc/%) $(DEPDIR)/portmap.do_compile
	cd @DIR_portmap@  && \
		@INSTALL_portmap@
	$(call adapted-etc-files,$(PORTMAP_ADAPTED_ETC_FILES))
	$(call initdconfig,portmap)
#	@DISTCLEANUP_portmap@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-portmap: $(flashprefix)/root/sbin/portmap

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/sbin/portmap: bootstrap flash-lsb $(DEPDIR)/portmap.do_compile \
@TARGETRULESET_FLASH_TRUE@		$(PORTMAP_ADAPTED_ETC_FILES:%=root/etc/%) | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_portmap@  && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 0755 portmap $(flashprefix)/root/sbin && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 0755 pmap_dump $(flashprefix)/root/sbin && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 0755 pmap_set $(flashprefix)/root/sbin && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 755 debian/init.d $(flashprefix)/root/etc/init.d/portmap
@TARGETRULESET_FLASH_TRUE@	$(call adapted-etc-flashfiles,$(PORTMAP_ADAPTED_ETC_FILES))
@TARGETRULESET_FLASH_TRUE@	$(call initdconfig-flash,portmap)
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# OPENRDATE
#
$(DEPDIR)/openrdate.do_prepare: bootstrap @DEPENDS_openrdate@
	@PREPARE_openrdate@
	cd @DIR_openrdate@
	touch $@

$(DEPDIR)/openrdate.do_compile: $(DEPDIR)/openrdate.do_prepare
	cd @DIR_openrdate@  && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--target=$(target) \
			--prefix=/usr && \
		$(MAKE) 
	touch $@

$(DEPDIR)/min-openrdate $(DEPDIR)/std-openrdate $(DEPDIR)/max-openrdate \
$(DEPDIR)/openrdate: \
$(DEPDIR)/%openrdate: $(OPENRDATE_ADAPTED_ETC_FILES:%=root/etc/%) \
		$(DEPDIR)/openrdate.do_compile
	cd @DIR_openrdate@  && \
		@INSTALL_openrdate@
	( cd root/etc && for i in $(OPENRDATE_ADAPTED_ETC_FILES); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(prefix)/$*cdkroot/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(prefix)/$*cdkroot/etc/$$i || true; done ) && \
	( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
		for s in rdate.sh ; do \
			$(hostprefix)/bin/target-initdconfig --add $$s || \
			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true )
#	@DISTCLEANUP_openrdate@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-openrdate: $(flashprefix)/root/usr/bin/rdate

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/bin/rdate: bootstrap $(DEPDIR)/openrdate.do_compile \
@TARGETRULESET_FLASH_TRUE@		$(OPENRDATE_ADAPTED_ETC_FILES:%=root/etc/%) | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_openrdate@  && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 755 src/rdate $@
@TARGETRULESET_FLASH_TRUE@	( cd root/etc && for i in $(OPENRDATE_ADAPTED_ETC_FILES); do \
@TARGETRULESET_FLASH_TRUE@		[ -f $$i ] && $(INSTALL) -m644 $$i $(flashprefix)/root/etc/$$i || true; \
@TARGETRULESET_FLASH_TRUE@		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(flashprefix)/root/etc/$$i || true; done ) && \
@TARGETRULESET_FLASH_TRUE@	( export HHL_CROSS_TARGET_DIR=$(flashprefix)/root && cd $(flashprefix)/root/etc/init.d && \
@TARGETRULESET_FLASH_TRUE@		for s in rdate.sh ; do \
@TARGETRULESET_FLASH_TRUE@			$(hostprefix)/bin/target-initdconfig --add $$s || \
@TARGETRULESET_FLASH_TRUE@			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true )
@TARGETRULESET_FLASH_TRUE@	@touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# E2FSPROGS
#
$(DEPDIR)/e2fsprogs.do_prepare: bootstrap @DEPENDS_e2fsprogs@
	@PREPARE_e2fsprogs@
	touch $@

@STM24_TRUE@$(DEPDIR)/e2fsprogs.do_compile: $(DEPDIR)/e2fsprogs.do_prepare | $(UTIL_LINUX)
@STM24_TRUE@	cd @DIR_e2fsprogs@ && \
@STM24_TRUE@	$(BUILDENV) \
@STM24_TRUE@	CFLAGS="$(TARGET_CFLAGS) -Os" \
@STM24_TRUE@	cc=$(target)-gcc \
@STM24_TRUE@	./configure \
@STM24_TRUE@		--build=$(build) \
@STM24_TRUE@		--host=$(target) \
@STM24_TRUE@		--target=$(target) \
@STM24_TRUE@		--with-linker=$(target)-ld \
@STM24_TRUE@		--enable-elf-shlibs \
@STM24_TRUE@		--with-root-prefix= \
@STM24_TRUE@		--enable-verbose-makecmds \
@STM24_TRUE@		--enable-symlink-install \
@STM24_TRUE@		--enable-compression \
@STM24_TRUE@		--disable-libblkid \
@STM24_TRUE@		--disable-libuuid \
@STM24_TRUE@		--disable-uuidd && \
@STM24_TRUE@	$(MAKE) all && \
@STM24_TRUE@	$(MAKE) -C e2fsck e2fsck.static
@STM24_TRUE@	touch $@
@STM24_FALSE@$(DEPDIR)/e2fsprogs.do_compile: $(DEPDIR)/e2fsprogs.do_prepare
@STM24_FALSE@	cd @DIR_e2fsprogs@ && \
@STM24_FALSE@	$(BUILDENV) \
@STM24_FALSE@	./configure \
@STM24_FALSE@		--build=$(build) \
@STM24_FALSE@		--host=$(target) \
@STM24_FALSE@		--target=$(target) \
@STM24_FALSE@		--with-linker=$(target)-ld \
@STM24_FALSE@		$(if $(STABLE), cc="$(target)-gcc") \
@STM24_FALSE@		--enable-htree \
@STM24_FALSE@		--disable-profile \
@STM24_FALSE@		--disable-e2initrd-helper \
@STM24_FALSE@		--disable-swapfs \
@STM24_FALSE@		--disable-debugfs \
@STM24_FALSE@		--disable-imager \
@STM24_FALSE@		--enable-resizer \
@STM24_FALSE@		--enable-dynamic-e2fsck \
@STM24_FALSE@		--enable-fsck \
@STM24_FALSE@		--with-gnu-ld \
@STM24_FALSE@		--disable-nls \
@STM24_FALSE@		--prefix=/usr \
@STM24_FALSE@		--enable-elf-shlibs \
@STM24_FALSE@		--enable-dynamic-e2fsck \
@STM24_FALSE@		--disable-evms \
@STM24_FALSE@		--with-root-prefix= && \
@STM24_FALSE@		$(MAKE) libs progs
@STM24_FALSE@	touch $@

@STM24_TRUE@$(DEPDIR)/e2fsprogs: $(DEPDIR)/e2fsprogs.do_compile
@STM24_TRUE@	cd @DIR_e2fsprogs@ && \
@STM24_TRUE@	$(BUILDENV) \
@STM24_TRUE@	$(MAKE) install install-libs \
@STM24_TRUE@		LDCONFIG=true \
@STM24_TRUE@		DESTDIR=$(targetprefix) && \
@STM24_TRUE@	$(INSTALL) e2fsck/e2fsck.static $(targetprefix)/sbin
@STM24_TRUE@	touch $@
@STM24_TRUE@	@TUXBOX_YAUD_CUSTOMIZE@
@STM24_FALSE@$(DEPDIR)/min-e2fsprogs $(DEPDIR)/std-e2fsprogs $(DEPDIR)/max-e2fsprogs $(DEPDIR)/ipk-e2fsprogs \
@STM24_FALSE@$(DEPDIR)/e2fsprogs: \
@STM24_FALSE@$(DEPDIR)/%e2fsprogs: $(DEPDIR)/e2fsprogs.do_compile
@STM24_FALSE@	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/ipk-cdkroot || true
@STM24_FALSE@	cd @DIR_e2fsprogs@ && \
@STM24_FALSE@		@INSTALL_e2fsprogs@
@STM24_FALSE@	[ "x$*" = "x" ] && ( cd @DIR_e2fsprogs@ && \
@STM24_FALSE@		$(MAKE) install -C lib/uuid DESTDIR=$(targetprefix) && \
@STM24_FALSE@		$(MAKE) install -C lib/blkid DESTDIR=$(targetprefix) ) || true
#       @DISTCLEANUP_e2fsprogs@
@STM24_FALSE@	@[ "x$*" = "x" ] && touch $@ || true
@STM24_FALSE@	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-e2fsprogs: $(flashprefix)/root/sbin/mke2fs

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/sbin/mke2fs: bootstrap $(DEPDIR)/e2fsprogs | $(flashprefix)
@TARGETRULESET_FLASH_TRUE@	cd @DIR_e2fsprogs@ && \
@TARGETRULESET_FLASH_TRUE@		for i in misc/chattr misc/lsattr misc/uuidgen; do \
@TARGETRULESET_FLASH_TRUE@			$(INSTALL) $$i $(flashprefix)/root/bin; done && \
@TARGETRULESET_FLASH_TRUE@		for i in e2fsck/e2fsck misc/fsck misc/mke2fs; do \
@TARGETRULESET_FLASH_TRUE@			$(INSTALL) $$i $(flashprefix)/root/sbin; done && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) misc/mke2fs.conf $(flashprefix)/root/etc && \
@TARGETRULESET_FLASH_TRUE@		ln -sf e2fsck $(flashprefix)/root/sbin/fsck.ext2 && \
@TARGETRULESET_FLASH_TRUE@		ln -sf e2fsck $(flashprefix)/root/sbin/fsck.ext3 && \
@TARGETRULESET_FLASH_TRUE@		ln -sf mke2fs $(flashprefix)/root/sbin/mkfs.ext2 && \
@TARGETRULESET_FLASH_TRUE@		ln -sf mke2fs $(flashprefix)/root/sbin/mkfs.ext3 && \
@TARGETRULESET_FLASH_TRUE@		ln -sf tune2fs $(flashprefix)/root/sbin/e2label && \
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
#		for i in e2fsck/e2fsck misc/fsck misc/mke2fs misc/tune2fs; do \
#

#
# XFSPROGS
#
$(DEPDIR)/xfsprogs.do_prepare: bootstrap @DEPENDS_xfsprogs@
	@PREPARE_xfsprogs@
	touch $@

$(DEPDIR)/xfsprogs.do_compile: $(DEPDIR)/e2fsprogs $(DEPDIR)/libreadline $(DEPDIR)/xfsprogs.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_xfsprogs@ && \
		export DEBUG=-DNDEBUG && export OPTIMIZER=-O2 && \
		mv -f aclocal.m4 aclocal.m4.orig && mv Makefile Makefile.sgi || true && chmod 644 Makefile.sgi && \
		aclocal -I m4 -I $(hostprefix)/share/aclocal && \
		autoconf && \
		libtoolize && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--target=$(target) \
			--prefix= \
			--enable-shared=yes \
			--enable-gettext=yes \
			--enable-readline=yes \
			--enable-editline=no \
			--enable-termcap=yes \
			--enable-shared-uuid=yes && \
		cp -p Makefile.sgi Makefile && export top_builddir=`pwd` && \
		$(MAKE) $(MAKE_OPTS)
	touch $@

$(DEPDIR)/min-xfsprogs $(DEPDIR)/std-xfsprogs $(DEPDIR)/max-xfsprogs $(DEPDIR)/ipk-xfsprogs \
$(DEPDIR)/xfsprogs: \
$(DEPDIR)/%xfsprogs: $(DEPDIR)/xfsprogs.do_compile
	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/ipk-cdkroot || true
	cd @DIR_xfsprogs@ && \
		export top_builddir=`pwd` && \
		@INSTALL_xfsprogs@
#       @DISTCLEANUP_xfsprogs@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-xfsprogs: $(flashprefix)/root/sbin/mkfs.xfs 

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/sbin/mkfs.xfs: bootstrap $(DEPDIR)/xfsprogs.do_compile
@TARGETRULESET_FLASH_TRUE@	cd @DIR_xfsprogs@ && \
@TARGETRULESET_FLASH_TRUE@		for i in mkfs/mkfs.xfs repair/xfs_repair; do \
@TARGETRULESET_FLASH_TRUE@			$(INSTALL) $$i $(flashprefix)/root/sbin; done && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) fsck/xfs_fsck.sh $(flashprefix)/root/sbin/fsck.xfs && \
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

xfsprogs.build_ipk: $(DEPDIR)/ipk-xfsprogs
	cp -prd ipk-control/xfsprogs/* $(prefix)/ipk-cdkroot && make $(prefix)/ipk-cdkroot/strippy && \
	ipkg-build -o root -g root $(prefix)/ipk-cdkroot $(prefix)/ipk
#	-rm -rf  $(prefix)/ipk-cdkroot

#
# MC
#
$(DEPDIR)/mc.do_prepare: @DEPENDS_mc@
	@PREPARE_mc@
	touch $@

$(DEPDIR)/mc.do_compile: bootstrap glib2 $(DEPDIR)/mc.do_prepare | $(NCURSES_DEV) 
	cd @DIR_mc@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--without-gpm-mouse \
			--with-screen=ncurses \
			--without-x && \
		$(MAKE) all
	touch $@

$(DEPDIR)/min-mc $(DEPDIR)/std-mc $(DEPDIR)/max-mc \
$(DEPDIR)/mc: \
$(DEPDIR)/%mc: %glib2 $(DEPDIR)/mc.do_compile
	cd @DIR_mc@ && \
		@INSTALL_mc@
#		export top_builddir=`pwd` && \
#		$(MAKE) install DESTDIR=$(prefix)/$*cdkroot
#       @DISTCLEANUP_mc@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# Evaluate package mc
# call MacroName,Source Package,Package
$(eval $(call Package,mc,mc))

#
# SDPARM
#
$(DEPDIR)/sdparm.do_prepare: @DEPENDS_sdparm@
	@PREPARE_sdparm@
	touch $@

$(DEPDIR)/sdparm.do_compile: $(DEPDIR)/sdparm.do_prepare
	cd @DIR_sdparm@ && \
		export PATH=$(MAKE_PATH) && \
		$(MAKE) clean || true && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix= \
			--exec-prefix=/usr \
			--mandir=/usr/share/man && \
		$(MAKE) $(MAKE_OPTS)
	touch $@

$(DEPDIR)/min-sdparm $(DEPDIR)/std-sdparm $(DEPDIR)/max-sdparm $(DEPDIR)/ipk-sdparm $(DEPDIR)/sdparm: \
$(DEPDIR)/%sdparm: $(DEPDIR)/sdparm.do_compile
	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/ipk-cdkroot || true
	cd @DIR_sdparm@ && \
		export PATH=$(MAKE_PATH) && \
		@INSTALL_sdparm@
	@( cd $(prefix)/$*cdkroot/usr/share/man/man8 && \
		gzip -v9 sdparm.8 )
#       @CLEANUP_sdparm@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

sdparm.build_ipk: $(DEPDIR)/ipk-sdparm
	cp -prd ipk-control/sdparm/* $(prefix)/ipk-cdkroot && \
	make $(prefix)/ipk-cdkroot/strippy && \
	ipkg-build -o root -g root $(prefix)/ipk-cdkroot $(prefix)/ipk
	-rm -rf  $(prefix)/ipk-cdkroot

#
# SG3_UTILS
#
$(DEPDIR)/sg3_utils.do_prepare: bootstrap @DEPENDS_sg3_utils@
	@PREPARE_sg3_utils@
	touch $@

$(DEPDIR)/sg3_utils.do_compile: $(DEPDIR)/sg3_utils.do_prepare
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd @DIR_sg3_utils@ && \
		$(MAKE) clean || true && \
		aclocal -I $(hostprefix)/share/aclocal && \
		autoconf && \
		libtoolize && \
		automake --add-missing --foreign && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix= && \
		$(MAKE) $(MAKE_OPTS)
	touch $@

$(DEPDIR)/min-sg3_utils $(DEPDIR)/std-sg3_utils $(DEPDIR)/max-sg3_utils $(DEPDIR)/ipk-sg3_utils \
$(DEPDIR)/sg3_utils: \
$(DEPDIR)/%sg3_utils: $(DEPDIR)/sg3_utils.do_compile
	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/ipk-cdkroot || true
	cd @DIR_sg3_utils@ && \
		export PATH=$(MAKE_PATH) && \
		@INSTALL_sg3_utils@
	$(INSTALL) -d $(prefix)/$*cdkroot/etc/default && \
	$(INSTALL) -d $(prefix)/$*cdkroot/etc/init.d && \
	$(INSTALL) -d $(prefix)/$*cdkroot/usr/sbin && \
	( cd root/etc && for i in $(SG3_UTILS_ADAPTED_ETC_FILES); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(prefix)/$*cdkroot/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(prefix)/$*cdkroot/etc/$$i || true; done ) && \
	$(INSTALL) -m755 root/usr/sbin/sg_down.sh $(prefix)/$*cdkroot/usr/sbin && \
	[ "x$*" != "xipk-" ] && \
             ( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
		for s in sg_down ; do \
			$(hostprefix)/bin/target-initdconfig --add $$s || \
			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true )
#       @DISTCLEANUP_sg3_utils@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

sg3_utils.build_ipk: $(DEPDIR)/ipk-sg3_utils
	cp -prd ipk-control/sg3_utils/* $(prefix)/ipk-cdkroot && \
	make $(prefix)/ipk-cdkroot/strippy && \
	ipkg-build -o root -g root $(prefix)/ipk-cdkroot $(prefix)/ipk
	-rm -rf  $(prefix)/ipk-cdkroot

@TARGETRULESET_FLASH_TRUE@flash-sg3_utils: $(flashprefix)/root/sbin/sg_start

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/sbin/sg_start: bootstrap $(SG3_UTILS_ADAPTED_ETC_FILES:%=root/etc/%) \
@TARGETRULESET_FLASH_TRUE@		$(DEPDIR)/sg3_utils.do_compile
@TARGETRULESET_FLASH_TRUE@	cd @DIR_sg3_utils@ && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m755 .libs/sg_start $@
@TARGETRULESET_FLASH_TRUE@	( cd root/etc && for i in $(SG3_UTILS_ADAPTED_ETC_FILES); do \
@TARGETRULESET_FLASH_TRUE@		[ -f $$i ] && $(INSTALL) -m644 $$i $(flashprefix)/root/etc/$$i || true; \
@TARGETRULESET_FLASH_TRUE@		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(flashprefix)/root/etc/$$i || true; done ) && \
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -m755 root/usr/sbin/sg_down.sh $(flashprefix)/root/sbin && \
@TARGETRULESET_FLASH_TRUE@	( export HHL_CROSS_TARGET_DIR=$(flashprefix)/root && cd $(flashprefix)/root/etc/init.d && \
@TARGETRULESET_FLASH_TRUE@		for s in sg_down ; do \
@TARGETRULESET_FLASH_TRUE@			$(hostprefix)/bin/target-initdconfig --add $$s || \
@TARGETRULESET_FLASH_TRUE@			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true ) && \
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@

#
# IPKG
#
$(DEPDIR)/ipkg.do_prepare: @DEPENDS_ipkg@
	@PREPARE_ipkg@
	touch $@

$(DEPDIR)/ipkg.do_compile: $(DEPDIR)/ipkg.do_prepare
	cd @DIR_ipkg@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr && \
		$(MAKE)
#			--datadir=/usr/share && \
#
	touch $@

$(DEPDIR)/min-ipkg $(DEPDIR)/std-ipkg $(DEPDIR)/max-ipkg \
$(DEPDIR)/ipkg: \
$(DEPDIR)/%ipkg: $(DEPDIR)/ipkg.do_compile
	cd @DIR_ipkg@ && \
		@INSTALL_ipkg@
	ln -sf ipkg-cl $(prefix)/$*cdkroot/usr/bin/ipkg && \
	$(INSTALL) -d $(prefix)/$*cdkroot/etc && $(INSTALL) -m 644 root/etc/ipkg.conf $(prefix)/$*cdkroot/etc && \
	$(INSTALL) -d $(prefix)/$*cdkroot/etc/ipkg
	$(INSTALL) -d $(prefix)/$*cdkroot/usr/lib/ipkg
	$(INSTALL) -m 644 root/usr/lib/ipkg/status.initial $(prefix)/$*cdkroot/usr/lib/ipkg/status
#	@DISTCLEANUP_ipkg@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-ipkg: $(flashprefix)/root/usr/bin/ipkg

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/bin/ipkg: $(DEPDIR)/ipkg.do_compile | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_ipkg@ && \
@TARGETRULESET_FLASH_TRUE@		$(MAKE) install DESTDIR=$|
@TARGETRULESET_FLASH_TRUE@	$(LN_SF) ipkg-cl $|/usr/bin/ipkg
@TARGETRULESET_FLASH_TRUE@	rm -rf $|/include/libipkg 
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -d $|/etc && $(INSTALL) -m 644 root/etc/ipkg.conf $|/etc/
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -d $(flashprefix)/root/usr/lib/ipkg
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -m 644 root/usr/lib/ipkg/status.initial $(flashprefix)/root/usr/lib/ipkg/status
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@
$(DEPDIR)/zd1211.do_prepare: @DEPENDS_zd1211@
	@PREPARE_zd1211@
	touch $@

$(DEPDIR)/zd1211.do_compile: $(DEPDIR)/zd1211.do_prepare
	cd @DIR_zd1211@ && \
		$(MAKE) KERNEL_LOCATION=$(buildprefix)/linux \
			ZD1211B=$(ZD1211B) \
			CROSS_COMPILE=$(target)- ARCH=sh
	touch $@

#$(DEPDIR)/min-zd1211 $(DEPDIR)/std-zd1211 $(DEPDIR)/max-zd1211 \
#
$(DEPDIR)/zd1211: \
$(DEPDIR)/%zd1211: $(DEPDIR)/zd1211.do_compile
	cd @DIR_zd1211@ && \
		$(MAKE) KERNEL_LOCATION=$(buildprefix)/linux \
			BIN_DEST=$(targetprefix)/bin \
			INSTALL_MOD_PATH=$(targetprefix) \
			install
	$(DEPMOD) -ae -b $(targetprefix) -r $(KERNELVERSION)
#	@DISTCLEANUP_zd1211@
#	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-zd1211.cramfs flash-zd1211.squashfs flash-zd1211.jffs2: \
@TARGETRULESET_FLASH_TRUE@flash-zd1211.%: bootstrap zd1211.do_compile | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	$(MAKE) zd1211 targetprefix=$(flashprefix)/root-$*
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# NANO
#
$(DEPDIR)/nano.do_prepare: @DEPENDS_nano@
	@PREPARE_nano@
	touch $@

$(DEPDIR)/nano.do_compile: bootstrap ncurses ncurses-dev $(DEPDIR)/nano.do_prepare 
	cd @DIR_nano@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--disable-nls \
			--enable-tiny \
			--enable-color && \
		$(MAKE)
	touch $@

$(DEPDIR)/min-nano $(DEPDIR)/std-nano $(DEPDIR)/max-nano \
$(DEPDIR)/nano: \
$(DEPDIR)/%nano: $(DEPDIR)/nano.do_compile
	cd @DIR_nano@ && \
		@INSTALL_nano@
#	@DISTCLEANUP_nano@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# Evaluate package nano
# call MacroName,Source Package,Package
$(eval $(call Package,nano,nano))

#
# RSYNC
#
$(DEPDIR)/rsync.do_prepare: @DEPENDS_rsync@
	@PREPARE_rsync@
	touch $@

$(DEPDIR)/rsync.do_compile: bootstrap $(DEPDIR)/rsync.do_prepare 
	cd @DIR_rsync@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--disable-debug \
			--disable-locale && \
		$(MAKE)
	touch $@

$(DEPDIR)/min-rsync $(DEPDIR)/std-rsync $(DEPDIR)/max-rsync \
$(DEPDIR)/rsync: \
$(DEPDIR)/%rsync: $(DEPDIR)/rsync.do_compile
	cd @DIR_rsync@ && \
		@INSTALL_rsync@
#	@DISTCLEANUP_rsync@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-rsync: $(flashprefix)/root/usr/bin/rsync

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/bin/rsync: $(DEPDIR)/rsync.do_compile | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_rsync@  && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) $(@F) $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# LM_SENSORS
#
$(DEPDIR)/lm_sensors.do_prepare: @DEPENDS_lm_sensors@
	@PREPARE_lm_sensors@
	touch $@

$(DEPDIR)/lm_sensors.do_compile: bootstrap $(DEPDIR)/lm_sensors.do_prepare 
	cd @DIR_lm_sensors@ && \
		$(MAKE) $(MAKE_OPTS) MACHINE=sh PREFIX=/usr user
	touch $@

$(DEPDIR)/min-lm_sensors $(DEPDIR)/std-lm_sensors $(DEPDIR)/max-lm_sensors \
$(DEPDIR)/lm_sensors: \
$(DEPDIR)/%lm_sensors: $(DEPDIR)/lm_sensors.do_compile
	cd @DIR_lm_sensors@ && \
		@INSTALL_lm_sensors@ && \
		rm $(prefix)/$*cdkroot/usr/bin/*.pl && \
		rm $(prefix)/$*cdkroot/usr/sbin/*.pl && \
		rm $(prefix)/$*cdkroot/usr/sbin/sensors-detect && \
		rm $(prefix)/$*cdkroot/usr/share/man/man8/sensors-detect.8 && \
		rm $(prefix)/$*cdkroot/usr/include/linux/i2c-dev.h && \
		rm $(prefix)/$*cdkroot/usr/bin/ddcmon
#	@DISTCLEANUP_lm_sensors@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-lm_sensors: $(flashprefix)/root/usr/sbin/i2cdetect

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/bin/i2cdetect: $(DEPDIR)/lm_sensors.do_compile | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_lm_sensors@  && \
@TARGETRULESET_FLASH_TRUE@		for i in prog/dump/{i2cset,i2cdump} detect/i2cdetect; do \
@TARGETRULESET_FLASH_TRUE@			$(INSTALL) $$i $(flashprefix)/root/usr/sbin; done
#	/usr/bin/sensors needs libsensors.so.3 -> if needed:
#$(flashprefix)/root/usr/bin/i2cdetect: $(DEPDIR)/lm_sensors | $(flashprefix)/root
#...		prog/sensors/sensors
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# FUSE
#
$(DEPDIR)/fuse.do_prepare: @DEPENDS_fuse@
	@PREPARE_fuse@
	touch $@

$(DEPDIR)/fuse.do_compile: bootstrap curl glib2 $(DEPDIR)/fuse.do_prepare
	cd @DIR_fuse@  && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -I$(buildprefix)/linux/arch/sh" \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--target=$(target) \
			--with-kernel=$(buildprefix)/$(KERNEL_DIR) \
			--disable-kernel-module \
			--prefix=/usr && \
		$(MAKE) all
	touch $@

$(DEPDIR)/min-fuse $(DEPDIR)/std-fuse $(DEPDIR)/max-fuse \
$(DEPDIR)/fuse: \
$(DEPDIR)/%fuse: %curl %glib2 $(DEPDIR)/fuse.do_compile
	cd @DIR_fuse@  && \
		@INSTALL_fuse@
	-rm $(prefix)/$*cdkroot/etc/udev/rules.d/99-fuse.rules
	-rmdir $(prefix)/$*cdkroot/etc/udev/rules.d
	-rmdir $(prefix)/$*cdkroot/etc/udev
	$(LN_SF) sh4-linux-fusermount $(prefix)/$*cdkroot/usr/bin/fusermount
	$(LN_SF) sh4-linux-ulockmgr_server $(prefix)/$*cdkroot/usr/bin/ulockmgr_server
	( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
		for s in fuse ; do \
			$(hostprefix)/bin/target-initdconfig --add $$s || \
			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true )
#	@DISTCLEANUP_fuse@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# Evaluate package libfuse
# call MacroName,Source Package,Package
$(eval $(call Package,fuse,libfuse))

# Evaluate package fuse-utils
# call MacroName,Source Package,Package
$(eval $(call Package,fuse,fuse-utils))

#
# CURLFTPFS
#
$(DEPDIR)/curlftpfs.do_prepare: @DEPENDS_curlftpfs@
	@PREPARE_curlftpfs@
	touch $@

$(DEPDIR)/curlftpfs.do_compile: fuse bootstrap $(DEPDIR)/curlftpfs.do_prepare
	cd @DIR_curlftpfs@ && \
		export ac_cv_func_malloc_0_nonnull=yes && \
		export ac_cv_func_realloc_0_nonnull=yes && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr && \
		$(MAKE) 
	touch $@

$(DEPDIR)/min-curlftpfs $(DEPDIR)/std-curlftpfs $(DEPDIR)/max-curlftpfs \
$(DEPDIR)/curlftpfs: \
$(DEPDIR)/%curlftpfs: %fuse $(DEPDIR)/curlftpfs.do_compile
	cd @DIR_curlftpfs@  && \
		@INSTALL_curlftpfs@
#	@DISTCLEANUP_curlftpfs@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

# Evaluate package curlftpfs
# call MacroName,Source Package,Package
$(eval $(call Package,curlftpfs,curlftpfs))

#
# FBSET
#
$(DEPDIR)/fbset.do_prepare: @DEPENDS_fbset@
	@PREPARE_fbset@
	touch $@

$(DEPDIR)/fbset.do_compile: bootstrap fbset.do_prepare
	cd @DIR_fbset@ && \
		make CC="$(target)-gcc -Wall -O2 -I."
	touch $@

$(DEPDIR)/min-fbset $(DEPDIR)/std-fbset $(DEPDIR)/max-fbset \
$(DEPDIR)/fbset: \
$(DEPDIR)/%fbset: fbset.do_compile
	cd @DIR_fbset@  && \
		@INSTALL_fbset@
#	@DISTCLEANUP_fbset@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# PNGQUANT
#
$(DEPDIR)/pngquant.do_prepare: @DEPENDS_pngquant@
	@PREPARE_pngquant@
	touch $@

$(DEPDIR)/pngquant.do_compile: bootstrap libz libpng pngquant.do_prepare 
	cd @DIR_pngquant@ && \
		$(target)-gcc -O3 -Wall -I. -funroll-loops -fomit-frame-pointer -o pngquant pngquant.c rwpng.c -lpng -lz -lm
	touch $@

$(DEPDIR)/min-pngquant $(DEPDIR)/std-pngquant $(DEPDIR)/max-pngquant \
$(DEPDIR)/pngquant: \
$(DEPDIR)/%pngquant: $(DEPDIR)/pngquant.do_compile
	cd @DIR_pngquant@ && \
		@INSTALL_pngquant@
#	@DISTCLEANUP_pngquant@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# MPLAYER
#
$(DEPDIR)/mplayer.do_prepare: @DEPENDS_mplayer@
	@PREPARE_mplayer@
	touch $@

$(DEPDIR)/mplayer.do_compile: bootstrap mplayer.do_prepare 
	cd @DIR_mplayer@ && \
		$(BUILDENV) \
		./configure \
			--cc=$(target)-gcc \
			--target=$(target) \
			--host-cc=gcc \
			--prefix=/usr \
			--disable-mencoder  && \
		$(MAKE) CC="$(target)-gcc"
	touch $@

$(DEPDIR)/min-mplayer $(DEPDIR)/std-mplayer $(DEPDIR)/max-mplayer \
$(DEPDIR)/mplayer: \
$(DEPDIR)/%mplayer: $(DEPDIR)/mplayer.do_compile
	cd @DIR_mplayer@ && \
		@INSTALL_mplayer@
#	@DISTCLEANUP_mplayer@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# MENCODER
#
#$(DEPDIR)/mencoder.do_prepare: @DEPENDS_mplayer@
#	@PREPARE_mplayer@
#	touch $@

$(DEPDIR)/mencoder.do_compile: bootstrap mplayer.do_prepare 
	cd @DIR_mencoder@ && \
		$(BUILDENV) \
		./configure \
			--cc=$(target)-gcc \
			--target=$(target) \
			--host-cc=gcc \
			--prefix=/usr \
			--disable-dvdnav \
			--disable-dvdread \
			--disable-dvdread-internal \
			--disable-libdvdcss-internal \
			--disable-libvorbis \
			--disable-mp3lib \
			--disable-liba52 \
			--disable-mad \
			--disable-vcd \
			--disable-ftp \
			--disable-pvr \
			--disable-tv-v4l2 \
			--disable-tv-v4l1 \
			--disable-tv \
			--disable-network \
			--disable-real \
			--disable-xanim \
			--disable-faad-internal \
			--disable-tremor-internal \
			--disable-pnm \
			--disable-ossaudio \
			--disable-tga \
			--disable-v4l2 \
			--disable-fbdev \
			--disable-dvb \
			--disable-mplayer && \
		$(MAKE) CC="$(target)-gcc"
	touch $@

$(DEPDIR)/min-mencoder $(DEPDIR)/std-mencoder $(DEPDIR)/max-mencoder \
$(DEPDIR)/mencoder: \
$(DEPDIR)/%mencoder: $(DEPDIR)/mencoder.do_compile
	cd @DIR_mencoder@ && \
		@INSTALL_mencoder@
#	@DISTCLEANUP_mencoder@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# UTIL-LINUX
#
# for stm24, look in contrib-apps-specs.mk 
@STM24_FALSE@$(DEPDIR)/util-linux.do_prepare: @DEPENDS_util_linux@
@STM24_FALSE@	@PREPARE_util_linux@
@STM24_FALSE@	cd @DIR_util_linux@ && \
@STM24_FALSE@		for p in `grep -v "^#" debian/patches/00list` ; do \
@STM24_FALSE@			patch -p1 < debian/patches/$$p.dpatch; \
@STM24_FALSE@		done; \
@STM24_FALSE@		patch -p1 < ../Patches/util-linux-stm.diff
@STM24_FALSE@	touch $@

@STM24_FALSE@$(DEPDIR)/util-linux.do_compile: bootstrap util-linux.do_prepare
@STM24_FALSE@	cd @DIR_util_linux@ && \
@STM24_FALSE@		sed -e 's/\ && .\/conftest//g' < configure > configure.new && \
@STM24_FALSE@		chmod +x configure.new && mv configure.new configure && \
@STM24_FALSE@		$(BUILDENV) \
@STM24_FALSE@		CFLAGS="$(TARGET_CFLAGS) -Os" \
@STM24_FALSE@		./configure && \
@STM24_FALSE@		sed 's/CURSESFLAGS=.*/CURSESFLAGS=-DNCH=1/' make_include > make_include.new && \
@STM24_FALSE@		mv make_include make_include.bak && \
@STM24_FALSE@		mv make_include.new make_include && \
@STM24_FALSE@		$(MAKE) ARCH=sh4 HAVE_SLANG=no HAVE_SHADOW=yes HAVE_PAM=no
@STM24_FALSE@	touch $@

@STM24_FALSE@$(DEPDIR)/min-util-linux $(DEPDIR)/std-util-linux $(DEPDIR)/max-util-linux \
@STM24_FALSE@$(DEPDIR)/util-linux: \
@STM24_FALSE@$(DEPDIR)/%util-linux: util-linux.do_compile
@STM24_FALSE@	cd @DIR_util_linux@  && \
@STM24_FALSE@		install -d $(targetprefix)/sbin && \
@STM24_FALSE@		install -m 755 fdisk/sfdisk $(targetprefix)/sbin/
#		$(MAKE) ARCH=sh4 HAVE_SLANG=no HAVE_SHADOW=yes HAVE_PAM=no \
#		USE_TTY_GROUP=no INSTALLSUID='$(INSTALL) -m $(SUIDMODE)' \
#		DESTDIR=$(targetprefix) install && \
#		ln -s agetty $(targetprefix)/sbin/getty && \
#		ln -s agetty.8.gz $(targetprefix)/usr/man/man8/getty.8.gz && \
#		install -m 755 debian/hwclock.sh $(targetprefix)/etc/init.d/hwclock.sh && \
#		( cd po && make install DESTDIR=$(targetprefix) )
#		@INSTALL_util_linux@
#	@DISTCLEANUP_util_linux@
@STM24_FALSE@	@[ "x$*" = "x" ] && touch $@ || true
@STM24_FALSE@	@TUXBOX_YAUD_CUSTOMIZE@

#
# jfsutils
#
$(DEPDIR)/jfsutils.do_prepare: @DEPENDS_jfsutils@
	@PREPARE_jfsutils@
	touch $@

$(DEPDIR)/jfsutils.do_compile: bootstrap jfsutils.do_prepare 
	cd @DIR_jfsutils@ && \
		$(BUILDENV) \
		CFLAGS="$(TARGET_CFLAGS) -Os" \
		./configure \
			--host=gcc \
			--target=$(target) \
			--prefix= && \
		$(MAKE) CC="$(target)-gcc"
	touch $@

$(DEPDIR)/min-jfsutils $(DEPDIR)/std-jfsutils $(DEPDIR)/max-jfsutils \
$(DEPDIR)/jfsutils: \
$(DEPDIR)/%jfsutils: $(DEPDIR)/jfsutils.do_compile
	cd @DIR_jfsutils@ && \
		@INSTALL_jfsutils@
#	@DISTCLEANUP_jfsutils@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# opkg
#
$(DEPDIR)/opkg.do_prepare: @DEPENDS_opkg@
	@PREPARE_opkg@
	touch $@

$(DEPDIR)/opkg.do_compile: bootstrap opkg.do_prepare 
	cd @DIR_opkg@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix=/usr \
			--disable-curl \
			--disable-gpg \
			--with-opkglibdir=/var && \
		$(MAKE) all
	touch $@

$(DEPDIR)/min-opkg $(DEPDIR)/std-opkg $(DEPDIR)/max-opkg \
$(DEPDIR)/opkg: \
$(DEPDIR)/%opkg: $(DEPDIR)/opkg.do_compile
	cd @DIR_opkg@ && \
		@INSTALL_opkg@
#	@DISTCLEANUP_jfsutils@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# NFS-UTILS
#
$(DEPDIR)/nfs-utils.do_prepare: @DEPENDS_nfs_utils@
	@PREPARE_nfs_utils@
	chmod +x @DIR_nfs_utils@/autogen.sh
	cd @DIR_nfs_utils@ && \
		gunzip -cd ../$(lastword $^) | cat > debian.patch && \
		patch -p1 <debian.patch && \
		sed -e 's/### BEGIN INIT INFO/# chkconfig: 2345 19 81\n### BEGIN INIT INFO/g' -i debian/nfs-common.init && \
		sed -e 's/### BEGIN INIT INFO/# chkconfig: 2345 20 80\n### BEGIN INIT INFO/g' -i debian/nfs-kernel-server.init && \
		sed -e 's/do_modprobe nfsd/# do_modprobe nfsd/g' -i debian/nfs-kernel-server.init && \
		sed -e 's/RPCNFSDCOUNT=8/RPCNFSDCOUNT=3/g' -i debian/nfs-kernel-server.default
	touch $@

$(DEPDIR)/nfs-utils.do_compile: bootstrap e2fsprogs $(DEPDIR)/nfs-utils.do_prepare
	cd @DIR_nfs_utils@  && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--target=$(target) \
			CC_FOR_BUILD=$(target)-gcc \
			--disable-gss \
			--disable-nfsv4 \
			--without-tcp-wrappers && \
		$(MAKE)
	touch $@

$(DEPDIR)/min-nfs-utils $(DEPDIR)/std-nfs-utils $(DEPDIR)/max-nfs-utils $(DEPDIR)/ipk-nfs-utils \
$(DEPDIR)/nfs-utils: \
$(DEPDIR)/%nfs-utils: $(NFS_UTILS_ADAPTED_ETC_FILES:%=root/etc/%) \
		$(DEPDIR)/nfs-utils.do_compile
	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/$*cdkroot || true
	$(INSTALL) -d $(prefix)/$*cdkroot/etc/{default,init.d} && \
	cd @DIR_nfs_utils@  && \
		@INSTALL_nfs_utils@
	( cd root/etc && for i in $(NFS_UTILS_ADAPTED_ETC_FILES); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(prefix)/$*cdkroot/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(prefix)/$*cdkroot/etc/$$i || true; done ) && \
	[ "x$*" != "xipk-" ] && { \
		export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
			for s in nfs-common nfs-kernel-server ; do \
				$(hostprefix)/bin/target-initdconfig --add $$s || \
				echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true ; } || true
#	@DISTCLEANUP_nfs_utils@
	@[ "x$*" = "x" ] && touch $@ || true
	@[ "x$*" = "xipk-" ] && make $(prefix)/$*cdkroot/strippy || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-nfs-utils: $(flashprefix)/root/usr/sbin/exportfs

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/sbin/exportfs: $(DEPDIR)/nfs-utils.do_compile \
@TARGETRULESET_FLASH_TRUE@		$(NFS_UTILS_ADAPTED_ETC_FILES:%=root/etc/%) | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_nfs_utils@  && \
@TARGETRULESET_FLASH_TRUE@		$(MAKE) install SUBDIRS="utils/exportfs utils/mount utils/mountd utils/nfsd utils/statd" DESTDIR=$(flashprefix)/root && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 644 debian/nfs-common.default $(flashprefix)/root/etc/default/nfs-common && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 755 debian/nfs-common.init $(flashprefix)/root/etc/init.d/nfs-common && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 644 debian/nfs-kernel-server.default $(flashprefix)/root/etc/default/nfs-kernel-server && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 755 debian/nfs-kernel-server.init $(flashprefix)/root/etc/init.d/nfs-kernel-server && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 644 debian/etc.exports $(flashprefix)/root/etc/exports; \
@TARGETRULESET_FLASH_TRUE@	cd $(flashprefix)/root/usr/sbin && rm start-statd sm-notify && \
@TARGETRULESET_FLASH_TRUE@	cd $(flashprefix)/root/sbin && rm mount.nfs4 umount.nfs4
@TARGETRULESET_FLASH_TRUE@	( cd root/etc && for i in $(NFS_UTILS_ADAPTED_ETC_FILES); do \
@TARGETRULESET_FLASH_TRUE@		[ -f $$i ] && $(INSTALL) -m644 $$i $(flashprefix)/root/etc/$$i || true; \
@TARGETRULESET_FLASH_TRUE@		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(flashprefix)/root/etc/$$i || true; done )
@TARGETRULESET_FLASH_TRUE@	( export HHL_CROSS_TARGET_DIR=$(flashprefix)/root && cd $(flashprefix)/root/etc/init.d && \
@TARGETRULESET_FLASH_TRUE@		for s in nfs-common nfs-kernel-server ; do \
@TARGETRULESET_FLASH_TRUE@			$(hostprefix)/bin/target-initdconfig --add $$s || \
@TARGETRULESET_FLASH_TRUE@			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true )
@TARGETRULESET_FLASH_TRUE@	echo "tmpfs         /var/lib/nfs        tmpfs   defaults                        0 0" >> $(flashprefix)/root/etc/fstab
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# AUTOFS
#
@ENABLE_TF7700_TRUE@$(DEPDIR)/autofs.do_prepare:  Archive/stlinux23-sh4-autofs-3.1.7-13.sh4.rpm
@ENABLE_TF7700_TRUE@	rpm $(DRPM) --noscripts --badreloc --relocate /opt/STM/STLinux-2.3/devkit/sh4/target=$(prefix)/cdkroot --ignorearch --nodeps --nosignature -Uhv $<
@ENABLE_TF7700_TRUE@	touch $@
@ENABLE_TF7700_FALSE@@ENABLE_UFS912_TRUE@$(DEPDIR)/autofs.do_prepare:  Archive/stlinux23-sh4-autofs-3.1.7-13.sh4.rpm
@ENABLE_TF7700_FALSE@@ENABLE_UFS912_TRUE@	rpm $(DRPM) --noscripts --badreloc --relocate /opt/STM/STLinux-2.3/devkit/sh4/target=$(prefix)/cdkroot --ignorearch --nodeps --nosignature -Uhv $<
@ENABLE_TF7700_FALSE@@ENABLE_UFS912_TRUE@	touch $@
@ENABLE_HS7810A_TRUE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@$(DEPDIR)/autofs.do_prepare:  Archive/stlinux23-sh4-autofs-3.1.7-13.sh4.rpm
@ENABLE_HS7810A_TRUE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	rpm $(DRPM) --noscripts --badreloc --relocate /opt/STM/STLinux-2.3/devkit/sh4/target=$(prefix)/cdkroot --ignorearch --nodeps --nosignature -Uhv $<
@ENABLE_HS7810A_TRUE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	touch $@
@ENABLE_HL101_TRUE@@ENABLE_HS7810A_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@$(DEPDIR)/autofs.do_prepare:  Archive/stlinux23-sh4-autofs-3.1.7-13.sh4.rpm
@ENABLE_HL101_TRUE@@ENABLE_HS7810A_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	rpm $(DRPM) --noscripts --badreloc --relocate /opt/STM/STLinux-2.3/devkit/sh4/target=$(prefix)/cdkroot --ignorearch --nodeps --nosignature -Uhv $<
@ENABLE_HL101_TRUE@@ENABLE_HS7810A_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	touch $@
@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK_TRUE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@$(DEPDIR)/autofs.do_prepare:  Archive/stlinux23-sh4-autofs-3.1.7-13.sh4.rpm
@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK_TRUE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	rpm $(DRPM) --noscripts --badreloc --relocate /opt/STM/STLinux-2.3/devkit/sh4/target=$(prefix)/cdkroot --ignorearch --nodeps --nosignature -Uhv $<
@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK_TRUE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	touch $@
@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_TRUE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@$(DEPDIR)/autofs.do_prepare:  Archive/stlinux23-sh4-autofs-3.1.7-13.sh4.rpm
@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_TRUE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	rpm $(DRPM) --noscripts --badreloc --relocate /opt/STM/STLinux-2.3/devkit/sh4/target=$(prefix)/cdkroot --ignorearch --nodeps --nosignature -Uhv $<
@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_TRUE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	touch $@
@ENABLE_ATEVIO7500_TRUE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@$(DEPDIR)/autofs.do_prepare:  Archive/stlinux23-sh4-autofs-3.1.7-13.sh4.rpm
@ENABLE_ATEVIO7500_TRUE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	rpm $(DRPM) --noscripts --badreloc --relocate /opt/STM/STLinux-2.3/devkit/sh4/target=$(prefix)/cdkroot --ignorearch --nodeps --nosignature -Uhv $<
@ENABLE_ATEVIO7500_TRUE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	touch $@
@ENABLE_ATEVIO7500_FALSE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@$(DEPDIR)/autofs.do_prepare: @DEPENDS_autofs@
@ENABLE_ATEVIO7500_FALSE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	@PREPARE_autofs@
@ENABLE_ATEVIO7500_FALSE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	touch $@

$(DEPDIR)/autofs.do_compile: bootstrap $(DEPDIR)/autofs.do_prepare
@ENABLE_ATEVIO7500_FALSE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	cd @DIR_autofs@  && \
@ENABLE_ATEVIO7500_FALSE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@		$(MAKE_OPTS) \
@ENABLE_ATEVIO7500_FALSE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@		$(MAKE)
	touch $@

$(DEPDIR)/min-autofs $(DEPDIR)/std-autofs $(DEPDIR)/max-autofs $(DEPDIR)/ipk-autofs \
$(DEPDIR)/autofs: \
$(DEPDIR)/%autofs: $(AUTOFS_ADAPTED_ETC_FILES:%=root/etc/%) \
		$(DEPDIR)/autofs.do_compile
	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/$*cdkroot || true
@ENABLE_TF7700_TRUE@	$(INSTALL) -d $(prefix)/$*cdkroot/etc/default
@ENABLE_TF7700_FALSE@@ENABLE_UFS912_TRUE@	$(INSTALL) -d $(prefix)/$*cdkroot/etc/default
@ENABLE_HS7810A_TRUE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	$(INSTALL) -d $(prefix)/$*cdkroot/etc/default
@ENABLE_HL101_TRUE@@ENABLE_HS7810A_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	$(INSTALL) -d $(prefix)/$*cdkroot/etc/default
@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK_TRUE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	$(INSTALL) -d $(prefix)/$*cdkroot/etc/default
@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_TRUE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	$(INSTALL) -d $(prefix)/$*cdkroot/etc/default
@ENABLE_ATEVIO7500_TRUE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	$(INSTALL) -d $(prefix)/$*cdkroot/etc/default	
@ENABLE_ATEVIO7500_FALSE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	$(INSTALL) -d $(prefix)/$*cdkroot/etc/default && \
@ENABLE_ATEVIO7500_FALSE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@	cd @DIR_autofs@  && \
@ENABLE_ATEVIO7500_FALSE@@ENABLE_HL101_FALSE@@ENABLE_HS7810A_FALSE@@ENABLE_SPARK7162_FALSE@@ENABLE_SPARK_FALSE@@ENABLE_TF7700_FALSE@@ENABLE_UFS912_FALSE@		@INSTALL_autofs@
	( cd root/etc && for i in $(AUTOFS_ADAPTED_ETC_FILES); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(prefix)/$*cdkroot/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(prefix)/$*cdkroot/etc/$$i || true; done ) && \
	[ "x$*" != "xipk-" ] && \
	( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
		for s in autofs ; do \
			$(hostprefix)/bin/target-initdconfig --add $$s || \
			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true ) || true
#	@DISTCLEANUP_autofs@
	@[ "x$*" = "x" ] && touch $@ || true
	@[ "x$*" = "xipk-" ] && make $(prefix)/$*cdkroot/strippy || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-autofs: $(flashprefix)/root/sbin/automount

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/sbin/automount: $(DEPDIR)/autofs.do_compile \
@TARGETRULESET_FLASH_TRUE@		$(AUTOFS_ADAPTED_ETC_FILES:%=root/etc/%) | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_autofs@  && \
@TARGETRULESET_FLASH_TRUE@		$(MAKE) install SUBDIRS="daemon modules" INSTALLROOT=$(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	( cd root/etc && for i in $(AUTOFS_ADAPTED_ETC_FILES); do \
@TARGETRULESET_FLASH_TRUE@		[ -f $$i ] && $(INSTALL) -m644 $$i $(flashprefix)/root/etc/$$i || true; \
@TARGETRULESET_FLASH_TRUE@		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(flashprefix)/root/etc/$$i || true; done )
@TARGETRULESET_FLASH_TRUE@	( export HHL_CROSS_TARGET_DIR=$(flashprefix)/root && cd $(flashprefix)/root/etc/init.d && \
@TARGETRULESET_FLASH_TRUE@		for s in autofs ; do \
@TARGETRULESET_FLASH_TRUE@			$(hostprefix)/bin/target-initdconfig --add $$s || \
@TARGETRULESET_FLASH_TRUE@			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true )
@TARGETRULESET_FLASH_TRUE@	rm -f $(flashprefix)/root/lib/autofs/lookup_multi.so
@TARGETRULESET_FLASH_TRUE@	rm -f $(flashprefix)/root/lib/autofs/lookup_program.so
@TARGETRULESET_FLASH_TRUE@	rm -f $(flashprefix)/root/lib/autofs/lookup_userhome.so
@TARGETRULESET_FLASH_TRUE@	rm -f $(flashprefix)/root/lib/autofs/lookup_yp.so
@TARGETRULESET_FLASH_TRUE@	rm -f $(flashprefix)/root/lib/autofs/mount_afs.so
@TARGETRULESET_FLASH_TRUE@	rm -f $(flashprefix)/root/lib/autofs/mount_autofs.so
@TARGETRULESET_FLASH_TRUE@	rm -f $(flashprefix)/root/lib/autofs/mount_changer.so
@TARGETRULESET_FLASH_TRUE@	@touch $@
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# VSFTPD
#
$(DEPDIR)/vsftpd.do_prepare: @DEPENDS_vsftpd@
	@PREPARE_vsftpd@
	touch $@

$(DEPDIR)/vsftpd.do_compile: bootstrap $(DEPDIR)/vsftpd.do_prepare
	cd @DIR_vsftpd@ && \
		$(MAKE) clean && \
		$(MAKE) $(MAKE_OPTS)
	touch $@

define vsftpd/install/pre
	$(INSTALL_DIR) $(prefix)/$*cdkroot/usr/sbin
	$(INSTALL_DIR) $(prefix)/$*cdkroot/etc/xinetd.d
	$(INSTALL_DIR) $(prefix)/$*cdkroot/etc/init.d
	$(INSTALL_DIR) $(prefix)/$*cdkroot/usr/share/man/man5
	$(INSTALL_DIR) $(prefix)/$*cdkroot/usr/share/man/man8
endef

# Evaluate yaud and temporary package install
$(eval $(call Cdkroot,vsftpd))

flash-vsftpd: $(flashprefix)/root/usr/sbin/vsftpd

$(flashprefix)/root/usr/sbin/vsftpd: $(DEPDIR)/vsftpd.do_compile \
		$(VSFTPD_ADAPTED_ETC_FILES:%=root/etc/%) | $(flashprefix)/root
	cd @DIR_vsftpd@ && \
		$(MAKE) install PREFIX=$(flashprefix)/root
	( cd root/etc && for i in $(VSFTPD_ADAPTED_ETC_FILES); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(flashprefix)/root/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(flashprefix)/root/etc/$$i || true; done )
	( export HHL_CROSS_TARGET_DIR=$(flashprefix)/root && cd $(flashprefix)/root/etc/init.d && \
		for s in vsftpd ; do \
			$(hostprefix)/bin/target-initdconfig --add $$s || \
			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true )
	@FLASHROOTDIR_MODIFIED@
	@TUXBOX_CUSTOMIZE@

#
# ETHTOOL
#
$(DEPDIR)/ethtool.do_prepare: @DEPENDS_ethtool@
	@PREPARE_ethtool@
	touch $@

$(DEPDIR)/ethtool.do_compile: bootstrap $(DEPDIR)/ethtool.do_prepare
	cd @DIR_ethtool@  && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--libdir=$(targetprefix)/usr/lib \
			--prefix=/usr && \
		$(MAKE)
	touch $@

$(DEPDIR)/min-ethtool $(DEPDIR)/std-ethtool $(DEPDIR)/max-ethtool \
$(DEPDIR)/ethtool: \
$(DEPDIR)/%ethtool: $(DEPDIR)/ethtool.do_compile
	cd @DIR_ethtool@  && \
		@INSTALL_ethtool@
#	@DISTCLEANUP_ethtool@
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

#
# SAMBA
#
$(DEPDIR)/samba.do_prepare: @DEPENDS_samba@
	@PREPARE_samba@
	touch $@

$(DEPDIR)/samba.do_compile: bootstrap $(DEPDIR)/samba.do_prepare
	cd @DIR_samba@ && \
		cd source3 && \
		./autogen.sh && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix= \
			--exec-prefix=/usr \
			--with-automount \
			--with-smbmount \
			--with-configdir=/etc/samba \
			--with-privatedir=/etc/samba/private \
			--with-mandir=/usr/share/man \
			--with-piddir=/var/run \
			--with-logfilebase=/var/log \
			--with-lockdir=/var/lock \
			--with-swatdir=/usr/share/swat \
			--disable-cups && \
		$(MAKE) $(MAKE_OPTS)
	touch $@

define samba/install
	cd @DIR_samba@ && \
		cd source3 && \
		$(MAKE) $(MAKE_OPTS) installservers installbin installcifsmount installman installscripts installdat installmodules \
			SBIN_PROGS="bin/smbd bin/nmbd bin/winbindd" DESTDIR=$(prefix)/$*cdkroot/ prefix=./. && \
		$(INSTALL) -d $(prefix)/$*cdkroot/etc/samba && \
		$(INSTALL) -c -m644 ../examples/smb.conf.default $(prefix)/$*cdkroot/etc/samba/smb.conf
#		$(MAKE) $(MAKE_OPTS) install DESTDIR=$(prefix)/$*cdkroot/ prefix=./.
endef
#//10.0.1.12/monkeyboy /home/john/Monkeyboy smbfs auto,credentials=/root/.credentials,uid=john,umask=000,lfs 0 0

# Evaluate yaud and temporary package install
$(eval $(call Cdkroot,samba))

# Evaluate packages
$(eval $(call Package,samba,samba))

#
# NETIO
#
$(DEPDIR)/netio.do_prepare: @DEPENDS_netio@
	@PREPARE_netio@
	touch $@

$(DEPDIR)/netio.do_compile: bootstrap $(DEPDIR)/netio.do_prepare
	cd @DIR_netio@ && \
		$(MAKE_OPTS) \
		$(MAKE) all O=.o X= CFLAGS="-DUNIX" LIBS="$(LDFLAGS) -lpthread" OUT=-o
	touch $@

$(DEPDIR)/min-netio $(DEPDIR)/std-netio $(DEPDIR)/max-netio \
$(DEPDIR)/netio: \
$(DEPDIR)/%netio: $(DEPDIR)/netio.do_compile
	cd @DIR_netio@ && \
		$(INSTALL) -d $(prefix)/$*cdkroot/usr/bin && \
		@INSTALL_netio@
	@TUXBOX_TOUCH@
	@TUXBOX_YAUD_CUSTOMIZE@

# Evaluate package netio
# call MacroName,Source Package,Package
$(eval $(call Package,netio,netio))

#
# LIGHTTPD
#
$(DEPDIR)/lighttpd.do_prepare: @DEPENDS_lighttpd@
	@PREPARE_lighttpd@
	touch $@

$(DEPDIR)/lighttpd.do_compile: bootstrap $(DEPDIR)/lighttpd.do_prepare
	cd @DIR_lighttpd@ && \
		$(BUILDENV) \
		./configure \
			--build=$(build) \
			--host=$(target) \
			--prefix= \
			--exec-prefix=/usr \
			--datarootdir=/usr/share && \
		$(MAKE)
	touch $@

$(DEPDIR)/min-lighttpd $(DEPDIR)/std-lighttpd $(DEPDIR)/max-lighttpd $(DEPDIR)/ipk-lighttpd \
$(DEPDIR)/lighttpd: \
$(DEPDIR)/%lighttpd: $(DEPDIR)/lighttpd.do_compile
	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/$*cdkroot || true
	cd @DIR_lighttpd@ && \
		@INSTALL_lighttpd@
	cd @DIR_lighttpd@ && \
		$(INSTALL) -d $(prefix)/$*cdkroot/etc/lighttpd && \
		$(INSTALL) -c -m644 doc/lighttpd.conf $(prefix)/$*cdkroot/etc/lighttpd && \
		$(INSTALL) -d $(prefix)/$*cdkroot/etc/init.d && \
		$(INSTALL) -c -m644 doc/rc.lighttpd.redhat $(prefix)/$*cdkroot/etc/init.d/lighttpd
	$(INSTALL) -d $(prefix)/$*cdkroot/etc/lighttpd && $(INSTALL) -m755 root/etc/lighttpd/lighttpd.conf $(prefix)/$*cdkroot/etc/lighttpd
	$(INSTALL) -d $(prefix)/$*cdkroot/etc/init.d && $(INSTALL) -m755 root/etc/init.d/lighttpd $(prefix)/$*cdkroot/etc/init.d
	[ "x$*" != "xipk-" ] && \
		( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
			$(hostprefix)/bin/target-initdconfig --add lighttpd || \
			echo "Unable to enable initd service: lighttpd" ) || true
#       @DISTCLEANUP_lighttpd@
	@[ "x$*" = "x" ] && touch $@ || true
	@[ "x$*" = "xipk-" ] && make $(prefix)/$*cdkroot/strippy || true
	@TUXBOX_YAUD_CUSTOMIZE@

lighttpd.build_ipk: $(DEPDIR)/ipk-lighttpd
	cp -prd ipk-control/lighttpd/* $(prefix)/ipk-cdkroot && make $(prefix)/ipk-cdkroot/strippy && \
	ipkg-build -o root -g root $(prefix)/ipk-cdkroot $(prefix)/ipk
	-rm -rf  $(prefix)/ipk-cdkroot

@TARGETRULESET_FLASH_TRUE@flash-lighttpd: $(flashprefix)/root/usr/sbin/lighttpd

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/sbin/lighttpd: $(DEPDIR)/lighttpd.do_compile | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_lighttpd@ && \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m755 src/lighttpd $@
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -d $(flashprefix)/root/etc/lighttpd && $(INSTALL) -m755 root/etc/lighttpd/lighttpd.conf $(flashprefix)/root/etc/lighttpd/
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -m755 root/etc/init.d/lighttpd $(flashprefix)/root/etc/init.d/
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
#
# NETKIT_FTP
#
$(DEPDIR)/netkit_ftp.do_prepare: @DEPENDS_netkit_ftp@
	@PREPARE_netkit_ftp@
	touch $@

$(DEPDIR)/netkit_ftp.do_compile: bootstrap ncurses libreadline $(DEPDIR)/netkit_ftp.do_prepare
	cd @DIR_netkit_ftp@  && \
		$(BUILDENV) \
		./configure \
			--with-c-compiler=$(target)-gcc \
			--prefix=/usr \
			--installroot=$(prefix)/$*cdkroot && \
		$(MAKE)
	touch $@

$(DEPDIR)/min-netkit_ftp $(DEPDIR)/std-netkit_ftp $(DEPDIR)/max-netkit_ftp $(DEPDIR)/ipk-netkit_ftp \
$(DEPDIR)/netkit_ftp: \
$(DEPDIR)/%netkit_ftp: $(DEPDIR)/netkit_ftp.do_compile
	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/$*cdkroot || true
	cd @DIR_netkit_ftp@  && \
		@INSTALL_netkit_ftp@
#	@DISTCLEANUP_netkit_ftp@
	@[ "x$*" = "x" ] && touch $@ || true
	@[ "x$*" = "xipk-" ] && make $(prefix)/$*cdkroot/strippy || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-netkit_ftp: $(flashprefix)/root/usr/bin/ftp

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/bin/ftp: $(DEPDIR)/netkit_ftp.do_compile | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_netkit_ftp@ && \
@TARGETRULESET_FLASH_TRUE@		for i in ftp/ftp ; do \
@TARGETRULESET_FLASH_TRUE@			$(INSTALL) $$i $@; done && \
@TARGETRULESET_FLASH_TRUE@		ln -sf ftp $(@D)/pftp
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# WIRELESS_TOOLS
#
$(DEPDIR)/wireless_tools.do_prepare: @DEPENDS_wireless_tools@
	@PREPARE_wireless_tools@
	touch $@

$(DEPDIR)/wireless_tools.do_compile: bootstrap $(DEPDIR)/wireless_tools.do_prepare
	cd @DIR_wireless_tools@  && \
		$(MAKE) $(MAKE_OPTS)
	touch $@

$(DEPDIR)/min-wireless_tools $(DEPDIR)/std-wireless_tools $(DEPDIR)/max-wireless_tools $(DEPDIR)/ipk-wireless_tools \
$(DEPDIR)/wireless_tools: \
$(DEPDIR)/%wireless_tools: $(DEPDIR)/wireless_tools.do_compile
	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/$*cdkroot || true
	cd @DIR_wireless_tools@  && \
		@INSTALL_wireless_tools@
#	@DISTCLEANUP_wireless_tools@
	@[ "x$*" = "x" ] && touch $@ || true
	@[ "x$*" = "xipk-" ] && make $(prefix)/$*cdkroot/strippy || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-wireless_tools: $(flashprefix)/root/usr/sbin/iwconfig

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/sbin/iwconfig: $(DEPDIR)/wireless_tools.do_compile | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_wireless_tools@ && \
@TARGETRULESET_FLASH_TRUE@		for i in iwconfig ; do \
@TARGETRULESET_FLASH_TRUE@			$(INSTALL) $$i $@; done
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

#
# WPA_SUPPLICANT
#
$(DEPDIR)/wpa_supplicant.do_prepare: @DEPENDS_wpa_supplicant@
	@PREPARE_wpa_supplicant@
	touch $@

$(DEPDIR)/wpa_supplicant.do_compile: bootstrap Patches/wpa_supplicant.config $(DEPDIR)/wpa_supplicant.do_prepare
	cd @DIR_wpa_supplicant@  && \
		$(INSTALL) -m 644 ../$(word 2,$^) .config && \
		$(MAKE) $(MAKE_OPTS)
	touch $@

$(DEPDIR)/min-wpa_supplicant $(DEPDIR)/std-wpa_supplicant $(DEPDIR)/max-wpa_supplicant $(DEPDIR)/ipk-wpa_supplicant \
$(DEPDIR)/wpa_supplicant: \
$(DEPDIR)/%wpa_supplicant: $(DEPDIR)/wpa_supplicant.do_compile
	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/$*cdkroot || true
	cd @DIR_wpa_supplicant@  && \
		@INSTALL_wpa_supplicant@
#	@DISTCLEANUP_wpa_supplicant@
	@[ "x$*" = "x" ] && touch $@ || true
	@[ "x$*" = "xipk-" ] && make $(prefix)/$*cdkroot/strippy || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-wpa_supplicant: $(flashprefix)/root/usr/sbin/wpa_supplicant

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root/usr/sbin/wpa_supplicant: $(DEPDIR)/wpa_supplicant.do_compile | $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	cd @DIR_wpa_supplicant@ && \
@TARGETRULESET_FLASH_TRUE@		for i in wpa_supplicant ; do \
@TARGETRULESET_FLASH_TRUE@			$(INSTALL) $$i $@; done
@TARGETRULESET_FLASH_TRUE@	@FLASHROOTDIR_MODIFIED@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

$(DEPDIR)/min-diverse-tools $(DEPDIR)/std-diverse-tools $(DEPDIR)/max-diverse-tools $(DEPDIR)/diverse-tools: \
$(DEPDIR)/%diverse-tools: $(DIVERSE_TOOLS_ADAPTED_ETC_FILES:%=root/etc/%)
	( cd root/etc && for i in $(DIVERSE_TOOLS_ADAPTED_ETC_FILES); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(prefix)/$*cdkroot/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(prefix)/$*cdkroot/etc/$$i || true; done ) && \
	( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
		for s in $(DIVERSE_TOOLS_ADAPTED_ETC_FILES); do \
			[ "$${s%%/*}" = "init.d" ] && ( \
			$(hostprefix)/bin/target-initdconfig --add $${s#init.d/} || \
			echo "Unable to enable initd service: $${s#init.d/}" ) ; done && rm *rpmsave 2>/dev/null || true ) && \
	ln -sf /usr/share/zoneinfo/Europe/Berlin $(prefix)/$*cdkroot/etc/localtime
#	( \
#		[ -f root/usr/bin/dbox-perf-hdd.sh ] && $(INSTALL) -m 755 root/usr/bin/dbox-perf-hdd.sh $(prefix)/$*cdkroot/usr/bin || true && \
#		[ -f root/usr/bin/dbox-perf-nfs.sh ] && $(INSTALL) -m 755 root/usr/bin/dbox-perf-nfs.sh $(prefix)/$*cdkroot/usr/bin || true )
	$(INSTALL_BIN) root/usr/sbin/mountro $(prefix)/$*cdkroot/usr/sbin/
	$(INSTALL_BIN) root/usr/sbin/mountrw $(prefix)/$*cdkroot/usr/sbin/
#	$(INSTALL_BIN) root/bin/devinit $(prefix)/$*cdkroot/bin
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

flash-diverse-tools: $(flashprefix)/root/etc/init.d/allerlei

$(flashprefix)/root/etc/init.d/allerlei: $(DIVERSE_TOOLS_ADAPTED_ETC_FILES:%=root/etc/%)
	( cd root/etc && for i in $(DIVERSE_TOOLS_ADAPTED_ETC_FILES); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(flashprefix)/root/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(flashprefix)/root/etc/$$i || true; done ) && \
	( export HHL_CROSS_TARGET_DIR=$(flashprefix)/root && cd $(flashprefix)/root/etc/init.d && \
		for s in $(DIVERSE_TOOLS_ADAPTED_ETC_FILES) ; do \
			[ "$${s%%/*}" = "init.d" ] && ( \
			$(hostprefix)/bin/target-initdconfig --add $${s#init.d/} || \
			echo "Unable to enable initd service: $${s#init.d/}" ) ; done && rm *rpmsave 2>/dev/null || true ) && \
	ln -sf /usr/share/zoneinfo/Europe/Berlin $(flashprefix)/root/etc/localtime
#	( \
#		[ -f root/usr/bin/dbox-perf-hdd.sh ] && $(INSTALL) -m 755 root/usr/bin/dbox-perf-hdd.sh $(flashprefix)/root/usr/bin || true && \
#		[ -f root/usr/bin/dbox-perf-nfs.sh ] && $(INSTALL) -m 755 root/usr/bin/dbox-perf-nfs.sh $(flashprefix)/root/usr/bin || true )
	$(INSTALL_BIN) root/usr/sbin/mountro $(flashprefix)/root/usr/sbin/
	$(INSTALL_BIN) root/usr/sbin/mountrw $(flashprefix)/root/usr/sbin/
	$(INSTALL_BIN) root/bin/devinit $(flashprefix)/root/bin
	touch $@
	@FLASHROOTDIR_MODIFIED@

# This file serves as a marker for misc_libs
$(targetprefix)/usr/lib/pkgconfig/tuxbox-xmltree.pc:
	$(MAKE) misc_libs

$(appsdir)/misc/libs/config.status: bootstrap libz
	cd $(appsdir)/misc/libs && $(CONFIGURE)

misc_libs: $(appsdir)/misc/libs/config.status
	$(MAKE) -C $(appsdir)/misc/libs all install

#$(appsdir)/misc/tools/config.status: bootstrap libpng
$(appsdir)/misc/tools/config.status: bootstrap
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd $(appsdir)/misc/tools && \
	libtoolize -f -c && \
	$(CONFIGURE) --prefix= \
	$(if $(MULTICOM322), --enable-multicom322) $(if $(MULTICOM324), --enable-multicom324)

$(DEPDIR)/min-misc-tools $(DEPDIR)/std-misc-tools $(DEPDIR)/max-misc-tools $(DEPDIR)/misc-tools: \
$(DEPDIR)/%misc-tools: driver libstdc++-dev libdvdnav libdvdcss libpng jpeg ffmpeg $(appsdir)/misc/tools/config.status
	$(MAKE) -C $(appsdir)/misc/tools all install DESTDIR=$(prefix)/$*cdkroot \
	CPPFLAGS="\
	$(if $(SPARK), -DPLATFORM_SPARK) \
	$(if $(PLAYER131), -DPLAYER131) \
	$(if $(PLAYER179), -DPLAYER179) \
	$(if $(PLAYER191), -DPLAYER191) \
	$(if $(STM22), -DSTM22)"
	[ "x$*" = "x" ] && touch $@ || true

flash-misc-tools: $(DEPDIR)/misc-tools \
		| $(flashprefix)/root
	$(MAKE) -C $(appsdir)/misc/tools install DESTDIR=$(flashprefix)/root
	@FLASHROOTDIR_MODIFIED@
	@TUXBOX_CUSTOMIZE@

flash-vfdctl: $(flashprefix)/root/bin/vfdctl

$(flashprefix)/root/bin/vfdctl: $(DEPDIR)/misc-tools \
		| $(flashprefix)/root
	$(MAKE) -C $(appsdir)/misc/tools/vfdctl install DESTDIR=$(flashprefix)/root
	touch $@
	@FLASHROOTDIR_MODIFIED@
	@TUXBOX_CUSTOMIZE@

$(appsdir)/tuxbox/plugins/config.status: bootstrap freetype-old curl libz libsigc $(targetprefix)/usr/lib/pkgconfig/tuxbox.pc $(targetprefix)/usr/lib/pkgconfig/tuxbox-xmltree.pc $(targetprefix)/usr/lib/pkgconfig/tuxbox-tuxtxt.pc
	cd $(appsdir)/tuxbox/plugins && $(CONFIGURE) \
		LDFLAGS="-L$(targetprefix)/usr/lib/freetype-old"

$(targetprefix)/usr/include/tuxbox/plugin.h \
$(targetprefix)/usr/lib/pkgconfig/tuxbox-plugins.pc: $(appsdir)/tuxbox/plugins/config.status
	$(MAKE) -C $(appsdir)/tuxbox/plugins/include all install
	cp $(appsdir)/tuxbox/plugins/tuxbox-plugins.pc $(targetprefix)/usr/lib/pkgconfig/tuxbox-plugins.pc

enigma-plugins: $(appsdir)/tuxbox/plugins/config.status $(targetprefix)/usr/include/tuxbox/plugin.h
	$(MAKE) -C $(appsdir)/tuxbox/plugins/enigma all install

tuxtxt: $(appsdir)/tuxbox/plugins/config.status $(targetprefix)/usr/include/tuxbox/plugin.h
	$(MAKE) -C $(appsdir)/tuxbox/plugins/tuxtxt all install

plugins-distclean plugins-clean:
	rm $(targetprefix)/usr/lib/pkgconfig/tuxbox-plugins.pc
	rm $(targetprefix)/usr/include/tuxbox/plugin.h
	$(MAKE) -C $(appsdir)/tuxbox/plugins distclean

# tuxbox/libs

# This file serves as a marker for tuxbox_libs
$(targetprefix)/usr/lib/pkgconfig/tuxbox-tuxtxt.pc:
	$(MAKE) tuxbox-libs

$(appsdir)/tuxbox/libs/config.status: bootstrap freetype-old libpng
	cd $(appsdir)/tuxbox/libs && $(CONFIGURE) \
		LDFLAGS="-L$(targetprefix)/usr/lib/freetype-old"

tuxbox-libs: $(appsdir)/tuxbox/libs/config.status
	$(MAKE) -C $(appsdir)/tuxbox/libs all install

tuxbox-libs-distclean tuxbox-libs-clean:
	rm $(targetprefix)/usr/lib/pkgconfig/tuxbox-tuxtxt.pc
	$(MAKE) -C $(appsdir)/tuxbox/libs distclean

.PHONY: tuxbox_libs

$(DEPDIR)/min-stock $(DEPDIR)/std-stock $(DEPDIR)/max-stock $(DEPDIR)/stock: \
$(DEPDIR)/%stock: %jpeg $(STOCK_GUI_ADAPTED_ETC_FILES:%=root/etc/%)
	( cd root/etc && for i in $(STOCK_GUI_ADAPTED_ETC_FILES); do \
		[ -f $$i ] && $(INSTALL) -m644 $$i $(prefix)/$*cdkroot/etc/$$i || true; \
		[ "$${i%%/*}" = "init.d" ] && chmod 755 $(prefix)/$*cdkroot/etc/$$i || true; done ) && \
	( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
		for s in $(STOCK_GUI_ADAPTED_ETC_FILES); do \
			[ "$${s%%/*}" = "init.d" ] && ( \
			$(hostprefix)/bin/target-initdconfig --add $${s#init.d/} || \
			echo "Unable to enable initd service: $${s#init.d/}" ) ; done && rm *rpmsave 2>/dev/null || true ) && \
	$(INSTALL) -d $(prefix)/$*cdkroot/{app,app.static,config,data,etc.static} && \
	$(INSTALL) -d $(prefix)/$*cdkroot/{var/CI,ramdisk} && \
	( cd $(prefix)/$*cdkroot/root && ln -sf /app/modules_sys/modules26 modules26 ) && \
	( cd $(prefix)/$*cdkroot/usr/sbin && ln -sf /app/usr/local/bin/lircd lircd && \
			ln -sf /app/usr/local/bin/lircmd lircmd ) && \
	( cd $(prefix)/$*cdkroot/etc && ln -sf /app/script/lircd.conf lircd.conf && \
			ln -sf /app/script/lircmd.conf lircmd.conf ) && \
	ln -sf /app/usr/lib/libvfsblkid.so $(prefix)/$*cdkroot/usr/lib/libvfsblkid.so && \
	ln -sf /tmp/ttyIO $(prefix)/$*cdkroot/var/ttyIO && \
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@flash-stock: $(flashprefix)/root-stock

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/root-stock: bootstrap $(wildcard root-stock-local.sh) config.status \
@TARGETRULESET_FLASH_TRUE@		$(STOCK_GUI_ADAPTED_ETC_FILES:%=root/etc/%) libz jpeg | $(CROSS_LIBGCC) $(LIBSTDC)
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -d $@/etc/{default,init.d,rc.d/rcS.d,rc.d/rc3.d}
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -d $@/var
@TARGETRULESET_FLASH_TRUE@	( cd root/etc && for i in $(STOCK_GUI_ADAPTED_ETC_FILES); do \
@TARGETRULESET_FLASH_TRUE@		[ -f $$i ] && $(INSTALL) -m644 $$i $@/etc/$$i || true; \
@TARGETRULESET_FLASH_TRUE@		[ "$${i%%/*}" = "init.d" ] && chmod 755 $@/etc/$$i || true; done ) && \
@TARGETRULESET_FLASH_TRUE@	( export HHL_CROSS_TARGET_DIR=$@ && cd $@/etc/init.d && \
@TARGETRULESET_FLASH_TRUE@		for s in ufs910-common ufs910 ; do \
@TARGETRULESET_FLASH_TRUE@			$(hostprefix)/bin/target-initdconfig --add $$s || \
@TARGETRULESET_FLASH_TRUE@			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true ) && \
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -d $@/{app,app.static,config,data,etc.static,usr/sbin,root} && \
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -d $@/{var/CI,ramdisk} && \
@TARGETRULESET_FLASH_TRUE@	( cd $@/root && ln -sf /app/modules_sys/modules26 modules26 ) && \
@TARGETRULESET_FLASH_TRUE@	( cd $@/usr/sbin && ln -sf /app/usr/local/bin/lircd lircd && \
@TARGETRULESET_FLASH_TRUE@			ln -sf /app/usr/local/bin/lircmd lircmd ) && \
@TARGETRULESET_FLASH_TRUE@	( cd $@/etc && ln -sf /app/script/lircd.conf lircd.conf && \
@TARGETRULESET_FLASH_TRUE@			ln -sf /app/script/lircmd.conf lircmd.conf ) && \
@TARGETRULESET_FLASH_TRUE@	ln -sf /tmp/ttyIO $@/var/ttyIO && \
@TARGETRULESET_FLASH_TRUE@	touch $@
@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

@TARGETRULESET_FLASH_TRUE@$(flashprefix)/conf-stock: bootstrap $(wildcard conf-stock-local.sh) config.status \
@TARGETRULESET_FLASH_TRUE@		| $(flashprefix)
@TARGETRULESET_FLASH_TRUE@	rm -rf $@
@TARGETRULESET_FLASH_TRUE@	$(INSTALL) -d $@
@TARGETRULESET_FLASH_TRUE@	[ -f $(stockdir)/.app/start.sh ] && ( \
@TARGETRULESET_FLASH_TRUE@		$(INSTALL) -m 755 $(stockdir)/.app/start.sh $@/start-ext.sh; \
@TARGETRULESET_FLASH_TRUE@		sed -e 's|/usr/sbin/telnetd -l /bin/sh|#/usr/sbin/telnetd -l /bin/sh|' -i $@/start-ext.sh; \
@TARGETRULESET_FLASH_TRUE@		sed -e 's|insmod /app/modules_sys/smsc911x.ko tx_dma=256 rx_dma=256|#insmod /app/modules_sys/smsc911x.ko tx_dma=256 rx_dma=256|' -i $@/start-ext.sh; \
@TARGETRULESET_FLASH_TRUE@		sed -e 's|mount  -t usbfs none /proc/bus/usb/|#mount  -t usbfs none /proc/bus/usb/|' -i $@/start-ext.sh ) || true

@TARGETRULESET_FLASH_TRUE@	@TUXBOX_CUSTOMIZE@

# tuxbox/enigma2 
$(appsdir)/enigma2/config.status: bootstrap freetype expat fontconfig libpng jpeg libgif libfribidi libid3tag libmad libsigc libreadline \
		libdvbsi++ python libxml2 libxslt elementtree zope-interface twisted pyopenssl lxml libxmlccwrap ncurses-dev
	cd $(appsdir)/enigma2 && \
		./autogen.sh && \
		sed -e 's|#!/usr/bin/python|#!$(crossprefix)/bin/python|' -i po/xml2po.py && \
		./configure \
			--host=$(target) \
			--without-libsdl \
			--with-datadir=/usr/local/share \
			--with-libdir=/usr/lib \
			--with-plugindir=/usr/lib/enigma2/python/Plugins \
			PKG_CONFIG=$(hostprefix)/bin/pkg-config \
			PKG_CONFIG_PATH=$(targetprefix)/usr/lib/pkgconfig \
			PY_PATH=$(targetprefix)/usr \
			CPPFLAGS="$(CPPFLAGS) -DPLATFORM_SPARK -I$(driverdir)/include -I $(buildprefix)/$(KERNEL_DIR)/include"

$(DEPDIR)/enigma2.do_prepare:
@ENABLE_HL101_TRUE@	cd $(appsdir)/enigma2 && patch -p1 < ../../cdk/Patches/e2_api5.patch
@ENABLE_VIP2_V1_TRUE@	cd $(appsdir)/enigma2 && patch -p1 < ../../cdk/Patches/e2_api5.patch
@ENABLE_VIP1_V2_TRUE@	cd $(appsdir)/enigma2 && patch -p1 < ../../cdk/Patches/e2_api5.patch
	touch $@

$(DEPDIR)/enigma2.do_compile: $(appsdir)/enigma2/config.status
	cd $(appsdir)/enigma2 && \
		$(MAKE) all
	touch $@

$(DEPDIR)/enigma2: enigma2.do_prepare enigma2.do_compile
	$(MAKE) -C $(appsdir)/enigma2 install DESTDIR=$(targetprefix)
	$(target)-strip $(targetprefix)/usr/local/bin/enigma2
	touch $@

$(DEPDIR)/enigma2-misc:
#	workarounds to allow rebuild
	find $(targetprefix)/usr/local/share/enigma2/ -name .svn |xargs rm -fr
	rm -f $(targetprefix)/usr/local/etc

	$(INSTALL_DIR) $(targetprefix)/usr/bin && \
	$(INSTALL_DIR) $(targetprefix)/usr/share && \
	$(LN_SF) /usr/local/share/enigma2 $(targetprefix)/usr/share/enigma2 && \
	$(INSTALL_DIR) $(targetprefix)/usr/share/etc && \
	$(LN_SF) /usr/local/share/enigma2 $(targetprefix)/usr/share/etc/enigma2 && \
	cp -rd root/usr/local/share/enigma2/* $(targetprefix)/usr/local/share/enigma2/ && \
	$(INSTALL_DIR) $(targetprefix)/usr/share/fonts && \
	cp -rd root/usr/share/fonts/* $(targetprefix)/usr/share/fonts/ && \
	$(INSTALL_DIR) $(targetprefix)/etc && \
	$(INSTALL_DIR) $(targetprefix)/etc/enigma2 && \
	$(LN_SF) /etc $(targetprefix)/usr/local/etc && \
	cp -rd root/etc/enigma2/* $(targetprefix)/etc/enigma2/ && \
	$(INSTALL_FILE) root/etc/videomode $(targetprefix)/etc/ && \
	$(INSTALL_FILE) root/etc/lircd.conf $(targetprefix)/etc/ && \
	$(INSTALL_FILE) root/etc/inetd.conf $(targetprefix)/etc/ && \
	$(INSTALL_FILE) root/etc/image-version $(targetprefix)/etc/ && \
	$(INSTALL_DIR) $(targetprefix)/etc/tuxbox && \
	$(INSTALL_FILE) root/etc/tuxbox/satellites.xml $(targetprefix)/etc/tuxbox/ && \
	$(INSTALL_FILE) root/etc/tuxbox/tuxtxt2.conf $(targetprefix)/etc/tuxbox/ && \
	$(INSTALL_FILE) root/etc/tuxbox/cables.xml $(targetprefix)/etc/tuxbox/ && \
	$(INSTALL_FILE) root/etc/tuxbox/terrestrial.xml $(targetprefix)/etc/tuxbox/ && \
	$(INSTALL_FILE) root/etc/tuxbox/timezone.xml $(targetprefix)/etc/tuxbox/ && \
	$(INSTALL_DIR) $(targetprefix)/boot && \
	$(INSTALL_DIR) $(targetprefix)/media/{hdd,dvd} && \
	$(INSTALL_DIR) $(targetprefix)/hdd/{music,picture,movie} && \
	$(INSTALL_DIR) $(targetprefix)/usr/tuxtxt && \
	chmod 755 $(targetprefix)/usr/bin/tuxtxt && \
	$(INSTALL_FILE) root/usr/tuxtxt/tuxtxt2.conf $(targetprefix)/usr/tuxtxt/
@ENABLE_TF7700_TRUE@	cd $(targetprefix)/usr/local/share/enigma2/ && mv -f keymap_tf7700.xml keymap.xml
@ENABLE_TF7700_FALSE@	rm -f $(targetprefix)/usr/local/share/enigma2/keymap_tf7700.xml
	touch $@

enigma2-clean enigma2-distclean:
	rm -f $(DEPDIR)/enigma2
	rm -f $(DEPDIR)/enigma2.do_prepare
	rm -f $(DEPDIR)/enigma2.do_compile
	cd $(appsdir)/enigma2 && \
		$(MAKE) distclean

flash-enigma2: $(flashprefix)/root-enigma2

$(flashprefix)/root-enigma2: \
		bootstrap $(wildcard root-enigma2-local.sh) \
		$(ENIGMA2_GUI_ADAPTED_ETC_FILES:%=root/etc/%) \
		enigma2.do_compile
	$(MAKE) flash-python-enigma2 && \
	$(MAKE) flash-libxml2-enigma2 && \
	$(MAKE) flash-libxslt-enigma2 && \
	$(MAKE) flash-elementtree-enigma2 && \
	$(MAKE) flash-zope-interface-enigma2 && \
	$(MAKE) flash-twisted-enigma2 && \
	$(MAKE) flash-libxmlccwrap-enigma2 && \
	$(MAKE) -C $(appsdir)/enigma2 install DESTDIR=$@ && \
	$(MAKE) enigma2-misc targetprefix=$@ && \
	$(INSTALL_DIR) $@/etc/init.d && \
	$(INSTALL_BIN) root/etc/init.d/{player,enigma2} $@/etc/init.d && \
	$(INSTALL_DIR) $@/etc/rc.d/rc{S,0,1,2,3,4,5,6}.d && \
	$(LN_SF) ../init.d $@/etc/rc.d/init.d && \
	( export HHL_CROSS_TARGET_DIR=$@ && cd $@/etc/init.d && \
		for s in player enigma2 ; do \
			$(hostprefix)/bin/target-initdconfig --add $$s || \
			echo "Unable to enable initd service: $$s" ; done && rm *rpmsave 2>/dev/null || true ) && \
	$(INSTALL_BIN) root/etc/init.d/rcS_flash $@/etc/init.d/rcS && \
	$(INSTALL_BIN) root/etc/init.d/rc $@/etc/init.d/ && \
	touch $@
	@TUXBOX_CUSTOMIZE@

#
# dvb/libdvbsi++
#
$(appsdir)/dvb/libdvbsi++/config.status: bootstrap
	cd $(appsdir)/dvb/libdvbsi++ && $(CONFIGURE) CPPFLAGS="$(CPPFLAGS) -I$(driverdir)/dvb/include"

$(DEPDIR)/libdvbsi++: $(appsdir)/dvb/libdvbsi++/config.status
	$(MAKE) -C $(appsdir)/dvb/libdvbsi++ all install
	touch $@

$(DEPDIR)/enigma2-nightly.do_prepare:
	REVISION=""; \
	DIFF="0"; \
	rm -rf $(appsdir)/enigma2-nightly; \
	rm -rf $(appsdir)/enigma2-nightly.org; \
	rm -rf $(appsdir)/enigma2-nightly.newest; \
	rm -rf $(appsdir)/enigma2-nightly.patched; \
	clear; \
	echo "Media Framwork: $(MEDIAFW)"; \
	echo "Choose between the following revisions:"; \
	echo " 0) Latest Mo,  7 Nov 2011"; \
	echo "---- REVISIONS ----"; \
	echo "1) Sat, 29 Mar 2011 13:49 - E2 V3.0 e013d09af0e010f15e225a12dcc217abc052ee19"; \
	echo "2) inactive"; \
	echo "3) inactive"; \
	echo "4) inactive"; \
	echo "5) Fri,  5 Nov 2010 00:16 - E2 V2.4 libplayer3 7fd4241a1d7b8d7c36385860b24882636517473b"; \
	echo "6) Wed,  6 Jul 2011 11:17 - E2 V3.1 gstreamer  388dcd814d4e99720cb9a6c769611be4951e4ad4"; \
	echo "7) current inactive... comming soon, here is the next stable (case 7 == DIFF=7)"; \
	read -p "Select: "; \
	echo "Selection: " $$REPLY; \
	[ "$$REPLY" == "0" ] && DIFF="0" && HEAD="experimental"; \
	[ "$$REPLY" == "1" ] && DIFF="1" && HEAD="experimental" && REVISION="e013d09af0e010f15e225a12dcc217abc052ee19"; \
	[ "$$REPLY" == "2" ] && DIFF="2" && HEAD="experimental" && REVISION=""; \
	[ "$$REPLY" == "3" ] && DIFF="3" && HEAD="experimental" && REVISION=""; \
	[ "$$REPLY" == "4" ] && DIFF="4" && HEAD="master" && REVISION="be8ccc9f63c4cd79f8dba84087c7348c23657865"; \
	[ "$$REPLY" == "5" ] && DIFF="5" && HEAD="master" && REVISION="7fd4241a1d7b8d7c36385860b24882636517473b"; \
	[ "$$REPLY" == "6" ] && DIFF="6" && HEAD="experimental" && REVISION="388dcd814d4e99720cb9a6c769611be4951e4ad4"; \
	echo "Revision: " $$REVISION; \
	[ -d "$(appsdir)/enigma2-nightly" ] && \
	git pull $(appsdir)/enigma2-nightly $$HEAD;\
	[ -d "$(appsdir)/enigma2-nightly" ] || \
	git clone -b $$HEAD git://gitorious.org/open-duckbox-project-sh4/guigit.git $(appsdir)/enigma2-nightly; \
	cp -ra $(appsdir)/enigma2-nightly $(appsdir)/enigma2-nightly.newest; \
	[ "$$REVISION" == "" ] || (cd $(appsdir)/enigma2-nightly; git checkout "$$REVISION"; cd "$(buildprefix)";); \
	cp -ra $(appsdir)/enigma2-nightly $(appsdir)/enigma2-nightly.org; \
	cd $(appsdir)/enigma2-nightly && patch -p1 < "../../cdk/Patches/enigma2-nightly.$$DIFF.diff"; \
	cd $(appsdir)/enigma2-nightly && patch -p1 < "../../cdk/Patches/enigma2-nightly.$$DIFF.$(MEDIAFW).diff"; \
	cd $(appsdir)/enigma2-nightly && patch -p1 < "../../cdk/Patches/enigma2-nightly.VideoEnhancement.$$DIFF.diff"; \
	$(if $(SPARK),cd $(appsdir)/enigma2-nightly && patch -p1 < "../../cdk/Patches/enigma2-nightly.Evolution.spark.$$DIFF.diff" ); \
	cd $(appsdir)/enigma2-nightly && patch -p1 < "../../cdk/Patches/enigma2-nightly.tuxtxt.diff"
	cp -ra $(appsdir)/enigma2-nightly $(appsdir)/enigma2-nightly.patched
	touch $@

$(appsdir)/enigma2-nightly/config.status: bootstrap freetype expat fontconfig libpng jpeg libgif libfribidi libid3tag libmad libsigc libreadline \
		libdvbsi++ python libxml2 libxslt elementtree zope-interface twisted pyopenssl lxml libxmlccwrap ncurses-dev $(MEDIAFW_DEP)
	cd $(appsdir)/enigma2-nightly && \
		./autogen.sh && \
		sed -e 's|#!/usr/bin/python|#!$(crossprefix)/bin/python|' -i po/xml2po.py && \
		./configure \
			--host=$(target) \
			--without-libsdl \
			--with-datadir=/usr/local/share \
			--with-libdir=/usr/lib \
			--with-plugindir=/usr/lib/tuxbox/plugins \
			--prefix=/usr \
			--datadir=/usr/local/share \
			--sysconfdir=/etc \
			STAGING_INCDIR=$(hostprefix)/usr/include \
			STAGING_LIBDIR=$(hostprefix)/usr/lib \
			PKG_CONFIG=$(hostprefix)/bin/pkg-config \
			PKG_CONFIG_PATH=$(targetprefix)/usr/lib/pkgconfig \
			PY_PATH=$(targetprefix)/usr \
			CPPFLAGS="$(CPPFLAGS) -DPLATFORM_SPARK -I$(driverdir)/include -I $(buildprefix)/$(KERNEL_DIR)/include"

$(DEPDIR)/enigma2-nightly.do_compile: $(appsdir)/enigma2-nightly/config.status
	cd $(appsdir)/enigma2-nightly && \
		$(MAKE) all
	touch $@

$(DEPDIR)/enigma2-nightly: enigma2-nightly.do_prepare enigma2-nightly.do_compile
	$(MAKE) -C $(appsdir)/enigma2-nightly install DESTDIR=$(targetprefix)
	if [ -e $(targetprefix)/usr/bin/enigma2 ]; then \
		$(target)-strip $(targetprefix)/usr/bin/enigma2; \
	fi
	if [ -e $(targetprefix)/usr/local/bin/enigma2 ]; then \
		$(target)-strip $(targetprefix)/usr/local/bin/enigma2; \
	fi
	touch $@

enigma2-nightly-clean enigma2-nightly-distclean:
	rm -f $(DEPDIR)/enigma2-nightly
	rm -f $(DEPDIR)/enigma2-nightly.do_compile
	rm -f $(DEPDIR)/enigma2-nightly.do_prepare
	rm -rf $(appsdir)/enigma2-nightly
	rm -rf $(appsdir)/enigma2-nightly.newest
	rm -rf $(appsdir)/enigma2-nightly.org
	rm -rf $(appsdir)/enigma2-nightly.patched

$(targetprefix)/var/etc/.version:
	echo "imagename=Neutrino-HD" > $@
	echo "homepage=http://gitorious.org/open-duckbox-project-sh4" >> $@
	echo "creator=`id -un`" >> $@
	echo "docs=http://gitorious.org/open-duckbox-project-sh4/pages/Home" >> $@
	echo "forum=http://gitorious.org/open-duckbox-project-sh4" >> $@
	echo "version=0100`date +%Y%m%d%H%M`" >> $@
	echo "git =`git describe`" >> $@

#
#NIGHTLY
#

$(appsdir)/neutrino-nightly/config.status: bootstrap freetype jpeg libpng libgif libid3tag curl libmad libvorbisidec libboost openssl
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd $(appsdir)/neutrino-nightly && \
		ACLOCAL_FLAGS="-I $(hostprefix)/share/aclocal" ./autogen.sh && \
		$(BUILDENV) \
		./configure \
			--host=$(target) \
			--with-tremor \
			--with-libdir=/usr/lib \
			--with-datadir=/share/tuxbox \
			--with-fontdir=/share/fonts \
			--with-configdir=/var/tuxbox/config \
			--with-gamesdir=/var/tuxbox/games \
			--with-plugindir=/usr/lib/tuxbox/plugins \
			PKG_CONFIG=$(hostprefix)/bin/pkg-config \
			PKG_CONFIG_PATH=$(targetprefix)/usr/lib/pkgconfig \
			$(if $(PLAYER131),PLAYER131=$(PLAYER131)) \
			$(if $(PLAYER179),PLAYER179=$(PLAYER179)) \
			$(if $(PLAYER191),PLAYER191=$(PLAYER191)) \
			CPPFLAGS="$(CPPFLAGS) -D__KERNEL_STRICT_NAMES -DPLATFORM_SPARK -I$(driverdir)/include -I $(buildprefix)/$(KERNEL_DIR)/include"

#svn co http://www.coolstreamtech.de/coolstream_public_svn/THIRDPARTY/applications/neutrino-experimental/ --username coolstream --password coolstream $(appsdir)/neutrino-nightly
$(DEPDIR)/neutrino-nightly.do_prepare: Patches/neutrino-nightly.0.diff
	git clone git://novatux.git.sourceforge.net/gitroot/novatux/neutrino-experimental $(appsdir)/neutrino-nightly
	rm -rf $(appsdir)/neutrino-nightly/lib/libcoolstream
	rm -rf $(appsdir)/neutrino-nightly/src/zapit/include/linux
	cp -ra $(appsdir)/neutrino-nightly $(appsdir)/neutrino-nightly.org
	cd $(appsdir)/neutrino-nightly && patch -p1 <../../cdk/$(word 1,$^)
	touch $@

$(DEPDIR)/neutrino-nightly.do_compile: $(appsdir)/neutrino-nightly/config.status
	cd $(appsdir)/neutrino-nightly && \
		$(MAKE) all
	touch $@

$(DEPDIR)/neutrino-nightly: neutrino-nightly.do_prepare neutrino-nightly.do_compile
	$(MAKE) -C $(appsdir)/neutrino-nightly install DESTDIR=$(targetprefix)
	make $(targetprefix)/var/etc/.version
	$(target)-strip $(targetprefix)/usr/local/bin/neutrino
	$(target)-strip $(targetprefix)/usr/local/bin/pzapit
	$(target)-strip $(targetprefix)/usr/local/bin/sectionsdcontrol
	touch $@

neutrino-nightly-clean neutrino-nightly-distclean:
	rm -f $(DEPDIR)/neutrino-nightly
	rm -f $(DEPDIR)/neutrino-nightly.do_compile
	rm -f $(DEPDIR)/neutrino-nightly.do_prepare
	rm -rf $(appsdir)/neutrino-nightly.org
	rm -rf $(appsdir)/neutrino-nightly

#
#NORMAL
#

$(appsdir)/neutrino/config.status: bootstrap freetype libpng libid3tag openssl curl libmad libboost libgif
	export PATH=$(hostprefix)/bin:$(PATH) && \
	cd $(appsdir)/neutrino && \
		ACLOCAL_FLAGS="-I $(hostprefix)/share/aclocal" ./autogen.sh && \
		$(BUILDENV) \
		./configure \
			--host=$(target) \
			--without-libsdl \
			--with-datadir=/usr/local/share \
			--with-libdir=/usr/lib \
			--with-plugindir=/usr/lib/tuxbox/plugins \
			--with-fontdir=/usr/local/share/fonts \
			--with-configdir=/usr/local/share/config \
			--with-gamesdir=/usr/local/share/games \
			PKG_CONFIG=$(hostprefix)/bin/pkg-config \
			PKG_CONFIG_PATH=$(targetprefix)/usr/lib/pkgconfig \
			CPPFLAGS="$(CPPFLAGS) -D__KERNEL_STRICT_NAMES -DPLATFORM_SPARK -I$(driverdir)/include -I $(buildprefix)/$(KERNEL_DIR)/include"

$(DEPDIR)/neutrino.do_prepare: Patches/neutrino.patch
	touch $@

$(DEPDIR)/neutrino.do_compile: $(appsdir)/neutrino/config.status
	cd $(appsdir)/neutrino && \
		$(MAKE) all
	touch $@

$(DEPDIR)/neutrino: neutrino.do_prepare neutrino.do_compile
	$(MAKE) -C $(appsdir)/neutrino install DESTDIR=$(targetprefix) DATADIR=$(targetprefix)/usr/local/share/
	$(target)-strip $(targetprefix)/usr/local/bin/neutrino
	$(target)-strip $(targetprefix)/usr/local/bin/pzapit
	$(target)-strip $(targetprefix)/usr/local/bin/sectionsdcontrol
	touch $@

neutrino-clean neutrino-distclean:
	rm -f $(DEPDIR)/neutrino
	rm -f $(DEPDIR)/neutrino.do_compile
	rm -f $(DEPDIR)/neutrino.do_prepare
	cd $(appsdir)/neutrino && \
		$(MAKE) distclean && \
		find $(appsdir)/neutrino -name "Makefile.in" -exec rm -rf {} \; && \
		rm -rf $(appsdir)/neutrino/autom4te.cache

#libogg is needed

# This file serves as a marker for libtuxbox
$(targetprefix)/usr/lib/pkgconfig/tuxbox.pc:
	$(MAKE) libtuxbox

$(appsdir)/tuxbox/libtuxbox/config.status: bootstrap
	cd $(appsdir)/tuxbox/libtuxbox && $(CONFIGURE)

libtuxbox: $(appsdir)/tuxbox/libtuxbox/config.status
	$(MAKE) -C $(appsdir)/tuxbox/libtuxbox all install

min-prepare-yaud std-prepare-yaud max-prepare-yaud: \
%prepare-yaud:
	-rm -rf $(prefix)/$*cdkroot
	-rm -rf $(prefix)/$*cdkroot-rpmdb

#
# BOOTSTRAP
#
$(DEPDIR)/min-bootstrap $(DEPDIR)/std-bootstrap $(DEPDIR)/max-bootstrap $(DEPDIR)/bootstrap: \
$(DEPDIR)/%bootstrap: \
		%libtool \
		%$(FILESYSTEM) \
		| %$(GLIBC) \
		%$(CROSS_LIBGCC) \
		%$(LIBSTDC)
	@[ "x$*" = "x" ] && touch -r RPMS/sh4/$(STLINUX)-sh4-$(LIBSTDC)-$(GCC_VERSION).sh4.rpm $@ || true

#
# BARE-OS
#
min-bare-os std-bare-os max-bare-os bare-os: \
%bare-os: \
		%bootstrap \
		%$(LIBTERMCAP) \
		%$(NCURSES_BASE) \
		%$(NCURSES) \
		%$(BASE_PASSWD) \
		%$(MAKEDEV) \
		%$(BASE_FILES) \
		%module-init-tools \
		%busybox \
		\
		%libz \
		%$(INITSCRIPTS) \
		%openrdate \
		%$(NETBASE) \
		%$(BC) \
		%$(SYSVINIT) \
		%$(DISTRIBUTIONUTILS) \
		\
		%e2fsprogs \
		%jfsutils \
		%opkg \
		%u-boot-utils \
		%diverse-tools
#		%$(RELEASE) \
#		%$(FINDUTILS) \
#

min-net-utils std-net-utils max-net-utils net-utils: \
%net-utils:	\
		%$(NETKIT_FTP) \
		%autofs \
		%portmap \
		%$(NFSSERVER) \
		%vsftpd \
		%ethtool \
		%$(CIFS)

min-disk-utils std-disk-utils max-disk-utils disk-utils: \
%disk-utils:	\
		%$(XFSPROGS) \
		%util-linux \
		%$(SG3)

#dummy targets
#really ugly
min-:

std-:

max-:

#
# YAUD
#
yaud-stock: yaud-none stock
	@TUXBOX_YAUD_CUSTOMIZE@

#yaud-enigma: yaud-none splashutils enigma
yaud-enigma: yaud-none lirc stslave \
		boot-elf misc-cp remote firstboot enigma
	@TUXBOX_YAUD_CUSTOMIZE@

yaud-vdr: yaud-none stslave openssl openssl-dev \
		boot-elf misc-cp remote firstboot vdr release_vdr
	@TUXBOX_YAUD_CUSTOMIZE@

yaud-neutrino: yaud-none lirc stslave\
		boot-elf remote firstboot neutrino release_neutrino
	@TUXBOX_YAUD_CUSTOMIZE@

yaud-neutrino-static: yaud-none lirc stslave\
		boot-elf remote firstboot neutrino release_neutrino_static
	@TUXBOX_YAUD_CUSTOMIZE@

yaud-neutrino-nightly: yaud-none lirc stslave\
		boot-elf remote firstboot neutrino-nightly release_neutrino_nightly
	@TUXBOX_YAUD_CUSTOMIZE@

flash-ufs910-neutrino: yaud-none stslave \
		yaud-neutrino \
		kernel-squashfs.ubimage \
		root-stock.neutrino \
		var-stock.neutrino
	@TUXBOX_YAUD_CUSTOMIZE@

evolux: yaud-neutrino \
		yaud-enigma2-nightly \
		release_evolux
	@TUXBOX_YAUD_CUSTOMIZE@

evolux-full: yaud-none host-python lirc stslave \
		yaud-neutrino \
		yaud-enigma2-nightly \
		release_evolux
	@TUXBOX_YAUD_CUSTOMIZE@

@STM22_TRUE@yaud-enigma2: yaud-none host-python lirc stslave\
@STM22_TRUE@		boot-elf hotplug remote firstboot enigma2 enigma2-misc release
@STM22_TRUE@	@TUXBOX_YAUD_CUSTOMIZE@
@STM22_FALSE@yaud-enigma2: yaud-none host-python lirc \
@STM22_FALSE@		boot-elf remote firstboot enigma2 enigma2-misc release
@STM22_FALSE@	@TUXBOX_YAUD_CUSTOMIZE@

@STM22_TRUE@yaud-enigma2-nightly: yaud-none host-python lirc stslave\
@STM22_TRUE@		boot-elf hotplug remote firstboot enigma2-nightly enigma2-misc release
@STM22_TRUE@	@TUXBOX_YAUD_CUSTOMIZE@
@STM22_FALSE@yaud-enigma2-nightly: yaud-none host-python lirc stslave\
@STM22_FALSE@		boot-elf remote firstboot enigma2-nightly enigma2-misc release
@STM22_FALSE@	@TUXBOX_YAUD_CUSTOMIZE@

@STM22_TRUE@yaud-enigma1-hd: yaud-none lirc stslave\
@STM22_TRUE@		boot-elf hotplug remote firstboot enigma1-hd release_enigma1_hd
@STM22_TRUE@	@TUXBOX_YAUD_CUSTOMIZE@
@STM22_FALSE@yaud-enigma1-hd: yaud-none lirc stslave\
@STM22_FALSE@		boot-elf remote firstboot enigma1-hd release_enigma1_hd
@STM22_FALSE@	@TUXBOX_YAUD_CUSTOMIZE@

#work yet!!!
flash-ufs910-enigma2: yaud-none host-python lirc stslave \
		boot-elf hotplug remote firstboot enigma2 enigma2-misc release \
		kernel-squashfs.ubimage \
		conf-stock.enigma2 \
		root-stock.enigma2 \
		app-stock.enigma2 \
		var-stock.enigma2
	@TUXBOX_YAUD_CUSTOMIZE@

flash-hdbox-enigma2: yaud-none host-python lirc \
		boot-elf hotplug remote firstboot enigma2 enigma2-misc release \
		kernel-squashfs-hdbox.ubimage \
		root-stock-hdbox.enigma2 \
		var-stock-hdbox.enigma2
	@TUXBOX_YAUD_CUSTOMIZE@

yaud-none:	bare-os \
		libdvdcss \
		libdvdread \
		libdvdnav \
		linux-kernel \
		net-utils \
		disk-utils \
		driver \
		misc-tools
	@TUXBOX_YAUD_CUSTOMIZE@

#
# MIN-YAUD
#
test-kati: min-yaud-stock

min-yaud-stock: \
%yaud-stock: %prepare-yaud %yaud-none
	@TUXBOX_YAUD_CUSTOMIZE@

min-yaud-none: \
%yaud-none:	%bare-os \
		%misc-tools \
		%linux-kernel \
		%net-utils \
		%disk-utils
	@TUXBOX_YAUD_CUSTOMIZE@
#
#min-yaud-stock: \
#%yaud-stock: min-prepare-yaud min-yaud-none
#	@TUXBOX_YAUD_CUSTOMIZE@
#
#min-yaud-none: \
#%yaud-none: %bare-os \
#		...
#		%$(RELEASE) \
#		%linux-kernel \
#		%busybox \
#		%libz \
#		%$(GREP)
#	@TUXBOX_YAUD_CUSTOMIZE@

#
# STD-YAUD
#
yaud-kati: std-yaud-stock

std-yaud-stock: \
%yaud-stock: %prepare-yaud %yaud-none %stock
	@TUXBOX_YAUD_CUSTOMIZE@

std-yaud-none: \
%yaud-none:	%bare-os \
		%misc-tools \
		%linux-kernel \
		%net-utils \
		%disk-utils
	@TUXBOX_YAUD_CUSTOMIZE@

#
# MAX-YAUD
#
usb-kati: max-yaud-stock

max-yaud-stock: \
%yaud-stock: %prepare-yaud %yaud-none %stock
	@TUXBOX_YAUD_CUSTOMIZE@

max-yaud-none: \
%yaud-none: 	%bare-os \
		%misc-tools \
		%$(UDEV) \
		%$(HOTPLUG) \
		%linux-kernel \
		%net-utils \
		%disk-utils
	@TUXBOX_YAUD_CUSTOMIZE@
#		%$(BASH) \
#		%$(COREUTILS) \
#		%$(NET_TOOLS) \
#

#
# RECORD
# see http://board.ufs-910.de/viewtopic.php?t=1435 
# and http://board.ufs-910.de/viewtopic.php?t=1524&start=0
#
$(DEPDIR)/record.do_prepare: @DEPENDS_record@
	@PREPARE_record@
	touch $@

$(DEPDIR)/record.do_compile: $(DEPDIR)/record.do_prepare
	cd @DIR_record@ && \
		export PATH=$(MAKE_PATH) && \
		$(MAKE) clean && \
		$(MAKE) $(MAKE_OPTS) record
	touch $@

$(DEPDIR)/min-record $(DEPDIR)/std-record $(DEPDIR)/max-record $(DEPDIR)/ipk-record $(DEPDIR)/record: \
$(DEPDIR)/%record: $(DEPDIR)/record.do_compile
	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/ipk-cdkroot || true
	cd @DIR_record@ && \
		export PATH=$(MAKE_PATH) && \
		$(MAKE) install DESTDIR=$(prefix)/$*cdkroot
	[ "x$*" != "xipk-" ] && \
		( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
		$(hostprefix)/bin/target-initdconfig --add record || \
		echo "Unable to enable initd service: record" ) || true
#       @CLEANUP_record@
	@TUXBOX_YAUD_CUSTOMIZE@
	@[ "x$*" = "x" ] && touch $@ || true

record.build_ipk: $(DEPDIR)/ipk-record
	cp -prd ipk-control/record/* $(prefix)/ipk-cdkroot && make $(prefix)/ipk-cdkroot/strippy && \
	ipkg-build -o root -g root $(prefix)/ipk-cdkroot $(prefix)/ipk
#	-rm -rf  $(prefix)/ipk-cdkroot

#
# PROG
# see 
#
#$(DEPDIR)/prog.do_prepare: @DEPENDS_prog@
#	@PREPARE_prog@
#	touch $@
#$(DEPDIR)/prog.do_prepare
$(DEPDIR)/prog.do_compile:
	cd fb-stapi-0.1.20070720 && \
		export PATH=$(MAKE_PATH) && \
		$(MAKE) clean && \
		$(MAKE) INCDIR=$(prefix)/$*cdkroot/usr/include $(MAKE_OPTS) prog
	touch $@
#	cd @DIR_prog@ && \
#
$(DEPDIR)/min-prog $(DEPDIR)/std-prog $(DEPDIR)/max-prog $(DEPDIR)/prog: \
$(DEPDIR)/%prog: $(DEPDIR)/prog.do_compile
	cd @DIR_prog@ && \
		export PATH=$(MAKE_PATH) && \
		$(MAKE) install DESTDIR=$(prefix)/$*cdkroot
#       @CLEANUP_prog@
	@TUXBOX_YAUD_CUSTOMIZE@
	@[ "x$*" = "x" ] && touch $@ || true
prog.do_clean:
	@CLEANUP_prog@
	-rm .deps/$(subst do_clean,do_prepare,$@)
	-rm .deps/$(subst do_clean,do_compile,$@)
	-rm .deps/$(subst .do_clean,,$@)
prog.build_ipk: $(DEPDIR)/prog.do_compile
	[ -d $(buildprefix)/tmp-ipk ] && rm -rf $(buildprefix)/tmp-ipk || true
	cd @DIR_prog@ && \
		export PATH=$(MAKE_PATH) && \
		$(MAKE) install DESTDIR=$(buildprefix)/tmp-ipk
	cp -prd ipk-control/prog/* $(buildprefix)/tmp-ipk && make $(buildprefix)/tmp-ipk/strippy && \
	ipkg-build -o root -g root $(buildprefix)/tmp-ipk $(prefix)/ipk

#
# RUBY
#
$(DEPDIR)/ruby.do_prepare: @DEPENDS_ruby@ Patches/vsftpd.diff
	@PREPARE_ruby@
	touch $@

$(DEPDIR)/ruby.do_compile: $(DEPDIR)/ruby.do_prepare
	cd @DIR_ruby@ && \
		export PATH=$(MAKE_PATH) && \
		$(MAKE) clean || true && \
		autoconf && \
		echo "ac_cv_func_setpgrp_void=set" >> config.cache && \
		$(BUILDENV) \
		./configure \
			--cache-file=config.cache \
			--build=$(build) \
			--host=$(target) \
			--prefix= && \
		$(MAKE) $(MAKE_OPTS)
	touch $@
#

$(DEPDIR)/min-ruby $(DEPDIR)/std-ruby $(DEPDIR)/max-ruby $(DEPDIR)/ipk-ruby $(DEPDIR)/ruby: \
$(DEPDIR)/%ruby: $(DEPDIR)/ruby.do_compile
	@[ "x$*" = "xipk-" ] && rm -rf  $(prefix)/ipk-cdkroot || true
	cd @DIR_ruby@ && \
		export PATH=$(MAKE_PATH) && \
		$(INSTALL) -d $(prefix)/$*cdkroot/usr/sbin && \
		$(INSTALL) -d $(prefix)/$*cdkroot/etc/xinetd.d && \
		$(INSTALL) -d $(prefix)/$*cdkroot/etc/init.d && \
		$(INSTALL) -d $(prefix)/$*cdkroot/usr/share/man/man5 && \
		$(INSTALL) -d $(prefix)/$*cdkroot/usr/share/man/man8 && \
		@INSTALL_vsftpd@
	$(INSTALL) -d $(prefix)/$*cdkroot/etc && $(INSTALL) -m644 root/etc/vsftpd.conf $(prefix)/$*cdkroot/etc
	$(INSTALL) -d $(prefix)/$*cdkroot/etc/default && $(INSTALL) -m644 root/etc/default/vsftpd $(prefix)/$*cdkroot/etc/default
	$(INSTALL) -d $(prefix)/$*cdkroot/etc/init.d && $(INSTALL) -m755 root/etc/init.d/vsftpd $(prefix)/$*cdkroot/etc/init.d
	[ "x$*" != "xipk-" ] && \
		( export HHL_CROSS_TARGET_DIR=$(prefix)/$*cdkroot && cd $(prefix)/$*cdkroot/etc/init.d && \
		$(hostprefix)/bin/target-initdconfig --add vsftpd || \
		echo "Unable to enable initd service: networking" ) || true
#	@CLEANUP_vsftpd@
	@TUXBOX_YAUD_CUSTOMIZE@
	@[ "x$*" = "x" ] && touch $@ || true

ruby.build_ipk: $(DEPDIR)/ipk-ruby
	cp -prd ipk-control/ruby/* $(prefix)/ipk-cdkroot && make $(prefix)/ipk-cdkroot/strippy && \
	ipkg-build -o root -g root $(prefix)/ipk-cdkroot $(prefix)/ipk
#	-rm -rf  $(prefix)/ipk-cdkroot

RPMS/noarch/$(STLINUX)-$(HOST_STGFB)-$(HOST_STGFB_VERSION).noarch.rpm: \
		Archive/$(STLINUX)-$(HOST_STGFB)-$(HOST_STGFB_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $< && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-$(subst -source,,$(HOST_STGFB)).spec

$(DEPDIR)/$(HOST_STGFB): RPMS/noarch/$(STLINUX)-$(HOST_STGFB)-$(HOST_STGFB_VERSION).noarch.rpm
	@rpm $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(buildprefix)/stgfb=$(buildprefix) --nodeps --noscripts $<
	touch $@

$(DEPDIR)/stgfb.do_prepare: linux-kernel.do_compile $(HOST_STGFB)
	touch $@

$(DEPDIR)/stgfb.do_compile: \
		$(DEPDIR)/stgfb.do_prepare
	$(MAKE) -C $(STGFB_DIR)/Linux KERNELDIR=$(buildprefix)/linux CONFIG_STG_DEBUG=y CONFIG_STG_HD=n $(MAKE_OPTS)
#	For HD pipeline change to
#	$(MAKE) -C $(STGFB_DIR)/Linux KERNELDIR=$(kernelprefix)/linux-sh4 CONFIG_STG_DEBUG=y CONFIG_STG_HD=y $(MAKE_OPTS)
	touch $@

$(DEPDIR)/min-stgfb $(DEPDIR)/std-stgfb $(DEPDIR)/max-stgfb \
$(DEPDIR)/stgfb: \
$(DEPDIR)/%stgfb: $(DEPDIR)/stgfb.do_compile
	cd $(STGFB_DIR) && \
		$(MAKE) KERNELDIR=$(buildprefix)/linux \
			INSTALL_MOD_PATH=$(prefix)/$*cdkroot \
			INSTALL_MOD_DIR=stgfb \
			$(MAKE_OPTS) modules_install && \
		$(DEPMOD) -ae -F $(buildprefix)/linux/System.map -b $(prefix)/$*cdkroot -r $(KERNELVERSION)
	@[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/stgfb-dev: stgfb
	cp $(STGFB_DIR)/Linux/video/stmfb.h $(targetprefix)/usr/include/linux
	@[ "x$*" = "x" ] && touch $@ || true

stgfb.do_clean:
	rm .deps/$(subst do_clean,do_prepare,$@) || true
	rm .deps/$(subst do_clean,do_compile,$@) || true
	rm .deps/$(subst .do_clean,,$@) || true

RPMS/sh4/stlinux20-sh4-console-data-1999.08.29-4.sh4.rpm: \
		Archive/stlinux22-target-$(CONSOLE_DATAA)-$(CONSOLE_DATA_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	( cd SPECS; patch -p1 stm-target-$(CONSOLE_DATAA).spec < ../Patches/stm-target-$(CONSOLE_DATAA).spec.diff ) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(CONSOLE_DATAA).spec

$(DEPDIR)/min-$(CONSOLE_DATAA) $(DEPDIR)/std-$(CONSOLE_DATAA) $(DEPDIR)/max-$(CONSOLE_DATAA) $(DEPDIR)/$(CONSOLE_DATAA): \
$(DEPDIR)/%$(CONSOLE_DATAA): RPMS/sh4/stlinux20-sh4-$(CONSOLE_DATAA)-$(CONSOLE_DATA_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

RPMS/sh4/stlinux20-sh4-console-tools-0.2.3-6.sh4.rpm: \
		Archive/stlinux22-target-$(CONSOLE_TOOLS)-$(CONSOLE_TOOLS_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	( cd SPECS; patch -p1 stm-target-$(CONSOLE_TOOLS).spec < ../Patches/stm-target-$(CONSOLE_TOOLS).spec.diff ) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(CONSOLE_TOOLS).spec

$(DEPDIR)/min-$(CONSOLE_TOOLS) $(DEPDIR)/std-$(CONSOLE_TOOLS) $(DEPDIR)/max-$(CONSOLE_TOOLS) $(DEPDIR)/$(CONSOLE_TOOLS): \
$(DEPDIR)/%$(CONSOLE_TOOLS): RPMS/sh4/stlinux20-sh4-$(CONSOLE_TOOLS)-$(CONSOLE_TOOLS_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@
RPMS/sh4/stlinux20-sh4-ICE-6.8.1-2.sh4.rpm: \
		Archive/stlinux20-target-$(ICE)-$(ICE_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	( cd SPECS; patch -p1 stm-target-$(ICE).spec < ../Patches/stm-target-$(ICE).spec.diff ) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(ICE).spec
$(DEPDIR)/min-$(ICE) $(DEPDIR)/std-$(ICE) $(DEPDIR)/max-$(ICE) $(DEPDIR)/$(ICE): \
$(DEPDIR)/%$(ICE): RPMS/sh4/stlinux20-sh4-$(ICE)-$(ICE_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@
RPMS/sh4/stlinux20-sh4-SM-6.8.1-2.sh4.rpm: \
		Archive/stlinux20-target-$(SM)-$(SM_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	( cd SPECS; patch -p1 stm-target-$(SM).spec < ../Patches/stm-target-$(SM).spec.diff ) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(SM).spec
$(DEPDIR)/min-$(SM) $(DEPDIR)/std-$(SM) $(DEPDIR)/max-$(SM) $(DEPDIR)/$(SM): \
$(DEPDIR)/%$(SM): RPMS/sh4/stlinux20-sh4-$(SM)-$(SM_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@
RPMS/sh4/stlinux20-sh4-Xproto-6.8.1-2.sh4.rpm: \
		Archive/stlinux20-target-$(XPROTO)-$(XPROTO_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	( cd SPECS; patch -p1 stm-target-$(XPROTO).spec < ../Patches/stm-target-$(XPROTO).spec.diff ) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(XPROTO).spec
$(DEPDIR)/min-$(XPROTO) $(DEPDIR)/std-$(XPROTO) $(DEPDIR)/max-$(XPROTO) $(DEPDIR)/$(XPROTO): \
$(DEPDIR)/%$(XPROTO): RPMS/sh4/stlinux20-sh4-$(XPROTO)-$(XPROTO_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@
RPMS/sh4/stlinux20-sh4-XExtensions-6.8.1-2.sh4.rpm: \
		Archive/stlinux20-target-$(XEXTENSIONS)-$(XEXTENSIONS_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	( cd SPECS; patch -p1 stm-target-$(XEXTENSIONS).spec < ../Patches/stm-target-$(XEXTENSIONS).spec.diff ) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(XEXTENSIONS).spec
$(DEPDIR)/min-$(XEXTENSIONS) $(DEPDIR)/std-$(XEXTENSIONS) $(DEPDIR)/max-$(XEXTENSIONS) $(DEPDIR)/$(XEXTENSIONS): \
$(DEPDIR)/%$(XEXTENSIONS): RPMS/sh4/stlinux20-sh4-$(XEXTENSIONS)-$(XEXTENSIONS_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@
RPMS/sh4/stlinux20-sh4-Xt-6.8.1-2.sh4.rpm: \
		$(DEPDIR)/$(SM) \
		Archive/stlinux20-target-$(XT)-$(XT_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	( cd SPECS; patch -p1 stm-target-$(XT).spec < ../Patches/stm-target-$(XT).spec.diff ) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(XT).spec
$(DEPDIR)/min-$(XT) $(DEPDIR)/std-$(XT) $(DEPDIR)/max-$(XT) $(DEPDIR)/$(XT): \
$(DEPDIR)/%$(XT): RPMS/sh4/stlinux20-sh4-$(XT)-$(XT_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@
RPMS/sh4/stlinux20-sh4-xtrans-6.8.1-2.sh4.rpm: \
		Archive/stlinux20-target-$(XTRANS)-$(XTRANS_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	( cd SPECS; patch -p1 stm-target-$(XTRANS).spec < ../Patches/stm-target-$(XTRANS).spec.diff ) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(XTRANS).spec
$(DEPDIR)/min-$(XTRANS) $(DEPDIR)/std-$(XTRANS) $(DEPDIR)/max-$(XTRANS) $(DEPDIR)/$(XTRANS): \
$(DEPDIR)/%$(XTRANS): RPMS/sh4/stlinux20-sh4-$(XTRANS)-$(XTRANS_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@
RPMS/sh4/stlinux20-sh4-Xau-6.8.1-2.sh4.rpm: \
		$(DEPDIR)/$(XPROTO) \
		Archive/stlinux20-target-$(XAU)-$(XAU_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	( cd SPECS; patch -p1 stm-target-$(XAU).spec < ../Patches/stm-target-$(XAU).spec.diff ) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(XAU).spec
$(DEPDIR)/min-$(XAU) $(DEPDIR)/std-$(XAU) $(DEPDIR)/max-$(XAU) $(DEPDIR)/$(XAU): \
$(DEPDIR)/%$(XAU): $(DEPDIR)/%$(XPROTO) RPMS/sh4/stlinux20-sh4-$(XAU)-$(XAU_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@
RPMS/sh4/stlinux20-sh4-X11-6.8.1-4.sh4.rpm: \
		$(DEPDIR)/$(XAU) \
		$(DEPDIR)/$(XEXTENSIONS) \
		$(DEPDIR)/$(XTRANS) \
		Archive/stlinux20-target-$(X11)-$(X11_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	( cd SPECS; patch -p1 stm-target-$(X11).spec < ../Patches/stm-target-$(X11).spec.diff ) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(X11).spec
$(DEPDIR)/min-$(X11) $(DEPDIR)/std-$(X11) $(DEPDIR)/max-$(X11) $(DEPDIR)/$(X11): \
$(DEPDIR)/%$(X11): $(DEPDIR)/%$(XAU) RPMS/sh4/stlinux20-sh4-$(X11)-$(X11_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@
RPMS/sh4/stlinux20-sh4-lirc-apps-0.7.2pre1-7.sh4.rpm: \
		Archive/stlinux20-target-$(LIRC_APPS)-$(LIRC_APPS_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(LIRC_APPS).spec
$(DEPDIR)/min-$(LIRC_APPS) $(DEPDIR)/std-$(LIRC_APPS) $(DEPDIR)/max-$(LIRC_APPS) $(DEPDIR)/$(LIRC_APPS): \
$(DEPDIR)/%$(LIRC_APPS): $(DEPDIR)/%$(X11) RPMS/sh4/stlinux20-sh4-$(LIRC_APPS)-$(LIRC_APPS_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

########################################

$(DEPDIR)/stgfb-devnew:
	cp $(driverdir)/stgfb/stmfb/Linux/video/stmfb.h $(targetprefix)/usr/include/linux
	cp $(driverdir)/stgfb/stmfb/Linux/stm/coredisplay/stmhdmi.h $(targetprefix)/usr/include/linux
	@[ "x$*" = "x" ] && touch $@ || true

RPMS/sh4/$(STLINUX)-sh4-$(DIRECTFB)-$(DIRECTFB_VERSION).sh4.rpm \
RPMS/sh4/$(STLINUX)-sh4-$(DIRECTFB_DEV)-$(DIRECTFB_VERSION).sh4.rpm: \
		freetype \
		Archive/$(STLINUX)-target-$(DIRECTFB)-$(DIRECTFB_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	( cd SPECS; patch -p1 stm-target-$(DIRECTFB).spec < ../Patches/stm-target-$(DIRECTFB).spec.diff ) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(DIRECTFB).spec

$(DEPDIR)/min-$(DIRECTFB) $(DEPDIR)/std-$(DIRECTFB) $(DEPDIR)/max-$(DIRECTFB) $(DEPDIR)/$(DIRECTFB): \
$(DEPDIR)/%$(DIRECTFB):  %freetype %jpeg RPMS/sh4/$(STLINUX)-sh4-$(DIRECTFB)-$(DIRECTFB_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/min-$(DIRECTFB_DEV) $(DEPDIR)/std-$(DIRECTFB_DEV) $(DEPDIR)/max-$(DIRECTFB_DEV) $(DEPDIR)/$(DIRECTFB_DEV): \
$(DEPDIR)/%$(DIRECTFB_DEV): $(DEPDIR)/%$(DIRECTFB) RPMS/sh4/$(STLINUX)-sh4-$(DIRECTFB_DEV)-$(DIRECTFB_VERSION).sh4.rpm
	rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	perl -pi -e "s,^libdir=.*\$$,libdir='$(targetprefix)/usr/lib'," $(targetprefix)/usr/lib/libdirectfb.la && \
	perl -pi -e "s,^prefix=.*\$$,prefix=$(targetprefix)/usr," $(targetprefix)/usr/lib/pkgconfig/directfb.pc && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

RPMS/sh4/stlinux20-sh4-directfb-examples-0.9.22_stcvs20050810-7.sh4.rpm: \
		$(FREETYPE_DEV) \
		$(DIRECTFB_DEV) \
		Archive/stlinux20-target-directfb-examples-0.9.22_stcvs20050810-7.src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/stm-target-$(DIRECTFB_EXAMPLES).spec

$(DEPDIR)/min-$(DIRECTFB_EXAMPLES) $(DEPDIR)/std-$(DIRECTFB_EXAMPLES) $(DEPDIR)/max-$(DIRECTFB_EXAMPLES) $(DEPDIR)/$(DIRECTFB_EXAMPLES): \
$(DEPDIR)/%$(DIRECTFB_EXAMPLES): $(DEPDIR)/%$(FREETYPE) RPMS/sh4/stlinux20-sh4-$(DIRECTFB_EXAMPLES)-$(DIRECTFB_EXAMPLES_VERSION).sh4.rpm
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

########################################

$(X11).do_clean:
	for i in $(X11) $(XTRANS) $(XEXTENSIONS) $(XAU) $(XPROTO); do \
		rpm $(DRPM) -ev stlinux20-sh4-$$i || true && \
		[ -f .deps/$$i ] && rm .deps/$$i || true; \
	done

$(DIRECTFB).do_clean:
	for i in $(DIRECTFB) $(FREETYPE); do \
		rpm $(DRPM) -ev stlinux20-sh4-$$i || true && \
		[ -f .deps/$$i ] && rm .deps/$$i || true; \
	done

#Trick: ich haue mal das kopieren von /boot mal hier rein. ist fuer m82 und m84
$(DEPDIR)/boot-elf:
	$(INSTALL_DIR) $(targetprefix)/boot
	for elf in video_7109.elf video_7100.elf video_7111.elf video_7105.elf audio.elf audio_7111.elf audio_7105.elf \
	;do \
		if [ -e $(buildprefix)/root/boot/$$elf ] ; then \
			cp $(buildprefix)/root/boot/$$elf $(targetprefix)/boot/ ; \
		else \
			touch $(targetprefix)/boot/$$elf; \
		fi; \
	done
	$(INSTALL_DIR) $(targetprefix)/lib/firmware
	cp $(buildprefix)/root/firmware/*.fw $(targetprefix)/lib/firmware/
	@[ "x$*" = "x" ] && touch $@ || true

$(DEPDIR)/misc-cp:
	cp $(buildprefix)/root/sbin/hotplug $(targetprefix)/sbin
	cp $(buildprefix)/root/etc/$(LIRCD_CONF) $(targetprefix)/etc/lircd.conf
	cp -rd $(buildprefix)/root/etc/hotplug $(targetprefix)/etc
	cp -rd $(buildprefix)/root/etc/hotplug.d $(targetprefix)/etc
	@[ "x$*" = "x" ] && touch $@ || true

$(DEPDIR)/firstboot:
	$(INSTALL_DIR) $(targetprefix)/var/etc
	cp -rd $(buildprefix)/root/var/etc/.firstboot $(targetprefix)/var/etc/
	@[ "x$*" = "x" ] && touch $@ || true

$(DEPDIR)/remote:
	cp $(buildprefix)/root/etc/$(LIRCD_CONF) $(targetprefix)/etc/lircd.conf
	@[ "x$*" = "x" ] && touch $@ || true

$(DEPDIR)/misc-e2:
	$(INSTALL_DIR) $(targetprefix)/media/hdd
	$(INSTALL_DIR) $(targetprefix)/media/dvd
	$(INSTALL_DIR) $(targetprefix)/hdd
	$(INSTALL_DIR) $(targetprefix)/hdd/music
	$(INSTALL_DIR) $(targetprefix)/hdd/picture
	$(INSTALL_DIR) $(targetprefix)/hdd/movie
	@[ "x$*" = "x" ] && touch $@ || true

$(SPLASHUTILS_RPM): \
		$(if $(SPLASHUTILS_SPEC_PATCH),Patches/$(SPLASHUTILS_PATCH)) \
		$(if $(SPLASHUTILS_PATCHES),$(SPLASHUTILS_PATCHES:%=Patches/%)) \
		jpeg libmng freetype libpng \
		Archive/stlinux23-target-$(SPLASHUTILS)-$(SPLASHUTILS_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(SPLASHUTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(SPLASHUTILS_SPEC) < ../Patches/$(SPLASHUTILS_SPEC_PATCH) ) &&) \
	$(if $(SPLASHUTILS_PATCHES),cp $(SPLASHUTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	export PKG_CONFIG_PATH=$(targetprefix)/usr/lib/pkgconfig && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --nodeps --target=sh4-linux SPECS/$(SPLASHUTILS_SPEC)

$(DEPDIR)/min-$(SPLASHUTILS) $(DEPDIR)/std-$(SPLASHUTILS) $(DEPDIR)/max-$(SPLASHUTILS) $(DEPDIR)/$(SPLASHUTILS): \
$(DEPDIR)/%$(SPLASHUTILS): $(SPLASHUTILS_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	cp root/etc/splash/luxisri.ttf $(targetprefix)/etc/splash/ && \
	cp -rd root/etc/splash/{vdr,liquid,together}_theme $(targetprefix)/etc/splash/ && \
	$(LN_SF) liquid_theme $(targetprefix)/etc/splash/default && \
	$(INSTALL_DIR) $(targetprefix)/lib/lsb && \
	cp root/lib/lsb/splash-functions $(targetprefix)/lib/lsb/ && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

flash-splashutils: $(flashprefix)/root/sbin/fbsplashd

$(flashprefix)/root/sbin/fbsplashd: $(SPLASHUTILS_RPM)
	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^) && \
	cp root/etc/splash/luxisri.ttf $(flashprefix)/root/etc/splash/ && \
	cp -rd root/etc/splash/{vdr,liquid,together}_theme $(flashprefix)/root/etc/splash/ && \
	$(LN_SF) liquid_theme $(flashprefix)/root/etc/splash/default && \
	rm -rf $(flashprefix)/root/etc/splash/st_theme && \
	$(INSTALL_DIR) $(flashprefix)/root/lib/lsb && \
	cp root/lib/lsb/splash-functions $(flashprefix)/root/lib/lsb/ && \
	rm $(flashprefix)/root/sbin/{fbsplashd.static,splash-functions.sh} && \
	rm $(flashprefix)/root/usr/bin/{bootsplash2fbsplash,splash_geninitramfs,splash_manager,splash_resize} && \
	touch $@ && \
	@FLASHROOTDIR_MODIFIED@

$(BINUTILS_RPM) $(BINUTILS_DEV_RPM): \
		$(if $(BINUTILS_SPEC_PATCH),Patches/$(BINUTILS_PATCH)) \
		$(if $(BINUTILS_PATCHES),$(BINUTILS_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX:%23=%24)-target-$(BINUTILS)-$(BINUTILS_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(BINUTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(BINUTILS_SPEC) < ../Patches/$(BINUTILS_SPEC_PATCH) ) &&) \
	$(if $(BINUTILS_PATCHES),cp $(BINUTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(BINUTILS_SPEC)

$(BINUTILS): $(BINUTILS_RPM)
	@rpm $(DRPM) --ignorearch --nodeps -Uhv $< && \
	touch .deps/$(notdir $@)

$(BINUTILS_DEV): $(BINUTILS_DEV_RPM)
	@rpm $(DRPM) --ignorearch --nodeps --noscripts -Uhv $< && \
	touch .deps/$(notdir $@)

$(STSLAVE_RPM): \
		$(if $(STSLAVE_SPEC_PATCH),Patches/$(STSLAVE_PATCH)) \
		$(if $(STSLAVE_PATCHES),$(STSLAVE_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX:%23=%24)-target-$(STSLAVE)-$(STSLAVE_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(STSLAVE_SPEC_PATCH),( cd SPECS && patch -p1 $(STSLAVE_SPEC) < ../Patches/$(STSLAVE_SPEC_PATCH) ) &&) \
	$(if $(STSLAVE_PATCHES),cp $(STSLAVE_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(STSLAVE_SPEC)

@STM22_TRUE@$(DEPDIR)/min-$(STSLAVE) $(DEPDIR)/std-$(STSLAVE) $(DEPDIR)/max-$(STSLAVE) $(DEPDIR)/$(STSLAVE): \
@STM22_TRUE@$(DEPDIR)/%$(STSLAVE): $(STSLAVE_RPM)
@STM22_TRUE@	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch -Uhv \
@STM22_TRUE@		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
@STM22_TRUE@	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
@STM22_TRUE@	@TUXBOX_YAUD_CUSTOMIZE@
@STM22_FALSE@$(DEPDIR)/min-$(STSLAVE) $(DEPDIR)/std-$(STSLAVE) $(DEPDIR)/max-$(STSLAVE) $(DEPDIR)/$(STSLAVE): \
@STM22_FALSE@$(DEPDIR)/%$(STSLAVE): linux-kernel-headers binutils-dev $(STSLAVE_RPM)
@STM22_FALSE@	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
@STM22_FALSE@		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
@STM22_FALSE@	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
@STM22_FALSE@	@TUXBOX_YAUD_CUSTOMIZE@

flash-stslave: $(flashprefix)/root/bin/stslave

$(flashprefix)/root/bin/stslave: $(STSLAVE)
	$(INSTALL_DIR) $(dir $@) && \
	$(CP_D) $(targetprefix)/bin/stslave $@ && \
	touch $@ && \
	@FLASHROOTDIR_MODIFIED@

$(OPENSSL_RPM) $(OPENSSL_DEV_RPM): \
		$(if $(OPENSSL_SPEC_PATCH),Patches/$(OPENSSL_PATCH)) \
		$(if $(OPENSSL_PATCHES),$(OPENSSL_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(OPENSSL)-$(OPENSSL_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(OPENSSL_SPEC_PATCH),( cd SPECS && patch -p1 $(OPENSSL_SPEC) < ../Patches/$(OPENSSL_SPEC_PATCH) ) &&) \
	$(if $(OPENSSL_PATCHES),cp $(OPENSSL_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(OPENSSL_SPEC)

$(DEPDIR)/min-$(OPENSSL) $(DEPDIR)/std-$(OPENSSL) $(DEPDIR)/max-$(OPENSSL) $(DEPDIR)/$(OPENSSL): \
$(DEPDIR)/%$(OPENSSL): $(OPENSSL_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/min-$(OPENSSL_DEV) $(DEPDIR)/std-$(OPENSSL_DEV) $(DEPDIR)/max-$(OPENSSL_DEV) $(DEPDIR)/$(OPENSSL_DEV): \
$(DEPDIR)/%$(OPENSSL_DEV): %$(OPENSSL) $(OPENSSL_DEV_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(ALSALIB_RPM) $(ALSALIB_DEV_RPM): \
		$(if $(ALSALIB_SPEC_PATCH),Patches/$(ALSALIB_SPEC_PATCH)) \
		$(if $(ALSALIB_PATCHES),$(ALSALIB_PATCHES:%=Patches/%)) \
		Archive/$(STLINUX)-target-$(ALSALIB)-$(ALSALIB_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(ALSALIB_SPEC_PATCH),( cd SPECS && patch -p1 $(ALSALIB_SPEC) < ../Patches/$(ALSALIB_SPEC_PATCH) ) &&) \
	$(if $(ALSALIB_PATCHES),cp $(ALSALIB_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(ALSALIB_SPEC)

$(DEPDIR)/min-$(ALSALIB) $(DEPDIR)/std-$(ALSALIB) $(DEPDIR)/max-$(ALSALIB) $(DEPDIR)/$(ALSALIB): \
$(DEPDIR)/%$(ALSALIB): $(ALSALIB_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/min-$(ALSALIB_DEV) $(DEPDIR)/std-$(ALSALIB_DEV) $(DEPDIR)/max-$(ALSALIB_DEV) $(DEPDIR)/$(ALSALIB_DEV): \
$(DEPDIR)/%$(ALSALIB_DEV): %$(ALSALIB) $(ALSALIB_DEV_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

flash-alsa-lib: $(flashprefix)/root/usr/bin/aserver

$(flashprefix)/root/usr/bin/aserver: $(ALSALIB_RPM)
	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^) && \
	touch $@ && \
	@FLASHROOTDIR_MODIFIED@

$(ALSAUTILS_RPM): \
		$(if $(ALSAUTILS_SPEC_PATCH),Patches/$(ALSAUTILS_PATCH)) \
		$(if $(ALSAUTILS_PATCHES),$(ALSAUTILS_PATCHES:%=Patches/%)) \
		$(NCURSES_DEV) $(ALSALIB_DEV) \
		Archive/$(STLINUX)-target-$(ALSAUTILS)-$(ALSAUTILS_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(ALSAUTILS_SPEC_PATCH),( cd SPECS && patch -p1 $(ALSAUTILS_SPEC) < ../Patches/$(ALSAUTILS_SPEC_PATCH) ) &&) \
	$(if $(ALSAUTILS_PATCHES),cp $(ALSAUTILS_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --nodeps --target=sh4-linux SPECS/$(ALSAUTILS_SPEC)

$(DEPDIR)/min-$(ALSAUTILS) $(DEPDIR)/std-$(ALSAUTILS) $(DEPDIR)/max-$(ALSAUTILS) $(DEPDIR)/$(ALSAUTILS): \
$(DEPDIR)/%$(ALSAUTILS): $(ALSAUTILS_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

flash-alsa-utils: $(flashprefix)/root/usr/bin/amixer

$(flashprefix)/root/usr/bin/amixer: $(ALSAUTILS_RPM)
	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^) && \
	rm -rf $(flashprefix)/root/usr/share/sounds/alsa && \
	rmdir $(flashprefix)/root/usr/share/sounds && \
	touch $@ && \
	@FLASHROOTDIR_MODIFIED@

$(ALSAPLAYER_RPM) $(ALSAPLAYER_DEV_RPM): \
		$(if $(ALSAPLAYER_SPEC_PATCH),Patches/$(ALSAPLAYER_PATCH)) \
		$(if $(ALSAPLAYER_PATCHES),$(ALSAPLAYER_PATCHES:%=Patches/%)) \
		libmad libid3tag \
		Archive/$(STLINUX:%23=%24)-target-$(ALSAPLAYER)-$(ALSAPLAYER_VERSION).src.rpm
	rpm $(DRPM) --nosignature -Uhv $(lastword $^) && \
	$(if $(ALSAPLAYER_SPEC_PATCH),( cd SPECS && patch -p1 $(ALSAPLAYER_SPEC) < ../Patches/$(ALSAPLAYER_SPEC_PATCH) ) &&) \
	$(if $(ALSAPLAYER_PATCHES),cp $(ALSAPLAYER_PATCHES:%=Patches/%) SOURCES/ &&) \
	export PATH=$(hostprefix)/bin:$(PATH) && \
	export PKG_CONFIG_PATH=$(targetprefix)/usr/include/pkgconfig && \
	rpmbuild $(DRPMBUILD) -bb -v --clean --target=sh4-linux SPECS/$(ALSAPLAYER_SPEC)

$(DEPDIR)/min-$(ALSAPLAYER) $(DEPDIR)/std-$(ALSAPLAYER) $(DEPDIR)/max-$(ALSAPLAYER) $(DEPDIR)/$(ALSAPLAYER): \
$(DEPDIR)/%$(ALSAPLAYER): $(ALSAPLAYER_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

$(DEPDIR)/min-$(ALSAPLAYER_DEV) $(DEPDIR)/std-$(ALSAPLAYER_DEV) $(DEPDIR)/max-$(ALSAPLAYER_DEV) $(DEPDIR)/$(ALSAPLAYER_DEV): \
$(DEPDIR)/%$(ALSAPLAYER_DEV): $(ALSAPLAYER_DEV_RPM)
	@rpm --dbpath $(prefix)/$*cdkroot-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(prefix)/$*cdkroot $(lastword $^) && \
	[ "x$*" = "x" ] && touch -r $(lastword $^) $@ || true
	@TUXBOX_YAUD_CUSTOMIZE@

flash-alsaplayer: $(flashprefix)/root/usr/bin/alsaplayer

$(flashprefix)/root/usr/bin/alsaplayer: $(ALSAPLAYER_RPM)
	@rpm --dbpath $(flashprefix)-rpmdb $(DRPM) --ignorearch --nodeps -Uhv \
		--badreloc --relocate $(targetprefix)=$(flashprefix)/root $(lastword $^) && \
	touch $@ && \
	@FLASHROOTDIR_MODIFIED@

$(flashprefix)/root-stock-cramfs/lib/ld-linux.so.2 \
$(flashprefix)/root-stock-squashfs/lib/ld-linux.so.2 \
$(flashprefix)/root-stock-jffs2/lib/ld-linux.so.2 \
$(flashprefix)/root-stock-usb/lib/ld-linux.so.2 \
$(flashprefix)/root-stock-focramfs/lib/ld-linux.so.2 \
$(flashprefix)/root-stock-fosquashfs/lib/ld-linux.so.2: \
%/lib/ld-linux.so.2: %
	find $</lib -maxdepth 1 -type f -o -type l | xargs rm -f
	find $</usr/lib -maxdepth 1 -type f -o -type l | xargs rm -f
	cp -d $(targetprefix)/lib/libnss_dns-?.*.so $</lib
	cp -d $(targetprefix)/lib/libnss_files-?.*.so $</lib
#	rm $</bin/sh
#	rm $</usr/sbin/lircd
#	rm $</usr/sbin/lircmd
	PATH=$(MAKE_PATH) $(MKLIBS) --target $(target) --ldlib ld-linux.so.2 --libc-extras-dir \
		$(targetprefix)/usr/lib \
		-d $</lib \
		-D -L $(mklibs_librarypath) \
		--root $< \
		`find $</bin/ -path "*bin/?*" -type f` \
		`find $</sbin/ -path "*sbin/?*" -type f` \
		`find $</usr/bin/ -path "*bin/?*" -type f` \
		`find $</usr/sbin/ -path "*sbin/?*" -type f` \
		`find $</var/bin/ -path "*bin/?*" -type f` \
		`find $(flashprefix)/root/var/xbin/ -path "*bin/?*" -type f` \
		`find $</lib/ -name "*.so" -type f`
	if [ -e $(targetprefix)/lib/libgcc_s-4.1.1.so.1 -a ! -e $</lib/libgcc_s-4.1.1.so.1 ]; then \
		cp $(targetprefix)/lib/libgcc_s-4.1.1.so.1 $</lib/libgcc_s-4.1.1.so.1 ; \
		ln -sf libgcc_s-4.1.1.so.1 $</lib/libgcc_s.so.1 ; \
	fi
	if [ -e $(targetprefix)/lib/libm-2.5.so -a ! -e $</lib/libm-2.5.so ]; then \
		cp $(targetprefix)/lib/libm-2.5.so $</lib/libm-2.5.so ; \
		ln -sf libm-2.5.so $</lib/libm.so.6 ; \
	fi
	if [ -e $(targetprefix)/lib/libpthread-2.5.so -a ! -e $</lib/libpthread-2.5.so ]; then \
		cp $(targetprefix)/lib/libpthread-2.5.so $</lib/libpthread-2.5.so ; \
		ln -sf libpthread-2.5.so $</lib/libpthread.so.0 ; \
	fi
	if [ -e $(targetprefix)/usr/lib/libstdc++.so.6.0.8 -a ! -e $</lib/libstdc++.so.6.0.8 ]; then \
		cp $(targetprefix)/usr/lib/libstdc++.so.6.0.8 $</lib/libstdc++.so.6.0.8 ; \
		ln -sf libstdc++.so.6.0.8 $</lib/libstdc++.so.6 ; \
	fi
	if [ -e $(targetprefix)/usr/lib/libz.so.1.2.3 -a ! -e $</lib/libz.so.1.2.3 ]; then \
		cp $(targetprefix)/usr/lib/libz.so.1.2.3 $</lib/libz.so.1.2.3 ; \
		ln -sf libz.so.1.2.3 $</lib/libz.so.1 ; \
	fi
	if [ -e $(targetprefix)/lib/librt-2.5.so -a ! -e $</lib/librt-2.5.so ]; then \
		cp $(targetprefix)/lib/librt-2.5.so $</lib/librt-2.5.so ; \
		ln -sf librt-2.5.so $</lib/librt.so.1 ; \
	fi
	if [ -e $(targetprefix)/usr/lib/libjpeg.so.62.0.0 -a ! -e $</lib/libjpeg.so.62.0.0 ]; then \
		cp $(targetprefix)/usr/lib/libjpeg.so.62.0.0 $</lib/ ; \
		ln -sf libjpeg.so.62.0.0 $</lib/libjpeg.so.62 ; \
	fi
	ln -sf /app/usr/lib/libvfsblkid.so $</lib/libvfsblkid.so
	PATH=$(MAKE_PATH) $(target)-strip --remove-section=.comment --remove-section=.note \
		`find $</bin/ -path "*bin/?*"` \
		`find $</sbin/ -path "*sbin/?*"` \
		`find $</usr/bin/ -path "*bin/?*"` \
		`find $</usr/sbin/ -path "*sbin/?*"` \
		`find $</var/bin/ -path "*bin/?*"` 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $</lib/* 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $</usr/lib/* 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $</usr/lib/gconv/* 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $</usr/lib/autofs/* 2>/dev/null || /bin/true
#	ln -sf /bin/ash $</bin/sh
#	ln -sf /app/usr/local/bin/lircd $</usr/sbin/lircd
#	ln -sf /app/usr/local/bin/lircmd $</usr/sbin/lircmd
	chmod u+rwX,go+rX -R $</
	find $</lib -name '*.la' | xargs rm -f
	find $</usr/lib -name '*.la' | xargs rm -f
	rm -rf $</include

$(flashprefix)/root/strippy \
$(flashprefix)/root-stock-cramfs/strippy \
$(flashprefix)/root-stock-squashfs/strippy \
$(flashprefix)/root-stock-jffs2/strippy \
$(flashprefix)/var-stock-jffs2/strippy \
$(prefix)/cdkroot/strippy \
$(prefix)/cdkroot-nfs/strippy \
$(prefix)/min-cdkroot/strippy \
$(prefix)/std-cdkroot/strippy \
$(prefix)/max-cdkroot/strippy \
$(prefix)/ipk-cdkroot/strippy \
$(ipkgbuilddir)/strippy: \
%/strippy: 
	PATH=$(MAKE_PATH) $(target)-strip --remove-section=.comment --remove-section=.note \
		`find $*/bin/ -path "*bin/?*"` \
		`find $*/sbin/ -path "*sbin/?*"` \
		`find $*/usr/bin/ -path "*bin/?*"` \
		`find $*/usr/local/bin/ -path "*bin/?*"` \
		`find $*/usr/sbin/ -path "*sbin/?*"` 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $*/lib/* 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $*/usr/lib/* 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $*/usr/lib/gconv/* 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $*/usr/lib/autofs/* 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip `find $*/usr/lib/python*/ -path "*lib/?*"` 2>/dev/null || /bin/true

$(flashprefix)/root-enigma2-disk/lib/ld-linux.so.2: \
%/lib/ld-linux.so.2: %
	find $</lib -maxdepth 1 -type f -o -type l | xargs rm -f
	find $</usr/lib -maxdepth 1 -type f -o -type l | xargs rm -f
	cp -d $(targetprefix)/lib/libnss_dns-?.*.so $</lib
	cp -d $(targetprefix)/lib/libnss_files-?.*.so $</lib
	PATH=$(MAKE_PATH) $(MKLIBS) --target $(target) --ldlib ld-linux.so.2 --libc-extras-dir \
		$(targetprefix)/usr/lib \
		-d $</lib \
		-D -L $(mklibs_librarypath) \
		--root $< \
		`find $</bin/ -path "*bin/?*" -type f ! -name "*.sh" ! -name "*.static"` \
		`find $</sbin/ -path "*sbin/?*" -type f ! -name "*.sh" ! -name "*.static" ! -name fbcondecor_helper` \
		`find $</usr/bin/ -path "*bin/?*" -type f` \
		`find $</usr/sbin/ -path "*sbin/?*" -type f` \
		`find $</usr/local/bin/ -path "*bin/?*" -type f` \
		`find $</lib/ -name "*.so" -type f` \
		`find $</usr/lib/ -name "*.so" -type f`
#	if [ -e $(targetprefix)/lib/libgcc_s-4.1.1.so.1 -a ! -e $</lib/libgcc_s-4.1.1.so.1 ]; then \
#		cp $(targetprefix)/lib/libgcc_s-4.1.1.so.1 $</lib/libgcc_s-4.1.1.so.1 ; \
#		ln -sf libgcc_s-4.1.1.so.1 $</lib/libgcc_s.so.1 ; \
#	fi
#	if [ -e $(targetprefix)/lib/libm-2.5.so -a ! -e $</lib/libm-2.5.so ]; then \
#		cp $(targetprefix)/lib/libm-2.5.so $</lib/libm-2.5.so ; \
#		ln -sf libm-2.5.so $</lib/libm.so.6 ; \
#	fi
#	if [ -e $(targetprefix)/lib/libpthread-2.5.so -a ! -e $</lib/libpthread-2.5.so ]; then \
#		cp $(targetprefix)/lib/libpthread-2.5.so $</lib/libpthread-2.5.so ; \
#		ln -sf libpthread-2.5.so $</lib/libpthread.so.0 ; \
#	fi
#	if [ -e $(targetprefix)/usr/lib/libstdc++.so.6.0.8 -a ! -e $</lib/libstdc++.so.6.0.8 ]; then \
#		cp $(targetprefix)/usr/lib/libstdc++.so.6.0.8 $</lib/libstdc++.so.6.0.8 ; \
#		ln -sf libstdc++.so.6.0.8 $</lib/libstdc++.so.6 ; \
#	fi
#	if [ -e $(targetprefix)/usr/lib/libz.so.1.2.3 -a ! -e $</lib/libz.so.1.2.3 ]; then \
#		cp $(targetprefix)/usr/lib/libz.so.1.2.3 $</lib/libz.so.1.2.3 ; \
#		ln -sf libz.so.1.2.3 $</lib/libz.so.1 ; \
#	fi
#	if [ -e $(targetprefix)/lib/librt-2.5.so -a ! -e $</lib/librt-2.5.so ]; then \
#		cp $(targetprefix)/lib/librt-2.5.so $</lib/librt-2.5.so ; \
#		ln -sf librt-2.5.so $</lib/librt.so.1 ; \
#	fi
	if [ -e $(targetprefix)/usr/lib/libdvdcss.so.2.0.8  ]; then \
		cp $(targetprefix)/usr/lib/libdvdcss.so.2.0.8 $</lib/ ; \
		ln -sf libdvdcss.so.2.0.8 $</lib/libdvdcss.so.2 ; \
	fi
	PATH=$(MAKE_PATH) $(target)-strip --remove-section=.comment --remove-section=.note \
		`find $</bin/ -path "*bin/?*"` \
		`find $</sbin/ -path "*sbin/?*"` \
		`find $</usr/bin/ -path "*bin/?*"` \
		`find $</usr/sbin/ -path "*sbin/?*"` \
		`find $</usr/local/bin/ -path "*bin/?*"` \
		`find $</var/bin/ -path "*bin/?*"` 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $</lib/* 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $</usr/lib/* 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $</usr/lib/gconv/* 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $</usr/lib/python2.6/lib-dynload/* 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip `find $</usr/lib/python2.6/site-packages/* -type f -name "*.so"` 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip `find $</usr/lib/enigma2/* -type f -name "*.so"` 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip `find $</usr/lib/alsaplayer/* -type f -name "*.so"` 2>/dev/null || /bin/true
	PATH=$(MAKE_PATH) $(target)-strip $</usr/lib/autofs/* 2>/dev/null || /bin/true
	chmod u+rwX,go+rX -R $</
	find $</lib -name '*.la' | xargs rm -f
	find $</usr/lib -name '*.la' | xargs rm -f
	rm -rf $</include

# Delete all marker files in .deps, except those belonging to bootstrap,
# thus forcing unpack-patch-install-delete-targets to be rebuilt.
depsclean:
	$(DEPSCLEANUP)

# currently rpmdepsclean is including targets made by tuxbox rules
rpmdepsclean:
	( cd .deps && find . ! -name "*\.*" -delete )
#	$(RPMDEPSCLEANUP)

@TARGETRULESET_FLASH_TRUE@mostlyclean-local: flash-clean cdk-clean
@TARGETRULESET_FLASH_FALSE@mostlyclean-local: cdk-clean

# Clean tuxbox source directories
cdk-clean:
	-$(MAKE) -C $(driverdir) KERNEL_LOCATION=$(buildprefix)/linux-sh4 \
		BIN_DEST=$(targetprefix)/bin \
		INSTALL_MOD_PATH=$(targetprefix) clean
	-$(MAKE) -C $(appsdir)/tuxbox/libs clean
	-$(MAKE) -C $(appsdir)/tuxbox/libtuxbox clean
	-$(MAKE) -C $(appsdir)/tuxbox/plugins clean
	-$(MAKE) -C $(appsdir)/misc/libs clean
	-$(MAKE) -C $(appsdir)/misc/tools distclean
	-$(MAKE) -C $(appsdir)/dvb/dvbsnoop clean
	-$(MAKE) -C $(hostappsdir) clean
#	-$(MAKE) -C root clean
	-rm -rf build

# Clean tuxbox source directories. Clean up in cdkroot as much as the
# uninstall facilities of the components allow.
clean-local: mostlyclean-local depsclean rpmdepsclean
	-$(MAKE) -C $(appsdir)/tuxbox/libs uninstall
	-$(MAKE) -C $(appsdir)/tuxbox/libtuxbox uninstall
	-$(MAKE) -C $(appsdir)/tuxbox/plugins uninstall
	-$(MAKE) -C $(appsdir)/misc/libs uninstall
	-$(MAKE) -C $(appsdir)/misc/tools uninstall
	-$(MAKE) -C $(appsdir)/dvb/dvbsnoop uninstall
	-$(MAKE) -C $(hostappsdir) uninstall
	-rm -rf $(hostprefix)
@TARGETRULESET_FLASH_TRUE@	-rm -rf $(flashprefix)/
@TARGETRULESET_FLASH_TRUE@	-rm -rf $(flashprefix)-rpmdb/
@TARGETRULESET_FLASH_TRUE@	-rm -rf $(ipkgbuilddir)/
	-rm -rf $(crossprefix)/
	-rm -rf $(configprefix)/
	-rm -rf $(devkitprefix)/
	-rm -rf $(prefix)/*cdkroot/
	-rm -rf $(prefix)/*cdkroot-rpmdb
	-rm -rf $(prefix)/*cdkroot-tftpboot
	-rm -rf $(rpmdbprefix)/
	-rm -rf $(ipkprefix)/
#	-rm -rf $(prefix)/release_neutrino*
	-rm -rf $(prefix)/release*
	-rm -rf SOURCES SPECS BUILD && install -d SOURCES SPECS BUILD
	-rm -rf $(prefix)/ccache
	-rm -rf $(DEPDIR)/autofs.*

# Be brutal...just nuke it!
distclean-local:
#	-$(MAKE) -C root distclean
	-$(MAKE) -C $(appsdir) distclean
#	-$(MAKE) -C $(appsdir)/dvb/dvbsnoop distclean
#	-$(MAKE) -C $(appsdir)/dvb/libdvb++ distclean
#	-$(MAKE) -C $(appsdir)/dvb/libdvbsi++ distclean
	-$(MAKE) -C $(appsdir)/tuxbox/libs distclean
	-$(MAKE) -C $(appsdir)/tuxbox/plugins distclean
	-$(MAKE) -C $(appsdir)/tuxbox/libtuxbox distclean
	-$(MAKE) -C $(appsdir)/misc/libs distclean
	-$(MAKE) -C $(appsdir)/misc/tools distclean
	-$(MAKE) -C $(hostappsdir) distclean
	-$(MAKE) driver-clean
	-$(MAKE) enigma2-clean
	-rm -f Makefile-archive
	-rm -f rules-downcheck.pl
	-rm -f linux
	-rm -rf $(DEPDIR)
#	-rm -rf $(targetprefix)
	-rm -rf $(hostprefix)
	-rm -rf $(serversupport)
@TARGETRULESET_FLASH_TRUE@	-rm -rf $(flashprefix)/
@TARGETRULESET_FLASH_TRUE@	-rm -rf $(flashprefix)-rpmdb/
@TARGETRULESET_FLASH_TRUE@	-rm -rf $(ipkgbuilddir)/
	-rm -rf $(crossprefix)/
	-rm -rf $(configprefix)/
	-rm -rf $(devkitprefix)/
	-rm -rf $(prefix)/*cdkroot/
	-rm -rf $(prefix)/*cdkroot-rpmdb
	-rm -rf $(prefix)/*cdkroot-tftpboot
	-rm -rf $(rpmdbprefix)/
	-rm -rf $(ipkprefix)/
	-rm -rf SOURCES SPECS BUILD BUILDROOT SRPMS RPMS
	-rm -rf $(prefix)/ccache
	-rm -rf $(kernelprefix)/u-boot
	-rm -rf $(STGFB_DIR)
	-@DISTCLEANUP@
#	rm symlinks
#	-rm compile config config.guess config.sub COPYING depcomp INSTALL install-sh ltmain.sh missing

################################################################
# flash-clean deletes everything created with the flash-* commands
# flash-semiclean leaves the flfs-images and the root-$filesystem dirs.
# (This is sensible, while these files seldomly change, and take rather
# long to build.)

# flash-semiclean is "homemade",
# flash-clean and flash-mostlyclean have semantics like in the GNU
# Makefile standards.

@TARGETRULESET_FLASH_TRUE@flash-semiclean:
@TARGETRULESET_FLASH_TRUE@	rm -f $(flashprefix)/*.cramfs $(flashprefix)/*.squashfs \
@TARGETRULESET_FLASH_TRUE@	$(flashprefix)/*.jffs2 $(flashprefix)/.*-flfs \
@TARGETRULESET_FLASH_TRUE@	$(flashprefix)/*.list
@TARGETRULESET_FLASH_TRUE@	rm -rf $(flashprefix)/root
@TARGETRULESET_FLASH_TRUE@	rm -rf $(flashprefix)/root-stock*
@TARGETRULESET_FLASH_TRUE@	rm -rf $(flashprefix)/root-neutrino*
@TARGETRULESET_FLASH_TRUE@	rm -rf $(flashprefix)/root-radiobox*
@TARGETRULESET_FLASH_TRUE@	rm -rf $(flashprefix)/root-enigma*
@TARGETRULESET_FLASH_TRUE@	rm -rf $(flashprefix)/conf*
@TARGETRULESET_FLASH_TRUE@	rm -rf $(flashprefix)/var*
@TARGETRULESET_FLASH_TRUE@	rm -rf $(flashprefix)/data*
@TARGETRULESET_FLASH_TRUE@	rm -rf $(flashprefix)/kernel*
@TARGETRULESET_FLASH_TRUE@	-rm -rf $(flashprefix)/mtdblock*
@TARGETRULESET_FLASH_TRUE@	-rm -rf $(flashprefix)/sdax*
@TARGETRULESET_FLASH_TRUE@	-rm -rf $(flashprefix)-rpmdb/*
@TARGETRULESET_FLASH_TRUE@	-rm $(flashprefix)/enigma2*

@TARGETRULESET_FLASH_TRUE@flash-mostlyclean: flash-semiclean
@TARGETRULESET_FLASH_TRUE@	rm -rf $(flashprefix)/root-*
@TARGETRULESET_FLASH_TRUE@	rm -f $(flashprefix)/*.flfs*x

@TARGETRULESET_FLASH_TRUE@flash-clean: flash-mostlyclean
@TARGETRULESET_FLASH_TRUE@	rm -f $(flashprefix)/*.img*

#
# RPM stuff
#
list-clean:
	make $(LIST_CLEAN)

$(LIST_CLEAN): \
%-clean:
	-$(DEPSCLEANUP_$*)

$(RPMLIST_CLEAN): \
%-clean:
	-rpm $(DRPM) -ev --nodeps $(STLINUX)-sh4-$(subst -clean,,$@)
	-$(DEPSCLEANUP_$*)

%-clean:
	-rpm $(DRPM) -ev --nodeps $(STLINUX)-$(subst -clean,,$@)
	-rpm $(DRPM) -ev --nodeps $(STLINUX)-sh4-$(subst -clean,,$@)
	-rm .deps/$(subst -clean,,$@)

list-distclean:
	make $(LIST_DISTCLEAN)

$(LIST_DISTCLEAN): \
%-distclean:
	-$(DISTCLEANUP_$*)
	-$(DEPSDISTCLEANUP_$*)

$(RPMLIST_DISTCLEAN): \
%-distclean:
	-rpm $(DRPM) -ev --nodeps $(STLINUX)-sh4-$(subst -distclean,,$@)
	-rm RPMS/sh4/$(STLINUX)-sh4-$(subst -distclean,,$@)*
	-$(DEPSDISTCLEANUP_$*)

%-distclean:
	-rpm $(DRPM) -ev --nodeps $(STLINUX)-$(subst -distclean,,$@)
	-rpm $(DRPM) -ev --nodeps $(STLINUX)-sh4-$(subst -distclean,,$@)
	-rm RPMS/${host_arch}/$(STLINUX)-$(subst -distclean,,$@)*
	-rm RPMS/noarch/$(STLINUX)-$(subst -distclean,,$@)*
	-rm RPMS/sh4/$(STLINUX)-$(subst -distclean,,$@)*
	-rm RPMS/sh4/$(STLINUX)-sh4-$(subst -distclean,,$@)*
	-rm .deps/$(subst -distclean,,$@)*

.PHONY: depsclean mostlyclean-local cdk-clean distclean-local flash-semiclean \
flash-mostlyclean flash-clean

.PHONY: all everything yadd-all extra serversupport \
	bare-os yadd-none yadd-micro-neutrino yadd-neutrino yadd-enigma \
	yadd-lcars yadd-all extra 
TAGS: Makefile.am $(shell echo make/*.mk)
	etags --language=makefile $^

tags: Makefile.am $(shell echo make/*.mk)
	gnuctags --language=makefile $^
@MAINTAINER_MODE_TRUE@Makefile-archive: $(top_srcdir)/rules-archive $(top_srcdir)/rules-archive.pl
@MAINTAINER_MODE_TRUE@	$(top_srcdir)/rules-archive.pl $(top_srcdir)/rules-archive > Makefile-archive

@ARCHIVE@
# auxiliary targets for model-specific builds
release_common_utils:
#       remove the slink to busybox
	rm -f $(prefix)/release/sbin/halt
	cp -f $(targetprefix)/sbin/halt $(prefix)/release/sbin/
	cp $(buildprefix)/root/release/umountfs $(prefix)/release/etc/init.d/
	cp $(buildprefix)/root/release/rc $(prefix)/release/etc/init.d/
	cp $(buildprefix)/root/release/sendsigs $(prefix)/release/etc/init.d/
	chmod 755 $(prefix)/release/etc/init.d/umountfs
	chmod 755 $(prefix)/release/etc/init.d/rc
	chmod 755 $(prefix)/release/etc/init.d/sendsigs
	chmod 755 $(prefix)/release/etc/init.d/halt
	mkdir -p $(prefix)/release/etc/rc.d/rc0.d
	ln -s ../init.d $(prefix)/release/etc/rc.d
	ln -fs halt $(prefix)/release/sbin/reboot
	ln -fs halt $(prefix)/release/sbin/poweroff
	ln -s ../init.d/sendsigs $(prefix)/release/etc/rc.d/rc0.d/S20sendsigs
	ln -s ../init.d/umountfs $(prefix)/release/etc/rc.d/rc0.d/S40umountfs
	ln -s ../init.d/halt $(prefix)/release/etc/rc.d/rc0.d/S90halt
	mkdir -p $(prefix)/release/etc/rc.d/rc6.d
	ln -s ../init.d/sendsigs $(prefix)/release/etc/rc.d/rc6.d/S20sendsigs
	ln -s ../init.d/umountfs $(prefix)/release/etc/rc.d/rc6.d/S40umountfs
	ln -s ../init.d/reboot $(prefix)/release/etc/rc.d/rc6.d/S90reboot

release_spark:
	echo "PinguLux" > $(prefix)/release/etc/hostname

	cp $(buildprefix)/root/release/umountfs $(prefix)/release/etc/init.d/
	cp $(buildprefix)/root/release/rc $(prefix)/release/etc/init.d/
	cp $(buildprefix)/root/release/sendsigs $(prefix)/release/etc/init.d/
	rm -f $(prefix)/release/sbin/halt
	cp -f $(targetprefix)/sbin/halt $(prefix)/release/sbin/
	cp $(buildprefix)/root/release/halt_spark_enigma2 $(prefix)/release/etc/init.d/halt
	chmod 755 $(prefix)/release/etc/init.d/umountfs
	chmod 755 $(prefix)/release/etc/init.d/rc
	chmod 755 $(prefix)/release/etc/init.d/sendsigs
	chmod 755 $(prefix)/release/etc/init.d/halt
	mkdir -p $(prefix)/release/usr/script
	mkdir -p $(prefix)/release/etc/rc.d/rc0.d
	ln -s ../init.d $(prefix)/release/etc/rc.d
	ln -fs halt $(prefix)/release/sbin/reboot
	ln -fs halt $(prefix)/release/sbin/poweroff
	ln -s ../init.d/sendsigs $(prefix)/release/etc/rc.d/rc0.d/S20sendsigs
	ln -s ../init.d/umountfs $(prefix)/release/etc/rc.d/rc0.d/S40umountfs
	ln -s ../init.d/halt $(prefix)/release/etc/rc.d/rc0.d/S90halt
	mkdir -p $(prefix)/release/etc/rc.d/rc6.d
	ln -s ../init.d/sendsigs $(prefix)/release/etc/rc.d/rc6.d/S20sendsigs
	ln -s ../init.d/umountfs $(prefix)/release/etc/rc.d/rc6.d/S40umountfs
	ln -s ../init.d/reboot $(prefix)/release/etc/rc.d/rc6.d/S90reboot
	ln -fs init $(prefix)/release/sbin/telinit

	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmcore-display-sti7111.ko $(prefix)/release/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontcontroller/aotom/aotom.ko $(prefix)/release/lib/modules/

	cp -f $(buildprefix)/root/release/fstab_spark $(prefix)/release/etc/fstab
	cp $(buildprefix)/root/boot/startup.mp4 $(prefix)/release/boot/startup.mp4

	cp -f $(buildprefix)/root/usr/local/share/enigma2/keymap_spark.xml $(prefix)/release/usr/local/share/enigma2/keymap.xml
	cp -f $(buildprefix)/root/usr/sbin/iw* $(prefix)/release/usr/sbin/
	cp -f $(buildprefix)/root/usr/sbin/wpa* $(prefix)/release/usr/sbin/
	cp -RP $(buildprefix)/root/etc/Wireless $(prefix)/release/etc/
	cp -f $(buildprefix)/root/usr/lib/libiw.so.29 $(prefix)/release/usr/lib/
	cp -f $(buildprefix)/root/usr/lib/libgnu* $(prefix)/release/usr/lib/
	cp -f $(buildprefix)/root/usr/lib/libgcrypt* $(prefix)/release/usr/lib/
	cp -f $(buildprefix)/root/usr/lib/libgpg* $(prefix)/release/usr/lib/
	cp -RP $(buildprefix)/root/etc/init.d/setupETH.sh $(prefix)/release/etc/init.d/

@STM23_TRUE@	cp -f $(buildprefix)/root/lib/modules/rt2870sta_stm23.ko $(prefix)/release/lib/modules/rt2870sta.ko
@STM23_TRUE@	cp -f $(buildprefix)/root/lib/modules/rt3070sta_stm23.ko $(prefix)/release/lib/modules/rt3070sta.ko
@STM23_TRUE@	cp -f $(buildprefix)/root/lib/modules/smartcard_stm23.ko $(prefix)/release/lib/modules/smartcard.ko
#	cp -f $(buildprefix)/root/release/vfd_spark$(KERNELSTMLABEL)_noptk.ko $(prefix)/release/lib/modules/vfd.ko
@STM23_TRUE@	cp -f $(buildprefix)/root/release/encrypt_spark$(KERNELSTMLABEL)_noptk.ko $(prefix)/release/lib/modules/encrypt.ko
@ENABLE_P0207_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/smartcard/smartcard.ko $(prefix)/release/lib/modules/
@ENABLE_P0207_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/wireless/rt2870sta/rt2870sta.ko $(prefix)/release/lib/modules/
@ENABLE_P0207_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/wireless/rt3070sta/rt3070sta.ko $(prefix)/release/lib/modules/
#	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontcontroller/vfd.fulan/vfd.ko $(prefix)/release/lib/modules/
@ENABLE_P0207_TRUE@@STM24_TRUE@	cp -f $(buildprefix)/root/release/encrypt_spark$(KERNELSTMLABEL).ko $(prefix)/release/lib/modules/encrypt.ko
@ENABLE_P0209_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/smartcard/smartcard.ko $(prefix)/release/lib/modules/
@ENABLE_P0209_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/wireless/rt2870sta/rt2870sta.ko $(prefix)/release/lib/modules/
@ENABLE_P0209_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/wireless/rt3070sta/rt3070sta.ko $(prefix)/release/lib/modules/
#	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontcontroller/vfd.fulan/vfd.ko $(prefix)/release/lib/modules/
#	cp -f $(buildprefix)/root/release/encrypt_spark$(KERNELSTMLABEL).ko $(prefix)/release/lib/modules/encrypt.ko
	cp -f $(buildprefix)/root/sbin/flash* $(prefix)/release/sbin
	cp -f $(buildprefix)/root/sbin/nand* $(prefix)/release/sbin

	cp -dp $(buildprefix)/root/etc/lircd_spark.conf $(prefix)/release/etc/lircd.conf
	cp -dp $(targetprefix)/usr/bin/lircd $(prefix)/release/usr/bin/

	$(INSTALL_DIR) $(prefix)/release/usr/share/fonts
	cp $(targetprefix)/usr/local/share/fonts/* $(prefix)/release/usr/share/fonts/

	cp $(kernelprefix)/linux-sh4/drivers/usb/serial/ftdi_sio.ko $(prefix)/release/lib/modules/ftdi.ko
	cp $(kernelprefix)/linux-sh4/drivers/usb/serial/pl2303.ko $(prefix)/release/lib/modules
	cp $(kernelprefix)/linux-sh4/drivers/usb/serial/usbserial.ko $(prefix)/release/lib/modules
#	if STM23
	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko $(prefix)/release/lib/modules || true
#	endif
#	install autofs
	cp -f $(targetprefix)/usr/sbin/automount $(prefix)/release/usr/sbin/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/kernel/fs/autofs4/autofs4.ko $(prefix)/release/lib/modules
	cp -f $(buildprefix)/root/release/auto.usb $(prefix)/release/etc/
	echo 'sda    -fstype=auto,noatime,nodiratime          :/dev/sda' >> $(prefix)/release/etc/auto.usb
	echo 'sda1   -fstype=auto,noatime,nodiratime          :/dev/sda1' >> $(prefix)/release/etc/auto.usb
	echo 'sda2   -fstype=auto,noatime,nodiratime          :/dev/sda2' >> $(prefix)/release/etc/auto.usb
	echo 'sda3   -fstype=auto,noatime,nodiratime          :/dev/sda3' >> $(prefix)/release/etc/auto.usb

	rm -f $(prefix)/release/lib/firmware/dvb-fe-avl2108.fw
	rm -f $(prefix)/release/lib/firmware/dvb-fe-stv6306.fw
	rm -f $(prefix)/release/lib/firmware/dvb-fe-cx24116.fw
	rm -f $(prefix)/release/lib/firmware/dvb-fe-cx21143.fw
	rm -f $(prefix)/release/bin/evremote
	rm -f $(prefix)/release/bin/gotosleep
	rm -f $(prefix)/release/bin/vdstandby

	mv $(prefix)/release/lib/firmware/component_7111_mb618.fw $(prefix)/release/lib/firmware/component.fw
	rm $(prefix)/release/lib/firmware/component_7105_pdk7105.fw

	cp -f $(buildprefix)/root/usr/local/share/enigma2/po/de/LC_MESSAGES/enigma2.mo.pingulux $(prefix)/release/usr/local/share/enigma2/po/de/LC_MESSAGES/enigma2.mo
	cp -f $(buildprefix)/root/usr/bin/mkfs.jffs2 $(prefix)/release/usr/bin/
	cp -f $(buildprefix)/root/sbin/mkyaffs2 $(prefix)/release/sbin/
	( cd $(prefix) && cp -RP ../flash/spark/spark_oob.img $(prefix)/release/sbin/ )
	cp -RP $(buildprefix)/root/usr/lib/liblzo2.so.2* $(prefix)/release/usr/lib/
	cp -RP $(buildprefix)/root/lib/libproc* $(prefix)/release/lib/
	cp -RP $(buildprefix)/root/sbin/ntpdate $(prefix)/release/sbin/
	rm $(prefix)/release/bin/ps
	mkdir -p $(prefix)/release/usr/lib/opkg/info
	touch $(prefix)/release/usr/lib/opkg/info/opkg.list
	cp -RP $(buildprefix)/root/bin/ps $(prefix)/release/bin/
	cp -RP $(buildprefix)/root/bin/dropbear $(prefix)/release/bin/
	cp -RP $(buildprefix)/root/bin/dropbearkey $(prefix)/release/bin/
	cp -RP $(buildprefix)/root/etc/init.d/dropbear $(prefix)/release/etc/init.d/
	mkdir -p $(prefix)/release/etc/dropbear
	cp -RP $(buildprefix)/root/usr/lib/python2.6/site-packages/* $(prefix)/release/usr/lib/python2.6/site-packages/
	cp -f $(buildprefix)/root/usr/bin/backup_pingulux_image.sh $(prefix)/release/usr/bin/
	cp -f $(buildprefix)/root/etc/init.d/Swap.sh $(prefix)/release/etc/init.d/
	cp -f $(buildprefix)/root/etc/init.d/ntpupdate.sh $(prefix)/release/etc/init.d/
	cp -f $(buildprefix)/root/etc/fw_env.config $(prefix)/release/etc/
	cp -f $(buildprefix)/root/etc/bootargs_* $(prefix)/release/etc/
	cp -f $(buildprefix)/root/bin/fw_printenv $(prefix)/release/bin/
	cp -f $(buildprefix)/root/bin/fw_setenv $(prefix)/release/bin/
	touch $(prefix)/release/etc/.fsck
	if [ ! -e $(prefix)/release/etc/rc.d/rc3.d ]; then \
		mkdir -p $(prefix)/release/etc/rc.d/rc3.d; \
	fi; 
	ln -sf ../init.d/Swap.sh $(prefix)/release/etc/rc.d/rc3.d/S51swap
	ln -sf ../init.d/ntpupdate.sh $(prefix)/release/etc/rc.d/rc3.d/S52ntpupdate
### del libcoolstream+libeplayer2 stuff as not needed for pingulux-E2 ###
	rm -f $(prefix)/release/lib/libcool*
	rm -f $(prefix)/release/lib/libeplayer2*
# copy evo mc files ####
	rm -rf $(prefix)/release/usr/local/share/enigma2/skin_default
	cp -RP $(buildprefix)/root/usr/local/share/enigma2/skin_default $(prefix)/release/usr/local/share/enigma2/
	cp -RP $(buildprefix)/root/usr/local/share/enigma2/skin_default.xml $(prefix)/release/usr/local/share/enigma2/
	cp -RP $(buildprefix)/root/usr/local/share/enigma2/skin.xml $(prefix)/release/usr/local/share/enigma2/
	cp -RP $(buildprefix)/root/usr/local/share/enigma2/prev.png $(prefix)/release/usr/local/share/enigma2/
	cp -RP $(buildprefix)/root/usr/local/share/enigma2/EVO-blackGlass-HD $(prefix)/release/usr/local/share/enigma2/

#
# The main target depends on the model.
# IMPORTANT: it is assumed that only one variable is set. Otherwise the target name won't be resolved.
#
$(DEPDIR)/min-release $(DEPDIR)/std-release $(DEPDIR)/max-release $(DEPDIR)/ipk-release $(DEPDIR)/release: \
$(DEPDIR)/%release: release_base release_$(SPARK)
	touch $@

release-clean:
	rm -f $(DEPDIR)/release
	rm -f $(DEPDIR)/release_base
	rm -f $(DEPDIR)/release_$(SPARK)
	rm -f $(DEPDIR)/release_common_utils
	rm -f $(DEPDIR)/release_cube_common

# the following target creates the common file base
release_base:
	rm -rf $(prefix)/release || true
	$(INSTALL_DIR) $(prefix)/release && \
	$(INSTALL_DIR) $(prefix)/release/bin && \
	$(INSTALL_DIR) $(prefix)/release/sbin && \
	$(INSTALL_DIR) $(prefix)/release/boot && \
	$(INSTALL_DIR) $(prefix)/release/dev && \
	$(INSTALL_DIR) $(prefix)/release/dev.static && \
	$(INSTALL_DIR) $(prefix)/release/etc && \
	$(INSTALL_DIR) $(prefix)/release/etc/fonts && \
	$(INSTALL_DIR) $(prefix)/release/etc/init.d && \
	$(INSTALL_DIR) $(prefix)/release/etc/network && \
	$(INSTALL_DIR) $(prefix)/release/etc/network/if-down.d && \
	$(INSTALL_DIR) $(prefix)/release/etc/network/if-post-down.d && \
	$(INSTALL_DIR) $(prefix)/release/etc/network/if-pre-up.d && \
	$(INSTALL_DIR) $(prefix)/release/etc/network/if-up.d && \
	$(INSTALL_DIR) $(prefix)/release/etc/tuxbox && \
	$(INSTALL_DIR) $(prefix)/release/etc/enigma2 && \
	$(INSTALL_DIR) $(prefix)/release/media/hdd && \
	$(INSTALL_DIR) $(prefix)/release/media/hdd/movie && \
	$(INSTALL_DIR) $(prefix)/release/media/hdd/music && \
	$(INSTALL_DIR) $(prefix)/release/media/hdd/picture && \
	$(INSTALL_DIR) $(prefix)/release/lib && \
	$(INSTALL_DIR) $(prefix)/release/lib/modules && \
	$(INSTALL_DIR) $(prefix)/release/ram && \
	$(INSTALL_DIR) $(prefix)/release/var && \
	$(INSTALL_DIR) $(prefix)/release/var/opkg && \
	export CROSS_COMPILE=$(target)- && \
		$(MAKE) install -C @DIR_busybox@ CONFIG_PREFIX=$(prefix)/release && \
	ln -s  ../etc $(prefix)/release/var/etc && \
	cp -a $(targetprefix)/bin/* $(prefix)/release/bin/ && \
	ln -s /bin/showiframe $(prefix)/release/usr/bin/showiframe && \
	cp -dp $(targetprefix)/bin/hotplug $(prefix)/release/sbin/ && \
	cp -dp $(targetprefix)/sbin/init $(prefix)/release/sbin/ && \
	cp -dp $(targetprefix)/sbin/killall5 $(prefix)/release/sbin/ && \
	cp -dp $(targetprefix)/sbin/portmap $(prefix)/release/sbin/ && \
	cp -dp $(targetprefix)/sbin/mke2fs $(prefix)/release/sbin/ && \
	ln -sf /sbin/mke2fs $(prefix)/release/sbin/mkfs.ext2 && \
	ln -sf /sbin/mke2fs $(prefix)/release/sbin/mkfs.ext3 && \
	ln -sf /sbin/mke2fs $(prefix)/release/sbin/mkfs.ext4 && \
	ln -sf /sbin/mke2fs $(prefix)/release/sbin/mkfs.ext4dev && \
	cp -dp $(targetprefix)/sbin/fsck $(prefix)/release/sbin/ && \
	cp -dp $(targetprefix)/sbin/e2fsck $(prefix)/release/sbin/ && \
	ln -sf /sbin/e2fsck $(prefix)/release/sbin/fsck.ext2 && \
	ln -sf /sbin/e2fsck $(prefix)/release/sbin/fsck.ext3 && \
	ln -sf /sbin/e2fsck $(prefix)/release/sbin/fsck.ext4 && \
	ln -sf /sbin/e2fsck $(prefix)/release/sbin/fsck.ext4dev && \
	cp -dp $(targetprefix)/sbin/jfs_fsck $(prefix)/release/sbin/ && \
	ln -sf /sbin/jfs_fsck $(prefix)/release/sbin/fsck.jfs && \
	cp -dp $(targetprefix)/sbin/jfs_mkfs $(prefix)/release/sbin/ && \
	ln -sf /sbin/jfs_mkfs $(prefix)/release/sbin/mkfs.jfs && \
	cp -dp $(targetprefix)/sbin/jfs_tune $(prefix)/release/sbin/ && \
	cp -dp $(targetprefix)/sbin/fsck.nfs $(prefix)/release/sbin/ && \
	cp -dp $(targetprefix)/sbin/sfdisk $(prefix)/release/sbin/ && \
	cp -dp $(targetprefix)/sbin/tune2fs $(prefix)/release/sbin/ && \
	cp -dp $(targetprefix)/etc/init.d/portmap $(prefix)/release/etc/init.d/ && \
	cp -dp $(buildprefix)/root/etc/init.d/udhcpc $(prefix)/release/etc/init.d/ && \
	cp -a $(targetprefix)/dev/* $(prefix)/release/dev/ && \
	cp -dp $(targetprefix)/etc/fstab $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/group $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/host.conf $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/hostname $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/hosts $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/inetd.conf $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/inittab $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/localtime $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/mtab $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/passwd $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/profile $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/protocols $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/resolv.conf $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/services $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/shells $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/shells.conf $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/timezone.xml $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/vsftpd.conf $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/inetd.conf $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/image-version $(prefix)/release/etc/ && \
	cp -dp $(targetprefix)/etc/network/interfaces $(prefix)/release/etc/network/ && \
	cp -dp $(targetprefix)/etc/network/options $(prefix)/release/etc/network/ && \
	cp -dp $(targetprefix)/etc/init.d/umountfs $(prefix)/release/etc/init.d/ && \
	cp -dp $(targetprefix)/etc/init.d/sendsigs $(prefix)/release/etc/init.d/ && \
	cp -dp $(targetprefix)/etc/init.d/halt $(prefix)/release/etc/init.d/ && \
	cp $(buildprefix)/root/release/reboot $(prefix)/release/etc/init.d/ && \
	cp $(targetprefix)/etc/tuxbox/satellites.xml $(prefix)/release/etc/tuxbox/ && \
	cp $(targetprefix)/etc/tuxbox/cables.xml $(prefix)/release/etc/tuxbox/ && \
	cp $(targetprefix)/etc/tuxbox/terrestrial.xml $(prefix)/release/etc/tuxbox/ && \
	echo "576i50" > $(prefix)/release/etc/videomode && \
	cp -R $(targetprefix)/etc/fonts/* $(prefix)/release/etc/fonts/ && \
	cp $(buildprefix)/root/release/rcS_stm23_24_spark $(prefix)/release/etc/init.d/rcS && \
	chmod 755 $(prefix)/release/etc/init.d/rcS && \
	cp $(buildprefix)/root/release/mountvirtfs $(prefix)/release/etc/init.d/ && \
	cp $(buildprefix)/root/release/mme_check $(prefix)/release/etc/init.d/ && \
	cp $(buildprefix)/root/release/mountall $(prefix)/release/etc/init.d/ && \
	cp $(buildprefix)/root/release/hostname $(prefix)/release/etc/init.d/ && \
	cp $(buildprefix)/root/release/vsftpd $(prefix)/release/etc/init.d/ && \
	cp $(buildprefix)/root/release/bootclean.sh $(prefix)/release/etc/init.d/ && \
	cp $(buildprefix)/root/release/networking $(prefix)/release/etc/init.d/ && \
	cp -rd $(targetprefix)/lib/* $(prefix)/release/lib/ && \
	rm -f $(prefix)/release/lib/*.a && \
	rm -f $(prefix)/release/lib/*.o && \
	rm -f $(prefix)/release/lib/*.la && \
	find $(prefix)/release/lib/ -name '*.so*' -exec sh4-linux-strip --strip-unneeded {} \;

@STM24_TRUE@	cp -dp $(targetprefix)/sbin/mkfs $(prefix)/release/sbin/

@ENABLE_PLAYER131_TRUE@	cd $(targetprefix)/lib/modules/$(KERNELVERSION)/extra && \
@ENABLE_PLAYER131_TRUE@	for mod in \
@ENABLE_PLAYER131_TRUE@		sound/pseudocard/pseudocard.ko \
@ENABLE_PLAYER131_TRUE@		sound/silencegen/silencegen.ko \
@ENABLE_PLAYER131_TRUE@		stm/mmelog/mmelog.ko \
@ENABLE_PLAYER131_TRUE@		stm/monitor/stm_monitor.ko \
@ENABLE_PLAYER131_TRUE@		media/video/stm/stm_v4l2.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/dvb/stmdvb.ko \
@ENABLE_PLAYER131_TRUE@		sound/ksound/ksound.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/mpeg2_hard_host_transformer/mpeg2hw.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/backend/player2.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/h264_preprocessor/sth264pp.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/allocator/stmalloc.ko \
@ENABLE_PLAYER131_TRUE@		stm/platform/platform.ko \
@ENABLE_PLAYER131_TRUE@		stm/platform/p2div64.ko \
@ENABLE_PLAYER131_TRUE@	;do \
@ENABLE_PLAYER131_TRUE@		echo `pwd` player2/linux/drivers/$$mod; \
@ENABLE_PLAYER131_TRUE@		if [ -e player2/linux/drivers/$$mod ]; then \
@ENABLE_PLAYER131_TRUE@			cp player2/linux/drivers/$$mod $(prefix)/release/lib/modules/; \
@ENABLE_PLAYER131_TRUE@			sh4-linux-strip --strip-unneeded $(prefix)/release/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER131_TRUE@		else \
@ENABLE_PLAYER131_TRUE@			touch $(prefix)/release/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER131_TRUE@		fi; \
@ENABLE_PLAYER131_TRUE@		echo "."; \
@ENABLE_PLAYER131_TRUE@	done
@ENABLE_PLAYER131_TRUE@	echo "touched";
@ENABLE_PLAYER179_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stm_v4l2.ko $(prefix)/release/lib/modules/
@ENABLE_PLAYER179_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvbi.ko $(prefix)/release/lib/modules/
@ENABLE_PLAYER179_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvout.ko $(prefix)/release/lib/modules/
@ENABLE_PLAYER179_TRUE@	cd $(targetprefix)/lib/modules/$(KERNELVERSION)/extra && \
@ENABLE_PLAYER179_TRUE@	for mod in \
@ENABLE_PLAYER179_TRUE@		sound/pseudocard/pseudocard.ko \
@ENABLE_PLAYER179_TRUE@		sound/silencegen/silencegen.ko \
@ENABLE_PLAYER179_TRUE@		stm/mmelog/mmelog.ko \
@ENABLE_PLAYER179_TRUE@		stm/monitor/stm_monitor.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/dvb/stmdvb.ko \
@ENABLE_PLAYER179_TRUE@		sound/ksound/ksound.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/mpeg2_hard_host_transformer/mpeg2hw.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/backend/player2.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/h264_preprocessor/sth264pp.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/allocator/stmalloc.ko \
@ENABLE_PLAYER179_TRUE@		stm/platform/platform.ko \
@ENABLE_PLAYER179_TRUE@		stm/platform/p2div64.ko \
@ENABLE_PLAYER179_TRUE@		media/sysfs/stm/stmsysfs.ko \
@ENABLE_PLAYER179_TRUE@	;do \
@ENABLE_PLAYER179_TRUE@		echo `pwd` player2/linux/drivers/$$mod; \
@ENABLE_PLAYER179_TRUE@		if [ -e player2/linux/drivers/$$mod ]; then \
@ENABLE_PLAYER179_TRUE@			cp player2/linux/drivers/$$mod $(prefix)/release/lib/modules/; \
@ENABLE_PLAYER179_TRUE@			sh4-linux-strip --strip-unneeded $(prefix)/release/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER179_TRUE@		else \
@ENABLE_PLAYER179_TRUE@			touch $(prefix)/release/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER179_TRUE@		fi; \
@ENABLE_PLAYER179_TRUE@		echo "."; \
@ENABLE_PLAYER179_TRUE@	done
@ENABLE_PLAYER179_TRUE@	echo "touched";

@ENABLE_PLAYER191_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stm_v4l2.ko $(prefix)/release/lib/modules/
@ENABLE_PLAYER191_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvbi.ko $(prefix)/release/lib/modules/
@ENABLE_PLAYER191_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvout.ko $(prefix)/release/lib/modules/
@ENABLE_PLAYER191_TRUE@	cd $(targetprefix)/lib/modules/$(KERNELVERSION)/extra && \
@ENABLE_PLAYER191_TRUE@	for mod in \
@ENABLE_PLAYER191_TRUE@		sound/pseudocard/pseudocard.ko \
@ENABLE_PLAYER191_TRUE@		sound/silencegen/silencegen.ko \
@ENABLE_PLAYER191_TRUE@		stm/mmelog/mmelog.ko \
@ENABLE_PLAYER191_TRUE@		stm/monitor/stm_monitor.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/dvb/stmdvb.ko \
@ENABLE_PLAYER191_TRUE@		sound/ksound/ksound.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/mpeg2_hard_host_transformer/mpeg2hw.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/backend/player2.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/h264_preprocessor/sth264pp.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/allocator/stmalloc.ko \
@ENABLE_PLAYER191_TRUE@		stm/platform/platform.ko \
@ENABLE_PLAYER191_TRUE@		stm/platform/p2div64.ko \
@ENABLE_PLAYER191_TRUE@		media/sysfs/stm/stmsysfs.ko \
@ENABLE_PLAYER191_TRUE@	;do \
@ENABLE_PLAYER191_TRUE@		echo `pwd` player2/linux/drivers/$$mod; \
@ENABLE_PLAYER191_TRUE@		if [ -e player2/linux/drivers/$$mod ]; then \
@ENABLE_PLAYER191_TRUE@			cp player2/linux/drivers/$$mod $(prefix)/release/lib/modules/; \
@ENABLE_PLAYER191_TRUE@			sh4-linux-strip --strip-unneeded $(prefix)/release/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER191_TRUE@		else \
@ENABLE_PLAYER191_TRUE@			touch $(prefix)/release/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER191_TRUE@		fi; \
@ENABLE_PLAYER191_TRUE@		echo "."; \
@ENABLE_PLAYER191_TRUE@	done
@ENABLE_PLAYER191_TRUE@	echo "touched";

@STM22_TRUE@	rm $(prefix)/release/lib/modules/p2div64.ko
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/avs/avs.ko $(prefix)/release/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/boxtype/boxtype.ko $(prefix)/release/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/simu_button/simu_button.ko $(prefix)/release/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/e2_proc/e2_proc.ko $(prefix)/release/lib/modules/

	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmfb.ko $(prefix)/release/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxshell/embxshell.ko $(prefix)/release/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxmailbox/embxmailbox.ko $(prefix)/release/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxshm/embxshm.ko $(prefix)/release/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/mme/mme_host.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/multituner/*.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/kernel/drivers/media/dvb/frontends/dvb-pll.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/multituner/*.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/kernel/drivers/media/dvb/frontends/dvb-pll.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/multituner/*.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/kernel/drivers/media/dvb/frontends/dvb-pll.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_250HD_TRUE@@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_FALSE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/multituner/*.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_250HD_TRUE@@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_FALSE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/kernel/drivers/media/dvb/frontends/dvb-pll.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_250HD_FALSE@@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_FALSE@@ENABLE_CUBEREVO_MINI_FTA_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/multituner/*.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_250HD_FALSE@@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_FALSE@@ENABLE_CUBEREVO_MINI_FTA_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/kernel/drivers/media/dvb/frontends/dvb-pll.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_2000HD_TRUE@@ENABLE_CUBEREVO_250HD_FALSE@@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_FALSE@@ENABLE_CUBEREVO_MINI_FTA_FALSE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/multituner/*.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_2000HD_TRUE@@ENABLE_CUBEREVO_250HD_FALSE@@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_FALSE@@ENABLE_CUBEREVO_MINI_FTA_FALSE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/kernel/drivers/media/dvb/frontends/dvb-pll.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_2000HD_FALSE@@ENABLE_CUBEREVO_250HD_FALSE@@ENABLE_CUBEREVO_9500HD_TRUE@@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_FALSE@@ENABLE_CUBEREVO_MINI_FTA_FALSE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/multituner/*.ko $(prefix)/release/lib/modules/
@ENABLE_CUBEREVO_2000HD_FALSE@@ENABLE_CUBEREVO_250HD_FALSE@@ENABLE_CUBEREVO_9500HD_TRUE@@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_FALSE@@ENABLE_CUBEREVO_MINI_FTA_FALSE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/kernel/drivers/media/dvb/frontends/dvb-pll.ko $(prefix)/release/lib/modules/
@ENABLE_ATEVIO7500_TRUE@@ENABLE_CUBEREVO_2000HD_FALSE@@ENABLE_CUBEREVO_250HD_FALSE@@ENABLE_CUBEREVO_9500HD_FALSE@@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_FALSE@@ENABLE_CUBEREVO_MINI_FTA_FALSE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/multituner/*.ko $(prefix)/release/lib/modules/
@ENABLE_ATEVIO7500_FALSE@@ENABLE_CUBEREVO_2000HD_FALSE@@ENABLE_CUBEREVO_250HD_FALSE@@ENABLE_CUBEREVO_9500HD_FALSE@@ENABLE_CUBEREVO_FALSE@@ENABLE_CUBEREVO_MINI2_FALSE@@ENABLE_CUBEREVO_MINI_FALSE@@ENABLE_CUBEREVO_MINI_FTA_FALSE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/*.ko $(prefix)/release/lib/modules/

	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko $(prefix)/release/lib/modules || true
	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti_np/pti.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti_np/pti.ko $(prefix)/release/lib/modules || true
@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/compcache/lzo-kmod/lzo1x_compress.ko $(prefix)/release/lib/modules/
@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/compcache/lzo-kmod/lzo1x_decompress.ko $(prefix)/release/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/compcache/ramzswap.ko $(prefix)/release/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/bpamem/bpamem.ko $(prefix)/release/lib/modules/
	find $(prefix)/release/lib/modules/ -name '*.ko' -exec sh4-linux-strip --strip-unneeded {} \;

	rm -rf $(prefix)/release/lib/autofs
	rm -rf $(prefix)/release/lib/modules/$(KERNELVERSION)

	$(INSTALL_DIR) $(prefix)/release/media
	ln -s /media/hdd $(prefix)/release/hdd
	$(INSTALL_DIR) $(prefix)/release/media/dvd

	$(INSTALL_DIR) $(prefix)/release/mnt
	$(INSTALL_DIR) $(prefix)/release/mnt/usb
	$(INSTALL_DIR) $(prefix)/release/mnt/hdd
	$(INSTALL_DIR) $(prefix)/release/mnt/nfs

	$(INSTALL_DIR) $(prefix)/release/root

	$(INSTALL_DIR) $(prefix)/release/proc
	$(INSTALL_DIR) $(prefix)/release/sys
	$(INSTALL_DIR) $(prefix)/release/tmp

	$(INSTALL_DIR) $(prefix)/release/usr
	$(INSTALL_DIR) $(prefix)/release/usr/bin
	cp -p $(targetprefix)/usr/sbin/vsftpd $(prefix)/release/usr/bin/
	cp -p $(targetprefix)/usr/bin/python $(prefix)/release/usr/bin/

	cp -p $(targetprefix)/usr/bin/killall $(prefix)/release/usr/bin/
	cp -p $(targetprefix)/usr/bin/opkg-cl $(prefix)/release/usr/bin/opkg
	cp -p $(targetprefix)/usr/bin/ffmpeg $(prefix)/release/sbin/
	cp -p $(targetprefix)/usr/bin/tuxtxt $(prefix)/release/usr/bin/
	cp -p $(targetprefix)/usr/sbin/ethtool $(prefix)/release/usr/sbin/

	$(INSTALL_DIR) $(prefix)/release/usr/tuxtxt
	cp -p $(targetprefix)/usr/tuxtxt/tuxtxt2.conf $(prefix)/release/usr/tuxtxt/

	$(INSTALL_DIR) $(prefix)/release/usr/share

	ln -s /usr/local/share/enigma2 $(prefix)/release/usr/share/enigma2

	$(INSTALL_DIR) $(prefix)/release/usr/share/fonts
	cp $(targetprefix)/usr/share/fonts/ae_AlMateen.ttf $(prefix)/release/usr/share/fonts/
	cp $(targetprefix)/usr/share/fonts/lcd.ttf $(prefix)/release/usr/share/fonts/
	cp $(targetprefix)/usr/share/fonts/md_khmurabi_10.ttf $(prefix)/release/usr/share/fonts/
	cp $(targetprefix)/usr/share/fonts/nmsbd.ttf $(prefix)/release/usr/share/fonts/
	cp $(targetprefix)/usr/share/fonts/tuxtxt.ttf $(prefix)/release/usr/share/fonts/
	cp $(targetprefix)/usr/share/fonts/goodtime.ttf $(prefix)/release/usr/share/fonts/
	cp $(targetprefix)/usr/share/fonts/valis_enigma.ttf $(prefix)/release/usr/share/fonts/
	cp $(targetprefix)/usr/share/fonts/valis_lcd.ttf $(prefix)/release/usr/share/fonts/
	cp $(targetprefix)/usr/share/fonts/seg.ttf $(prefix)/release/usr/share/fonts/
	cp $(targetprefix)/usr/share/fonts/seg_internat.ttf $(prefix)/release/usr/share/fonts/
	cp $(targetprefix)/usr/share/fonts/Symbols.ttf $(prefix)/release/usr/share/fonts/

#       Font libass
	cp $(buildprefix)/root/usr/share/fonts/FreeSans.ttf $(prefix)/release/usr/share/fonts/

	$(INSTALL_DIR) $(prefix)/release/usr/share/zoneinfo
	cp -aR $(buildprefix)/root/usr/share/zoneinfo/* $(prefix)/release/usr/share/zoneinfo/

	$(INSTALL_DIR) $(prefix)/release/usr/share/udhcpc
	cp -aR $(buildprefix)/root/usr/share/udhcpc/* $(prefix)/release/usr/share/udhcpc/

	if [ -e $(targetprefix)/usr/share/alsa ]; then \
		mkdir $(prefix)/release/usr/share/alsa/; \
		mkdir $(prefix)/release/usr/share/alsa/cards/; \
		mkdir $(prefix)/release/usr/share/alsa/pcm/; \
		cp $(targetprefix)/usr/share/alsa/alsa.conf $(prefix)/release/usr/share/alsa/alsa.conf; \
		cp $(targetprefix)/usr/share/alsa/cards/aliases.conf $(prefix)/release/usr/share/alsa/cards/; \
		cp $(targetprefix)/usr/share/alsa/pcm/default.conf $(prefix)/release/usr/share/alsa/pcm/; \
		cp $(targetprefix)/usr/share/alsa/pcm/dmix.conf $(prefix)/release/usr/share/alsa/pcm/; fi

	ln -s /usr/local/share/keymaps $(prefix)/release/usr/share/keymaps

	$(INSTALL_DIR) $(prefix)/release/usr/local
	$(INSTALL_DIR) $(prefix)/release/usr/local/bin
	if [ -e $(targetprefix)/usr/bin/enigma2 ]; then \
		cp -f $(targetprefix)/usr/bin/enigma2 $(prefix)/release/usr/local/bin/enigma2;fi
	if [ -e $(targetprefix)/usr/local/bin/enigma2 ]; then \
		cp -f $(targetprefix)/usr/local/bin/enigma2 $(prefix)/release/usr/local/bin/enigma2;fi
	find $(prefix)/release/usr/local/bin/ -name  enigma2 -exec sh4-linux-strip --strip-unneeded {} \;

	ln -s /etc $(prefix)/release/usr/local/etc

	$(INSTALL_DIR) $(prefix)/release/usr/local/share
	$(INSTALL_DIR) $(prefix)/release/usr/local/share/keymaps
	$(INSTALL_DIR) $(prefix)/release/usr/local/share/enigma2
	cp -a $(targetprefix)/usr/local/share/enigma2/* $(prefix)/release/usr/local/share/enigma2
	cp -a $(targetprefix)/etc/enigma2/* $(prefix)/release/etc/enigma2

	ln -s /usr/share/fonts $(prefix)/release/usr/local/share/fonts

	$(INSTALL_DIR) $(prefix)/release/usr/lib
	cp -R $(targetprefix)/usr/lib/* $(prefix)/release/usr/lib/
	rm -rf $(prefix)/release/usr/lib/engines
	rm -rf $(prefix)/release/usr/lib/enigma2
	rm -rf $(prefix)/release/usr/lib/gconv
	rm -rf $(prefix)/release/usr/lib/libxslt-plugins
	rm -rf $(prefix)/release/usr/lib/pkgconfig
	rm -rf $(prefix)/release/usr/lib/python2.6
	rm -rf $(prefix)/release/usr/lib/sigc++-1.2
	rm -rf $(prefix)/release/usr/lib/X11
	rm -f $(prefix)/release/usr/lib/*.a
	rm -f $(prefix)/release/usr/lib/*.o
	rm -f $(prefix)/release/usr/lib/*.la
	chmod 755 -R $(prefix)/release/usr/lib/
	find $(prefix)/release/usr/lib/ -name '*.so*' -exec sh4-linux-strip --strip-unneeded {} \;

	$(INSTALL_DIR) $(prefix)/release/usr/lib/enigma2
	cp -a $(targetprefix)/usr/lib/enigma2/* $(prefix)/release/usr/lib/enigma2/
	if test -d $(targetprefix)/usr/local/lib/enigma2; then \
		cp -a $(targetprefix)/usr/local/lib/enigma2/* $(prefix)/release/usr/lib/enigma2/; fi

	cp -RP $(targetprefix)/usr/lib/enigma2/python/Plugins/SystemPlugins/Tuxtxt $(prefix)/release/usr/lib/enigma2/python/Plugins/SystemPlugins/

#	Dont remove pyo files, remove pyc instead
	find $(prefix)/release/usr/lib/enigma2/ -name '*.pyc' -exec rm -f {} \;
	find $(prefix)/release/usr/lib/enigma2/ -name '*.pyo' -exec rm -f {} \;
	find $(prefix)/release/usr/lib/enigma2/ -name '*.a' -exec rm -f {} \;
	find $(prefix)/release/usr/lib/enigma2/ -name '*.o' -exec rm -f {} \;
	find $(prefix)/release/usr/lib/enigma2/ -name '*.la' -exec rm -f {} \;
	find $(prefix)/release/usr/lib/enigma2/ -name '*.so*' -exec sh4-linux-strip --strip-unneeded {} \;

#	Delete unnecessary plugins
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/DemoPlugins
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/SystemPlugins/FrontprocessorUpgrade
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/SystemPlugins/NFIFlash
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/Extensions/FileManager
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/Extensions/DVDBurn
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/Extensions/DVDPlayer
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/Extensions/CutListEditor
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/Extensions/MediaScanner
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/Extensions/TuxboxPlugins
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/SystemPlugins/CrashlogAutoSubmit
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/SystemPlugins/TempFanControl
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/SystemPlugins/DefaultServicesScanner
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/SystemPlugins/DiseqcTester
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/SystemPlugins/CommonInterfaceAssignment

	$(INSTALL_DIR) $(prefix)/release/usr/lib/python2.6
	cp -a $(targetprefix)/usr/lib/python2.6/* $(prefix)/release/usr/lib/python2.6/
	rm -rf $(prefix)/release/usr/lib/python2.6/test
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/lxml
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/lxml-2.0.5-py2.6.egg-info
	rm -f $(prefix)/release/usr/lib/python2.6/site-packages/libxml2mod.so
	rm -f $(prefix)/release/usr/lib/python2.6/site-packages/libxsltmod.so
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/OpenSSL/test
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/setuptools
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/setuptools-0.6c8-py2.6.egg-info
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/zope.interface-3.3.0-py2.6.egg-info
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/test
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/conch
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/mail
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/manhole
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/names
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/news
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/trial
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/words
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/application
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/enterprise
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/flow
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/lore
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/pair
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/runner
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/scripts
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/tap
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/twisted/topfiles
	rm -rf $(prefix)/release/usr/lib/python2.6/site-packages/Twisted-8.2.0-py2.6.egg-info
	rm -rf $(prefix)/release/usr/lib/python2.6/bsddb
	rm -rf $(prefix)/release/usr/lib/python2.6/compiler
	rm -rf $(prefix)/release/usr/lib/python2.6/config
	rm -rf $(prefix)/release/usr/lib/python2.6/ctypes
	rm -rf $(prefix)/release/usr/lib/python2.6/curses
	rm -rf $(prefix)/release/usr/lib/python2.6/distutils
	rm -rf $(prefix)/release/usr/lib/python2.6/email

#	Dont remove pyo files, remove pyc instead
	find $(prefix)/release/usr/lib/python2.6/ -name '*.pyc' -exec rm -f {} \;
	find $(prefix)/release/usr/lib/python2.6/ -name '*.pyo' -exec rm -f {} \;
	find $(prefix)/release/usr/lib/python2.6/ -name '*.a' -exec rm -f {} \;
	find $(prefix)/release/usr/lib/python2.6/ -name '*.o' -exec rm -f {} \;
	find $(prefix)/release/usr/lib/python2.6/ -name '*.la' -exec rm -f {} \;
	find $(prefix)/release/usr/lib/python2.6/ -name '*.so*' -exec sh4-linux-strip --strip-unneeded {} \;

	cp -RP $(buildprefix)/root/usr/lib/enigma2/python $(prefix)/release/usr/lib/enigma2/
	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/Extensions/FlashBackup
#### displaytime plugin not longer needed so we remove it #####
#	rm -rf $(prefix)/release/usr/lib/enigma2/python/Plugins/Extensions/PPDisplayTime
	cp -RP $(buildprefix)/root/etc/enigma2/* $(prefix)/release/etc/enigma2/
	cp -RP $(buildprefix)/root/etc/tuxbox/satellites.xml $(prefix)/release/etc/tuxbox/
	touch $(prefix)/release/etc/.start_enigma2
#	cp -RP $(buildprefix)/root/usr/lib/enigma2/python/Components/Converter $(prefix)/release/usr/lib/enigma2/python/Components/
	rm $(prefix)/release/usr/local/share/enigma2/keymap_*.xml
	touch $(prefix)/release/etc/changelog.txt
######## FOR YOUR OWN CHANGES use these folder in cdk/own_build/enigma2 #############
	rm $(prefix)/release/bin/showiframe
	rm $(prefix)/release/usr/local/share/enigma2/radio.mvi
	rm $(prefix)/release/bin/stslave

	cp -RP $(buildprefix)/own_build/enigma2/* $(prefix)/release/

@STM22_TRUE@	cp $(kernelprefix)/linux/arch/sh/boot/uImage $(prefix)/release/boot/
@STM22_TRUE@	cp $(kernelprefix)/linux/drivers/usb/serial/ftdi_sio.ko $(prefix)/release/lib/modules/ftdi.ko
@STM22_TRUE@	cp $(kernelprefix)/linux/drivers/usb/serial/pl2303.ko $(prefix)/release/lib/modules
@STM22_TRUE@	cp $(kernelprefix)/linux/drivers/usb/serial/usbserial.ko $(prefix)/release/lib/modules
@STM22_TRUE@	cp $(kernelprefix)/linux/fs/autofs4/autofs4.ko $(prefix)/release/lib/modules
@STM22_FALSE@	cp $(kernelprefix)/linux-sh4/arch/sh/boot/uImage $(prefix)/release/boot/
@ENABLE_UFS912_TRUE@@STM22_FALSE@	cp $(kernelprefix)/linux-sh4/drivers/usb/serial/ftdi_sio.ko $(prefix)/release/lib/modules/ftdi.ko
@ENABLE_UFS912_TRUE@@STM22_FALSE@	cp $(kernelprefix)/linux-sh4/drivers/usb/serial/pl2303.ko $(prefix)/release/lib/modules
@ENABLE_UFS912_TRUE@@STM22_FALSE@	cp $(kernelprefix)/linux-sh4/drivers/usb/serial/usbserial.ko $(prefix)/release/lib/modules
@ENABLE_HS7810A_TRUE@@ENABLE_UFS912_FALSE@@STM22_FALSE@	cp $(kernelprefix)/linux-sh4/drivers/usb/serial/ftdi_sio.ko $(prefix)/release/lib/modules/ftdi.ko
@ENABLE_HS7810A_TRUE@@ENABLE_UFS912_FALSE@@STM22_FALSE@	cp $(kernelprefix)/linux-sh4/drivers/usb/serial/pl2303.ko $(prefix)/release/lib/modules
@ENABLE_HS7810A_TRUE@@ENABLE_UFS912_FALSE@@STM22_FALSE@	cp $(kernelprefix)/linux-sh4/drivers/usb/serial/usbserial.ko $(prefix)/release/lib/modules
@ENABLE_UFS912_FALSE@@ENABLE_UFS922_TRUE@@STM22_FALSE@	cp $(kernelprefix)/linux-sh4/fs/autofs4/autofs4.ko $(prefix)/release/lib/modules

@STM24_TRUE@	[ -e $(kernelprefix)/linux-sh4/fs/autofs4/autofs4.ko ] && cp $(kernelprefix)/linux-sh4/fs/autofs4/autofs4.ko $(prefix)/release/lib/modules || true
@STM24_TRUE@	[ -e $(kernelprefix)/linux-sh4/drivers/usb/serial/ftdi_sio.ko ] && cp $(kernelprefix)/linux-sh4/drivers/usb/serial/ftdi_sio.ko $(prefix)/release/lib/modules/ftdi.ko || true
@STM24_TRUE@	[ -e $(kernelprefix)/linux-sh4/drivers/usb/serial/pl2303.ko ] && cp $(kernelprefix)/linux-sh4/drivers/usb/serial/pl2303.ko $(prefix)/release/lib/modules || true
@STM24_TRUE@	[ -e $(kernelprefix)/linux-sh4/drivers/usb/serial/usbserial.ko ] && cp $(kernelprefix)/linux-sh4/drivers/usb/serial/usbserial.ko $(prefix)/release/lib/modules || true
@STM24_TRUE@	[ -e $(kernelprefix)/linux-sh4/fs/ntfs/ntfs.ko ] && cp $(kernelprefix)/linux-sh4/fs/ntfs/ntfs.ko $(prefix)/release/lib/modules || true
@STM24_TRUE@	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko $(prefix)/release/lib/modules || true

#GSTREAMER STUFF
	if [ -d $(prefix)/release/usr/lib/gstreamer-0.10 ]; then \
		rm -rf $(prefix)/release/usr/lib/libgstfft*; \
		rm -rf $(prefix)/release/usr/lib/gstreamer-0.10/*; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstalsa.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstapp.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstasf.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstassrender.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstaudioconvert.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstaudioparsersbad.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstaudioresample.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstautodetect.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstavi.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstcdxaparse.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstcoreelements.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstcoreindexers.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstdecodebin.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstdecodebin2.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstdvbaudiosink.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstdvbvideosink.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstdvdsub.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstflac.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstflv.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstfragmented.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgsticydemux.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstid3demux.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstmad.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstmatroska.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstmpegaudioparse.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstmpegdemux.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstmpegstream.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstogg.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstplaybin.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstrtp.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstrtpmanager.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstsouphttpsrc.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstsubparse.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgsttypefindfunctions.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstudp.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstvcdsrc.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstwavparse.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		if [ -e $(prefix)/release/usr/lib/gstreamer-0.10/libgstffmpeg.so ]; then \
			cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstffmpeg.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
			cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstffmpegscale.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
			cp -a $(targetprefix)/usr/lib/gstreamer-0.10/libgstpostproc.so $(prefix)/release/usr/lib/gstreamer-0.10/; \
		fi; \
		sh4-linux-strip --strip-unneeded $(prefix)/release/usr/lib/gstreamer-0.10/*; \
	fi

#DFB Stuff
	if [ -d $(prefix)/release/usr/lib/directfb-1.4-5 ]; then \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/gfxdrivers/*.a; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/gfxdrivers/*.la; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/gfxdrivers/*.o; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/inputdrivers/*; \
		cp -a $(targetprefix)/usr/lib/directfb-1.4-5/inputdrivers/libdirectfb_ps2mouse.so $(prefix)/release/usr/lib/directfb-1.4-5/inputdrivers/; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/systems/*.a; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/systems/*.la; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/systems/*.o; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/systems/libdirectfb_dummy.so; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/systems/libdirectfb_fbdev.so; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/wm/*.a; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/wm/*.la; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/wm/*.o; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/interfaces/IDirectFBFont/*.a; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/interfaces/IDirectFBFont/*.la; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/interfaces/IDirectFBFont/*.o; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/interfaces/IDirectFBImageProvider/*.a; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/interfaces/IDirectFBImageProvider/*.la; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/interfaces/IDirectFBImageProvider/*.o; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/interfaces/IDirectFBVideoProvider/*.a; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/interfaces/IDirectFBVideoProvider/*.la; \
		rm -rf $(prefix)/release/usr/lib/directfb-1.4-5/interfaces/IDirectFBVideoProvider/*.o; \
	fi
	if [ -d $(prefix)/release/usr/lib/icu ]; then \
		rm -rf $(prefix)/release/usr/lib/icu; \
	fi
	if [ -d $(prefix)/release/usr/lib/glib-2.0 ]; then \
		rm -rf $(prefix)/release/usr/lib/glib-2.0; \
	fi
	if [ -d $(prefix)/release/usr/lib/gio ]; then \
		rm -rf $(prefix)/release/usr/lib/gio; \
	fi
	if [ -d $(prefix)/release/usr/lib/enchant ]; then \
		rm -rf $(prefix)/release/usr/lib/enchant; \
	fi
#Trick ALPHA-Version ;)
$(DEPDIR)/min-release_neutrino $(DEPDIR)/std-release_neutrino $(DEPDIR)/max-release_neutrino $(DEPDIR)/ipk-release_neutrino $(DEPDIR)/release_neutrino: \
$(DEPDIR)/%release_neutrino:
	rm -rf $(prefix)/release_neutrino || true
	$(INSTALL_DIR) $(prefix)/release_neutrino && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/bin && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/sbin && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/boot && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/dev && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/dev.static && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/etc && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/etc/fonts && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/etc/init.d && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/etc/network && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/etc/network/if-down.d && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/etc/network/if-post-down.d && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/etc/network/if-pre-up.d && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/etc/network/if-up.d && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/etc/tuxbox && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/media/hdd && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/media/hdd/movie && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/media/hdd/music && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/media/hdd/picture && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/lib && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/lib/modules && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/ram && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/var && \
	$(INSTALL_DIR) $(prefix)/release_neutrino/var/etc && \
	export CROSS_COMPILE=$(target)- && \
		$(MAKE) install -C @DIR_busybox@ CONFIG_PREFIX=$(prefix)/release_neutrino && \
	cp -a $(targetprefix)/bin/* $(prefix)/release_neutrino/bin/ && \
	rm $(prefix)/release_neutrino/bin/showiframe && \
	rm $(prefix)/release_neutrino/bin/stslave && \
	cp -dp $(targetprefix)/bin/hotplug $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/init $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/killall5 $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/portmap $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/mke2fs $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/mkfs.ext2 $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/mkfs.ext3 $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/fsck $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/fsck.ext2 $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/fsck.ext3 $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/fsck.nfs $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/sfdisk $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/sbin/tune2fs $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/usr/bin/rdate $(prefix)/release_neutrino/sbin/ && \
	cp -dp $(targetprefix)/etc/init.d/portmap $(prefix)/release_neutrino/etc/init.d/ && \
	cp -dp $(buildprefix)/root/etc/init.d/udhcpc $(prefix)/release_neutrino/etc/init.d/ && \
	cp -dp $(targetprefix)/usr/bin/ffmpeg $(prefix)/release_neutrino/sbin/ && \
	\
	cp $(targetprefix)/boot/video_7100.elf $(prefix)/release_neutrino/boot/video.elf && \
	cp $(targetprefix)/boot/video_7111.elf $(prefix)/release_neutrino/boot/video.elf && \
	\
	cp $(targetprefix)/boot/audio.elf $(prefix)/release_neutrino/boot/audio.elf && \
	cp $(targetprefix)/boot/audio_7111.elf $(prefix)/release_neutrino/boot/audio.elf && \
	\
	cp -a $(targetprefix)/dev/* $(prefix)/release_neutrino/dev/ && \
	cp -f $(buildprefix)/root/release/fstab_spark $(prefix)/release_neutrino/etc/fstab && \
	cp -dp $(targetprefix)/etc/group $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/host.conf $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/hostname $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/hosts $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/inittab $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/localtime $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/mtab $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/passwd $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/profile $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/protocols $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/resolv.conf $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/services $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/shells $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/shells.conf $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/timezone.xml $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/vsftpd.conf $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/vdstandby.cfg $(prefix)/release_neutrino/etc/ && \
	cp -dp $(targetprefix)/etc/network/interfaces $(prefix)/release_neutrino/etc/network/ && \
	cp -dp $(targetprefix)/etc/network/options $(prefix)/release_neutrino/etc/network/ && \
	cp -dp $(targetprefix)/etc/init.d/umountfs $(prefix)/release_neutrino/etc/init.d/ && \
	cp -dp $(targetprefix)/etc/init.d/sendsigs $(prefix)/release_neutrino/etc/init.d/ && \
	cp -dp $(targetprefix)/etc/init.d/halt $(prefix)/release_neutrino/etc/init.d/ && \
	mkdir -p $(prefix)/release_neutrino/usr/local/share/config/tuxtxt/ && \
	cp $(buildprefix)/root/release/reboot $(prefix)/release_neutrino/etc/init.d/ && \
	echo "576i50" > $(prefix)/release_neutrino/etc/videomode && \
	cp $(buildprefix)/root/release/rcS_stm23_24_neutrino_spark $(prefix)/release_neutrino/etc/init.d/rcS && \
	chmod 755 $(prefix)/release_neutrino/etc/init.d/rcS && \
	cp $(buildprefix)/root/release/mountvirtfs $(prefix)/release_neutrino/etc/init.d/ && \
	cp $(buildprefix)/root/release/mme_check $(prefix)/release_neutrino/etc/init.d/ && \
	cp $(buildprefix)/root/release/mountall $(prefix)/release_neutrino/etc/init.d/ && \
	cp $(buildprefix)/root/release/hostname $(prefix)/release_neutrino/etc/init.d/ && \
	cp $(buildprefix)/root/release/vsftpd $(prefix)/release_neutrino/etc/init.d/ && \
	cp $(buildprefix)/root/release/bootclean.sh $(prefix)/release_neutrino/etc/init.d/ && \
	cp $(buildprefix)/root/release/networking $(prefix)/release_neutrino/etc/init.d/ && \
	cp $(buildprefix)/root/release/getfb.awk $(prefix)/release_neutrino/etc/init.d/ && \
	cp -rd $(targetprefix)/lib/* $(prefix)/release_neutrino/lib/ && \
	rm -f $(prefix)/release_neutrino/lib/*.a && \
	rm -f $(prefix)/release_neutrino/lib/*.o && \
	rm -f $(prefix)/release_neutrino/lib/*.la && \
	find $(prefix)/release_neutrino/lib/ -name '*.so*' -exec sh4-linux-strip --strip-unneeded {} \;
	cp $(kernelprefix)/$(kernelpath)/fs/autofs4/autofs4.ko $(prefix)/release_neutrino/lib/modules

@STM24_TRUE@	cp -dp $(targetprefix)/sbin/mkfs $(prefix)/release_neutrino/sbin/

	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/avs/avs.ko $(prefix)/release_neutrino/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/boxtype/boxtype.ko $(prefix)/release_neutrino/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/simu_button/simu_button.ko $(prefix)/release_neutrino/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/e2_proc/e2_proc.ko $(prefix)/release_neutrino/lib/modules/

@ENABLE_SPARK_TRUE@	echo "pingulux" > $(prefix)/release_neutrino/etc/hostname

@ENABLE_SPARK_TRUE@	cp $(buildprefix)/root/release/umountfs $(prefix)/release_neutrino/etc/init.d/
@ENABLE_SPARK_TRUE@	cp $(buildprefix)/root/release/rc $(prefix)/release_neutrino/etc/init.d/
@ENABLE_SPARK_TRUE@	cp $(buildprefix)/root/release/sendsigs $(prefix)/release_neutrino/etc/init.d/
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/release_neutrino/sbin/halt
@ENABLE_SPARK_TRUE@	cp -f $(targetprefix)/sbin/halt $(prefix)/release_neutrino/sbin/
@ENABLE_SPARK_TRUE@	cp $(buildprefix)/root/release/halt_spark_enigma2 $(prefix)/release_neutrino/etc/init.d/halt
@ENABLE_SPARK_TRUE@	chmod 755 $(prefix)/release_neutrino/etc/init.d/umountfs
@ENABLE_SPARK_TRUE@	chmod 755 $(prefix)/release_neutrino/etc/init.d/rc
@ENABLE_SPARK_TRUE@	chmod 755 $(prefix)/release_neutrino/etc/init.d/sendsigs
@ENABLE_SPARK_TRUE@	chmod 755 $(prefix)/release_neutrino/etc/init.d/halt
@ENABLE_SPARK_TRUE@	mkdir -p $(prefix)/release_neutrino/etc/rc.d/rc0.d
@ENABLE_SPARK_TRUE@	ln -s ../init.d $(prefix)/release_neutrino/etc/rc.d
@ENABLE_SPARK_TRUE@	ln -fs halt $(prefix)/release_neutrino/sbin/reboot
@ENABLE_SPARK_TRUE@	ln -fs halt $(prefix)/release_neutrino/sbin/poweroff
@ENABLE_SPARK_TRUE@	ln -s ../init.d/sendsigs $(prefix)/release_neutrino/etc/rc.d/rc0.d/S20sendsigs
@ENABLE_SPARK_TRUE@	ln -s ../init.d/umountfs $(prefix)/release_neutrino/etc/rc.d/rc0.d/S40umountfs
@ENABLE_SPARK_TRUE@	ln -s ../init.d/halt $(prefix)/release_neutrino/etc/rc.d/rc0.d/S90halt
@ENABLE_SPARK_TRUE@	mkdir -p $(prefix)/release_neutrino/etc/rc.d/rc6.d
@ENABLE_SPARK_TRUE@	ln -s ../init.d/sendsigs $(prefix)/release_neutrino/etc/rc.d/rc6.d/S20sendsigs
@ENABLE_SPARK_TRUE@	ln -s ../init.d/umountfs $(prefix)/release_neutrino/etc/rc.d/rc6.d/S40umountfs
@ENABLE_SPARK_TRUE@	ln -s ../init.d/reboot $(prefix)/release_neutrino/etc/rc.d/rc6.d/S90reboot
@ENABLE_SPARK_TRUE@	ln -fs init $(prefix)/release_neutrino/sbin/telinit

@ENABLE_SPARK_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontcontroller/aotom/aotom.ko $(prefix)/release_neutrino/lib/modules/
@ENABLE_SPARK_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmcore-display-sti7111.ko $(prefix)/release_neutrino/lib/modules/

@ENABLE_SPARK_TRUE@	rm -f $(prefix)/release_neutrino/lib/firmware/dvb-fe-avl2108.fw
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/release_neutrino/lib/firmware/dvb-fe-stv6306.fw
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/release_neutrino/lib/firmware/dvb-fe-cx24116.fw
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/release_neutrino/lib/firmware/dvb-fe-cx21143.fw
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/release_neutrino/lib/firmware/component_7105_pdk7105.fw
@ENABLE_SPARK_TRUE@	mv $(prefix)/release_neutrino/lib/firmware/component_7111_mb618.fw $(prefix)/release_neutrino/lib/firmware/component.fw
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/release_neutrino/bin/evremote
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/release_neutrino/bin/gotosleep
@ENABLE_SPARK_TRUE@	cp -f $(buildprefix)/root/usr/bin/mkfs.jffs2 $(prefix)/release_neutrino/usr/bin/
@ENABLE_SPARK_TRUE@	cp -f $(buildprefix)/root/sbin/mkyaffs2 $(prefix)/release_neutrino/sbin/
@ENABLE_SPARK_TRUE@	mkdir -p $(prefix)/release_neutrino/usr/lib
@ENABLE_SPARK_TRUE@	cp -RP $(buildprefix)/root/usr/lib/liblzo2.so.2* $(prefix)/release_neutrino/usr/lib/
@ENABLE_SPARK_TRUE@	cp -RP $(buildprefix)/root/lib/libproc* $(prefix)/release_neutrino/lib/
@ENABLE_SPARK_TRUE@	cp -RP $(buildprefix)/root/sbin/ntpdate $(prefix)/release_neutrino/sbin/
@ENABLE_SPARK_TRUE@	rm $(prefix)/release_neutrino/bin/ps
@ENABLE_SPARK_TRUE@	mkdir -p $(prefix)/release_neutrino/usr/lib/opkg/info
@ENABLE_SPARK_TRUE@	touch $(prefix)/release_neutrino/usr/lib/opkg/info/opkg.list
@ENABLE_SPARK_TRUE@	cp -RP $(buildprefix)/root/bin/ps $(prefix)/release_neutrino/bin/
@ENABLE_SPARK_TRUE@	cp -RP $(buildprefix)/root/bin/dropbear $(prefix)/release_neutrino/bin/
@ENABLE_SPARK_TRUE@	cp -RP $(buildprefix)/root/bin/dropbearkey $(prefix)/release_neutrino/bin/
@ENABLE_SPARK_TRUE@	cp -RP $(buildprefix)/root/etc/init.d/dropbear $(prefix)/release_neutrino/etc/init.d/
@ENABLE_SPARK_TRUE@	cp -RP $(buildprefix)/root/etc/init.d/DisplayTime.sh $(prefix)/release_neutrino/etc/init.d/
@ENABLE_SPARK_TRUE@	touch $(prefix)/release_neutrino/etc/.time
@ENABLE_SPARK_TRUE@	mkdir -p $(prefix)/release_neutrino/etc/dropbear
@ENABLE_SPARK_TRUE@	cp -f $(buildprefix)/root/usr/bin/backup_pingulux_image.sh $(prefix)/release_neutrino/usr/bin/
@ENABLE_SPARK_TRUE@	cp -f $(buildprefix)/root/usr/sbin/iw* $(prefix)/release_neutrino/usr/sbin/
@ENABLE_SPARK_TRUE@	cp -f $(buildprefix)/root/usr/sbin/wpa* $(prefix)/release_neutrino/usr/sbin/
@ENABLE_SPARK_TRUE@	cp -RP $(buildprefix)/root/etc/Wireless $(prefix)/release_neutrino/etc/
@ENABLE_SPARK_TRUE@	cp -f $(buildprefix)/root/usr/lib/libiw.so.29 $(prefix)/release_neutrino/usr/lib/
@ENABLE_SPARK_TRUE@	cp -f $(buildprefix)/root/usr/lib/libgnu* $(prefix)/release_neutrino/usr/lib/
@ENABLE_SPARK_TRUE@	cp -f $(buildprefix)/root/usr/lib/libgcrypt* $(prefix)/release_neutrino/usr/lib/
@ENABLE_SPARK_TRUE@	cp -f $(buildprefix)/root/usr/lib/libgpg* $(prefix)/release_neutrino/usr/lib/
@ENABLE_SPARK_TRUE@	cp -dp $(buildprefix)/root/etc/lircd_spark.conf $(prefix)/release_neutrino/etc/lircd.conf
@ENABLE_SPARK_TRUE@	cp -dp $(targetprefix)/usr/bin/lircd $(prefix)/release_neutrino/usr/bin/
@ENABLE_SPARK_TRUE@	cp -RP $(buildprefix)/root/etc/init.d/setupETH.sh $(prefix)/release_neutrino/etc/init.d/

@ENABLE_SPARK_TRUE@@STM23_TRUE@	cp -f $(buildprefix)/root/lib/modules/rt2870sta_stm23.ko $(prefix)/release_neutrino/lib/modules/rt2870sta.ko
@ENABLE_SPARK_TRUE@@STM23_TRUE@	cp -f $(buildprefix)/root/lib/modules/rt3070sta_stm23.ko $(prefix)/release_neutrino/lib/modules/rt3070sta.ko
@ENABLE_SPARK_TRUE@@STM23_TRUE@	cp -f $(buildprefix)/root/lib/modules/smartcard_stm23.ko $(prefix)/release_neutrino/lib/modules/smartcard.ko
#	cp -f $(buildprefix)/root/release/vfd_spark$(KERNELSTMLABEL)_noptk.ko $(prefix)/release_neutrino/lib/modules/vfd.ko
@ENABLE_SPARK_TRUE@@STM23_TRUE@	cp -f $(buildprefix)/root/release/encrypt_spark$(KERNELSTMLABEL)_noptk.ko $(prefix)/release_neutrino/lib/modules/encrypt.ko
@ENABLE_P0207_TRUE@@ENABLE_SPARK_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/smartcard/smartcard.ko $(prefix)/release_neutrino/lib/modules/
@ENABLE_P0207_TRUE@@ENABLE_SPARK_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/wireless/rt2870sta/rt2870sta.ko $(prefix)/release_neutrino/lib/modules/
@ENABLE_P0207_TRUE@@ENABLE_SPARK_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/wireless/rt3070sta/rt3070sta.ko $(prefix)/release_neutrino/lib/modules/
#	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontcontroller/vfd.fulan/vfd.ko $(prefix)/release_neutrino/lib/modules/
@ENABLE_P0207_TRUE@@ENABLE_SPARK_TRUE@@STM24_TRUE@	cp -f $(buildprefix)/root/release/encrypt_spark$(KERNELSTMLABEL).ko $(prefix)/release_neutrino/lib/modules/encrypt.ko
@ENABLE_P0209_TRUE@@ENABLE_SPARK_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/smartcard/smartcard.ko $(prefix)/release_neutrino/lib/modules/
@ENABLE_P0209_TRUE@@ENABLE_SPARK_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/wireless/rt2870sta/rt2870sta.ko $(prefix)/release_neutrino/lib/modules/
@ENABLE_P0209_TRUE@@ENABLE_SPARK_TRUE@@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/wireless/rt3070sta/rt3070sta.ko $(prefix)/release_neutrino/lib/modules/
#	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontcontroller/vfd.fulan/vfd.ko $(prefix)/release_neutrino/lib/modules/
#	cp -f $(buildprefix)/root/release/encrypt_spark$(KERNELSTMLABEL).ko $(prefix)/release_neutrino/lib/modules/encrypt.ko
@ENABLE_SPARK_TRUE@	cp -f $(buildprefix)/root/sbin/flash* $(prefix)/release_neutrino/sbin
@ENABLE_SPARK_TRUE@	cp -f $(buildprefix)/root/sbin/nand* $(prefix)/release_neutrino/sbin
@ENABLE_SPARK_TRUE@	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko $(prefix)/release_neutrino/lib/modules || true

	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmfb.ko $(prefix)/release_neutrino/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxshell/embxshell.ko $(prefix)/release_neutrino/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxmailbox/embxmailbox.ko $(prefix)/release_neutrino/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxshm/embxshm.ko $(prefix)/release_neutrino/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/mme/mme_host.ko $(prefix)/release_neutrino/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/bpamem/bpamem.ko $(prefix)/release_neutrino/lib/modules/

	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/*.ko $(prefix)/release_neutrino/lib/modules/

@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/compcache/lzo-kmod/lzo1x_compress.ko $(prefix)/release_neutrino/lib/modules/
@STM24_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/compcache/lzo-kmod/lzo1x_decompress.ko $(prefix)/release_neutrino/lib/modules/

	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/compcache/ramzswap.ko $(prefix)/release_neutrino/lib/modules/

@ENABLE_PLAYER131_TRUE@	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko $(prefix)/release_neutrino/lib/modules/ || true
@ENABLE_PLAYER131_TRUE@	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti_np/pti.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti_np/pti.ko $(prefix)/release_neutrino/lib/modules/ || true

@ENABLE_PLAYER131_TRUE@	find $(prefix)/release_neutrino/lib/modules/ -name '*.ko' -exec sh4-linux-strip --strip-unneeded {} \;
@ENABLE_PLAYER131_TRUE@	cd $(targetprefix)/lib/modules/$(KERNELVERSION)/extra && \
@ENABLE_PLAYER131_TRUE@	for mod in \
@ENABLE_PLAYER131_TRUE@		sound/pseudocard/pseudocard.ko \
@ENABLE_PLAYER131_TRUE@		sound/silencegen/silencegen.ko \
@ENABLE_PLAYER131_TRUE@		stm/mmelog/mmelog.ko \
@ENABLE_PLAYER131_TRUE@		stm/monitor/stm_monitor.ko \
@ENABLE_PLAYER131_TRUE@		media/video/stm/stm_v4l2.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/dvb/stmdvb.ko \
@ENABLE_PLAYER131_TRUE@		sound/ksound/ksound.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/mpeg2_hard_host_transformer/mpeg2hw.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/backend/player2.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/h264_preprocessor/sth264pp.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/allocator/stmalloc.ko \
@ENABLE_PLAYER131_TRUE@		stm/platform/platform.ko \
@ENABLE_PLAYER131_TRUE@		stm/platform/p2div64.ko \
@ENABLE_PLAYER131_TRUE@	;do \
@ENABLE_PLAYER131_TRUE@		if [ -e player2/linux/drivers/$$mod ] ; then \
@ENABLE_PLAYER131_TRUE@			cp player2/linux/drivers/$$mod $(prefix)/release_neutrino/lib/modules/; \
@ENABLE_PLAYER131_TRUE@			sh4-linux-strip --strip-unneeded $(prefix)/release_neutrino/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER131_TRUE@		else \
@ENABLE_PLAYER131_TRUE@			touch $(prefix)/release_neutrino/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER131_TRUE@		fi;\
@ENABLE_PLAYER131_TRUE@	done

@ENABLE_PLAYER179_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stm_v4l2.ko $(prefix)/release_neutrino/lib/modules/
@ENABLE_PLAYER179_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvbi.ko $(prefix)/release_neutrino/lib/modules/
@ENABLE_PLAYER179_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvout.ko $(prefix)/release_neutrino/lib/modules/

@ENABLE_PLAYER179_TRUE@	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko $(prefix)/release_neutrino/lib/modules/ || true
@ENABLE_PLAYER179_TRUE@	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti_np/pti.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti_np/pti.ko $(prefix)/release_neutrino/lib/modules/ || true

@ENABLE_PLAYER179_TRUE@	find $(prefix)/release_neutrino/lib/modules/ -name '*.ko' -exec sh4-linux-strip --strip-unneeded {} \;
@ENABLE_PLAYER179_TRUE@	cd $(targetprefix)/lib/modules/$(KERNELVERSION)/extra && \
@ENABLE_PLAYER179_TRUE@	for mod in \
@ENABLE_PLAYER179_TRUE@		sound/pseudocard/pseudocard.ko \
@ENABLE_PLAYER179_TRUE@		sound/silencegen/silencegen.ko \
@ENABLE_PLAYER179_TRUE@		stm/mmelog/mmelog.ko \
@ENABLE_PLAYER179_TRUE@		stm/monitor/stm_monitor.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/dvb/stmdvb.ko \
@ENABLE_PLAYER179_TRUE@		sound/ksound/ksound.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/mpeg2_hard_host_transformer/mpeg2hw.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/backend/player2.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/h264_preprocessor/sth264pp.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/allocator/stmalloc.ko \
@ENABLE_PLAYER179_TRUE@		stm/platform/platform.ko \
@ENABLE_PLAYER179_TRUE@		stm/platform/p2div64.ko \
@ENABLE_PLAYER179_TRUE@		media/sysfs/stm/stmsysfs.ko \
@ENABLE_PLAYER179_TRUE@	;do \
@ENABLE_PLAYER179_TRUE@		if [ -e player2/linux/drivers/$$mod ] ; then \
@ENABLE_PLAYER179_TRUE@			cp player2/linux/drivers/$$mod $(prefix)/release_neutrino/lib/modules/; \
@ENABLE_PLAYER179_TRUE@			sh4-linux-strip --strip-unneeded $(prefix)/release_neutrino/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER179_TRUE@		else \
@ENABLE_PLAYER179_TRUE@			touch $(prefix)/release_neutrino/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER179_TRUE@		fi;\
@ENABLE_PLAYER179_TRUE@	done

@ENABLE_PLAYER191_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stm_v4l2.ko $(prefix)/release_neutrino/lib/modules/
@ENABLE_PLAYER191_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvbi.ko $(prefix)/release_neutrino/lib/modules/
@ENABLE_PLAYER191_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvout.ko $(prefix)/release_neutrino/lib/modules/

@ENABLE_PLAYER191_TRUE@	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko $(prefix)/release_neutrino/lib/modules/ || true
@ENABLE_PLAYER191_TRUE@	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti_np/pti.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti_np/pti.ko $(prefix)/release_neutrino/lib/modules/ || true

@ENABLE_PLAYER191_TRUE@	find $(prefix)/release_neutrino/lib/modules/ -name '*.ko' -exec sh4-linux-strip --strip-unneeded {} \;
@ENABLE_PLAYER191_TRUE@	cd $(targetprefix)/lib/modules/$(KERNELVERSION)/extra && \
@ENABLE_PLAYER191_TRUE@	for mod in \
@ENABLE_PLAYER191_TRUE@		sound/pseudocard/pseudocard.ko \
@ENABLE_PLAYER191_TRUE@		sound/silencegen/silencegen.ko \
@ENABLE_PLAYER191_TRUE@		stm/mmelog/mmelog.ko \
@ENABLE_PLAYER191_TRUE@		stm/monitor/stm_monitor.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/dvb/stmdvb.ko \
@ENABLE_PLAYER191_TRUE@		sound/ksound/ksound.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/mpeg2_hard_host_transformer/mpeg2hw.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/backend/player2.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/h264_preprocessor/sth264pp.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/allocator/stmalloc.ko \
@ENABLE_PLAYER191_TRUE@		stm/platform/platform.ko \
@ENABLE_PLAYER191_TRUE@		stm/platform/p2div64.ko \
@ENABLE_PLAYER191_TRUE@		media/sysfs/stm/stmsysfs.ko \
@ENABLE_PLAYER191_TRUE@	;do \
@ENABLE_PLAYER191_TRUE@		if [ -e player2/linux/drivers/$$mod ] ; then \
@ENABLE_PLAYER191_TRUE@			cp player2/linux/drivers/$$mod $(prefix)/release_neutrino/lib/modules/; \
@ENABLE_PLAYER191_TRUE@			sh4-linux-strip --strip-unneeded $(prefix)/release_neutrino/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER191_TRUE@		else \
@ENABLE_PLAYER191_TRUE@			touch $(prefix)/release_neutrino/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER191_TRUE@		fi;\
@ENABLE_PLAYER191_TRUE@	done

@STM22_TRUE@	rm $(prefix)/release_neutrino/lib/modules/p2div64.ko
	rm -rf $(prefix)/release_neutrino/lib/modules/$(KERNELVERSION)

	$(INSTALL_DIR) $(prefix)/release_neutrino/media
	ln -sf /media/hdd $(prefix)/release_neutrino/hdd
	$(INSTALL_DIR) $(prefix)/release_neutrino/media/dvd

	$(INSTALL_DIR) $(prefix)/release_neutrino/mnt
	$(INSTALL_DIR) $(prefix)/release_neutrino/mnt/usb
	$(INSTALL_DIR) $(prefix)/release_neutrino/mnt/hdd
	$(INSTALL_DIR) $(prefix)/release_neutrino/mnt/nfs

	$(INSTALL_DIR) $(prefix)/release_neutrino/root

	$(INSTALL_DIR) $(prefix)/release_neutrino/proc
	$(INSTALL_DIR) $(prefix)/release_neutrino/sys
	$(INSTALL_DIR) $(prefix)/release_neutrino/tmp

	$(INSTALL_DIR) $(prefix)/release_neutrino/usr
	$(INSTALL_DIR) $(prefix)/release_neutrino/usr/bin
	$(INSTALL_DIR) $(prefix)/release_neutrino/usr/lib
	cp -p $(targetprefix)/usr/sbin/vsftpd $(prefix)/release_neutrino/usr/bin/

	cp -p $(targetprefix)/usr/bin/killall $(prefix)/release_neutrino/usr/bin/
	cp -p $(targetprefix)/usr/sbin/ethtool $(prefix)/release_neutrino/usr/sbin/

	$(INSTALL_DIR) $(prefix)/release_neutrino/usr/tuxtxt

#######################################################################################
	mkdir -p $(prefix)/release_neutrino/tuxbox/config
	mkdir -p $(prefix)/release_neutrino/var/plugins
	cp -aR $(buildprefix)/root/var/plugins/* $(prefix)/release_neutrino/var/plugins/
	mkdir -p $(prefix)/release_neutrino/lib/tuxbox
	mkdir -p $(prefix)/release_neutrino/usr/lib/tuxbox
	mkdir -p $(prefix)/release_neutrino/usr/keys
	mkdir -p $(prefix)/release_neutrino/var/tuxbox/config
	mkdir -p $(prefix)/release_neutrino/share/tuxbox
	mkdir -p $(prefix)/release_neutrino/var/share/icons
#	mkdir -p $(prefix)/release_neutrino/var/usr/local/share/config
	mkdir -p $(prefix)/release_neutrino/usr/local/share/neutrino/icons
	mkdir -p $(prefix)/release_neutrino/media/net
#	( cd $(prefix)/release_neutrino/var && ln -s ../usr/bin emu )
	( cd $(prefix)/release_neutrino/var && ln -s ../usr/keys keys )
	( cd $(prefix)/release_neutrino/var/tuxbox/config && ln -s ../../../usr/local/share/config/neutrino.conf )
	( cd $(prefix)/release_neutrino/var/tuxbox/config && ln -s ../../../usr/local/share/config/Sportster.conf )
	( cd $(prefix)/release_neutrino/var/tuxbox/config && ln -s ../../../usr/local/share/config/nhttpd.conf )
	( cd $(prefix)/release_neutrino/share/tuxbox && ln -s /usr/local/share/neutrino )
	( cd $(prefix)/release_neutrino/var/share/icons/ && ln -s /usr/local/share/neutrino/icons/logo )
	( cd $(prefix)/release_neutrino/ && ln -s /usr/local/share/neutrino/icons/logo logos )
	( cd $(prefix)/release_neutrino/usr/lib && ln -s libcrypto.so.0.9.8 libcrypto.so.0.9.7 )
	( cd $(prefix)/release_neutrino/lib/tuxbox && ln -s /var/plugins )
	( cd $(prefix)/release_neutrino/var/tuxbox && ln -s /var/plugins )
	( cd $(prefix)/release_neutrino/usr/lib/tuxbox && ln -s /var/plugins )
	rm -rf $(prefix)/release_neutrino/media/sda*
	cp -RP $(appsdir)/neutrino/data/icons/* $(prefix)/release_neutrino/usr/local/share/neutrino/icons/

#######################################################################################
#######################################################################################
#######################################################################################

	$(INSTALL_DIR) $(prefix)/release_neutrino/usr/share

#######################################################################################

#######################################################################################

#######################################################################################

	$(INSTALL_DIR) $(prefix)/release_neutrino/usr/share/zoneinfo
	cp -aR $(buildprefix)/root/usr/share/zoneinfo/* $(prefix)/release_neutrino/usr/share/zoneinfo/

#######################################################################################

	$(INSTALL_DIR) $(prefix)/release_neutrino/usr/share/udhcpc
	cp -aR $(buildprefix)/root/usr/share/udhcpc/* $(prefix)/release_neutrino/usr/share/udhcpc/

#######################################################################################
#######################################################################################
#######################################################################################
#######################################################################################

	$(INSTALL_DIR) $(prefix)/release_neutrino/usr/local

#######################################################################################

	$(INSTALL_DIR) $(prefix)/release_neutrino/usr/local/bin
	cp $(targetprefix)/usr/local/bin/neutrino $(prefix)/release_neutrino/usr/local/bin/
	cp $(targetprefix)/usr/local/bin/pzapit $(prefix)/release_neutrino/usr/local/bin/
	cp $(targetprefix)/usr/local/bin/sectionsdcontrol $(prefix)/release_neutrino/usr/local/bin/
	find $(prefix)/release_neutrino/usr/local/bin/ -name  neutrino -exec sh4-linux-strip --strip-unneeded {} \;
	find $(prefix)/release_neutrino/usr/local/bin/ -name  pzapit -exec sh4-linux-strip --strip-unneeded {} \;
	find $(prefix)/release_neutrino/usr/local/bin/ -name  sectionsdcontrol -exec sh4-linux-strip --strip-unneeded {} \;

#######################################################################################

	$(INSTALL_DIR) $(prefix)/release_neutrino/usr/local/share
	cp -aR $(targetprefix)/usr/local/share/iso-codes $(prefix)/release_neutrino/usr/local/share/
#	TODO: Channellist ....
	$(INSTALL_DIR) $(prefix)/release_neutrino/usr/local/share/config
	cp -aR $(buildprefix)/root/usr/local/share/config/* $(prefix)/release_neutrino/usr/local/share/config/
	cp -aR $(targetprefix)/usr/local/share/neutrino $(prefix)/release_neutrino/usr/local/share/
#	( cd $(prefix)/release_neutrino/usr/local/share/config/tuxtxt/ && ln -sf tuxtxt2_720.conf tuxtxt2.conf )
	rm $(prefix)/release_neutrino/usr/local/share/config/tuxtxt/tuxtxt2_*
#	TODO: HACK
	cp -aR $(targetprefix)/$(targetprefix)/usr/local/share/neutrino/* $(prefix)/release_neutrino/usr/local/share/neutrino
#######################################################################################
#	cp -aR $(targetprefix)/usr/local/share/fonts $(prefix)/release_neutrino/usr/local/share/
	mkdir -p $(prefix)/release_neutrino/usr/local/share/fonts
	cp $(buildprefix)/root/usr/share/fonts/tuxtxt.ttf $(prefix)/release_neutrino/usr/local/share/fonts/

#       Font libass
	mkdir -p $(prefix)/release_neutrino/usr/share/fonts
	cp $(buildprefix)/root/usr/share/fonts/FreeSans.ttf $(prefix)/release_neutrino/usr/share/fonts/

	cp -aR $(targetprefix)/usr/local/share/fonts/micron.ttf $(prefix)/release_neutrino/usr/local/share/fonts/neutrino.ttf
	cp $(appsdir)/neutrino/src/nhttpd/web/{Y_Baselib.js,Y_VLC.js} $(prefix)/release_neutrino/usr/local/share/neutrino/httpd-y/
#	rm $(prefix)/release_neutrino/usr/local/share/neutrino/httpd-y/{Y_Baselib.js.gz,Y_VLC.js.gz}
#######################################################################################
	echo "pingulux-rev#: " > $(prefix)/release_neutrino/etc/imageinfo
	git describe >> $(prefix)/release_neutrino/etc/imageinfo
	$(buildprefix)/root/release/neutrino_version.sh
	rm -rf $(prefix)/release_neutrino/var/etc

#	echo 'comment=created by pingulux-git' > $(buildprefix)/root/var/etc/.version.new
#	echo 'imagename=Neutrino for Pingulux' >> $(buildprefix)/root/var/etc/.version.new
#	echo 'homepage=http://gitorious.org/open-duckbox-project-sh4/pingulux-git' >> $(buildprefix)/root/var/etc/.version.new
#	echo 'creator=git-developer' >> $(buildprefix)/root/var/etc/.version.new
#	echo 'docs=http://gitorious.org/open-duckbox-project-sh4/pingulux-git/commits' >> $(buildprefix)/root/var/etc/.version.new
#	echo 'forum=http://kathif.vs120005.hl-users.com/index.php?sid=' >> $(buildprefix)/root/var/etc/.version.new
	cp $(buildprefix)/root/var/etc/.version.new $(prefix)/release_neutrino/etc/.version
	ln -s ../etc $(prefix)/release_neutrino/var
	ln -sf ../etc/.version $(prefix)/release_neutrino
#######################################################################################

	$(INSTALL_DIR) $(prefix)/release_neutrino/usr/lib

	cp -R $(targetprefix)/usr/lib/* $(prefix)/release_neutrino/usr/lib/
	cp -R $(targetprefix)/usr/local/lib/* $(prefix)/release_neutrino/usr/lib/
	rm -rf $(prefix)/release_neutrino/usr/lib/alsa-lib
	rm -rf $(prefix)/release_neutrino/usr/lib/alsaplayer
	rm -rf $(prefix)/release_neutrino/usr/lib/engines
	rm -rf $(prefix)/release_neutrino/usr/lib/enigma2
	rm -rf $(prefix)/release_neutrino/usr/lib/gconv
	rm -rf $(prefix)/release_neutrino/usr/lib/libxslt-plugins
	rm -rf $(prefix)/release_neutrino/usr/lib/pkgconfig
	rm -rf $(prefix)/release_neutrino/usr/lib/sigc++-1.2
	rm -rf $(prefix)/release_neutrino/usr/lib/X11
	rm -f $(prefix)/release_neutrino/usr/lib/*.a
	rm -f $(prefix)/release_neutrino/usr/lib/*.o
	rm -f $(prefix)/release_neutrino/usr/lib/*.la
	mkdir -p $(prefix)/release_neutrino/usr/local/share/neutrino/icons/logo
	( cd $(prefix)/release_neutrino/usr/local/share/neutrino/httpd-y && ln -s /usr/local/share/neutrino/icons/logo )
	( cd $(prefix)/release_neutrino/usr/local/share/neutrino/httpd-y && ln -s /usr/local/share/neutrino/icons/logo logos )
	( cd $(prefix)/release_neutrino/usr/local/share/neutrino && ln -s /usr/local/share/neutrino/httpd-y httpd )
	( cd $(prefix)/release_neutrino/var && ln -s /usr/local/share/neutrino/httpd-y httpd )
	find $(prefix)/release_neutrino/usr/lib/ -name '*.so*' -exec sh4-linux-strip --strip-unneeded {} \;
	touch $(prefix)/release_neutrino/etc/.fsck
	cp -f $(buildprefix)/root/etc/init.d/Swap.sh $(prefix)/release_neutrino/etc/init.d/
	cp -f $(buildprefix)/root/etc/fw_env.config $(prefix)/release_neutrino/etc/
	cp -f $(buildprefix)/root/etc/bootargs_* $(prefix)/release_neutrino/etc/
	cp -f $(buildprefix)/root/bin/fw_printenv $(prefix)/release_neutrino/bin/
	cp -f $(buildprefix)/root/bin/fw_setenv $(prefix)/release_neutrino/bin/

	cp -f $(targetprefix)/usr/sbin/automount $(prefix)/release_neutrino/usr/sbin/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/kernel/fs/autofs4/autofs4.ko $(prefix)/release_neutrino/lib/modules
	cp -f $(buildprefix)/root/release/auto.usb $(prefix)/release_neutrino/etc/
	echo 'sda    -fstype=auto,noatime,nodiratime          :/dev/sda' >> $(prefix)/release_neutrino/etc/auto.usb
	echo 'sda1   -fstype=auto,noatime,nodiratime          :/dev/sda1' >> $(prefix)/release_neutrino/etc/auto.usb
	echo 'sda2   -fstype=auto,noatime,nodiratime          :/dev/sda2' >> $(prefix)/release_neutrino/etc/auto.usb
	echo 'sda3   -fstype=auto,noatime,nodiratime          :/dev/sda3' >> $(prefix)/release_neutrino/etc/auto.usb
#
######## FOR YOUR OWN CHANGES use these folder in cdk/own_build/neutrino #############
#	rm $(prefix)/release_neutrino/bin/mount
	cp -RP $(buildprefix)/own_build/neutrino/* $(prefix)/release_neutrino/

	cp $(kernelprefix)/$(kernelpath)/arch/sh/boot/uImage $(prefix)/release_neutrino/boot/

	cp -dp $(buildprefix)/root/usr/sbin/blkid $(prefix)/release_neutrino/usr/bin/
	cp -dp $(targetprefix)/usr/bin/rdate $(prefix)/release_neutrino/usr/bin/

	[ -e $(kernelprefix)/$(kernelpath)/drivers/usb/serial/ftdi_sio.ko ] && cp $(kernelprefix)/$(kernelpath)/drivers/usb/serial/ftdi_sio.ko $(prefix)/release_neutrino/lib/modules/ftdi.ko || true
	[ -e $(kernelprefix)/$(kernelpath)/drivers/usb/serial/pl2303.ko ] && cp $(kernelprefix)/$(kernelpath)/drivers/usb/serial/pl2303.ko $(prefix)/release_neutrino/lib/modules || true
	[ -e $(kernelprefix)/$(kernelpath)/drivers/usb/serial/usbserial.ko ] && cp $(kernelprefix)/$(kernelpath)/drivers/usb/serial/usbserial.ko $(prefix)/release_neutrino/lib/modules || true
#	[ -e $(kernelprefix)/$(kernelpath)/fs/ntfs/ntfs.ko ] && cp $(kernelprefix)/$(kernelpath)/fs/ntfs/ntfs.ko $(prefix)/release_neutrino/lib/modules || true
#	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko $(prefix)/release/lib/modules || true

	touch $@

#
# max ALPHA-Version ;)
#
$(DEPDIR)/min-release_neutrino_nightly $(DEPDIR)/std-release_neutrino_nightly $(DEPDIR)/max-release_neutrino_nightly $(DEPDIR)/ipk-release_neutrino_nightly $(DEPDIR)/release_neutrino_nightly: \
$(DEPDIR)/%release_neutrino_nightly:

# the following target creates the common file base
	rm -rf $(prefix)/$(release_dir) || true
	$(INSTALL_DIR) $(prefix)/$(release_dir) && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/bin && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/boot && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/dev && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/dev.static && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/etc && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/etc/fonts && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/etc/init.d && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/etc/network && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/etc/network/if-down.d && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/etc/network/if-post-down.d && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/etc/network/if-pre-up.d && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/etc/network/if-up.d && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/hdd && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/hdd/movie && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/hdd/music && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/hdd/picture && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/lib && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/lib/modules && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/media && \
	ln -s /hdd $(prefix)/$(release_dir)/media/hdd && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/media/dvd && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/mnt && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/mnt/usb && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/mnt/hdd && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/mnt/nfs && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/ram && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/sbin && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/var && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/var/etc && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/root && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/proc && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/sys && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/tmp && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/usr && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/usr/bin && \
	$(INSTALL_DIR) $(prefix)/$(release_dir)/usr/lib && \
	export CROSS_COMPILE=$(target)- && \
		$(MAKE) install -C @DIR_busybox@ CONFIG_PREFIX=$(prefix)/$(release_dir) && \
	touch $(prefix)/$(release_dir)/var/etc/.firstboot && \
	cp -dp $(buildprefix)/root/var/etc/.version $(prefix)/$(release_dir)/var/etc/ && \
	ln -sf /var/etc/.version $(prefix)/$(release_dir)/.version && \
	cp -a $(targetprefix)/bin/* $(prefix)/$(release_dir)/bin/ && \
	ln -s /bin/showiframe $(prefix)/$(release_dir)/usr/bin/showiframe && \
	cp -dp $(targetprefix)/bin/hotplug $(prefix)/$(release_dir)/sbin/ && \
	cp -dp $(targetprefix)/etc/init.d/portmap $(prefix)/$(release_dir)/etc/init.d/ && \
	cp -dp $(buildprefix)/root/etc/init.d/udhcpc $(prefix)/$(release_dir)/etc/init.d/ && \
	cp -dp $(targetprefix)/sbin/init $(prefix)/$(release_dir)/sbin/ && \
	cp -dp $(targetprefix)/sbin/killall5 $(prefix)/$(release_dir)/sbin/ && \
	cp -dp $(targetprefix)/sbin/portmap $(prefix)/$(release_dir)/sbin/ && \
	cp -dp $(targetprefix)/sbin/mke2fs $(prefix)/$(release_dir)/sbin/ && \
	ln -sf /sbin/mke2fs $(prefix)/$(release_dir)/sbin/mkfs.ext2 && \
	ln -sf /sbin/mke2fs $(prefix)/$(release_dir)/sbin/mkfs.ext3 && \
	ln -sf /sbin/mke2fs $(prefix)/$(release_dir)/sbin/mkfs.ext4 && \
	ln -sf /sbin/mke2fs $(prefix)/$(release_dir)/sbin/mkfs.ext4dev && \
	cp -dp $(targetprefix)/sbin/e2fsck $(prefix)/$(release_dir)/sbin/ && \
	ln -sf /sbin/e2fsck $(prefix)/$(release_dir)/sbin/fsck.ext2 && \
	ln -sf /sbin/e2fsck $(prefix)/$(release_dir)/sbin/fsck.ext3 && \
	ln -sf /sbin/e2fsck $(prefix)/$(release_dir)/sbin/fsck.ext4 && \
	ln -sf /sbin/e2fsck $(prefix)/$(release_dir)/sbin/fsck.ext4dev && \
	cp -dp $(targetprefix)/sbin/jfs_fsck $(prefix)/$(release_dir)/sbin/ && \
	ln -sf /sbin/jfs_fsck $(prefix)/$(release_dir)/sbin/fsck.jfs && \
	cp -dp $(targetprefix)/sbin/jfs_mkfs $(prefix)/$(release_dir)/sbin/ && \
	ln -sf /sbin/jfs_mkfs $(prefix)/$(release_dir)/sbin/mkfs.jfs && \
	cp -dp $(targetprefix)/sbin/jfs_tune $(prefix)/$(release_dir)/sbin/ && \
	cp -dp $(targetprefix)/sbin/fsck.nfs $(prefix)/$(release_dir)/sbin/ && \
	cp -dp $(targetprefix)/sbin/sfdisk $(prefix)/$(release_dir)/sbin/ && \
	cp -dp $(targetprefix)/sbin/tune2fs $(prefix)/$(release_dir)/sbin/ && \
	cp -dp $(targetprefix)/sbin/blkid $(prefix)/$(release_dir)/sbin/ && \
	cp -dp $(targetprefix)/usr/sbin/vsftpd $(prefix)/$(release_dir)/usr/bin/ && \
	cp -dp $(targetprefix)/usr/bin/rdate $(prefix)/$(release_dir)/sbin/ && \
	cp -dp $(targetprefix)/usr/bin/ffmpeg $(prefix)/$(release_dir)/sbin/ && \
	cp $(targetprefix)/boot/uImage $(prefix)/$(release_dir)/boot/ && \
	cp $(targetprefix)/boot/video_7100.elf $(prefix)/$(release_dir)/boot/video.elf && \
	cp $(targetprefix)/boot/video_7111.elf $(prefix)/$(release_dir)/boot/video.elf && \
	cp $(targetprefix)/boot/audio.elf $(prefix)/$(release_dir)/boot/audio.elf && \
	cp $(targetprefix)/boot/audio_7111.elf $(prefix)/$(release_dir)/boot/audio.elf && \
	cp -a $(targetprefix)/dev/* $(prefix)/$(release_dir)/dev/ && \
	cp -dp $(targetprefix)/etc/fstab $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/group $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/host.conf $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/hostname $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/hosts $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/inittab $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/localtime $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/mtab $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/passwd $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/profile $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/protocols $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/resolv.conf $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/services $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/shells $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/shells.conf $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/timezone.xml $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/vsftpd.conf $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/vdstandby.cfg $(prefix)/$(release_dir)/etc/ && \
	cp -dp $(targetprefix)/etc/network/interfaces $(prefix)/$(release_dir)/etc/network/ && \
	cp -dp $(targetprefix)/etc/network/options $(prefix)/$(release_dir)/etc/network/ && \
	cp -dp $(targetprefix)/etc/init.d/umountfs $(prefix)/$(release_dir)/etc/init.d/ && \
	cp -dp $(targetprefix)/etc/init.d/sendsigs $(prefix)/$(release_dir)/etc/init.d/ && \
	cp -dp $(targetprefix)/etc/init.d/halt $(prefix)/$(release_dir)/etc/init.d/ && \
	cp $(buildprefix)/root/release/reboot $(prefix)/$(release_dir)/etc/init.d/ && \
	echo "576i50" > $(prefix)/$(release_dir)/etc/videomode && \
	cp $(buildprefix)/root/release/mountvirtfs $(prefix)/$(release_dir)/etc/init.d/ && \
	cp $(buildprefix)/root/release/mme_check $(prefix)/$(release_dir)/etc/init.d/ && \
	cp $(buildprefix)/root/release/mountall $(prefix)/$(release_dir)/etc/init.d/ && \
	cp $(buildprefix)/root/release/hostname $(prefix)/$(release_dir)/etc/init.d/ && \
	cp $(buildprefix)/root/release/vsftpd $(prefix)/$(release_dir)/etc/init.d/ && \
	cp $(buildprefix)/root/release/bootclean.sh $(prefix)/$(release_dir)/etc/init.d/ && \
	cp $(buildprefix)/root/release/networking $(prefix)/$(release_dir)/etc/init.d/ && \
	cp $(buildprefix)/root/release/getfb.awk $(prefix)/$(release_dir)/etc/init.d/ && \
	cp -rd $(targetprefix)/lib/* $(prefix)/$(release_dir)/lib/
#
#
#
@STM23_TRUE@	cp $(buildprefix)/root/release/rcS_stm23_neutrino$(if $(SPARK),_$(SPARK)) $(prefix)/$(release_dir)/etc/init.d/rcS
@STM23_TRUE@	chmod 755 $(prefix)/$(release_dir)/etc/init.d/rcS
#
#
#
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/avs/avs.ko $(prefix)/$(release_dir)/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/boxtype/boxtype.ko $(prefix)/$(release_dir)/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/simu_button/simu_button.ko $(prefix)/$(release_dir)/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/e2_proc/e2_proc.ko $(prefix)/$(release_dir)/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/kernel/fs/autofs4/autofs4.ko $(prefix)/$(release_dir)/lib/modules

@ENABLE_SPARK_TRUE@	echo "spark" > $(prefix)/$(release_dir)/etc/hostname
@ENABLE_SPARK_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontcontroller/micom/micom.ko $(prefix)/$(release_dir)/lib/modules/
@ENABLE_SPARK_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmcore-display-sti7111.ko $(prefix)/$(release_dir)/lib/modules/
@ENABLE_SPARK_TRUE@	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko $(prefix)/release/lib/modules || true
@ENABLE_SPARK_TRUE@	cp $(targetprefix)/boot/video_7111.elf $(prefix)/$(release_dir)/boot/video.elf
@ENABLE_SPARK_TRUE@	cp $(targetprefix)/boot/audio_7111.elf $(prefix)/$(release_dir)/boot/audio.elf
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/$(release_dir)/lib/firmware/dvb-fe-avl2108.fw
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/$(release_dir)/lib/firmware/dvb-fe-stv6306.fw
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/$(release_dir)/lib/firmware/dvb-fe-cx24116.fw
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/$(release_dir)/lib/firmware/dvb-fe-cx21143.fw
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/$(release_dir)/bin/evremote
@ENABLE_SPARK_TRUE@	rm -f $(prefix)/$(release_dir)/bin/gotosleep
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmfb.ko $(prefix)/$(release_dir)/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxshell/embxshell.ko $(prefix)/$(release_dir)/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxmailbox/embxmailbox.ko $(prefix)/$(release_dir)/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxshm/embxshm.ko $(prefix)/$(release_dir)/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/mme/mme_host.ko $(prefix)/$(release_dir)/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/bpamem/bpamem.ko $(prefix)/$(release_dir)/lib/modules/

	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/*.ko $(prefix)/$(release_dir)/lib/modules/

	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/compcache/lzo-kmod/lzo1x_compress.ko $(prefix)/$(release_dir)/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/compcache/lzo-kmod/lzo1x_decompress.ko $(prefix)/$(release_dir)/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/compcache/ramzswap.ko $(prefix)/$(release_dir)/lib/modules/

@ENABLE_PLAYER131_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko $(prefix)/$(release_dir)/lib/modules/
#	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti_np/pti.ko $(prefix)/$(release_dir)/lib/modules/
@ENABLE_PLAYER131_TRUE@	find $(prefix)/$(release_dir)/lib/modules/ -name '*.ko' -exec sh4-linux-strip --strip-unneeded {} \;
@ENABLE_PLAYER131_TRUE@	cd $(targetprefix)/lib/modules/$(KERNELVERSION)/extra && \
@ENABLE_PLAYER131_TRUE@	for mod in \
@ENABLE_PLAYER131_TRUE@		sound/pseudocard/pseudocard.ko \
@ENABLE_PLAYER131_TRUE@		sound/silencegen/silencegen.ko \
@ENABLE_PLAYER131_TRUE@		stm/mmelog/mmelog.ko \
@ENABLE_PLAYER131_TRUE@		stm/monitor/stm_monitor.ko \
@ENABLE_PLAYER131_TRUE@		media/video/stm/stm_v4l2.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/dvb/stmdvb.ko \
@ENABLE_PLAYER131_TRUE@		sound/ksound/ksound.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/mpeg2_hard_host_transformer/mpeg2hw.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/backend/player2.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/h264_preprocessor/sth264pp.ko \
@ENABLE_PLAYER131_TRUE@		media/dvb/stm/allocator/stmalloc.ko \
@ENABLE_PLAYER131_TRUE@		stm/platform/platform.ko \
@ENABLE_PLAYER131_TRUE@		stm/platform/p2div64.ko \
@ENABLE_PLAYER131_TRUE@	;do \
@ENABLE_PLAYER131_TRUE@		if [ -e player2/linux/drivers/$$mod ] ; then \
@ENABLE_PLAYER131_TRUE@			cp player2/linux/drivers/$$mod $(prefix)/$(release_dir)/lib/modules/; \
@ENABLE_PLAYER131_TRUE@			sh4-linux-strip --strip-unneeded $(prefix)/$(release_dir)/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER131_TRUE@		else \
@ENABLE_PLAYER131_TRUE@			touch $(prefix)/$(release_dir)/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER131_TRUE@		fi;\
@ENABLE_PLAYER131_TRUE@	done

@ENABLE_PLAYER179_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stm_v4l2.ko $(prefix)/$(release_dir)/lib/modules/
@ENABLE_PLAYER179_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvbi.ko $(prefix)/$(release_dir)/lib/modules/
@ENABLE_PLAYER179_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvout.ko $(prefix)/$(release_dir)/lib/modules/
@ENABLE_PLAYER179_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko $(prefix)/$(release_dir)/lib/modules/
#	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti_np/pti.ko $(prefix)/$(release_dir)/lib/modules/
@ENABLE_PLAYER179_TRUE@	find $(prefix)/$(release_dir)/lib/modules/ -name '*.ko' -exec sh4-linux-strip --strip-unneeded {} \;
@ENABLE_PLAYER179_TRUE@	cd $(targetprefix)/lib/modules/$(KERNELVERSION)/extra && \
@ENABLE_PLAYER179_TRUE@	for mod in \
@ENABLE_PLAYER179_TRUE@		sound/pseudocard/pseudocard.ko \
@ENABLE_PLAYER179_TRUE@		sound/silencegen/silencegen.ko \
@ENABLE_PLAYER179_TRUE@		stm/mmelog/mmelog.ko \
@ENABLE_PLAYER179_TRUE@		stm/monitor/stm_monitor.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/dvb/stmdvb.ko \
@ENABLE_PLAYER179_TRUE@		sound/ksound/ksound.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/mpeg2_hard_host_transformer/mpeg2hw.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/backend/player2.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/h264_preprocessor/sth264pp.ko \
@ENABLE_PLAYER179_TRUE@		media/dvb/stm/allocator/stmalloc.ko \
@ENABLE_PLAYER179_TRUE@		stm/platform/platform.ko \
@ENABLE_PLAYER179_TRUE@		stm/platform/p2div64.ko \
@ENABLE_PLAYER179_TRUE@		media/sysfs/stm/stmsysfs.ko \
@ENABLE_PLAYER179_TRUE@	;do \
@ENABLE_PLAYER179_TRUE@		if [ -e player2/linux/drivers/$$mod ] ; then \
@ENABLE_PLAYER179_TRUE@			cp player2/linux/drivers/$$mod $(prefix)/$(release_dir)/lib/modules/; \
@ENABLE_PLAYER179_TRUE@			sh4-linux-strip --strip-unneeded $(prefix)/$(release_dir)/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER179_TRUE@		else \
@ENABLE_PLAYER179_TRUE@			touch $(prefix)/$(release_dir)/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER179_TRUE@		fi;\
@ENABLE_PLAYER179_TRUE@	done

@ENABLE_PLAYER191_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stm_v4l2.ko $(prefix)/$(release_dir)/lib/modules/
@ENABLE_PLAYER191_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvbi.ko $(prefix)/$(release_dir)/lib/modules/
@ENABLE_PLAYER191_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvout.ko $(prefix)/$(release_dir)/lib/modules/
@ENABLE_PLAYER191_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko $(prefix)/$(release_dir)/lib/modules/
#	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti_np/pti.ko $(prefix)/$(release_dir)/lib/modules/
@ENABLE_PLAYER191_TRUE@	find $(prefix)/$(release_dir)/lib/modules/ -name '*.ko' -exec sh4-linux-strip --strip-unneeded {} \;
@ENABLE_PLAYER191_TRUE@	cd $(targetprefix)/lib/modules/$(KERNELVERSION)/extra && \
@ENABLE_PLAYER191_TRUE@	for mod in \
@ENABLE_PLAYER191_TRUE@		sound/pseudocard/pseudocard.ko \
@ENABLE_PLAYER191_TRUE@		sound/silencegen/silencegen.ko \
@ENABLE_PLAYER191_TRUE@		stm/mmelog/mmelog.ko \
@ENABLE_PLAYER191_TRUE@		stm/monitor/stm_monitor.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/dvb/stmdvb.ko \
@ENABLE_PLAYER191_TRUE@		sound/ksound/ksound.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/mpeg2_hard_host_transformer/mpeg2hw.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/backend/player2.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/h264_preprocessor/sth264pp.ko \
@ENABLE_PLAYER191_TRUE@		media/dvb/stm/allocator/stmalloc.ko \
@ENABLE_PLAYER191_TRUE@		stm/platform/platform.ko \
@ENABLE_PLAYER191_TRUE@		stm/platform/p2div64.ko \
@ENABLE_PLAYER191_TRUE@		media/sysfs/stm/stmsysfs.ko \
@ENABLE_PLAYER191_TRUE@	;do \
@ENABLE_PLAYER191_TRUE@		if [ -e player2/linux/drivers/$$mod ] ; then \
@ENABLE_PLAYER191_TRUE@			cp player2/linux/drivers/$$mod $(prefix)/$(release_dir)/lib/modules/; \
@ENABLE_PLAYER191_TRUE@			sh4-linux-strip --strip-unneeded $(prefix)/$(release_dir)/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER191_TRUE@		else \
@ENABLE_PLAYER191_TRUE@			touch $(prefix)/$(release_dir)/lib/modules/`basename $$mod`; \
@ENABLE_PLAYER191_TRUE@		fi;\
@ENABLE_PLAYER191_TRUE@	done

	cp -p $(targetprefix)/usr/bin/killall $(prefix)/$(release_dir)/usr/bin/
	cp -p $(targetprefix)/usr/sbin/ethtool $(prefix)/$(release_dir)/usr/sbin/

########################################################################
#	mkdir -p $(prefix)/$(release_dir)/var/plugins
#	mkdir -p $(prefix)/$(release_dir)/lib/tuxbox
#	mkdir -p $(prefix)/$(release_dir)/var/tuxbox/config
#	mkdir -p $(prefix)/$(release_dir)/share/tuxbox
#	mkdir -p $(prefix)/$(release_dir)/var/share/icons
#	mkdir -p $(prefix)/$(release_dir)/var/usr/local/share/config
#	( cd $(prefix)/$(release_dir)/share/tuxbox && ln -s /usr/local/share/neutrino )
#	( cd $(prefix)/$(release_dir)/var/share/icons/ && ln -s /usr/local/share/neutrino/icons/logo )
#	( cd $(prefix)/$(release_dir)/ && ln -s /usr/local/share/neutrino/icons/logo logos )
#	( cd $(prefix)/$(release_dir)/lib && ln -s libcrypto.so.0.9.7 libcrypto.so.0.9.8 )
#	( cd $(prefix)/$(release_dir)/lib/tuxbox && ln -s /var/plugins )
#	( cd $(prefix)/$(release_dir)/var/tuxbox && ln -s /var/plugins )
#	( cd $(prefix)/$(release_dir)/usr/lib/tuxbox && ln -s /var/plugins )
#	mkdir -p $(prefix)/$(release_dir)/usr/local/share/config/tuxtxt/
#	cp $(buildprefix)/root/etc/tuxbox/tuxtxt2.conf $(prefix)/$(release_dir)/usr/local/share/config/tuxtxt/
########################################################################
#
#
#
	$(INSTALL_DIR) $(prefix)/$(release_dir)/usr/share/udhcpc
	cp -aR $(buildprefix)/root/usr/share/udhcpc/* $(prefix)/$(release_dir)/usr/share/udhcpc/
#
#
#
	$(INSTALL_DIR) $(prefix)/$(release_dir)/usr/local/bin
	cp $(targetprefix)/usr/local/bin/neutrino $(prefix)/$(release_dir)/usr/local/bin/
	cp $(targetprefix)/usr/local/bin/pzapit $(prefix)/$(release_dir)/usr/local/bin/
	cp $(targetprefix)/usr/local/bin/sectionsdcontrol $(prefix)/$(release_dir)/usr/local/bin/

#
# zapit
#
	$(INSTALL_DIR) $(prefix)/$(release_dir)/var/tuxbox/config/zapit

#
# channellist
#
	$(INSTALL_DIR) $(prefix)/$(release_dir)/var/tuxbox/config
	cp -aR $(targetprefix)/var/tuxbox/config/* $(prefix)/$(release_dir)/var/tuxbox/config
#
# zoneinfo
#
	$(INSTALL_DIR) $(prefix)/$(release_dir)/usr/share/zoneinfo
	cp -aR $(buildprefix)/root/usr/share/zoneinfo/* $(prefix)/$(release_dir)/usr/share/zoneinfo/
#
# fonts
#
	$(INSTALL_DIR) $(prefix)/$(release_dir)/share/fonts
	cp -aR $(targetprefix)/share/fonts $(prefix)/$(release_dir)/share/
#
# iso-codes
#
	cp -aR $(targetprefix)/usr/local/share/iso-codes $(prefix)/$(release_dir)/share/
#
# httpd/icons/locale/themes
#
	$(INSTALL_DIR) $(prefix)/$(release_dir)/share/tuxbox/neutrino
	cp -aR $(targetprefix)/share/tuxbox/neutrino/* $(prefix)/$(release_dir)/share/tuxbox/neutrino/

#
# /usr/lib
#
	$(INSTALL_DIR) $(prefix)/$(release_dir)/usr/lib
	cp -R $(targetprefix)/usr/lib/* $(prefix)/$(release_dir)/usr/lib/

#
# FOR YOUR OWN CHANGES use these folder in cdk/own_build/neutrino
#
	cp -RP $(buildprefix)/own_build/neutrino/* $(prefix)/$(release_dir)/

#
# del/strip
#

	rm -rf $(prefix)/$(release_dir)/lib/modules/$(KERNELVERSION)
	rm -rf $(prefix)/$(release_dir)/usr/lib/alsa-lib
	rm -rf $(prefix)/$(release_dir)/usr/lib/alsaplayer
	rm -rf $(prefix)/$(release_dir)/usr/lib/engines
	rm -rf $(prefix)/$(release_dir)/usr/lib/enigma2
	rm -rf $(prefix)/$(release_dir)/usr/lib/gconv
	rm -rf $(prefix)/$(release_dir)/usr/lib/libxslt-plugins
	rm -rf $(prefix)/$(release_dir)/usr/lib/pkgconfig
	rm -rf $(prefix)/$(release_dir)/usr/lib/sigc++-1.2
	rm -rf $(prefix)/$(release_dir)/usr/lib/X11
	rm -f $(prefix)/$(release_dir)/lib/*.a
	rm -f $(prefix)/$(release_dir)/lib/*.o
	rm -f $(prefix)/$(release_dir)/lib/*.la
	find $(prefix)/$(release_dir)/lib/ -name '*.so*' -exec sh4-linux-strip --strip-unneeded {} \;
	rm -f $(prefix)/$(release_dir)/usr/lib/*.a
	rm -f $(prefix)/$(release_dir)/usr/lib/*.o
	rm -f $(prefix)/$(release_dir)/usr/lib/*.la
	find $(prefix)/$(release_dir)/usr/lib/ -name '*.so*' -exec sh4-linux-strip --strip-unneeded {} \;
#
# release_neutrino_nightly end
#
	touch $@
$(DEPDIR)/release_evolux: \
$(DEPDIR)/%release_evolux:
	rm -rf $(prefix)/release_evolux_with_dev || true
	rm -rf $(prefix)/uImage || true
	rm -rf $(prefix)/e2jffs2.img || true
	mkdir -p $(prefix)/release_evolux_with_dev
	$(USERS) cp -RP $(prefix)/release_neutrino_with_dev/* $(prefix)/release_evolux_with_dev/
	$(USERS) chmod 777 -R $(prefix)/release_evolux_with_dev
	if [ -e /usr/bin/python2.6 ] && [ -e $(buildprefix)/doEVOLUX.sh ] ; then \
		$(buildprefix)/doEVOLUX.sh; \
	fi;
	cp -RP $(prefix)/release_with_dev/var $(prefix)/release_evolux_with_dev/
	cp -RP $(prefix)/release_with_dev/sbin $(prefix)/release_evolux_with_dev/
	cp -RP $(prefix)/release_with_dev/usr/bin $(prefix)/release_evolux_with_dev/usr/
	cp -RP $(prefix)/release_with_dev/usr/sbin $(prefix)/release_evolux_with_dev/usr/
	cp -RP $(prefix)/release_with_dev/usr/script $(prefix)/release_evolux_with_dev/usr/
	cp -RP $(prefix)/release_with_dev/usr/share $(prefix)/release_evolux_with_dev/usr/
	cp -RP $(prefix)/release_with_dev/usr/tuxtxt $(prefix)/release_evolux_with_dev/usr/
	cp -RP $(prefix)/release_with_dev/usr/lib $(prefix)/release_evolux_with_dev/usr/
	mv $(prefix)/release_evolux_with_dev/usr/local/share/fonts/neutrino.ttf $(prefix)/release_evolux_with_dev/usr/share/fonts
	rm -rf $(prefix)/release_evolux_with_dev/usr/local/share/fonts
	cp -RP $(prefix)/release_with_dev/usr/local $(prefix)/release_evolux_with_dev/usr/
	cp -RP $(prefix)/release_with_dev/etc/network/interfaces $(prefix)/release_evolux_with_dev/etc/network/
	cp -RP $(prefix)/release_with_dev/etc/dropbear $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(prefix)/release_with_dev/etc/enigma2 $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(prefix)/release_with_dev/etc/fonts $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(prefix)/release_with_dev/etc/tuxbox $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(prefix)/release_with_dev/etc/Wireless $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(prefix)/release_with_dev/etc/changelog.txt $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(prefix)/release_with_dev/etc/hostname $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(prefix)/release_with_dev/etc/image-version $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(prefix)/release_with_dev/etc/inetd.conf $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(prefix)/release_with_dev/etc/localtime $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(prefix)/release_with_dev/etc/rc.d/rc0.d $(prefix)/release_evolux_with_dev/etc/rc.d/
	cp -RP $(prefix)/release_with_dev/etc/rc.d/rc3.d $(prefix)/release_evolux_with_dev/etc/rc.d/
	cp -RP $(prefix)/release_with_dev/etc/rc.d/rc6.d $(prefix)/release_evolux_with_dev/etc/rc.d/
	cp -RP $(prefix)/release_with_dev/etc/init.d/ntpupdate.sh $(prefix)/release_evolux_with_dev/etc/init.d/
	cp -RP $(buildprefix)/root/etc/init.d/DisplayTime.sh $(prefix)/release_evolux_with_dev/etc/init.d/
	cp -RP $(buildprefix)/root/release/rcS_stm23_24_evolux_spark $(prefix)/release_evolux_with_dev/etc/init.d/rcS
	cp -RP $(prefix)/release_with_dev/lib/modules $(prefix)/release_evolux_with_dev/lib/
	cp -RP $(prefix)/release_evolux_with_dev/boot/uImage $(prefix)/
	cp -RP $(buildprefix)/root/etc/bootargs_* $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(buildprefix)/root/etc/fw_env.config $(prefix)/release_evolux_with_dev/etc/
	cp -RP $(buildprefix)/root/bin/fw_printenv $(prefix)/release_evolux_with_dev/bin/
	cp -RP $(buildprefix)/root/bin/fw_setenv $(prefix)/release_evolux_with_dev/bin/
	mkdir -p $(prefix)/BootargsPack/bin
	mkdir -p $(prefix)/BootargsPack/etc
	cp -RP $(buildprefix)/root/etc/fw_env.config $(prefix)/BootargsPack/etc/
	cp -RP $(buildprefix)/root/etc/bootargs_* $(prefix)/BootargsPack/etc/
	cp -RP $(buildprefix)/root/bin/fw_printenv $(prefix)/BootargsPack/bin/
	cp -RP $(buildprefix)/root/bin/fw_setenv $(prefix)/BootargsPack/bin/
	cp -RP $(buildprefix)/root/bin/setmtdmode $(prefix)/BootargsPack/bin/
	( cd $(prefix) && cp -RP ../flash/spark/spark_oob.img $(prefix)/release_evolux_with_dev/sbin/ )
	( cd $(prefix) && cp -RP ../flash/spark/flash_E2_yaffs2.sh $(prefix)/ )
	( cd $(prefix) && cp -RP ../flash/spark/howto_flash_yaffs2_new3.txt $(prefix)/ )
	( cd $(prefix) && cp -RP ../flash/spark/orig-spark-plugin/Evolux-Orig-Spark-BootPlugin $(prefix)/ )
	if [ -e $(prefix)/release_with_dev/etc/changelog.txt ]; then \
		cp -RP $(prefix)/release_with_dev/etc/changelog.txt $(prefix)/; \
		( cd $(prefix) && ../flash/spark/mkyaffs2 -o ../flash/spark/spark_oob.img $(prefix)/release_evolux_with_dev $(prefix)/e2yaffs2.img ); \
		( cd $(prefix) && tar -czvf EvoLux_on_Pingulux_v$(EVOLUXVERSION)-YAFFS2.tar.gz e2yaffs2.img uImage changelog.txt howto_flash_yaffs2_new3.txt flash_E2_yaffs2.sh BootargsPack Evolux-Orig-Spark-BootPlugin ) ; \
		$(prefix)/host/bin/mkfs.jffs2 -r $(prefix)/release_evolux_with_dev -o $(prefix)/e2jffs2.img -e 0x20000 -n; \
		( cd $(prefix) && tar -czvf EvoLux_on_Pingulux_v$(EVOLUXVERSION)-JFFS2.tar.gz e2jffs2.img uImage changelog.txt ); \
	else \
		( cd $(prefix) && ../flash/spark/mkyaffs2 -o ../flash/spark/spark_oob.img $(prefix)/release_evolux_with_dev $(prefix)/e2yaffs2.img ); \
		( cd $(prefix) && tar -czvf EvoLux_on_Pingulux_v$(EVOLUXVERSION)-YAFFS2.tar.gz e2yaffs2.img uImage howto_flash_yaffs2_new3.txt flash_E2_yaffs2.sh BootargsPack Evolux-Orig-Spark-BootPlugin ); \
		$(prefix)/host/bin/mkfs.jffs2 -r $(prefix)/release_evolux_with_dev -o $(prefix)/e2jffs2.img -e 0x20000 -n; \
		( cd $(prefix) && tar -czvf EvoLux_on_Pingulux_v$(EVOLUXVERSION)-JFFS2.tar.gz e2jffs2.img uImage ); \
	fi;

	touch $@
$(DEPDIR)/min-release_neutrino_static $(DEPDIR)/std-release_neutrino_static $(DEPDIR)/max-release_neutrino_static $(DEPDIR)/ipk-release_neutrino_static $(DEPDIR)/release_neutrino_static: \
$(DEPDIR)/%release_neutrino_static:
	$(INSTALL_DIR) $(prefix)/release_neutrino_static && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/bin && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/sbin && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/boot && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/dev && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/etc && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/etc/fonts && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/etc/init.d && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/etc/network && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/etc/network/if-down.d && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/etc/network/if-post-down.d && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/etc/network/if-pre-up.d && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/etc/network/if-up.d && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/hdd && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/lib && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/lib/modules && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/ram && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/var && \
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/var/etc && \
	export CROSS_COMPILE=$(target)- && \
		$(MAKE) install -C @DIR_busybox@ CONFIG_PREFIX=$(prefix)/release_neutrino_static && \
	cp -a $(targetprefix)/bin/* $(prefix)/release_neutrino_static/bin/ && \
	cp -dp $(targetprefix)/bin/hotplug $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/init $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/killall5 $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/portmap $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/mke2fs $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/mkfs.ext2 $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/mkfs.ext3 $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/fsck.ext2 $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/fsck.ext3 $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/fsck.nfs $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/sfdisk $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/tune2fs $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/sbin/blkid $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/usr/bin/rdate $(prefix)/release_neutrino_static/sbin/ && \
	cp -dp $(targetprefix)/etc/init.d/portmap $(prefix)/release_neutrino_static/etc/init.d/ && \
	cp -dp $(targetprefix)/usr/bin/ffmpeg $(prefix)/release_neutrino_static/sbin/ && \
	cp -R $(buildprefix)/static/common/* $(prefix)/release_neutrino_static/ && \
	cp -R $(buildprefix)/static/$(SPARK)/* $(prefix)/release_neutrino_static/ && \
	cp -R $(buildprefix)/static/neutrino/* $(prefix)/release_neutrino_static/ && \
	cp -rd $(targetprefix)/lib/* $(prefix)/release_neutrino_static/lib/ && \
	rm -f $(prefix)/release_neutrino_static/lib/*.a && \
	rm -f $(prefix)/release_neutrino_static/lib/*.o && \
	rm -f $(prefix)/release_neutrino_static/lib/*.la && \
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/avs/avs.ko $(prefix)/release_neutrino_static/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/boxtype/boxtype.ko $(prefix)/release_neutrino_static/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/simu_button/simu_button.ko $(prefix)/release_neutrino_static/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/e2_proc/e2_proc.ko $(prefix)/release_neutrino_static/lib/modules/

@ENABLE_SPARK_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontcontroller/aotom/aotom.ko $(prefix)/release_neutrino_static/lib/modules/
@ENABLE_SPARK_TRUE@	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmcore-display-sti7111.ko $(prefix)/release_neutrino_static/lib/modules/
@ENABLE_SPARK_TRUE@	[ -e $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko ] && cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/cpu_frequ/cpu_frequ.ko $(prefix)/release/lib/modules || true

	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmfb.ko $(prefix)/release_neutrino_static/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxshell/embxshell.ko $(prefix)/release_neutrino_static/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxmailbox/embxmailbox.ko $(prefix)/release_neutrino_static/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/embxshm/embxshm.ko $(prefix)/release_neutrino_static/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/multicom/mme/mme_host.ko $(prefix)/release_neutrino_static/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/bpamem/bpamem.ko $(prefix)/release_neutrino_static/lib/modules/

	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/frontends/*.ko $(prefix)/release_neutrino_static/lib/modules/

#	PLAYER

	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stm_v4l2.ko $(prefix)/release_neutrino_static/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvbi.ko $(prefix)/release_neutrino_static/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/stgfb/stmfb/stmvout.ko $(prefix)/release_neutrino_static/lib/modules/
	cp $(targetprefix)/lib/modules/$(KERNELVERSION)/extra/pti/pti.ko $(prefix)/release_neutrino_static/lib/modules/

	find $(prefix)/release_neutrino_static/lib/modules/ -name '*.ko' -exec sh4-linux-strip --strip-unneeded {} \;
	cd $(targetprefix)/lib/modules/$(KERNELVERSION)/extra && \
	for mod in \
		sound/pseudocard/pseudocard.ko \
		sound/silencegen/silencegen.ko \
		stm/mmelog/mmelog.ko \
		stm/monitor/stm_monitor.ko \
		media/dvb/stm/dvb/stmdvb.ko \
		sound/ksound/ksound.ko \
		media/dvb/stm/mpeg2_hard_host_transformer/mpeg2hw.ko \
		media/dvb/stm/backend/player2.ko \
		media/dvb/stm/h264_preprocessor/sth264pp.ko \
		media/dvb/stm/allocator/stmalloc.ko \
		stm/platform/platform.ko \
		stm/platform/p2div64.ko \
		media/sysfs/stm/stmsysfs.ko \
	;do \
		if [ -e player2/linux/drivers/$$mod ] ; then \
			cp player2/linux/drivers/$$mod $(prefix)/release_neutrino_static/lib/modules/; \
		else \
			touch $(prefix)/release_neutrino_static/lib/modules/`basename $$mod`; \
		fi;\
	done

	$(INSTALL_DIR) $(prefix)/release_neutrino_static/mnt

	$(INSTALL_DIR) $(prefix)/release_neutrino_static/root

	$(INSTALL_DIR) $(prefix)/release_neutrino_static/proc
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/sys
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/tmp

	$(INSTALL_DIR) $(prefix)/release_neutrino_static/usr
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/usr/bin
	$(INSTALL_DIR) $(prefix)/release_neutrino_static/usr/lib
	cp -p $(targetprefix)/usr/sbin/vsftpd $(prefix)/release_neutrino_static/usr/bin/
	cp -dp $(buildprefix)/root/etc/lircd.conf $(prefix)/release_neutrino_static/etc/
	cp -dp $(targetprefix)/usr/bin/lircd $(prefix)/release_neutrino_static/usr/bin/
	cp -dp $(targetprefix)/usr/lib/liblirc* $(prefix)/release_neutrino_static/usr/lib/

#######################################################################################

	$(INSTALL_DIR) $(prefix)/release_neutrino_static/usr/local/bin
	cp $(targetprefix)/usr/local/bin/neutrino $(prefix)/release_neutrino_static/usr/local/bin/
	cp $(targetprefix)/usr/local/bin/pzapit $(prefix)/release_neutrino_static/usr/local/bin/
	cp $(targetprefix)/usr/local/bin/sectionsdcontrol $(prefix)/release_neutrino_static/usr/local/bin/
	find $(prefix)/release_neutrino_static/usr/local/bin/ -name  neutrino -exec sh4-linux-strip --strip-unneeded {} \;
	find $(prefix)/release_neutrino_static/usr/local/bin/ -name  pzapit -exec sh4-linux-strip --strip-unneeded {} \;
	find $(prefix)/release_neutrino_static/usr/local/bin/ -name  sectionsdcontrol -exec sh4-linux-strip --strip-unneeded {} \;

#######################################################################################
	echo "duckbox-rev#: " > $(prefix)/release_neutrino_static/etc/imageinfo
	git describe >> $(prefix)/release_neutrino_static/etc/imageinfo
#######################################################################################

	$(INSTALL_DIR) $(prefix)/release_neutrino_static/usr/lib

	cp -R $(targetprefix)/usr/lib/* $(prefix)/release_neutrino_static/usr/lib/
	cp -R $(targetprefix)/usr/local/lib/* $(prefix)/release_neutrino_static/usr/lib/
	rm -rf $(prefix)/release_neutrino_static/usr/lib/alsa-lib
	rm -rf $(prefix)/release_neutrino_static/usr/lib/alsaplayer
	rm -rf $(prefix)/release_neutrino_static/usr/lib/engines
	rm -rf $(prefix)/release_neutrino_static/usr/lib/enigma2
	rm -rf $(prefix)/release_neutrino_static/usr/lib/gconv
	rm -rf $(prefix)/release_neutrino_static/usr/lib/libxslt-plugins
	rm -rf $(prefix)/release_neutrino_static/usr/lib/pkgconfig
	rm -rf $(prefix)/release_neutrino_static/usr/lib/sigc++-1.2
	rm -rf $(prefix)/release_neutrino_static/usr/lib/X11
	rm -f $(prefix)/release_neutrino_static/usr/lib/*.a
	rm -f $(prefix)/release_neutrino_static/usr/lib/*.o
	rm -f $(prefix)/release_neutrino_static/usr/lib/*.la
	find $(prefix)/release_neutrino_static/usr/lib/ -name '*.so*' -exec sh4-linux-strip --strip-unneeded {} \;

######## FOR YOUR OWN CHANGES use these folder in cdk/own_build/neutrino #############
	cp -RP $(buildprefix)/own_build/neutrino/* $(prefix)/release_neutrino_static/

	cp $(kernelprefix)/linux-sh4/arch/sh/boot/uImage $(prefix)/release_neutrino_static/boot/

	touch $@

# Set up the build environment

# Include Archive targets (SPECS derived)

# Include host apps targets
# ipkg-utils

# Include ipk stuff

# Include bootstrap targets (SPECS derived)

#  Include u-boot targets
#if ENABLE_TF7700
#include make/tf_u-boot.mk
#else
#endif

# Include adapted etc files and etc read-write files

# Include bare-os targets (mainly SPECS derived)

# Include linux kernel targets

# Include busybox targets

# Include contrib lib targets

# Include contrib apps (SPECS derived)

# Include contrib apps

# Include net apps

# Include divers tools targets

# More misc libs, mostly nonessential

# Misc tools, not essential

# Plugins

# Include stock gui targets

# Include enigma gui targets
#include make/enigma.mk

# Include enigma2 gui targets

# Include enigma2-nightly gui targets

# Include neutrino gui targets

# Include vdr gui targets
#include make/vdr.mk
#include make/vdrdev.mk

# Include enigma1-hd gui targets
#include make/enigma1-hd.mk

# Essential, and some less essential, libraries
#include make/tuxbox_libs.mk

# A small, but absolutely essential library

# Include yaud targets

# Include record targets

# Include prog targets

# Include usb targets
#include make/flashybrid.mk

# Include development targets

# Include stg-framebuffer targets (SPECS derived)
# (stgfb X... freetype directfb)

# Include misc targets (SPECS derived)
# (splashutils)

# flash_parts-[root]-[cramfs,squashfs,jffs2,all]
# Expand all flash targets containg the word "all"
#include make/flash-expand-targets.mk

# Create complete images ("without u-boot bootloader stuff")
#include make/fullimages.mk

# Create update images
#include make/partition-update-images.mk

# Create images of the root and var file systems
#include make/partition-images.mk

# Create root and var filesystems, ready for image creation
#include make/flashable-dirs.mk

# Strip libraries of symbols not needed.

# Create the root file systems for jffs2-only, cramfs, and squashfs
# images (containing kernel modules but not GUI)
#include make/flashroot-fs.mk

# Create the root file system, without kernel and GUI (be aware of RW_FILES)
#include make/flashroot.mk

# Create partition und update partition images from given directories
#include make/helper-images.mk

# A number of cleaning targets

# "Phony" make targets

# Create the TAGS file

# Target for building source distributions (hardly used these days of CVS :-)

#Trick

#include make/release_vdr.mk

#include make/release_enigma1_hd.mk

# New static folder

# Give the user rope to hang himself :-).  (Note: read from the
# generated Makefile during make run, automake or configure does not
# see it.)
-include ./Makefile.local

# installer image for TF7700
#include make/tfinstaller.mk

# Tell versions [3.59,3.63) of GNU make to not export all variables.
# Otherwise a system limit (for SysV at least) may be exceeded.
.NOEXPORT:
